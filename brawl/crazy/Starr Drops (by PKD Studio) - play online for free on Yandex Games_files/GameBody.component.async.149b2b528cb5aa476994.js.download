(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[5676],{88249:(e,t,s)=>{"use strict";s.d(t,{N:()=>i});var i=function(){return"undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement}},89193:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var i=s(87363),n=s.n(i),a=s(86976);const r=(0,a.Z)({resolved:{},chunkName:()=>"DebugPanel.component.async",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!s.m[t]},importAsync:()=>Promise.all([s.e(2683),s.e(1685),s.e(7671)]).then(s.bind(s,93717)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return s(t)},resolve(){return 93717}},{ssr:!1}),o=r},39010:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var i=s(87363),n=s.n(i),a=s(86976);const r=(0,a.Z)({resolved:{},chunkName:()=>"PassportRegistrationChecker.component.async",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!s.m[t]},importAsync:()=>s.e(6952).then(s.bind(s,19599)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return s(t)},resolve(){return 19599}},{ssr:!1}),o=r},14665:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var i=s(87363),n=s.n(i),a=s(86976);const r=(0,a.Z)({resolved:{},chunkName:()=>"AuthDialog.component.async",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!s.m[t]},importAsync:()=>s.e(8946).then(s.bind(s,67656)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return s(t)},resolve(){return 67656}},{ssr:!1}),o=r},48225:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var i=s(87363),n=s.n(i),a=s(86976);const r=(0,a.Z)({resolved:{},chunkName:()=>"BalanceRefilled.component.async",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!s.m[t]},importAsync:()=>s.e(4521).then(s.bind(s,62706)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return s(t)},resolve(){return 62706}},{ssr:!1}),o=r},92999:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var i=s(87363),n=s.n(i),a=s(86976);const r=(0,a.Z)({resolved:{},chunkName:()=>"Feedback.component.async",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!s.m[t]},importAsync:()=>Promise.all([s.e(6122),s.e(1648),s.e(7110)]).then(s.bind(s,35666)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return s(t)},resolve(){return 35666}},{ssr:!1}),o=r},59389:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var i=s(87363),n=s.n(i),a=s(86976);const r=(0,a.Z)({resolved:{},chunkName:()=>"MergeConflictsDialog.component.async",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!s.m[t]},importAsync:()=>s.e(3925).then(s.bind(s,29069)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return s(t)},resolve(){return 29069}},{}),o=r},11775:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var i=s(87363),n=s.n(i),a=s(86976);const r=(0,a.Z)({resolved:{},chunkName:()=>"PlayGameHeaderMenu.component.async",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!s.m[t]},importAsync:()=>Promise.all([s.e(2683),s.e(1685),s.e(4932)]).then(s.bind(s,61041)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return s(t)},resolve(){return 61041}},{}),o=r},69833:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var i=s(87363),n=s.n(i),a=s(86976);const r=(0,a.Z)({resolved:{},chunkName:()=>"PlayPurchaseDialog.component.async",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!s.m[t]},importAsync:()=>Promise.all([s.e(6122),s.e(2683),s.e(1685),s.e(8726)]).then(s.bind(s,38490)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return s(t)},resolve(){return 38490}},{ssr:!1}),o=r},43633:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var i=s(87363),n=s.n(i),a=s(86976);const r=(0,a.Z)({resolved:{},chunkName:()=>"PlaySimilarGamesManager.component.async",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!s.m[t]},importAsync:()=>Promise.all([s.e(6122),s.e(9359)]).then(s.bind(s,93175)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return s(t)},resolve(){return 93175}},{}),o=r},87005:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var i=s(87363),n=s.n(i),a=s(86976);const r=(0,a.Z)({resolved:{},chunkName:()=>"InGameProfilePopup.component.async",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!s.m[t]},importAsync:()=>s.e(888).then(s.bind(s,44194)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return s(t)},resolve(){return 44194}},{}),o=r},125:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var i=s(87363),n=s.n(i),a=s(86976);const r=(0,a.Z)({resolved:{},chunkName:()=>"QuestManager.component.async",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!s.m[t]},importAsync:()=>s.e(3111).then(s.bind(s,73457)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return s(t)},resolve(){return 73457}},{ssr:!1}),o=r},58097:(e,t,s)=>{"use strict";s.d(t,{c:()=>r});var i=s(87363),n=s.n(i),a=s(86976);const r=(0,a.Z)({resolved:{},chunkName:()=>"UserContainer.component.async",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!s.m[t]},importAsync:()=>Promise.all([s.e(6122),s.e(2683),s.e(1685),s.e(1891)]).then(s.bind(s,48053)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return s(t)},resolve(){return 48053}},{resolveComponent:e=>e.UserContainer})},33196:(e,t,s)=>{"use strict";s.d(t,{Z:()=>d});var i=s(87363),n=s.n(i),a=s(86976),r=s(1481);const o=(0,a.Z)({resolved:{},chunkName:()=>"Promo.component.async",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!s.m[t]},importAsync:()=>s.e(3660).then(s.bind(s,46993)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return s(t)},resolve(){return 46993}},{ssr:!1,error:r.Z}),d=o},13048:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var i=s(87363),n=s.n(i),a=s(86976);const r=(0,a.Z)({resolved:{},chunkName:()=>"ScopesDialog.component.async",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!s.m[t]},importAsync:()=>s.e(7925).then(s.bind(s,72100)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return s(t)},resolve(){return 72100}},{}),o=r},33381:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var i=s(87363),n=s.n(i),a=s(86976);const r=(0,a.Z)({resolved:{},chunkName:()=>"ShortcutPopup.component.async",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!s.m[t]},importAsync:()=>s.e(6587).then(s.bind(s,82579)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return s(t)},resolve(){return 82579}},{}),o=r},85152:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var i=s(87363),n=s.n(i),a=s(86976);const r=(0,a.Z)({resolved:{},chunkName:()=>"TurboAppRemover.component.async",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!s.m[t]},importAsync:()=>s.e(662).then(s.bind(s,20717)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return s(t)},resolve(){return 20717}},{}),o=r},89775:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var i=s(87363),n=s.n(i),a=s(86976);const r=(0,a.Z)({resolved:{},chunkName:()=>"UserActivityPopup.component.async",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!s.m[t]},importAsync:()=>s.e(987).then(s.bind(s,11305)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return s(t)},resolve(){return 11305}},{}),o=r},47774:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var i=s(87363),n=s.n(i),a=s(86976);const r=(0,a.Z)({resolved:{},chunkName:()=>"UxFeedbackFrame.component.async",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!s.m[t]},importAsync:()=>s.e(7191).then(s.bind(s,40023)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return s(t)},resolve(){return 40023}},{ssr:!1}),o=r},81839:(e,t,s)=>{"use strict";s.d(t,{Z:()=>d});var i=s(87363),n=s.n(i),a=s(86976),r=s(77976);const o=(0,a.Z)({resolved:{},chunkName:()=>"GameInfo.component.async",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!s.m[t]},importAsync:()=>Promise.all([s.e(6122),s.e(2683),s.e(1685),s.e(1648),s.e(4005),s.e(7734),s.e(805)]).then(s.bind(s,30841)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return s(t)},resolve(){return 30841}},{error:r.Z}),d=o},17780:(e,t,s)=>{"use strict";s.d(t,{E:()=>n});var i=s(95765);const n=({baseUrl:e,path:t,lang:s,languages:n,tld:a="ru"})=>{let r="";void 0!==s&&(r=(({lang:e,languages:t,tld:s})=>"com"===s&&"en"!==e&&t.includes(e))({languages:n,lang:s,tld:a})?`${s}/`:"");let o=`${`${e}${r?`/${r.replace(/\/*$/,"")}`:""}`}${t}`;return r&&(o=(0,i.D)(o)),o}},26108:(e,t,s)=>{"use strict";s.d(t,{C:()=>i,Z:()=>n});var i=(e=>(e[e.Pending=0]="Pending",e[e.Fulfilled=1]="Fulfilled",e[e.Rejected=2]="Rejected",e))(i||{});const n=class{constructor(){this.resolve=()=>{},this.reject=()=>{},this.promiseState=0,this.promise=new Promise(((e,t)=>{this.resolve=t=>{this.promiseState=1,e(t)},this.reject=e=>{this.promiseState=2,t(e)}}))}get state(){return this.promiseState}}},10576:(e,t,s)=>{"use strict";s.d(t,{_I:()=>n});const i={AVATAR:"avatar",NAME:"public_name"};Object.keys(i).map((e=>i[e]));var n=(e=>(e.ALLOW="allow",e.FORBID="forbid",e.NOT_SET="not_set",e))(n||{})},95631:(e,t,s)=>{"use strict";s.d(t,{X:()=>S});var i,n,a=s(87363),r=s.n(a),o=s(51813);function d(){return d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e},d.apply(this,arguments)}const l=e=>a.createElement("svg",d({fill:"none",viewBox:"0 0 18 18",xmlns:"http://www.w3.org/2000/svg"},e),i||(i=a.createElement("rect",{width:"100%",height:"100%",rx:4})),n||(n=a.createElement("path",{fill:"currentColor",d:"M5.456 7.846 3.95 9.353l4.02 4.02 1.507-1.507L14.5 6.84l-1.507-1.507-5.025 5.025z"})));var c=s(9579),h=s(86871);let u;var p=Object.defineProperty,v=Object.defineProperties,m=Object.getOwnPropertyDescriptors,g=Object.getOwnPropertySymbols,w=Object.prototype.hasOwnProperty,y=Object.prototype.propertyIsEnumerable,f=(e,t,s)=>t in e?p(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;const b={...(u=s(42762))&&u.default||{}},A=(0,a.forwardRef)(((e,t)=>{const s=e,{align:i="center",className:n="",size:d,checked:u=!1,disabled:p=!1,onChange:A,onKeyDown:S,onKeyUp:k,label:E}=s,I=((e,t)=>{var s={};for(var i in e)w.call(e,i)&&t.indexOf(i)<0&&(s[i]=e[i]);if(null!=e&&g)for(var i of g(e))t.indexOf(i)<0&&y.call(e,i)&&(s[i]=e[i]);return s})(s,["align","className","size","checked","disabled","onChange","onKeyDown","onKeyUp","label"]),R=`input-${(0,a.useId)()}`,P=(0,a.useCallback)((e=>{!p&&(null==A||A(e))}),[p,A]),T=(0,h.c)({variant:"checkbox-label"});return r().createElement("div",{className:(0,c.y)(b.checkbox,p&&b.disabled,u&&b.checked,b[`align-${i}`],b[`sz-${d}`])},E&&r().createElement("label",{className:(0,c.y)(b.part,b.label,T),htmlFor:R},E),r().createElement("div",{className:(0,c.y)(b.wrapper,b.part)},r().createElement("div",{className:(0,c.y)(b.tick)},u&&r().createElement(o.Z,{size:18},r().createElement(l,null))),r().createElement("input",(C=((e,t)=>{for(var s in t||(t={}))w.call(t,s)&&f(e,s,t[s]);if(g)for(var s of g(t))y.call(t,s)&&f(e,s,t[s]);return e})({type:"checkbox"},I),L={autoComplete:"off",checked:u,className:(0,c.y)(n,b.control),disabled:p,id:R,ref:t,onChange:P},v(C,m(L))))));var C,L}));A.displayName="Checkbox";const S=(0,a.memo)(A)},36640:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>yi});var i=s(38096),n=s(26108),a=s(85383),r=s(87363),o=s.n(r),d=s(29994),l=s(31320),c=s(43548),h=s(24890);const u="achv-manager";var p=s(68878),v=s(37705),m=s(40656),g=s(93298);const w=class{};w.achvPropsNamesMapping={slug:"id",status:"type",target:"cost",title:"name"},w.achvPropsValuesMapping={target:({goal:e})=>e},w.achvStatusMapping={allGlobal:"all_global",allLocal:"all_local",completed:"completed",inProgress:"in_progress",expired:"expired"},w.mapAcvToAchvEntity=e=>Object.entries(e).reduce(((e,[t,s])=>{const i=w.achvPropsValuesMapping[t];let n=s;return i&&(n=i(s)),e[w.achvPropsNamesMapping[t]||t]=n,e}),{}),w.mapAchvStatus=e=>w.achvStatusMapping[e];let y=w;var f=Object.defineProperty,b=Object.getOwnPropertySymbols,A=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable,k=(e,t,s)=>t in e?f(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,E=(e,t)=>{for(var s in t||(t={}))A.call(t,s)&&k(e,s,t[s]);if(b)for(var s of b(t))S.call(t,s)&&k(e,s,t[s]);return e},I=(e,t,s)=>new Promise(((i,n)=>{var a=e=>{try{o(s.next(e))}catch(e){n(e)}},r=e=>{try{o(s.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,r);o((s=s.apply(e,t)).next())}));const R=class{};R.setProgressErrMsg="Achievements | setProgress: cannot set achievement progress",R.getProgressErrMsg="Achievements | getProgress: cannot get achievement progress",R.getListErrMsg="Achievements | getList: cannot load achievements list",R.incorrectActionTypeErrMsg="Incorrect action type",R.logPrefix="Achievements | Parent frame",R.logColor={background:"#355c7d",text:"#ffffff"},R.debugLog=(0,g.M$)(R.logPrefix,g.XG.Dev,R.logColor),R.path="/achievements",R.timeout=5*m.WT*(0,l.n)(),R.lang=p.g.RU,R.isInitialized=!1,R.init=e=>{R.lang=e,R.isInitialized||(c.Z.onExternalMessage(u,R.onMessage),R.isInitialized=!0)},R.onMessage=({data:{type:e,action:t,data:s}},i)=>{const n=e=>i({data:{success:!0,result:e}}),a=e=>i({data:{success:!1,error:e}});switch(R.debugLog(`received ${u} messages event: `,e,t,s),t){case"setProgress":R.setProgress(s).then(n).catch((()=>a(R.setProgressErrMsg)));break;case"getProgress":R.getList(null,null==s?void 0:s.id).then((e=>{if(!e.length)return Promise.reject();n(e[0].progress)})).catch((()=>a(R.getProgressErrMsg)));break;case"getList":R.getList((null==s?void 0:s.status)||null).then(n).catch((()=>a(R.getListErrMsg)));break;default:R.log(new Error(`${R.incorrectActionTypeErrMsg}: ${t}`))}},R.setProgress=(...e)=>I(R,[...e],(function*(e={}){const{id:t,progress:s}=e;return t&&void 0!==s?R.fetch([],{method:"PATCH",body:JSON.stringify({slug:t,progress:{score:s}}),headers:new Headers({"content-type":"application/json"})}).then((({data:e})=>y.mapAcvToAchvEntity(e))):Promise.reject()})),R.getList=(e,t="")=>I(R,null,(function*(){if(Boolean(e&&e.length)===Boolean(t))return Promise.reject();const s=[["lang",R.lang]];return e&&e.length&&s.push(["status",y.mapAchvStatus(e[0])]),t&&s.push(["slug",t]),R.fetch(s).then((({data:e})=>e.map((e=>y.mapAcvToAchvEntity(e)))))})),R.fetch=(...e)=>I(R,[...e],(function*(e=[],t={}){const s=new URLSearchParams(e).toString();return(0,h.rQ)({apiPath:`${R.path}${s?"?"+s:""}`,options:E(E({},{credentials:"include",method:"GET"}),t),timeout:R.timeout}).catch((e=>{throw R.log(e),e}))})),R.log=({name:e="Error",message:t="Unknown achievements error"},s="")=>{const i=`${e}: ${t}`;R.debugLog(i),(0,v.H)({block:R.logPrefix,message:i,source:R.logPrefix,sourceMethod:s})};let P=R;const T=(0,r.memo)((({lang:e})=>((0,r.useEffect)((()=>P.init(e)),[e]),o().createElement(o().Fragment,null))));var C=s(60764),L=s(99572),D=s(45331),O=s(34235),B=s(77123);const x=s(14665).Z;var _=s(33119),N=s(65015),q=s(68279),M=s(21466),$=s(81470),F=s(98589),W=s(42126),Z=s(58432),U=s(83242),H=s(76488),z=s(17254),G=s(91605),j=s(77901),V=s(41811),Y=(e,t,s)=>new Promise(((i,n)=>{var a=e=>{try{o(s.next(e))}catch(e){n(e)}},r=e=>{try{o(s.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,r);o((s=s.apply(e,t)).next())}));const K=(0,g.M$)("auth-dialog-manager",g.XG.Dev);class X extends r.Component{constructor(e){var t;super(e),this.state={requestId:"",visible:!1},this.checkLogin=()=>{const e=(0,U.e)(this.authCookieName);this.login&&e&&this.login!==e&&(K("AuthDialogManager: change_account"),(0,G.U4)({},{backgroundAuthChange:"change_account"})),this.login=e},this.onInternalMessage=(e,t)=>{const{action:s,data:i}=e.data;if(this.isDisabled)return t({error:new Error("auth disabled")});"open"!==s&&"open-auth-window"!==s||(this.close(),this.setState({requestId:i.requestId},(()=>{this.createAuthPromise(e,t)})))},this.onAuthChanged=e=>{const{action:t,data:s}=e.data;["changed","auth-dialog-success"].includes(t)&&s.hasAuth!==this.props.hasAuth&&this.props.getUserPassport()},this.onDialogApply=()=>{this.sendParams("ok");const e=this._openAuthWindow();e?this.resolvePromise(e):this.rejectPromise(new q.Z({code:"AUTH_WINDOW_REJECTED",message:"Can not open auth window."})),this.close()},this.onDialogClose=()=>{this.sendParams("cancel"),this.close()};const s=(null==(t=(0,i.getDomainConfig)().auth)?void 0:t.provider)===O.Ho.XSOLLA;this.authCookieName=s?"xsolla_login":"yandex_login",this.login=(0,U.e)(this.authCookieName)}componentDidMount(){c.Z.onInternalMessage("auth-dialog",this.onInternalMessage),c.Z.onInternalMessage("auth",this.onAuthChanged,{withHistory:!0}),document.addEventListener("visibilitychange",this.checkLogin)}componentWillUnmount(){c.Z.offInternalMessage("auth-dialog",this.onInternalMessage),c.Z.offInternalMessage("auth",this.onAuthChanged),document.removeEventListener("visibilitychange",this.checkLogin)}componentDidUpdate(e){e.hasAuth!==this.props.hasAuth&&(this.login=(0,U.e)(this.authCookieName),this.props.hasAuth?this.props.fetchPlatformSubscriptions():this.props.clearPlatformSubscriptions())}createAuthPromise(e,t){const{action:s,data:i}=e.data;let n;switch(s){case"open-auth-window":n=this.openAuthWindow(!1,i.origin);break;case"open":n=this.open();break;default:return}n.then((e=>t({data:{authWindow:e}}))).catch((e=>{K(`${s} auth dialog error`,e),t({error:e})}))}sendParams(e){F.Z.params({borrowParams:{sdk:{auth:{dialog:e,appId:this.context.playPageData.gameInfo.appId}}}})}open(){return Y(this,null,(function*(){if(this.props.hasAuth)return;if(!this.props.inCurrentTab){const e=yield this._tryOpenAuthWindowOnStart();if(e)return Promise.resolve(e)}const e=this.setPromise();return this.showDialog(),e.promise}))}openAuthWindow(e=!1,t){return Y(this,null,(function*(){if(e)return Promise.resolve(this._openAuthWindow(t)||void 0);const{data:s}=yield c.Z.post({type:"auth",action:"has-auth"}),{hasAuth:i}=s;return!i&&this._openAuthWindow(t)||void 0}))}_tryOpenAuthWindowOnStart(){return function(){const{userAgent:e}=window.navigator;return!/^((?!chrome|android).)*safari/i.test(e)&&!/\sFirefox\//.test(e)&&!!/\sChrome\//.test(e)}()&&this.openAuthWindow()||Promise.resolve(void 0)}showDialog(){this.setState({visible:!0})}setPromise(){if(this.openPromise)return this.openPromise;let e=()=>{},t=()=>{};const s={promise:new Promise(((s,i)=>{e=s,t=i})),resolve:e,reject:t};return this.openPromise=s,s}resolvePromise(e){this.openPromise&&(this.openPromise.resolve(e),this.openPromise=null)}rejectPromise(e){this.openPromise&&(this.openPromise.reject(e),this.openPromise=null)}close(){this.setState({requestId:"",visible:!1}),this.rejectPromise(new q.Z({code:"AUTH_DIALOG_CANCEL",message:"User canceled auth dialog."}))}_openAuthWindow(e="games_sdk_auth"){const t=(0,j.zd)(),s=(0,Z.KT)(),n=V.XL.includes(s),a=this.props.inCurrentTab||t||n||this.context.isTranssion,{provider:r}=(0,i.getDomainConfig)().auth||{};let o="";a?(o=window.location.href,n&&(o=(0,W.Z)({url:o,params:{clid:s}}))):o=(0,M.EP)(`${location.origin}${this.context.baseUrl}/sdk/static/auth-retpath.html?req-id=${encodeURIComponent(this.state.requestId)}&origin=${encodeURIComponent(window.origin)}&version=${encodeURIComponent(this.context.version)}`);const d=(0,z.x)()?H.tu:"";let l=`https://${(0,H.GH)()}/auth${d}?from=game&origin=${encodeURIComponent(e)}&retpath=${encodeURIComponent(o)}`;const{requestId:c}=this.state;if(this.props.isOauth){if(!c)return void(0,N.fF)(new Error("No requestId for OAuthURL"));l=$.Z.getOauthUrl(c)}else if(r===O.Ho.XSOLLA){if(!c)return void(0,N.fF)(new Error("No requestId for XSollaUrl"));l=$.Z.getXsollaAuthUrl(c)}if(!a)return window.open(l,"_blank");window.location.href=l}get isDisabled(){const e=(0,Z.KT)();return V.TZ.includes(e)}render(){return this.state.visible?o().createElement(x,{onApply:this.onDialogApply,onClose:this.onDialogClose}):null}}X.contextType=D.Z;const J=(0,d.$j)((function(e){return{isOauth:e.userData.isOauth,hasAuth:Boolean(e.userData.login)}}),(function(e){return(0,B.DE)({getUserPassport:_.Ps,fetchPlatformSubscriptions:_.VR,clearPlatformSubscriptions:_.cp},e)}))(X);var Q=s(68797),ee=s(24029),te=s(88372),se=s(92999),ie=s(11324),ne=s(35090);class ae extends D.P{constructor(){super(...arguments),this.state={dialogIsRequested:!1,dialogWasRequested:!1,isCanShow:!1,reason:"UNKNOWN",wasTriggered:!1},this.onInternalMessage=e=>{var t,s;if("request-review"===e.data.action){this.setState({dialogIsRequested:!0});const{gameInfo:e}=this.context.playPageData,i=null==(s=null==(t=this.context.playPageData)?void 0:t.gameData)?void 0:s.media;this.props.dispatch((0,_.N3)({appID:parseInt(e.appId,10),gameID:e.appId,pictureUrl:i?(0,ie.Jn)(i,{size:V.xY.YOUR_GAMES}):"",game:e,gameName:e.title}))}},this.onExternalMessage=(e,t)=>{switch(e.data.action){case"request-review":this.setPromise(),this.openPopupDialog().then((e=>{this.setState({dialogIsRequested:!1},(()=>{t({data:e})}))})).catch((e=>{t({data:{feedbackSent:!1,reason:e}})}));break;case"can-review":this.releasePromise(),this.canShowPopup().then((({hasAuth:e,rated:s,isCanShow:i,reason:n})=>{i?this.setState({isCanShow:i},(()=>{t({data:{value:i}})})):this.state.wasTriggered&&n?t({data:{reason:n,value:i}}):s?this.setState({reason:"GAME_RATED",wasTriggered:!0},(()=>{t({data:{reason:"GAME_RATED",value:!1}})})):e?this.setState({isCanShow:!0,wasTriggered:!0},(()=>{t({data:{value:!0}})})):this.setState({reason:"NO_AUTH",wasTriggered:!0},(()=>{t({data:{reason:"NO_AUTH",value:!1}})}))})).catch((()=>{this.setState({reason:"UNKNOWN",wasTriggered:!0},(()=>{t({data:{reason:"UNKNOWN",value:this.state.isCanShow}})}))}))}}}componentDidMount(){var e;const{gameInfo:t}=this.context.playPageData,s=null==(e=this.context.playPageData.gameData)?void 0:e.media;this.props.dispatch((0,_.N3)({appID:parseInt(t.appId,10),gameID:t.appId,pictureUrl:s?(0,ie.Jn)(s,{size:V.xY.YOUR_GAMES}):"",game:t,gameName:t.title})),c.Z.onExternalMessage("feedback",this.onExternalMessage),c.Z.onInternalMessage("feedback",this.onInternalMessage)}componentWillUnmount(){c.Z.offExternalMessage("feedback",this.onExternalMessage),c.Z.offInternalMessage("feedback",this.onInternalMessage),this.props.dispatch((0,_.N3)({appID:null,gameID:null,rating:0,text:""}))}componentDidUpdate(e){if(this.promiseWrapper&&e.appID&&!this.props.appID&&["ready","success","error"].includes(e.state)){const{result:t,state:s}=e;"success"===s?this.promiseWrapper.resolve(t):this.promiseWrapper.reject(new Error("Unknown")),this.promiseWrapper=void 0}}releasePromise(){this.promiseWrapper&&(this.promiseWrapper.reject(new Error("Reject")),this.promiseWrapper=void 0)}setPromise(){this.releasePromise(),this.promiseWrapper=new n.Z}canShowPopup(){return new Promise(((e,t)=>{var s;if((0,z.x)())return e({isCanShow:!1,reason:"REQUESTED_FROM_TV"});if(null==(s=(0,i.getDomainConfig)().feedbackSettings)?void 0:s.disableRate)return e({isCanShow:!1,reason:"UNKNOWN"});c.Z.post({type:"auth",action:"has-auth"}).then((({data:s})=>{const{hasAuth:i}=s;if(i&&H.XK&&"NO_AUTH"===this.state.reason)return void e({isCanShow:!0});if(this.state.wasTriggered&&this.state.isCanShow)return void e({isCanShow:this.state.isCanShow});if(this.state.wasTriggered&&!this.state.dialogIsRequested&&!this.state.dialogWasRequested)return void e({isCanShow:this.state.isCanShow,reason:this.state.reason});if(!i&&H.XK)return void e({isCanShow:!1,reason:"NO_AUTH"});if(this.state.dialogIsRequested)return void e({isCanShow:!1,reason:"REVIEW_ALREADY_REQUESTED"});if(this.state.dialogWasRequested)return void e({isCanShow:!1,reason:"REVIEW_WAS_REQUESTED"});const{appId:n}=this.context.playPageData.gameInfo;this.props.dispatch((0,_.bq)(parseInt(n,10))).then(e).catch(t)}))}))}openPopupDialog(){var e;return this.state.wasTriggered&&this.state.isCanShow&&!this.state.dialogIsRequested&&!this.state.dialogWasRequested||(0,ne._G)()?(this.setState({dialogIsRequested:!0,dialogWasRequested:!0,isCanShow:!1}),(null==(e=this.promiseWrapper)?void 0:e.promise)||Promise.reject(new Error("Unexpected error"))):Promise.reject(new Error("Unexpected usage (use canReview before requestReview)"))}render(){return this.state.dialogIsRequested?o().createElement(se.Z,null):null}}const re=(0,d.$j)((function(e){return{appID:e.feedback.appID,rating:e.feedback.rating,result:e.feedback.result,state:e.feedback.state}}))(ae);var oe=s(13571),de=s(47552),le=s(86156),ce=s(74232);const he=()=>{const[e,t]=(0,r.useState)(""),s=(0,r.useCallback)((e=>{"show"===e.data.action&&t(e.data.data.message)}),[]);return(0,r.useEffect)((()=>(c.Z.onInternalMessage("message-box",s),()=>{c.Z.offInternalMessage("message-box",s)})),[s]),e?o().createElement(ce.Z,{autohide:!0},e):null};const ue=s(39010).Z;var pe=s(58613),ve=s(46211);const me=(0,g.M$)("PlatformSubscriptions",g.XG.Dev);class ge extends r.PureComponent{componentDidMount(){me("componentDidMount"),this.removeExpiredSubscriptions();Boolean(this.props.userData.login)&&Math.abs(Date.now()-this.props.subscriptions.time)>m.dV&&this.props.fetchPlatformSubscriptions()}componentWillUnmount(){this.removeExpiredSubscriptionsTimeout&&window.clearTimeout(this.removeExpiredSubscriptionsTimeout)}componentDidUpdate(e){const t=e.subscriptions,s=this.props.subscriptions;JSON.stringify(t)!==JSON.stringify(s)&&me("Subscriptions was updated",this.props.subscriptions)}removeExpiredSubscriptions(){me("removeExpiredSubscriptions");const{subscriptions:e,time:t,ver:s}=this.props.subscriptions;if("object"!=typeof e||"number"!=typeof t||s!==pe.iY||Math.abs(Date.now()-t)>m.s2)this.props.setPlatformSubscriptions(pe.$F.platformSubscriptions);else{let i=!1;Object.keys(e).forEach((t=>{const s=e[t],n=s.time?s.time+s.duration:s.expired;(function(e){return"object"==typeof e&&"number"==typeof e.duration&&"number"==typeof e.expired})(s)&&Date.now()<n||(me(`remove "${t}" subscription`),delete e[t],i=!0)})),i&&this.props.setPlatformSubscriptions({subscriptions:e,time:t,ver:s})}this.removeExpiredSubscriptionsTimeout=window.setTimeout((()=>this.removeExpiredSubscriptions()),m.dV)}render(){return null}}ge.contextType=D.Z;const we=(0,d.$j)((function(e){const{value:t,error:s}=(0,ve.c)(e);return{subscriptions:t,error:s,userData:e.userData}}),(function(e){return(0,B.DE)({fetchPlatformSubscriptions:_.VR,setPlatformSubscriptions:_.Cg},e)}))(ge);var ye=s(90268),fe=s(40532),be=s(27102),Ae=s(26256),Se=s(63904),ke=s.n(Se),Ee=s(36355),Ie=s(89492),Re=s(18455);const Pe=s(11775).Z;var Te=s(85510),Ce=s(58097),Le=s(36172),De=s(91521);var Oe=s(85578),Be=s(28705),xe=s(17061);var _e=s(73285),Ne=s(65751),qe=s(17780),Me=s(68108);function $e(e){var t;const{url:s,source:n,lang:a,location:r,context:o}=e,{hidePaymentsAndCurrency:d,isPWA:l,pfid:c,referrer:h,tld:u,baseUrl:p}=o,v=Ne.parse((null==(t=r.search)?void 0:t.slice(1))||""),m=n;d&&(m[V.o1]="1"),l&&(m[V.cB]="1"),(0,Me.sD)(h)&&(m[V.Vw]=h),c&&(m[V.om]=c);const g=["exit-button"];Object.keys(v).forEach((e=>{const t=v[e];g.includes(e)&&"string"==typeof t&&(m[e]=t)}));const w=(0,ne.Yk)(r.search,m);return(0,qe.E)({baseUrl:p,path:w?`${s}${w}`:s,lang:a,languages:(0,i.getDomainConfig)().languages,tld:u})}var Fe=s(92691),We=s(81442),Ze=s(82027),Ue=s(48810),He=s(30448),ze=s(41952),Ge=s(15771),je=s(69838),Ve=s(68606);const Ye=ke().with("play-game-header"),Ke=(0,g.M$)("PlayGameHeader",g.XG.Dev);s(9737);let Xe,Je=0;class Qe extends D.P{constructor(e){super(e),this.menuAnchorRef=o().createRef(),this.backButtonListenerInGame=!1,this.onPlayGameHeaderMessage=e=>{if(!this.props.isVisible)return;const{action:t}=e.data;"show"!==t?"hide"===t&&this.setState({visible:!1}):this.setState({visible:!0})},this.onAppInfoClick=e=>{e.preventDefault(),c.Z.post({type:"document-events",action:"show-info"}),this.sendParams("app-page")},this.onExitButtonClick=()=>{this.sendParams("exit"),this.onExit(!0)},this.onFullscreenButtonClick=()=>{this.sendParams("fullscreen"),this.toggleFullscreen()},this.onHeaderLogoClick=()=>{this.sendParams("logo")},this.onMenuIconClick=()=>{const e=(0,Ve.hY)(Ve.jF.GUARD);e?(0,Ve.Vy)(e.children):(this.sendParams("menu"),this.setState({menuDotted:!1,menuVisible:!this.state.menuVisible}))},this.onBackButtonClick=()=>{this.sendParams("hide-menu-back"),this.closeMenu({isMenuItem:!1,isBackLink:!0})},this.handleMenuClose=e=>{this.closeMenu({isMenuItem:Boolean(null==e?void 0:e.isMenuItem),isBackLink:!1})},this.closeMenu=e=>{e.isMenuItem||e.isBackLink||window.history.back(),this.setState({menuVisible:!1})},this.state={exitEnabled:!1,isFullscreen:!1,menuDotted:!1,menuVisible:!1,visible:e.isVisible}}get isAdvStickyBannerEnabled(){return(0,Be.xm)(this.context.playPageData)}componentDidMount(){Ke("componentDidMount"),this.setMenuDotMarker(),this.setExitButtonAvalibility(),this.setBackButtonGameHandler(),this.initMessaging()}componentWillUnmount(){Ke("componentWillUnmount"),c.Z.offInternalMessage("play-game-header",this.onPlayGameHeaderMessage),this.removeBackButtonListener()}initMessaging(){c.Z.onInternalMessage("play-game-header",this.onPlayGameHeaderMessage)}sendParams(e){F.Z.params({borrowParams:{header:{action:e}}})}setMenuDotMarker(){var e,t,s;const i=!0===(null==(s=null==(t=null==(e=window.YandexGamesSDK)?void 0:e.game.settings)?void 0:t.extraFeatures)?void 0:s.leaderboards)&&!(0,Ue.dq)(De.b).value,n=!(0,Ue.dq)(De.Z).value&&!(0,Fe.V)(this.context.abt.flags);this.setState({menuDotted:i||n})}setExitButtonAvalibility(){const e=this.context.isGamesApp||-1!==window.location.href.indexOf("exit-button=1");e&&(this.context.isGamesApp?this.handleHistoryBack():(0,He.c)((()=>{window.setTimeout((()=>this.handleHistoryBack()))}),{once:!0})),this.setState({exitEnabled:e})}setBackButtonGameHandler(){}get isEmbeddedWindow(){return Boolean("object"==typeof window&&window.parent!==window)}isFullscreenButtonAvailable(){return!(this.isEmbeddedWindow&&!(0,We.r)())&&(!this.state.exitEnabled&&this.props.isFullscreenEnabled)}handleHistoryBack(){window.history.pushState("root",""),window.history.pushState("main-page",""),window.addEventListener("popstate",(e=>{if(this.clearingHistoryAndGoToCatalog)null===e.state?function(e){const t=["utm_medium","utm_source"].reduce(((e,s)=>{const i=(0,xe.V)(s);return i&&(t[s]=i),e}),{}),s=(0,W.Z)({url:`${e}/`,params:t});window.location.replace(s)}(this.context.baseUrl):setTimeout((()=>{window.history.back()}),0);else if("root"===e.state){if(window.history.pushState("main-page",""),this.backButtonListenerInGame)return c.Z.postToChild({type:"sdk-event",action:Oe.q.HISTORY_BACK,data:t}),Je>0&&clearTimeout(Xe),Je++,void(Xe=setTimeout((()=>{var e,t;null==(t=null==(e=null==window?void 0:window.Ya)?void 0:e.Rum)||t.logEventString("history_back","",{additional:{backHandleCount:Je}}),Je=0}),2e3));var t;this.onExit()}}),!0)}toggleFullscreen(){c.Z.post({type:"screen-manager",action:"toggle-fullscreen"})}exitToCatalog(){const{reqUrl:e}=this.context,t=$e({url:"/",source:{utm_source:"game_header_x_close"},location:this.props.location,lang:this.props.lang,context:this.context}),s=(0,Re.ky)(t,{currentLocation:e});window.open(s,"_self")}onExit(e){this.context.isGamesApp?c.Z.post({type:"document-events",action:"back"}):e&&this.exitToCatalog()}componentDidUpdate(e,t){t.menuVisible!==this.state.menuVisible&&(this.state.menuVisible?this.addBackButtonListener():this.removeBackButtonListener())}addBackButtonListener(){setTimeout((()=>window.history.pushState("menu","","#menu")),0),window.addEventListener("popstate",this.onBackButtonClick,!1)}removeBackButtonListener(){window.removeEventListener("popstate",this.onBackButtonClick)}renderLogo(){const{isPWA:e,oneTabPWA:t,reqUrl:s}=this.context,i=$e({url:"/",source:{utm_source:"game_header_logo"},location:this.props.location,lang:this.context.pathLang,context:this.context});return o().createElement("span",{className:Ye("logo"),onClick:this.onHeaderLogoClick},o().createElement(Re.Kk,{className:`${Ye("logo-link")} pointer`,currentLocation:s,href:i,tabIndex:-1,target:(0,Ze.AO)({isPWA:e,oneTabPWA:t}),title:this.props.getText("common.service.name")},o().createElement(Te.Z,{type:je.q7.HEADER})))}renderHeaderInfo(){const{baseUrlWithLangPath:e,referrer:t,hidePaymentsAndCurrency:s,isPWA:i}=this.context,{appId:n,title:a}=this.context.playPageData.gameInfo,r=`${e}/app/${n}${(0,ne.Px)({search:"?utm_source=game_header_title&info=true",params:{[V.o1]:s?"1":"",[V.om]:(0,xe.V)(V.om,this.context.location)||"",[V.Vw]:(0,Me.sD)(t)?t:"",[V.cB]:i?"1":""}})}`;return o().createElement("span",{className:Ye("info")},o().createElement("span",{className:Ye("middle")},o().createElement("a",{className:`${Ye("link")} hover pointer app-page`,href:r,target:"_blank",title:(0,_e.T)(a),onClick:this.onAppInfoClick},o().createElement("span",{className:Ye("title")},(0,_e.T)(a)))))}renderFullscreenIcon(){const{isFullscreenActive:e}=this.props,{uatraits:t}=this.context,s=(null==t?void 0:t.OSFamily)===Ae.k.IOS&&!(null==t?void 0:t.isTablet),i=(null==t?void 0:t.BrowserName)===Ae.Z.YandexSearch;let n="desktop";return s&&i&&(n="yabroios"),o().createElement(Ie.Z,{className:Ye("fullscreen-icon",{enable:!e}),modifiers:{enable:!e,env:n},type:"fullscreen"})}renderBalance(){const{abt:e,hidePortalCurrency:t}=this.context,{getText:s}=this.props;return t||(0,Ge.Sn)(e.flags)?null:o().createElement("div",{className:`${Ye("action",{balance:!0})} ${Ye("menu")} menu hover pointer`,ref:this.menuAnchorRef,title:s("header.button.balance.text")},o().createElement(Ee.Z,{type:"game"}))}renderActions(){const{getText:e,isFullscreenActive:t}=this.props;let s=$e({url:"/",source:{utm_source:"game_header_tickets",tab_profile:"timeline"},context:this.context,location:this.props.location,lang:this.props.lang});return o().createElement("div",{className:Ye("actions"),"data-nosnippet":"true"},this.renderBalance(),this.isPlayToEarn&&o().createElement(Ce.c,{passportOrigin:ze._4.GamesHeader,small:!0,url:s}),o().createElement("div",{className:`${Ye("action")} ${Ye("menu")} menu hover pointer`,ref:this.menuAnchorRef,title:e("header.button.menu.text"),onClick:this.onMenuIconClick},o().createElement("div",{className:Ye("menu-icon-wrapper",{dotted:this.state.menuDotted})},o().createElement(Ie.Z,{className:Ye("menu-icon"),type:"game-menu-white"})),this.state.menuVisible&&o().createElement(Pe,{anchorRef:this.menuAnchorRef,onClose:this.handleMenuClose})),this.isFullscreenButtonAvailable()&&o().createElement("div",{className:`${Ye("action")} ${Ye("fullscreen")} hover pointer`,title:e(`header.button.${t?"exit":"enter"}-fullscreen.text`),onClick:this.onFullscreenButtonClick},this.renderFullscreenIcon()),this.state.exitEnabled&&o().createElement("div",{className:`${Ye("action")} ${Ye("exit")} hover pointer`,title:e("header.button.exit.text"),onClick:this.onExitButtonClick},o().createElement(Ie.Z,{className:Ye("exit"),type:"exit"})))}render(){return this.isPlayToEarn=(0,Ge.XP)(this.context.abt.flags),o().createElement("div",{className:Ye({"catalog-enabled":!1,"exit-enabled":this.state.exitEnabled,"fullscreen-enabled":this.props.isFullscreenEnabled,"menu-enabled":!0,"with-adv":this.isAdvStickyBannerEnabled,p2e:this.isPlayToEarn,hide:!this.state.visible})},this.state.visible&&o().createElement(o().Fragment,null,this.renderLogo(),this.renderHeaderInfo(),this.renderActions()))}}const et=(0,a.E)((0,d.$j)((function(e){return{darkTheme:(0,Le.Up)(e),isFullscreenActive:e.ui.isFullscreenActive,isFullscreenEnabled:e.ui.isFullscreenEnabled,lang:e.lang,getText:e.getText,userData:e.userData}}))(Qe));var tt=s(10576),st=s(14375),it=s(21742),nt=s(23073),at=s(24149),rt=s(11258),ot=s(72875),dt=s(10131),lt=s(40184),ct=s(85467);const ht=ke().with("play-guard-dialog"),ut=({onAuthButtonClick:e})=>{var t;const s=(0,ct.T)(),{playPageData:{gameSettings:n}}=(0,lt.b)(),a=(0,d.v9)((e=>Boolean(e.userData.login))),{disableLogin:r}=(0,i.getDomainConfig)().auth||{};if(r)return null;return!a&&Boolean(null==(t=n.features)?void 0:t.user_data_required)?o().createElement("div",{className:ht("authorize")},o().createElement("div",{className:ht("authorize-description")},s("guard.player.auth.description")),o().createElement(dt.z,{"data-guard-auth":"true","data-testid":"PlayGuardAuthorize-Button",size:32,type:"submit",view:"secondary",onClick:e},s("common.login"))):null},pt=ke().with("play-guard-dialog"),vt=()=>{const e=(0,ct.T)(),{playPageData:{gameInfo:t}}=(0,lt.b)(),s=t.categoryNames.map((t=>e(`category.${t}.disclaimer`,{withNoErrors:!0}))).filter(Boolean).join("\n");return s?o().createElement("div",{className:pt("disclaimer")},s):null};var mt=s(95631),gt=s(41318);const wt=ke().with("play-guard-dialog"),yt=({onPermissionChange:e,permissionChecked:t,withPurchasesPermissions:s})=>{var i;const{playPageData:{gameSettings:n}}=(0,lt.b)(),a=(0,ct.T)(),r=(0,d.v9)((e=>Boolean(e.userData.login)));if(!(s||r&&Boolean(null==(i=n.features)?void 0:i.user_data_required)))return null;const l=(0,gt.f)(r,s,a);return o().createElement("div",{className:wt("permission")},o().createElement("div",{className:wt("permission-description")},l),o().createElement(mt.X,{checked:t,className:wt("permission-checkbox"),size:18,onChange:e}))};var ft=s(22279);const bt=()=>o().createElement(Ie.Z,{type:"play"}),At=({className:e,onClick:t})=>{const s=(0,ct.T)()("common.play.notable");return o().createElement(ft.Z,{className:e,"data-guard-accept":"play_button",iconLeft:bt,size:"l",type:"submit",view:"play",onClick:t},s)},St=({children:e,className:t,onClick:s})=>{var n,a;const d=(0,r.useContext)(D.Z),{componentsSettings:l}=(0,i.getDomainConfig)(),c=(null==(n=l.buttons)?void 0:n.playGuardApplySize)||"l",h=(null==(a=l.buttons)?void 0:a.playGuardApplyView)||"action";return(0,Ge.Nt)(d.abt.flags)?o().createElement(At,{className:t,onClick:s}):o().createElement(ft.Z,{className:t,"data-guard-accept":"play_button",size:c,type:"submit",view:h,onClick:s},e)};var kt=s(4230),Et=(e=>(e.Background="background",e.CloseButton="close_button",e.DrawerSwipe="drawer_swipe",e.PlayButton="play_button",e))(Et||{}),It=s(92901),Rt=s(98343);function Pt(e){const t=function(e){let t=1;for(let s=1e3;s>1;s/=10)if(e>=s){t=s;break}return t}(e);return Math.floor(e/t)*t}function Tt(e){const t=Pt(e);let s="";try{s=new Intl.NumberFormat("ru-RU").format(t)}catch(e){s=function(e){let t=`${e}`,s="0";for(;t.length>0;){const e=t.slice(-3);t=t.slice(0,-3),s=s?`${e}Â ${s}`:e}return s}(t)}return t>10&&(s+="+"),s}var Ct=s(68199),Lt=(s(53722),s(29008)),Dt=Object.defineProperty,Ot=Object.defineProperties,Bt=Object.getOwnPropertyDescriptors,xt=Object.getOwnPropertySymbols,_t=Object.prototype.hasOwnProperty,Nt=Object.prototype.propertyIsEnumerable,qt=(e,t,s)=>t in e?Dt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,Mt=(e,t)=>{for(var s in t||(t={}))_t.call(t,s)&&qt(e,s,t[s]);if(xt)for(var s of xt(t))Nt.call(t,s)&&qt(e,s,t[s]);return e},$t=(e,t)=>Ot(e,Bt(t));s(52390);const Ft=ke().with("play-guard-dialog");Ft("header-cancel-link"),Ft("permission-checkbox"),Ft("apply-button");class Wt extends D.P{constructor(){super(...arguments),this.hasMounted=!1,this.aboutGameConversionDataEvents={isClicked:!1,isRendered:!1},this.state={permissionChecked:!0,isSimilarGamesEnables:this.isSimilarGamesEnabled()},this.handleEarlyEvents=()=>{var e;null==(e=window.earlyEvents)||e.messages.forEach((e=>{const{type:t,action:s,data:i}=e;if("guard"===t)switch(s){case"auth":this.auth();break;case"close":this.cancel();break;case"accept":this.setState({permissionChecked:i.permissionChecked},(()=>{this.apply(i.actionSource)}))}}))},this.handleFocusOutEvent=e=>{requestAnimationFrame((()=>{if(document.activeElement===(0,It.n)()){window.focus();const t=e.target;t&&"focus"in t&&"function"==typeof t.focus&&t.focus()}}))},this.onAuthButtonClick=()=>{this.auth()},this.onApplyButtonClick=()=>{this.apply(Et.PlayButton)},this.onExternalClick=e=>{const t=this.state.permissionChecked?tt._I.ALLOW:tt._I.FORBID;this.props.handleEvent(new CustomEvent("apply",{detail:{actionSource:Et.Background,permission:this.isPermissionsVisible()?t:void 0}}))},this.onContentClick=e=>{e.stopPropagation()},this.onOpenInfoClick=e=>{e.stopPropagation(),this.logOnceAboutGameConversionDataEventsIsClicked(),this.props.handleEvent(new CustomEvent("info")),c.Z.post({type:"promo-bar",action:"hide"})},this.apply=e=>{const t=this.state.permissionChecked?tt._I.ALLOW:tt._I.FORBID;this.props.handleEvent(new CustomEvent("apply",{detail:{actionSource:e,permission:this.isPermissionsVisible()?t:void 0}}))},this.auth=()=>{this.props.handleEvent(new CustomEvent("auth"))},this.cancel=()=>{this.props.handleEvent(new CustomEvent("cancel"))},this.onPermissionChange=e=>{this.setState($t(Mt({},this.state),{permissionChecked:e.target.checked}))}}componentDidMount(){this.hasMounted=!0,window.focus(),window.addEventListener("focusout",this.handleFocusOutEvent),this.setState($t(Mt({},this.state),{isSimilarGamesEnables:this.isSimilarGamesEnabled()})),this.handleEarlyEvents()}componentWillUnmount(){window.removeEventListener("focusout",this.handleFocusOutEvent)}isSimilarGamesEnabled(){const{abt:{flags:e},playPageData:t,isDistGame:s}=this.context,{location:i}=this.props;return(0,kt._Z)({appId:t.gameInfo.appId,hasMounted:this.hasMounted,isDistGame:s,search:i.search,showOnRedirectFromCatalog:(0,Ge.Fe)(e)})}isAdvStickyBannerEnabled(){const{settings:e}=this.context.playPageData.gameData||{},{adv:t}=(0,Be.Lf)(e);return this.context.playPageData.isAdvStickyBannerEnabled&&Boolean(t)}get texts(){const{getText:e}=this.props,{gamesLogoUrlText:t,gamesLogoUrlYandexName:s,verticalName:i}=this.props.vertical;return{aboutGameText:e(`guard.about-game.vertical-${i}`),commonPlayButtonText:e(`common.play.vertical-${i}`),gamesLogoUrlText:t===je.CF.WEBAPPS_CATEGORY_SERVICE_NAME?e("common.service.app_name"):e("common.service.short_name"),gamesLogoUrlYandexName:s,legalText:e(`guard.legal.text.vertical-${i}`),serviceLogoIconType:`logo-${i}`}}get gameData(){var e,t;const{getText:s}=this.props,{gameInfo:i,gameSettings:n,gameData:a}=this.context.playPageData,r=`guard.${i.hasWebAppsCategory?"users":"players"}.count.text`,o=i.playersCount?s(r,{number:Pt(i.playersCount)}):void 0,d=i.hasWebAppsCategory?s("game.rating.users.new"):s("game.rating.new"),l=(0,Ct.R)(this.context.isSlowCountry)?this.context.cdnUrl:void 0;return{ageRating:null==(e=n.features)?void 0:e.age_rating,hasWebAppsCategory:i.hasWebAppsCategory,icon:(0,ie.kM)(i.iconUrl,l),playersCount:i.playersCount?Tt(i.playersCount):void 0,playersCountText:o,gameQualityScore:i.gameQualityScore,publisher:(0,_e.T)(i.publisher.name),rating:i.rating,ratingText:d,title:(0,_e.T)(i.title),userDataRequired:Boolean(null==(t=n.features)?void 0:t.user_data_required),categories:i.categoryNames,categoriesIDs:(null==a?void 0:a.categoryIDs)||[]}}renderCancelButton(){const{isPWA:e,oneTabPWA:t}=this.context;return o().createElement("a",{className:`${Ft("header-cancel-link")} games-link`,"data-guard-close":"true",target:(0,Ze.AO)({isPWA:e,oneTabPWA:t}),onClick:this.cancel},this.props.getText("common.cancel"))}renderHeader(){const{baseUrl:e,referrer:t,tld:s,isPWA:n,oneTabPWA:a}=this.context,{getText:r,vertical:{verticalCategory:d,verticalName:l}}=this.props,c=d?`/category/${d}`:"/",h=(0,ne.Px)({search:"?utm_source=game_guard_logo",params:{[V.cB]:n?"1":"",[V.Vw]:(0,Me.sD)(t)?t:""}}),u=(0,qe.E)({baseUrl:e,path:`${c}${h?`${h}`:""}`,lang:this.context.pathLang,languages:(0,i.getDomainConfig)().languages,tld:s});return o().createElement("div",{className:Ft("header")},o().createElement("span",{className:Ft("header-logo")},o().createElement(Re.Kk,{className:Ft("header-logo-link"),href:u,tabIndex:-1,target:(0,Ze.AO)({isPWA:n,oneTabPWA:a}),title:r(`common.service.name.vertical-${l}`)},o().createElement(Te.Z,{type:je.q7.GUARD}))),this.renderCancelButton())}renderRating(){return o().createElement("div",{className:Ft("description-players")},this.gameData.gameQualityScore&&o().createElement(at.Z,{value:this.gameData.gameQualityScore}),o().createElement(rt.Z,{hasWebAppsCategory:this.gameData.hasWebAppsCategory,rating:this.gameData.rating,useNewText:!0}))}renderDescription(){const{isSlowCountry:e}=this.context,{ageRating:t}=this.gameData;return o().createElement("div",{className:Ft("description")},o().createElement(ot.Z,{alt:this.gameData.title,className:Ft("description-icon",{low:e}),crossOrigin:"anonymous",size:38,src:this.gameData.icon}),o().createElement("div",{className:Ft("description-details")},o().createElement("div",{className:Ft("description-details-header")},o().createElement("div",{className:Ft("description-title-wrapper")},o().createElement("h1",{className:Ft("description-title"),itemScope:!0,itemType:"http://schema.org/WebPage"},this.gameData.title),t&&o().createElement(it.Wd,{className:Ft("description-ageRating"),"data-testid":"PlayGuard-AgeTag",variant:Lt.Ft[t]},t)),o().createElement("div",{className:Ft("description-publisher")},this.gameData.publisher),o().createElement(nt.Z,{categoriesNames:this.gameData.categories,categoryIDs:this.gameData.categoriesIDs,mix:Ft("categories")}))))}isPermissionsVisible(){return this.props.withPurchasesPermissions||this.props.hasAuth&&this.gameData.userDataRequired}logOnceAboutGameConversionDataEventsIsRendered(){this.aboutGameConversionDataEvents.isRendered||(this.aboutGameConversionDataEvents.isRendered=!0,window.clickdaemonLog(Rt.zx.CONVERSION,{item:"game_page_guard_learn_more_render",app_id:this.context.playPageData.gameInfo.appId}))}logOnceAboutGameConversionDataEventsIsClicked(){this.aboutGameConversionDataEvents.isClicked||(this.aboutGameConversionDataEvents.isClicked=!0,window.clickdaemonLog(Rt.zx.CONVERSION,{item:"game_page_guard_learn_more_click",app_id:this.context.playPageData.gameInfo.appId}))}renderApply(){return o().createElement("div",{className:Ft("apply"),title:this.texts.commonPlayButtonText},o().createElement(St,{className:Ft("apply-button"),onClick:this.onApplyButtonClick},this.texts.commonPlayButtonText))}renderLegal(){const{baseHost:e}=this.context,{getText:t}=this.props;return o().createElement("div",{className:Ft("legal")},this.texts.legalText," ",o().createElement("a",{className:"games-link",href:t("guard.license.link.href"),target:"_blank"},t("guard.license.link.text")))}renderOpenInfo(){return"undefined"!=typeof window&&this.logOnceAboutGameConversionDataEventsIsRendered(),o().createElement("div",{className:`${Ft("open-info")} games-link`,onClick:this.onOpenInfoClick},this.texts.aboutGameText)}render(){const e=this.state.isSimilarGamesEnables&&!this.props.isFullscreenActive;return o().createElement("div",{className:Ft({"with-blur":!0,"with-adv":this.isAdvStickyBannerEnabled(),"with-similar":e,hidden:this.props.hidden}),onClick:this.onExternalClick},o().createElement("div",{className:Ft("content"),onClick:this.onContentClick},this.renderHeader(),this.renderDescription(),this.renderRating(),o().createElement(yt,{permissionChecked:this.state.permissionChecked,withPurchasesPermissions:this.props.withPurchasesPermissions,onPermissionChange:this.onPermissionChange}),o().createElement(ut,{onAuthButtonClick:this.onAuthButtonClick}),this.renderApply(),this.renderLegal(),o().createElement(vt,null)),this.renderOpenInfo())}}const Zt=(0,a.E)((0,d.$j)((function(e){return{darkTheme:(0,Le.Up)(e),hasAuth:Boolean(e.userData.login),lang:e.lang,vertical:e.vertical,isSimilarGamesLoading:e.similarGamesLoading,isFullscreenActive:e.ui.isFullscreenActive,getText:e.getText}}))(Wt));var Ut=s(32054),Ht=s(31136),zt=s(89592);const Gt=(0,g.M$)("PlayGuard",g.XG.Popup);class jt extends D.P{constructor(){super(...arguments),this.state={show:this.isNeedToShow(),hidden:!1},this.wasShowed=!this.state.show,this.permissionsPromiseWrapper=new n.Z,this.onGuardMessage=(e,t)=>{var s;if("play-guard"!==(null==(s=e.data.data)?void 0:s.source))switch(e.data.action){case"is-guard-enabled":t({data:{result:this.isGuardEnabled}});break;case"get-show-state":t({data:{result:!this.wasShowed}});break;case"get-was-showed":t({data:{result:this.wasShowed}});break;case"apply":if(this.wasShowed)this.permissionsPromiseWrapper.reject();else{const{actionSource:t,permission:s}=e.data.data;this.apply({actionSource:t,permission:s})}break;case"show":c.Z.post({type:"promo-bar",action:"show"}),c.Z.post({type:"guard",action:"state-changed",data:{state:"up"}});break;case"focus":this.wasShowed?(0,st.D)():window.focus()}},this.onExternalGuardMessage=(e,t)=>{if("get-permission-promise"===e.data.action)this.wasShowed&&this.permissionsPromiseWrapper.reject(),this.permissionsPromiseWrapper.promise.then((e=>{t({data:{result:e}})})).catch((()=>{t({data:{result:void 0}})}))},this.onScopesMessage=(e,t)=>{"open-scopes-dialog"!==e.data.action||this.wasShowed||(this.openScopesCallback=t)},this.handleEvent=e=>{switch(e.type){case"apply":{const{actionSource:t,permission:s}=e.detail;this.apply({actionSource:t,permission:s});break}case"auth":this.auth();break;case"cancel":this.cancel();break;case"info":this.info()}}}componentDidMount(){Gt("componentDidMount",this.state),c.Z.onExternalMessage("guard",this.onExternalGuardMessage),c.Z.onInternalMessage("guard",this.onGuardMessage,{withHistory:!0}),c.Z.onInternalMessage("scopes",this.onScopesMessage),this.permissionsPromiseWrapper.promise.catch((()=>{}));const e=this.isNeedToShow();this.wasShowed=!e;const t=e?"show":"hide";this.setState({hidden:"undefined"==typeof window,show:e},(()=>{this.wasShowed&&this.postSetWasShowedAction()})),e&&(c.Z.post({type:"promo-bar",action:"show"}),this.sendParams({show:!0})),this.sendParams({initialStatus:t}),c.Z.post({type:"guard",action:"init"}),c.Z.post({type:"guard",action:"state-changed",data:{state:"show"===t?"up":"play"}})}componentWillUnmount(){Gt("componentWillUnmount"),c.Z.offExternalMessage("guard",this.onExternalGuardMessage),c.Z.offInternalMessage("guard",this.onGuardMessage),c.Z.offInternalMessage("scopes",this.onScopesMessage)}get isPurchasesPermissionNeed(){const{playPageData:e,userRegionData:t}=this.context,{gameData:s}=e;return(0,Ut.CU)({gameData:s,userRegionData:t})}get isGuardEnabled(){const{location:e}=this.props,{playPageData:t,abt:s,userRegionData:i}=this.context,{gameData:n}=t,{flags:a}=s,r=(0,Ut.pr)({gameData:n,userRegionData:i});return(0,Ut.ZY)({location:e,flags:a,isConfirmedGuard:r})}isNeedToShow(){return this.isGuardEnabled}apply({actionSource:e,permission:t}){if(this.applyPromise)return;this.applyPromise=Promise.race([(0,Ht.D)(5e3).then((()=>this.permissionsPromiseWrapper.reject())),new Promise(((s,i)=>{const{appId:n}=this.context.playPageData.gameInfo;this.sendScope({appId:n,permission:t,withPurchasesPermissions:this.isPurchasesPermissionNeed,isGuardEnabled:!0}).then((()=>{void 0!==t?(this.permissionsPromiseWrapper.resolve(t),F.Z.params({borrowParams:{personal:{showed:!0,value:t===tt._I.ALLOW}}})):(this.permissionsPromiseWrapper.reject(),F.Z.params({borrowParams:{personal:{showed:!1,value:!1}}})),F.Z.reachGoal(zt.Ji.GUARD_APPLY),n&&F.Z.gtag("view_item",{send_to:"AW-10952943694",value:0,items:[{id:n,location_id:0,google_business_vertical:"custom"}]}),c.Z.post({type:"guard",action:"apply",data:{source:"play-guard"}}),c.Z.post({type:"guard",action:"state-changed",data:{state:"play"}}),this.sendParams({apply:e}),c.Z.post({type:"promo-bar",action:"remove"}),s(void 0)}))}))]).then((()=>this.close())).finally((()=>this.applyPromise=void 0))}auth(){this.sendParams({auth:!0}),c.Z.post({type:"auth",action:"auth-dialog-open",data:{initializer:"guard"}})}cancel(){const{referrer:e}=this.context;this.sendParams({cancel:!0}),this.openScopesCallback&&(this.openScopesCallback({data:{result:!1}}),this.openScopesCallback=void 0),c.Z.post({type:"guard",action:"cancel",data:e?{referrer:e}:{}})}close(){this.wasShowed=!0,this.setState({show:!1},(()=>this.postSetWasShowedAction())),(0,st.D)(),c.Z.post({type:"guard",action:"closed"})}info(){this.sendParams({info:!0}),c.Z.post({type:"guard",action:"info"}),c.Z.post({type:"guard",action:"state-changed",data:{state:"info"}}),c.Z.post({type:"promo-bar",action:"hide"})}sendScope(e){return t=this,s=arguments,i=function*({appId:e,isGuardEnabled:t,withPurchasesPermissions:s,permission:i}){const n=yield c.Z.post({type:"scopes",action:"apply-guard",data:{permission:i,appId:e,isGuardEnabled:t,withPurchasesPermissions:s}});this.openScopesCallback&&(this.openScopesCallback({data:{result:n}}),this.openScopesCallback=void 0)},new Promise(((e,n)=>{var a=e=>{try{o(i.next(e))}catch(e){n(e)}},r=e=>{try{o(i.throw(e))}catch(e){n(e)}},o=t=>t.done?e(t.value):Promise.resolve(t.value).then(a,r);o((i=i.apply(t,s)).next())}));var t,s,i}sendParams(e){F.Z.params({borrowParams:{guard:e}})}postSetWasShowedAction(){c.Z.post({type:"guard",action:"set-was-showed",data:{result:!0}})}render(){return this.state.show?o().createElement(Zt,{handleEvent:this.handleEvent,hidden:this.state.hidden,withPurchasesPermissions:this.isPurchasesPermissionNeed}):null}}const Vt=(0,a.E)((0,d.$j)(null)(jt));var Yt=s(41917),Kt=s(43633),Xt=s(87005),Jt=s(125),Qt=s(73673);const es=s(13048).Z;var ts=s(35864),ss=Object.defineProperty,is=Object.defineProperties,ns=Object.getOwnPropertyDescriptors,as=Object.getOwnPropertySymbols,rs=Object.prototype.hasOwnProperty,os=Object.prototype.propertyIsEnumerable,ds=(e,t,s)=>t in e?ss(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,ls=(e,t)=>{for(var s in t||(t={}))rs.call(t,s)&&ds(e,s,t[s]);if(as)for(var s of as(t))os.call(t,s)&&ds(e,s,t[s]);return e},cs=(e,t)=>is(e,ns(t)),hs=(e,t,s)=>new Promise(((i,n)=>{var a=e=>{try{o(s.next(e))}catch(e){n(e)}},r=e=>{try{o(s.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,r);o((s=s.apply(e,t)).next())}));const us=(0,g.M$)("Scopes",g.XG.Popup),ps={method:"POST",credentials:"include",referrerPolicy:"no-referrer-when-downgrade",headers:{Accept:"application/json","Content-Type":"application/json"}};class vs extends r.Component{constructor(e){super(e),this.onInternalMessage=(e,t)=>{const{action:s,data:i}=e.data;"apply-guard"===s&&this.handleApplyGuard(i,t)},this.onExternalMessage=(e,t)=>{"open-scopes-dialog"===e.data.action&&c.Z.post({type:"guard",action:"get-show-state"}).then((({data:e})=>{const{result:s}=e;s||this.show().then((e=>{t({data:{result:e}})})).catch((()=>{t({data:{result:null}})}))}))},this.handleEvent=e=>{switch(e.type){case"apply":this.sendParams("apply"),this.apply();break;case"cancel":this.sendParams("cancel"),this.cancel();break;case"close":this.sendParams("close"),this.close();break;default:(0,N.fF)(new Error(`Unknown event type ${e.type}`))}},this.state={show:!1}}componentDidMount(){us("componentDidMount"),c.Z.onInternalMessage("scopes",this.onInternalMessage),c.Z.onExternalMessage("scopes",this.onExternalMessage)}componentWillUnmount(){us("componentWillUnmount"),c.Z.offInternalMessage("scopes",this.onInternalMessage),c.Z.offExternalMessage("scopes",this.onExternalMessage)}handleApplyGuard(e,t){!e.isGuardEnabled&&this.props.hasAuth?e.permission&&this.postDataPermissions({permissions:e.permission,withPurchasesPermissions:e.withPurchasesPermissions}).then((e=>t({data:{result:e}}))).catch((()=>t({data:{result:null}}))):this.postData({permissions:e.permission,guardConfirm:!0,withPurchasesPermissions:e.withPurchasesPermissions}).then((e=>t({data:{result:e}}))).catch((()=>t({data:{result:null}})))}show(){const e=this.context.abt.flags;if(this.showPromiseWrapper)return this.showPromiseWrapper.promise;this.setState({show:!0}),this.sendParams("show");const t=this.createShowPromiseWrapper();return((0,z.x)()&&(0,Ge.r7)(e)||function(){const e=(0,Z.KT)();return V.XL.includes(e)}())&&this.handleEvent(new CustomEvent("cancel")),t}createShowPromiseWrapper(){return this.showPromiseWrapper=new n.Z,this.showPromiseWrapper.promise}postData(e){return hs(this,arguments,(function*({guardConfirm:e,permissions:t,withPurchasesPermissions:s}){const i={};if(t&&[tt._I.ALLOW,tt._I.FORBID].includes(t)&&(i.avatar=t,i.publicName=t,s&&(i.purchasesInfo=t)),void 0!==e&&(i.guard=e),0===Object.keys(i).length)return Promise.reject(new Error("Wrong param value for private-info"));const n=(0,ts.H)("/player/private-info/"),a=cs(ls({},ps),{body:JSON.stringify(i)});return yield(0,h.rQ)({apiPath:n,options:a})}))}postDataPermissions(e){return hs(this,arguments,(function*({permissions:e,withPurchasesPermissions:t}){const s={},i=(0,ts.H)("/player/scope-permissions/");[tt._I.ALLOW,tt._I.FORBID].includes(e)&&(s.avatar=e,s.publicName=e,t&&(s.purchasesInfo=e));const n=cs(ls({},ps),{body:JSON.stringify(s)});return yield(0,h.rQ)({apiPath:i,options:n})}))}apply(){this.postDataPermissions({permissions:tt._I.ALLOW}).then((e=>{this.showPromiseWrapper&&(this.showPromiseWrapper.resolve(e),this.showPromiseWrapper=null),this.close()})).catch((e=>{(0,N.fF)(e),this.close()}))}cancel(){this.postDataPermissions({permissions:tt._I.FORBID}).then((e=>{this.showPromiseWrapper&&(this.showPromiseWrapper.resolve(e),this.showPromiseWrapper=null),this.close()})).catch((e=>{(0,N.fF)(e),this.close()}))}close(){this.setState({show:!1}),this.showPromiseWrapper&&(this.showPromiseWrapper.reject(),this.showPromiseWrapper=null)}sendParams(e){F.Z.params({borrowParams:{scopes:{player:{dialog:e}}}})}render(){return this.state.show?o().createElement(es,{handleEvent:this.handleEvent}):null}}vs.contextType=D.Z;const ms=(0,d.$j)((e=>({hasAuth:Boolean(e.userData.login)})))(vs);var gs=s(27859),ws=s(79228),ys=Object.defineProperty,fs=Object.getOwnPropertySymbols,bs=Object.prototype.hasOwnProperty,As=Object.prototype.propertyIsEnumerable,Ss=(e,t,s)=>t in e?ys(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;const ks=ke().with("screen-manager-rotate-banner"),Es=()=>{c.Z.post({type:"screen-manager",action:"request-fullscreen"})},Is=e=>{const t=(0,ct.T)()("rotate.banner.button.text.short"),s=gs.Z.isLockable,i=(0,r.useCallback)((e=>{window.blur(),setTimeout((()=>{null==e||e.focus(),window.focus(),window.dispatchEvent(new Event("focus"))}),1)}),[]);return o().createElement(ws.Z,((e,t)=>{for(var s in t||(t={}))bs.call(t,s)&&Ss(e,s,t[s]);if(fs)for(var s of fs(t))As.call(t,s)&&Ss(e,s,t[s]);return e})({},e),s&&o().createElement("button",{className:ks("force-rotate-button"),ref:i,onClick:Es},t))};var Rs=s(33381),Ps=s(55968),Ts=s(80024),Cs=s(16527),Ls=s(70602),Ds=s(39449),Os=s(13377);const Bs="yandexGames_shortcut_installation_dates";const xs=(0,g.M$)("ShortcutManagerCommonApi",g.XG.Popup);function _s(e,t){(0,G.U4)({},{shortcutApi:{action:e,params:t}})}class Ns{constructor(e,t,s){this.context=t,this.beforeInstallEventCallbacks=[],this.isPlayToEarn=!1,this.isYandex=!1,this.wasBeforeInstallPrompt=()=>Boolean(this.shouldCallBeforeInstallEventCallbackImmediataly),this.showBeforeInstallprompt=!1,this.appId=e,this.dispatch=s,window.addEventListener("beforeinstallprompt",(e=>{e.preventDefault(),this.shortcutEventPrompt=e,this.callBeforeInstallEventCallbacks()})),this.isPlayToEarn=(0,Ge.XP)(t.abt.flags),this.isYandex=(0,j.RY)()}addListenerOnSuccessInit(e){this.shouldCallBeforeInstallEventCallbackImmediataly?e():this.beforeInstallEventCallbacks.push(e)}safeCallBeforeInstallEventCallbacks(){this.beforeInstallEventCallbacks.forEach((e=>e())),this.shouldCallBeforeInstallEventCallbackImmediataly=!0}callBeforeInstallEventCallbacks(){this.shouldCallBeforeInstallEventCallbackImmediataly||this.safeCallBeforeInstallEventCallbacks(),this.waitShowPromptAsync&&(this.waitShowPromptAsync=!1,this.showPromptByUserGesture("beforeinstallprompt")),_s("beforeinstallprompt",{show:this.showBeforeInstallprompt})}addListenerOnExpiration(e){this.expirationCallback=e}getSupportStatus(){return Boolean(this.shortcutEventPrompt)}showPromptByUserGesture(e){const t=(0,He.c)((()=>(t(),this.showPrompt(e,Ts.v.PAGE_OPEN))))}showPromptAsync(e){return t=this,s=null,i=function*(){const{source:t}=e;if(_s("showPromptStart",e),this.shortcutEventPrompt)return xs(`ShortcutManagerCommonApi showPromptAsync: showPrompt exists and is called, source: ${e.source}`),t===Ts.v.PAGE_OPEN?this.showPromptByUserGesture("userGesture"):this.showPrompt("showPrompt",t);this.waitShowPromptAsync=!0;const s=`ShortcutManagerCommonApi showPromptAsync: showPrompt doesn't exist and is called, source: ${e.source}`;if(xs(s),t===Ts.v.GAME_API)throw new Error(s);console.info(s)},new Promise(((e,n)=>{var a=e=>{try{o(i.next(e))}catch(e){n(e)}},r=e=>{try{o(i.throw(e))}catch(e){n(e)}},o=t=>t.done?e(t.value):Promise.resolve(t.value).then(a,r);o((i=i.apply(t,s)).next())}));var t,s,i}readInstallationDates(){const{value:e,wasError:t}=(0,Ue.dq)(Bs);if(!t)try{const t=JSON.parse(e||"{}");if(t&&"object"==typeof t)return t}catch(e){(0,v.H)({block:Os.W.SHORTCUTS_POPUP_MANAGER,prefix:"Error in readInstallationDates",source:"sdk"},e)}}shouldInstallAgain(){if(!this.appId)return!1;const e=this.readInstallationDates();if(!e)return!1;const t=new Date(e[this.appId]).getTime();return!!isNaN(t)||Math.abs(Date.now()-t)>=Ds.E$}setInstallationDate(){if(!this.appId)return;const e=this.readInstallationDates()||{};e[this.appId]=(new Date).toISOString(),(0,Ue.Ur)(Bs,JSON.stringify(e))}showPrompt(e,t){var s,i,n,a;if(xs("showPrompt"),this.shortcutEventPrompt){if("showPrompt"===e||this.shouldInstallAgain())return _s("showPrompt",{showPromptReason:e}),(0,G.NF)({},zt.Ji.SHORTCUT_PROMPT_SHOW,{showPromptSource:e}),Ls.Fj.show((0,Ls.oU)({context:this.context,popupType:"system",source:(0,Ls.N7)(t)})),null==(s=this.shortcutEventPrompt)||s.prompt().catch((e=>{_s("showPromptError",{err:e.message}),console.warn("ShortcutManagerCommonApi error: ",e)})),null==(i=this.shortcutEventPrompt)||i.userChoice.then((s=>(Ls.Fj.click((0,Ls.oU)({context:this.context,popupType:"system",source:(0,Ls.N7)(t),result:"accepted"===s.outcome?"accepted":"rejected"})),"accepted"===s.outcome?((0,G.NF)({},zt.Ji.SHORTCUT_USER_CHOICE_ACCEPTED,{showPromptSource:e}),this.isPlayToEarn&&this.isYandex&&this.dispatch((0,Cs.$B)(Ps.cb.CREATE_LINK_IN_CATALOGUE))):(this.dispatch((0,_.yf)(!0)),(0,G.NF)({},zt.Ji.SHORTCUT_USER_CHOICE_DISMISSED,{showPromptSource:e})),this.shortcutEventPrompt=void 0,s))),null==(n=this.expirationCallback)||n.call(this),this.setInstallationDate(),null==(a=this.shortcutEventPrompt)?void 0:a.userChoice;_s("showPromptError",{err:`You can call showPrompt on reason ${e} only once a day`})}}}var qs=s(15987);var Ms=s(62847),$s=s(32595),Fs=s(4915),Ws=s(31085);const Zs=(0,g.M$)("ShortcutPopupManager",g.XG.Popup),Us=m.WT;class Hs extends r.PureComponent{constructor(){super(...arguments),this.state={canShowCalled:!1,forsedShowshortcutPopup:!1},this.onExternalMessage=(e,t)=>{return s=this,i=null,n=function*(){const{appId:s}=this.context.playPageData.gameInfo,{action:i}=e.data;switch(i){case"can-show-prompt":{const e=this.canShowApiPrompt(s);Zs(`onExternalMessage: action: "${i}", canShow: ${e}`),t({data:{canShow:e}}),this.setState({canShowCalled:!0});break}case"show-prompt":{const e=this.canShowApiPrompt(s);if(Zs(`onExternalMessage: action: "${i}", canShow: ${e}`),e){const e=this.installationChecker.catalogPromptHasShown(s)?"game":"catalog";F.Z.reachGoal(zt.Ji.SHORTCUT_API_SHOW,{shortcutApi:{appId:s,manifestType:e}}),window.setTimeout((()=>{this.showApiPrompt({source:Ts.v.GAME_API},s).then((e=>{t({data:{outcome:null==e?void 0:e.outcome}})}))}),Us)}else this.state.canShowCalled?t({data:{canShow:e,reason:"cannot show prompt"}}):t({data:{canShow:e,reason:"use canShowPrompt before showPrompt"}});break}}},new Promise(((e,t)=>{var a=e=>{try{o(n.next(e))}catch(e){t(e)}},r=e=>{try{o(n.throw(e))}catch(e){t(e)}},o=t=>t.done?e(t.value):Promise.resolve(t.value).then(a,r);o((n=n.apply(s,i)).next())}));var s,i,n},this.onInternalMessage=e=>{var t,s,i;const{action:n,data:a}=e.data;switch(n){case"show-api-prompt":Zs('onInternalMessage "show-api-prompt"'),this.showApiPrompt({source:a.source});break;case"show-shortcut-popup":Zs('onInternalMessage "show-shortcut-popup"'),this.showShortcutPopup();break;case"show-standalone-api-prompt":Zs('onInternalMessage "show-standalone-api-prompt"'),null==(i=null==(s=null==(t=window.yandex)?void 0:t.app)?void 0:s.installShortcut)||i.call(s);break;case"activate":{Zs('onInternalMessage "activate"');const e=new Event("beforeinstallprompt");e.userChoice=this.createExternalShortcutPromise("user-choice"),e.prompt=()=>this.createExternalShortcutPromise("prompt"),window.dispatchEvent(e);break}}},this.createExternalShortcutPromise=e=>new Promise(((t,s)=>{const i=`${e}-resolve`,n=`${e}-reject`,a=e=>{const{action:r}=e.data;r!==i&&r!==n||(c.Z.offInternalMessage("shortcut-manager",a),r===i?t(e.data.result):r===n&&s(e.data.result))};c.Z.onInternalMessage("shortcut-manager",a,{withHistory:!0}),"prompt"===e&&c.Z.post({type:"shortcut-manager",action:"prompt"})})),this.handleCloseShortcutPopup=()=>{const e=(t="game",window.YandexGamesSDK&&"function"==typeof window.YandexGamesSDK.getStack?window.YandexGamesSDK.getStack(t):document.body).querySelector("iframe");var t;e&&(0,Ms.Z)(e),this.setState({forsedShowshortcutPopup:!1})}}componentDidMount(){const{appId:e}=this.context.playPageData.gameInfo;this.shortcutManagerApi=new Ns(e,this.context,this.props.dispatch),this.installationChecker=new Fs.Z,this.initMessaging()}initMessaging(){c.Z.onExternalMessage("shortcut-manager",this.onExternalMessage),c.Z.onInternalMessage("shortcut-manager",this.onInternalMessage,{withHistory:!0}),c.Z.post({type:"shortcut-manager",action:"request"})}canShowApiPrompt(e){var t;const s=(0,$s.N)(this.context.uatraits);return this.installationChecker.checkShowCapability(Ws.Wp.GameApi,{waitingPeriod:m.dV,maxShowCount:3,isMiniInfobarEnabled:s},e)&&(null==(t=this.shortcutManagerApi)?void 0:t.getSupportStatus())}showApiPrompt(e,t){const{source:s}=e;if(t&&!this.canShowApiPrompt(t))return Promise.resolve(void 0);const i=new Promise((e=>this.addListenerOnSuccessInit((()=>e(!0))))).then((()=>(s===Ts.v.GAME_API&&this.installationChecker.updateShowData(Ws.Wp.GameApi,t),this.shortcutManagerApi.showPromptAsync(e))));return i.then((e=>{void 0!==e&&(this.props.dispatch((0,_.FJ)(void 0)),s===Ts.v.GAME_API&&t&&("accepted"===e.outcome?(this.installationChecker.updateInstallationData(Ws.Wp.GameApi,t),this.installationChecker.setLastPromptAccepted(!0,t)):(this.props.dispatch((0,_.yf)(!0)),this.installationChecker.setLastPromptAccepted(!1,t))))})).catch((()=>{})),i}wasBeforeInstallPrompt(){return this.shortcutManagerApi.wasBeforeInstallPrompt()}addListenerOnSuccessInit(e){this.shortcutManagerApi.addListenerOnSuccessInit(e)}addListenerOnExpiration(e){this.shortcutManagerApi.addListenerOnExpiration(e)}showShortcutPopup(){this.setState({forsedShowshortcutPopup:!0})}render(){return this.state.forsedShowshortcutPopup||this.props.shouldShowShortcutPopup?o().createElement(Rs.Z,{trigger:this.state.forsedShowshortcutPopup?qs.w.MENU:qs.w.TIMER,type:this.props.type,onClose:this.handleCloseShortcutPopup}):null}}Hs.contextType=D.Z;const zs=(0,d.$j)((function(e){return{shouldShowShortcutPopup:e.shouldShowShortcutPopup}}))(Hs);var Gs=s(29810);const js=s(85152).Z;var Vs=s(68316);const Ys=s(47774).Z;var Ks=s(22263),Xs=s(53603),Js=s(37379),Qs=s.n(Js),ei=(e=>(e.FULL="full",e.HIDDEN="hidden",e.MOVING="moving",e.SMALL="small",e))(ei||{});const ti=ke().with("app-drawer");class si extends r.PureComponent{constructor(){super(...arguments),this.currentProgress=0,this.dragEvents=["touchstart","touchmove","touchend","touchcancel"],this.isDrawerEvent=void 0,this.touchStartPos={x:0,y:0},this.state={moving:!1},this.drawerInnerRef=e=>{e&&(this.element=e,this.curtain=this.element.querySelector(".app-drawer__curtain"),this.content=this.element.querySelector(".app-drawer__content"),this.dragEvents.forEach((e=>{var t;return null==(t=this.element)?void 0:t.addEventListener(e,this.handleDrag,{capture:!0,passive:!1})})),this.content.addEventListener("scroll",this.handleScroll,{passive:!0}))},this.handleDrag=e=>{var t;const{onChangeStatus:s,onClose:i,playerError:n,status:a}=this.props;if(!this.element||"hidden"===a||n)return;const r=e.touches[0];switch(e.type){case"touchstart":this.touchStartPos={x:r.pageX,y:r.pageY},this.isDrawerEvent=void 0;break;case"touchmove":void 0===this.isDrawerEvent&&(this.isDrawerEvent=Boolean(Math.abs(r.pageX-this.touchStartPos.x)<Math.abs(r.pageY-this.touchStartPos.y))&&(r.pageY>this.touchStartPos.y&&0===(null==(t=this.content)?void 0:t.scrollTop)||"full"!==a&&!this.isLandscape())),this.isDrawerEvent&&(e.preventDefault(),this.setState({moving:!0}),this.setProgress((this.touchStartPos.y-r.pageY)/this.element.offsetHeight));break;case"touchend":case"touchcancel":if(this.setState({moving:!1}),this.curtain&&(this.curtain.style.transform=""),!this.isDrawerEvent)return;if("full"===a&&this.currentProgress<1||this.currentProgress<.6)return s("hidden"),i(),void this.dragEvents.forEach((e=>{var t;return null==(t=this.element)?void 0:t.removeEventListener(e,this.handleDrag)}));this.currentProgress>.8&&s("full")}},this.handleScroll=()=>{var e;const{onChangeStatus:t,onUpdateScrollTop:s,status:i}=this.props;s((null==(e=this.content)?void 0:e.scrollTop)||0),"full"!==i&&t("full")},this.setProgress=e=>{const{status:t}=this.props;if(!this.element||!this.curtain)return;const s="full"===t||this.isLandscape()?1:.7,i=Math.min(1,Math.max(0,e+s)),n=this.element.offsetHeight-this.element.offsetHeight*i;this.curtain.style.transform=`translateY(${n}px) translateZ(0)`,this.currentProgress=i}}componentWillUnmount(){var e;null==(e=this.element)||e.removeEventListener("scroll",this.handleScroll),this.dragEvents.forEach((e=>{var t;return null==(t=this.element)?void 0:t.removeEventListener(e,this.handleDrag)}))}isLandscape(){return window.innerHeight<window.innerWidth}render(){const{children:e,hidden:t,mode:s,onClose:i,status:n,withShadow:a}=this.props,{moving:r}=this.state;return o().createElement("div",{className:ti({hidden:t,mode:s,moving:r,status:n,"with-promo-bar-landscape":!0}),ref:this.drawerInnerRef},o().createElement("div",{className:ti("drag-observer")},o().createElement("div",{className:ti("curtain",{moving:r,status:n})},o().createElement("div",{className:ti("handle")}),o().createElement("div",{className:ti("content",{status:n})},e)),o().createElement("div",{className:ti("bg",{shadow:a}),onClick:i})),o().createElement("noscript",null,o().createElement("style",null,".app .app-drawer_hidden {\n                            display: block;\n                        }")))}}si.contextType=D.Z;var ii=s(69543),ni=s(26213);const ai=({flags:e,isConfirmedGuard:t,platform:s,search:i})=>!!(({flags:e,platform:t,searchParams:s})=>{if(s[ni.U]||(0,Ge.bM)(e))return!0;const i=(0,Lt.AK)(t);return!!(i.isStandalone&&i.isAndroidStandalone&&(0,Ge.Iv)(e))})({flags:e,platform:s,searchParams:Ne.parse("?"===i.charAt(0)?i.slice(0):i)})||t,ri=s(81839).Z,oi=(0,g.M$)("gamePage",g.XG.Dev);s(33784);const di=["document-events","guard"];class li extends D.P{constructor(){super(...arguments),this.pageStartRef=o().createRef(),this.withInfo=-1!==this.props.location.search.indexOf("info=true"),this.needToShowLeaderboard=(()=>{const{search:e,hash:t}=this.props.location;return`${e}#${t}`.includes("leaderboard")})(),this.shouldRenderContent=Boolean(this.context.isSearchCrawler),this.state={showInfo:this.getInitGuardState(),showGuard:this.getInitGuardState(),drawerStatus:ei.SMALL,hiddenControls:this.getInitHiddenControls(),hiddenImages:!0,hiddenLazyElements:!0,hiddenVideo:!0,permission:!0,playerError:!1,scrollTop:0,scrollToLeaderboard:!1},this.handleClose=()=>{const{hiddenControls:e,showInfo:t}=this.state;!this.withInfo||e?(e?t&&!(0,Ze.PK)()&&"#info"===location.hash&&history.back():c.Z.post({type:"guard",action:"show"}),this.setState({hiddenVideo:!0,scrollToLeaderboard:!1,showInfo:!1})):this.handleBack()},this.handleBackgroundClick=()=>{this.handleApply(Et.Background)},this.handleCloseButton=()=>{this.handleApply(Et.CloseButton)},this.handleDrawerClose=()=>{this.handleApply(Et.DrawerSwipe)},this.handleAuth=()=>{c.Z.post({type:"auth",action:"auth-dialog-open",data:{initializer:"app-page"}}),(0,G.U4)({},{action:"auth"})},this.handleBack=()=>{const{hiddenControls:e,showInfo:t}=this.state,{baseUrlWithLangPath:s,isGamesLiteApp:i,pfid:n,referrer:a,hidePaymentsAndCurrency:r,isPWA:o}=this.context;if(t&&e)return this.setState({showInfo:!1}),history.back(),void(0,G.U4)({},{action:"close-info"});if((0,G.U4)({},{action:"back-to-catalog"}),document.documentElement.classList.remove("with-player"),this.exitFullscreen(),window.opener&&!i)window.close();else{const e=Ne.parse(window.location.search.slice(1));a&&(0,Me.sD)(a)&&(e[V.Vw]=a),i&&(e.utm_source="close_button"),r&&(e[V.o1]="1"),o&&(e[V.cB]="1"),n&&(e[V.om]=n);const t=Ne.stringify(e);let d=`${window.location.origin}${s}${t.length?`?${t}`:""}`;d=(0,Re.ky)(d,{currentLocation:window.location.href}),window.open(d,"_self")}},this.handlePlayButton=()=>{this.handleApply(Et.PlayButton)},this.handleUpdateScrollTop=e=>{this.setState({scrollTop:e})},this.handlePermissionsChange=e=>{this.setState({permission:e})},this.feedbackRef=e=>{this.feedbackTitleElement=e},this.gameInstructionRef=e=>{this.gameInstructionElement=e},this.handleBackButton=e=>{const{hiddenControls:t}=this.state;!e.state&&t&&this.hideInfo()},this.handleEarlyEvents=()=>{var e;null==(e=window.earlyEvents)||e.messages.forEach((e=>{const{type:t,action:s,data:i}=e;if("guard"===t)switch(s){case"auth":this.handleAuth();break;case"close":this.handleBack();break;case"accept":this.setState({permission:i.permissionChecked},(()=>{this.handleApply(i.actionSource)}))}})),document.documentElement.classList.remove("without-guard")},this.changeDrawerStatus=e=>{this.setState({drawerStatus:e}),e===ei.FULL&&(this.setState({hiddenLazyElements:!1,hiddenVideo:!1}),c.Z.post({type:"promo-bar",action:"remove"}))},this.handleVisibilityChange=()=>{"visible"===document.visibilityState&&this.requestFullscreen()},this.requestFullscreen=()=>{var e;const{game:t}=this.props,s=(0,Z.KT)();V.XL.includes(s)||gs.Z.requestFullscreenAndLockOrientation(null==(e=t.features)?void 0:e.orientation)},this.onAllMessages=e=>{const{type:t,action:s,data:i}=e.data,{platform:n}=this.context,{isIOS:a}=(0,Lt.AK)(n),{hiddenControls:r}=this.state;switch(t){case"document-events":switch(s){case"redirect":window.location.href=i.href;break;case"back":this.handleBack();break;case"show-info":case"show-review":case"show-instruction":case"show-leaderboard":this.setState({hiddenImages:!1,showInfo:!0}),this.setRenderTriggered(),this.sendNotificationToSelfWindow(),!(0,Ze.PK)()&&r&&window.parent.history.pushState("info","","#info"),requestAnimationFrame((()=>{this.changeDrawerStatus(ei.FULL),Qs().polyfill(),setTimeout((()=>{var e,t,i;switch(s){case"show-review":this.scrollAfterLeaderboardFetching("review");break;case"show-instruction":null==(e=this.gameInstructionElement)||e.scrollIntoView({behavior:"smooth"});break;case"show-leaderboard":this.scrollAfterLeaderboardFetching("leaderboard");break;case"show-info":null==(i=null==(t=this.pageStartRef.current)?void 0:t.parentElement)||i.scrollTo({behavior:"smooth",top:0})}a&&setTimeout((()=>{window.scrollTo(0,0)}),500)}),200)})),(0,G.U4)({},{action:s})}break;case"guard":switch(s){case"cancel":this.handleBack();break;case"info":this.setState({showInfo:!0,hiddenControls:!1,hiddenImages:!1,hiddenLazyElements:!1,hiddenVideo:!1}),this.setRenderTriggered(),this.sendNotificationToSelfWindow();break;case"apply":this.setState({hiddenControls:!0});break;case"init":this.setState({hiddenControls:!1})}}},this.setRenderTriggered=()=>{this.shouldRenderContent=!0}}handleApply(e){const{showInfo:t,hiddenControls:s,permission:i,playerError:n}=this.state;n||(s||c.Z.post({type:"guard",action:"apply",data:{permission:i?tt._I.ALLOW:tt._I.FORBID,actionSource:e}}),this.hideInfo(),this.setState({showGuard:!1}),t&&s&&((0,Ze.PK)()||"#info"===location.hash&&history.back(),(0,G.U4)({},{action:"hide-info"})),requestAnimationFrame((()=>{window.scrollTo(0,0),this.passFocusToFrame()})))}passFocusToFrame(){c.Z.hasChild()&&c.Z.postToChild((0,ii.$m)())}componentDidMount(){c.Z.onAllMessages(di,this.onAllMessages,{withHistory:!0}),this.handleEarlyEvents(),this.initInfoWindow()}componentDidUpdate(e,t){t.showInfo===this.state.showInfo||this.state.showInfo||c.Z.post({type:"document-events",action:"hide-info"})}componentWillUnmount(){this.exitFullscreen(),c.Z.offAllMessages(di,this.onAllMessages),document.removeEventListener("visibilitychange",this.handleVisibilityChange),window.removeEventListener("popstate",this.handleBackButton)}exitFullscreen(){}sendNotificationToSelfWindow(){c.Z.post({action:"open",type:"app-info"})}hideInfo(){this.changeDrawerStatus(ei.HIDDEN),setTimeout((()=>{this.setState({showInfo:!1,hiddenControls:!0,scrollToLeaderboard:!1,hiddenVideo:!0})}),200)}getInitHiddenControls(){const{abt:{flags:e},platform:t,playPageData:s,userRegionData:i}=this.context,{gameData:n}=s,a=(0,Ut.pr)({gameData:n,userRegionData:i});return ai({flags:e,isConfirmedGuard:a,platform:t,search:this.props.location.search})}getInitGuardState(){if(this.shouldRenderContent)return!0;if(this.withInfo||this.props.location.search.includes("leaderboard"))return!0;const{abt:{flags:e},platform:t,playPageData:s,userRegionData:i}=this.context,{gameData:n}=s,a=(0,Ut.pr)({gameData:n,userRegionData:i});ai({flags:e,isConfirmedGuard:a,platform:t,search:this.props.location.search});return this.shouldRenderContent}initInfoWindow(){var e,t;const{abt:{flags:s},platform:i,playPageData:n,userRegionData:a}=this.context,{gameData:r}=n,o=(0,Ut.pr)({gameData:r,userRegionData:a}),d=!ai({flags:s,isConfirmedGuard:o,platform:i,search:this.props.location.search});this.withInfo||this.needToShowLeaderboard?(this.setState({hiddenControls:!1,hiddenImages:!1,showGuard:!0,showInfo:!0}),requestAnimationFrame((()=>{this.changeDrawerStatus(this.withInfo?ei.FULL:ei.SMALL)}))):(this.changeDrawerStatus(ei.HIDDEN),this.setState({showInfo:this.shouldRenderContent,showGuard:this.shouldRenderContent,hiddenControls:!d})),window.addEventListener("popstate",this.handleBackButton,!1),c.Z.post({type:"guard",action:"load",data:{startTime:null==(t=null==(e=window.performance)?void 0:e.timing)?void 0:t.navigationStart}})}scrollAfterLeaderboardFetching(e){const{leaderboardsLoaded:t}=this.props;t?requestAnimationFrame((()=>{var t;switch(e){case"leaderboard":this.setState({scrollToLeaderboard:!0});break;case"review":null==(t=this.feedbackTitleElement)||t.scrollIntoView({behavior:"smooth"})}})):setTimeout((()=>{this.scrollAfterLeaderboardFetching(e)}),100)}render(){return oi("game-page render"),this.shouldRenderContent?(oi("game-page render desktop"),o().createElement(ri,{game:this.props.game,handlers:{handleBack:this.handleBack,handleClose:this.handleClose,handlePermissionsChange:this.handlePermissionsChange,handlePlayButton:this.handlePlayButton,handleAuth:this.handleAuth,handleBackgroundClick:this.handleBackgroundClick},refs:{pageStartRef:this.pageStartRef,feedbackRef:this.feedbackRef,gameInstructionRef:this.gameInstructionRef},state:this.state})):null}}const ci=(0,a.E)((0,d.$j)((function(e){var t,s;return{userData:e.userData,leaderboardsLoaded:(null==(t=e.leaderboards)?void 0:t.main.loaded)&&(null==(s=e.leaderboards)?void 0:s.friends.loaded),getText:e.getText}}))(li));var hi=s(90043),ui=s(47484),pi=s(90380),vi=Object.defineProperty,mi=(e,t,s)=>(((e,t,s)=>{t in e?vi(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s})(e,"symbol"!=typeof t?t+"":t,s),s);const gi=(0,g.M$)("AppPageBody",g.XG.Dev);class wi extends D.P{constructor(e){super(e),mi(this,"stackRef"),mi(this,"state",{hasMounted:!1,canRenderGamePage:!0,hasTurboAppRemover:!1,showUxFeedback:!1}),mi(this,"guardClosedPromiseWrapper",new n.Z),mi(this,"onGuardMessage",(e=>{const{action:t}=e.data;"set-was-showed"===t&&this.resolveGuardPromise()})),mi(this,"canShowUxFeedback",(()=>{var e;const{abt:t,isAutotests:s}=this.context,{isUxFeedbackForced:n}=this.props,a=(0,i.getDomainConfig)();this.setState({showUxFeedback:!(0,Ze.PK)()&&Boolean(null==(e=a.feedbackSettings)?void 0:e.canShowSpeedButton)&&Boolean((0,Ge._D)(t.flags))&&Boolean((0,Ks.c)(this.context,n))&&!(0,ne.$m)()&&!s})})),this.stackRef=o().createRef()}componentDidMount(){this.initMessaging(),this.setState({hasMounted:!0}),(0,ui.UQ)((()=>{var e,t;this.setState({hasTurboAppRemover:"function"==typeof(null==(t=null==(e=window.yandex)?void 0:e.publicFeature)?void 0:t.removeTurboApp)}),this.guardClosedPromiseWrapper.promise.then((()=>{this.gameLoadingFeedback()}))}))}componentDidUpdate(e){!e.isUxFeedbackForced&&this.props.isUxFeedbackForced&&this.canShowUxFeedback()}componentWillUnmount(){c.Z.offInternalMessage("guard",this.onGuardMessage)}initMessaging(){c.Z.onInternalMessage("guard",this.onGuardMessage)}resolveGuardPromise(){this.guardClosedPromiseWrapper.resolve(void 0),c.Z.offInternalMessage("guard",this.onGuardMessage)}renderProfilePopup(){const{showProfilePopup:e}=this.props;return e?o().createElement(Xt.Z,null):null}gameLoadingFeedback(){var e;const{abt:{flags:t},isAutotests:s,uxFeedbackControllerInstance:n}=this.context,a=(0,Ue.dq)(V.jo);if(!(null==(e=(0,i.getDomainConfig)().feedbackSettings)?void 0:e.canShowSpeedButton)||!(0,Ge._D)(t)||void 0===n||"true"===a.value||s)return void(0,Ue.Ur)(V.NY,"false");let r=null==n?void 0:n.onReady((()=>{gi("uxFeedbackControllerInstance sendMessage"),null==n||n.sendMessage("event",{event:"game_loading_feedback"}),(0,Ue.Ur)(V.jo,"true"),(0,Ue.Ur)(V.NY,"true"),null==r||r()}));gi("uxFeedbackControllerInstance",n),null==n||n.start(),this.props.dispatch((0,hi.zN)(!0))}render(){gi("render");const{appData:e,isAccountCompletionAvailable:t}=this.props,{abt:s,isStickyEnabled:i,isGamesApp:n,playPageData:a,location:r,hidePaymentsAndCurrency:d}=this.context,{showUxFeedback:l,hasMounted:c,canRenderGamePage:h,hasTurboAppRemover:u}=this.state,{gameData:p}=a,{isSearchCrawler:v,lang:m,hasHeader:g}=e;gi("showUxFeedback",l);let w="stack";if("undefined"!=typeof window){const e=document.querySelector(".stack");w=(null==e?void 0:e.className)||w}const y=c&&(0,Ge.RM)(s.flags,pi.Z.userActivityPopup),f=a.isGameLoaderEnabled&&!0,b=L.Z.shouldLoad(s.flags,r)?o().createElement(oe.Z,null):o().createElement(de.Z,null);return o().createElement(Xs.I,null,!n&&o().createElement(te.Z,{type:"game"}),o().createElement(we,null),o().createElement(Gs.Z,null),o().createElement(Qt.q,null),o().createElement(T,{lang:m}),o().createElement(et,{isVisible:g}),o().createElement("div",{className:w,ref:this.stackRef},i&&o().createElement(C.Z,{hideAdvCloseButton:d,placement:"app",wrapperRef:this.stackRef}),o().createElement(Q.Z,{page:"app"}),o().createElement(be.Z,null),o().createElement(Is,null),o().createElement(Kt.Z,{isBlackFadeout:!0}),o().createElement(J,null),o().createElement(ye.Z,null),o().createElement("div",{className:"rotate-banner"}),o().createElement(Vt,null),f&&b,o().createElement("div",{className:"shortcut"},c&&o().createElement(zs,{type:"game"})),o().createElement(Yt.Z,null),o().createElement(ms,null),o().createElement(re,null),o().createElement(le.Z,null),o().createElement(he,null),(0,Ge.XP)(s.flags)&&o().createElement(Jt.Z,null),(0,Ge.XP)(s.flags)&&this.renderProfilePopup()),h&&(null==p?void 0:p.appID)?o().createElement(ci,{game:p}):null,y&&o().createElement(Vs.Z,null),o().createElement(fe.Z,null),c&&o().createElement(ee.H,null),o().createElement("div",{className:"gdpr-overlay"}),u&&o().createElement(js,null),c&&!v&&t&&o().createElement(ue,null),l&&o().createElement(Ys,null))}}const yi=(0,a.E)((0,d.$j)((function(e){var t;return{isAccountCompletionAvailable:e.userData.isAccountCompletionAvailable,showProfilePopup:null==(t=e.playToEarn)?void 0:t.uiState.showProfilePopup,isUxFeedbackForced:e.ui.isUxFeedbackForced}}))(wi))},68797:(e,t,s)=>{"use strict";s.d(t,{Z:()=>T});var i=s(87363),n=s.n(i);const a="child-src 'self' blob: mc.yandex.ru; connect-src 'self' localhost.msup.yandex.ru mc.yandex.ru amc.yandex.ru an.yandex.ru jstracer.yandex.ru verify.yandex.ru *.verify.yandex.ru csp.yandex.net strm.yandex.ru strm.yandex.net *.strm.yandex.net favicon.yandex.net avatars.mds.yandex.net yandexmetrica.com www.google-analytics.com www.googletagmanager.com games-sdk.yandex.az games-sdk.yandex.by games-sdk.yandex.co.il games-sdk.yandex.com games-sdk.yandex.com.am games-sdk.yandex.com.ge games-sdk.yandex.com.tr games-sdk.yandex.ee games-sdk.yandex.fr games-sdk.yandex.kg games-sdk.yandex.kz games-sdk.yandex.lt games-sdk.yandex.lv games-sdk.yandex.md games-sdk.yandex.ru games-sdk.yandex.tj games-sdk.yandex.tm games-sdk.yandex.ua games-sdk.yandex.uz; default-src 'self'; font-src 'self' yastatic.net yastat.net an.yandex.ru fonts.gstatic.com; frame-src 'self' localhost yastatic.net; img-src 'self' data: blob: mc.yandex.ru amc.yandex.ru an.yandex.ru verify.yandex.ru *.verify.yandex.ru favicon.yandex.net avatars.mds.yandex.net games.games-test.yandex.ru games-sdk.yandex.az games-sdk.yandex.by games-sdk.yandex.co.il games-sdk.yandex.com games-sdk.yandex.com.am games-sdk.yandex.com.ge games-sdk.yandex.com.tr games-sdk.yandex.ee games-sdk.yandex.fr games-sdk.yandex.kg games-sdk.yandex.kz games-sdk.yandex.lt games-sdk.yandex.lv games-sdk.yandex.md games-sdk.yandex.ru games-sdk.yandex.tj games-sdk.yandex.tm games-sdk.yandex.ua games-sdk.yandex.uz; media-src 'self' data: blob: strm.yandex.ru *.strm.yandex.net; script-src 'self' 'unsafe-eval' 'unsafe-inline' blob: yandex.ru *.yandex.ru yastatic.net; style-src 'self' 'unsafe-eval' 'unsafe-inline' fonts.googleapis.com; report-uri https://csp.yandex.net/csp?from=games-game&project=games&yandex_login=&yandexuid=;";var r=s(38096),o=s(42126),d=s(83242),l=s(97777),c=Object.defineProperty,h=Object.getOwnPropertySymbols,u=Object.prototype.hasOwnProperty,p=Object.prototype.propertyIsEnumerable,v=(e,t,s)=>t in e?c(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,m=(e,t)=>{for(var s in t||(t={}))u.call(t,s)&&v(e,s,t[s]);if(h)for(var s of h(t))p.call(t,s)&&v(e,s,t[s]);return e};const g={[r.EDomain.Playhop]:{project:"playhop"},[r.EDomain.Yandex]:{project:"games"},default:{project:"games"}};class w{constructor(e){var t;const s=(null==(t=g[e])?void 0:t.project)||g.default.project;this.REPORT_URL=`https://csp.yandex.net/csp?from=${encodeURIComponent(s)}-game-html&project=${encodeURIComponent(s)}`}getReportURL(e){return(0,o.Z)({url:this.REPORT_URL,params:m({yandexuid:(0,d.e)("yandexuid")||""},e)})}report(e,t){const s=this.getReportURL(t);return(0,l.Z)(s,e,{credentials:"omit"})}}var y=s(40184),f=s(43548),b=s(71522),A=s(37705);function S(){const e="production";switch(e){case"production":case"prestable":case"testing":return e;default:return"development"}}var k=s(76958);function E(e){return e===k.n.desktop?"desktop":"touch"}var I=s(47484),R=s(15771);function P(e){try{const{data:t}=e.data;if(function({blockedURI:e,originalPolicy:t}){return!!/^https?:\/\/log\.strm\.yandex\.ru/.test(e)||t===a}(t))return null;const{blockedURI:s,columnNumber:i,disposition:n,documentURI:r,effectiveDirective:o,lineNumber:d,originalPolicy:l,referrer:c,sample:h,sourceFile:u,statusCode:p,violatedDirective:v}=t;return JSON.stringify({"csp-report":{"document-uri":r,referrer:c,"violated-directive":v,"effective-directive":o,"original-policy":l,disposition:n,"blocked-uri":s,"line-number":d,"column-number":i,"source-file":u,"status-code":p,"script-sample":h}})}catch(e){(0,A.H)({message:"[CSP] Failed to create violation report"},e)}return null}const T=n().memo((e=>{const{page:t}=e,{deviceType:s,playPageData:n,serviceName:a,abt:r,version:o}=(0,y.b)(),d=(0,i.useMemo)((()=>{const e={environment:S(),page:t,platform:E(s),version:String(o)};if("app"===t&&n){const t=String(n.gameInfo.appId);t&&(e.appId=t)}return e}),[s,t,n,o]),l=(0,i.useMemo)((()=>new w(a)),[a]),c=(0,i.useCallback)(((e,t)=>{if("violation"===e.data.action){const s=P(e);((0,R.jP)(r.flags)?I.EE:I.Bu)((()=>{s?l.report(s,d).then((e=>t({data:e}))):t({data:null})}))}}),[l,d,r]);return(0,i.useEffect)((()=>{const e=new URLSearchParams(window.location.search);if(Boolean(e.get("debug-mode"))||(0,b.m)()||Math.random()<.05)return f.Z.onExternalMessage("csp",c),function(){f.Z.offExternalMessage("csp",c)}}),[c]),null}))},24029:(e,t,s)=>{"use strict";s.d(t,{H:()=>o});var i=s(87363),n=s.n(i),a=s(89193),r=s(85375);const o=()=>(0,r.mv)()?n().createElement(a.Z,null):null},85375:(e,t,s)=>{"use strict";s.d(t,{Sy:()=>a,hw:()=>o,mv:()=>d,q:()=>r});var i=s(611),n=s(93298);const a=()=>i.v.HasFlag(n.AV,n.aR.AdvertisementPanel),r=()=>i.v.HasFlag(n.AV,n.aR.LogPanel),o=()=>i.v.HasFlag(n.AV,n.aR.GameDeveloperPanel),d=()=>o()||r()||a()},11258:(e,t,s)=>{"use strict";s.d(t,{Z:()=>p});var i=s(63904),n=s.n(i),a=s(87363),r=s.n(a),o=s(89492),d=s(85467),l=s(5825),c=s(36172),h=s(94671);const u=n().with("game-rating-description"),p=r().memo((({mix:e="",useNewText:t,hasWebAppsCategory:s,rating:i,withoutText:n})=>{const a=(0,d.T)();let p=a("game.rating").toLowerCase();const v=(0,l.C)(c.Up);return t&&(p=a(s?"game.rating.users.new":"game.rating.new")),0===i?null:r().createElement("div",{className:(0,h.E)(u(),e),title:a("game.rating")},r().createElement("div",{className:u("star-wrapper")},r().createElement(o.Z,{className:u("rating-star",{dark:v}),type:"rating-star"}),r().createElement("span",{className:u("rating")},function(e){if(e<=0)return"0";try{return new Intl.NumberFormat("ru-RU",{minimumFractionDigits:1,maximumFractionDigits:1}).format(e)}catch(e){}return String(e.toPrecision(2)).replace(".",",")}(i))),!n&&r().createElement("div",{className:u("text",{new:t})},p))}))},73673:(e,t,s)=>{"use strict";s.d(t,{q:()=>r});var i=s(87363),n=s(40893);const a=[],r=()=>{const e=(0,i.useContext)(n.O),t=(0,i.useRef)(!1);return(0,i.useEffect)((()=>{e&&!t.current&&(t.current=!0,a.forEach((t=>{e.registerPopup(t)})))})),null}},79228:(e,t,s)=>{"use strict";s.d(t,{Z:()=>p});var i=s(87363),n=s.n(i),a=s(40184);const r=s(29994).v9;var o=s(63904),d=s.n(o),l=s(85467);const c=({className:e})=>n().createElement("img",{alt:"",className:e,src:'data:image/svg+xml,%3Csvg width="153" height="163" viewBox="0 0 153 163" fill="none" xmlns="http://www.w3.org/2000/svg"%3E%3Cg opacity="0.5"%3E%3Crect x="2" y="-2" width="72" height="125" rx="14" transform="matrix(-1 0 0 1 153 4)" fill="%23CFCFDC" stroke="white" stroke-width="4"/%3E%3Cpath fill-rule="evenodd" clip-rule="evenodd" d="M128.965 8H130.6C135.64 8 138.161 8 140.086 8.98094C141.779 9.8438 143.156 11.2206 144.019 12.9141C145 14.8393 145 17.3595 145 22.4V106.6C145 111.64 145 114.161 144.019 116.086C143.156 117.779 141.779 119.156 140.086 120.019C138.161 121 135.64 121 130.6 121H99.4C94.3595 121 91.8393 121 89.9141 120.019C88.2206 119.156 86.8438 117.779 85.9809 116.086C85 114.161 85 111.64 85 106.6L85 22.4C85 17.3595 85 14.8393 85.9809 12.9141C86.8438 11.2206 88.2206 9.8438 89.9141 8.98094C91.8393 8 94.3595 8 99.4 8H101.035C101.012 8.16331 101 8.33025 101 8.50001C101 10.433 102.567 12 104.5 12L125.5 12C127.433 12 129 10.433 129 8.50001C129 8.33025 128.988 8.16331 128.965 8Z" fill="%23F4F4F6"/%3E%3C/g%3E%3Crect x="2" y="161" width="72" height="125" rx="14" transform="rotate(-90 2 161)" fill="%2390919D" stroke="white" stroke-width="4"/%3E%3Cpath fill-rule="evenodd" clip-rule="evenodd" d="M7.99999 138.965V140.6C7.99999 145.64 7.99999 148.161 8.98093 150.086C9.84379 151.779 11.2206 153.156 12.9141 154.019C14.8393 155 17.3595 155 22.4 155H106.6C111.64 155 114.161 155 116.086 154.019C117.779 153.156 119.156 151.779 120.019 150.086C121 148.161 121 145.64 121 140.6V109.4C121 104.36 121 101.839 120.019 99.9141C119.156 98.2206 117.779 96.8438 116.086 95.9809C114.161 95 111.64 95 106.6 95H22.4C17.3595 95 14.8393 95 12.9141 95.9809C11.2206 96.8438 9.84379 98.2206 8.98093 99.9141C7.99999 101.839 7.99999 104.36 7.99999 109.4V111.035C8.16329 111.012 8.33023 111 8.5 111C10.433 111 12 112.567 12 114.5L12 135.5C12 137.433 10.433 139 8.5 139C8.33023 139 8.16329 138.988 7.99999 138.965Z" fill="%23F4F4F6"/%3E%3Cpath d="M35.9999 69.6001C39.3484 72.9486 41.2258 74.826 44.5744 78.1745" stroke="%235641FF" stroke-width="6" stroke-linecap="round" stroke-linejoin="round"/%3E%3Cpath d="M52.8525 70.0004L44.7001 78.153" stroke="%235641FF" stroke-width="6" stroke-linecap="round" stroke-linejoin="round"/%3E%3Cpath d="M41.7002 76C41.7002 77.6569 43.0433 79 44.7002 79C46.357 79 47.7002 77.6569 47.7002 76H41.7002ZM68.7002 54C70.357 54 71.7002 52.6569 71.7002 51C71.7002 49.3431 70.357 48 68.7002 48V54ZM47.7002 76V63H41.7002V76H47.7002ZM56.7002 54H68.7002V48H56.7002V54ZM47.7002 63C47.7002 58.0294 51.7296 54 56.7002 54V48C48.4159 48 41.7002 54.7157 41.7002 63H47.7002Z" fill="%235641FF"/%3E%3C/svg%3E%0A'}),h=d().with("screen-manager-rotate-banner"),u=({orientation:e,children:t})=>{const s=(0,l.T)(),a=(0,i.useMemo)((()=>s("rotate.banner.description",{params:{orientation:s(`rotate.banner.description.orientation.${e}`)}}).replace("\\n","<br/>")),[e,s]);return n().createElement("div",{className:`${h({orientation:e})} with-play-game-header-fix`},n().createElement(c,{className:h("image")}),n().createElement("h2",{className:h("title")},s("rotate.banner.action.text")),n().createElement("div",{className:h("description"),dangerouslySetInnerHTML:{__html:a}}),t)},p=({children:e})=>{const t=r((e=>e.ui.screenOrientationBannerVisible)),{playPageData:s}=(0,a.b)(),{orientation:i}=s.gameSettings.features||{},o=(e=>{if("landscape"===e||"portrait"===e)return e})(i);return t&&o?n().createElement(u,{children:e,orientation:o}):null}},60764:(e,t,s)=>{"use strict";s.d(t,{Z:()=>mn});var i=s(87363),n=s.n(i),a=s(85383),r=s(29994),o=s(38096),d=s(34235),l=s(9878),c=s(63904),h=s.n(c),u=s(61533),p=(e=>(e.DESKTOP="desktop",e.LANDSCAPE="landscape",e.PORTRAIT="portrait",e))(p||{}),v=(e=>(e.HORIZONTAL="horizontal",e.VERTICAL="vertical",e))(v||{}),m=(e=>(e.ADSENSE="adsense",e.GOOGLE="google",e.NATIVE="native",e.YANDEX="yandex",e))(m||{}),g=(e=>(e.ADSENSE="adsense",e.GOOGLE="google",e.NATIVE="native",e.PREBID="prebid",e.YANDEX="yandex",e))(g||{}),w=(e=>(e.height="height",e.width="width",e))(w||{});const y=1e3,f=2e3,b={portrait:{[g.ADSENSE]:{minWidth:200,minHeight:50,maxWidth:y,maxHeight:100},[g.YANDEX]:{minWidth:250,minHeight:50,maxWidth:y,maxHeight:100},[g.GOOGLE]:{minWidth:200,minHeight:50,maxWidth:y,maxHeight:100},[g.PREBID]:{minWidth:200,minHeight:50,maxWidth:y,maxHeight:100}},landscape:{[g.ADSENSE]:{minWidth:320,minHeight:50,maxWidth:y,maxHeight:f},[g.YANDEX]:{minWidth:448,minHeight:50,maxWidth:y,maxHeight:f},[g.GOOGLE]:{minWidth:320,minHeight:50,maxWidth:y,maxHeight:f},[g.PREBID]:{minWidth:200,minHeight:50,maxWidth:y,maxHeight:f}},desktop:{[g.ADSENSE]:{minWidth:200,minHeight:125,maxWidth:y,maxHeight:600},[g.YANDEX]:{minWidth:200,minHeight:100,maxWidth:y,maxHeight:f},[g.GOOGLE]:{minWidth:200,minHeight:125,maxWidth:y,maxHeight:f},[g.PREBID]:{minWidth:200,minHeight:125,maxWidth:y,maxHeight:f}}},A={maxHeight:0,maxWidth:0,minHeight:0,minWidth:0},S="base-sticky-banner",k="base-sticky-banner_error",E="sticky-google-banner",I="base-sticky-banner_hidden",R="sticky_g",P="sticky_ready",T="base-sticky-banner_requesting",C="sticky_resize",L="sticky-yandex-banner";var D=s(26108),O=s(93298);const B="google-adv-sticky-banner-",x=h().with("google-sticky-adv-banner"),_=(0,O.M$)("AdsenseStickyBanner",O.XG.Adv);function N(e,t=!1){return s=this,i=null,n=function*(){return new Promise((s=>{function i(){s({height:(null==e?void 0:e.offsetHeight)||0,width:(null==e?void 0:e.offsetWidth)||0})}function n(){null==r||r.disconnect(),window.clearTimeout(a),i()}if(!e||!t)return void i();const a=window.setTimeout(n,500);let r;"undefined"!=typeof MutationObserver&&(r=new MutationObserver(n),r.observe(e,{childList:!0,attributes:!0,subtree:!0}))}))},new Promise(((e,t)=>{var a=e=>{try{o(n.next(e))}catch(e){t(e)}},r=e=>{try{o(n.throw(e))}catch(e){t(e)}},o=t=>t.done?e(t.value):Promise.resolve(t.value).then(a,r);o((n=n.apply(s,i)).next())}));var s,i,n}var q=s(3436),M=s(37705),$=s(13377),F=(e,t,s)=>new Promise(((i,n)=>{var a=e=>{try{o(s.next(e))}catch(e){n(e)}},r=e=>{try{o(s.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,r);o((s=s.apply(e,t)).next())}));const W=(0,O.M$)("BaseStickyBanner",O.XG.Adv),Z=50,U=50;class H extends q.R{constructor(e){var t;super(),this.isAlternateLogs=!1,this._isHidden=!1,this._hasError=!1,this._wasRendered=!1,this._wasDestroyed=!1,this._isRequesting=!1,this._isFirstRequestEnded=!1,this.maxRetries=0,this.wasContainerRendered=new D.Z,this.baseParams=e,this.id=`${Date.now()}-${Math.random()}`,this.containerId=`${e.baseClassName}-${this.id}`,this.baseClassName=e.baseClassName,this.orientationSize=e.orientationSize,this.serviceType=e.serviceType,this.maxRetries=null!=(t=e.retries)?t:0,this.maxSize=e.maxSize,this.availableMaxSize=e.availableMaxSize,this.isAlternateLogs=e.isAlternateLogs,this.wasContainerRendered.promise.then((()=>{this.setAvailableSize(this.maxSize[this.orientationSize])}))}get container(){return document.getElementById(this.containerId)}getSize(){const e={width:0,height:0};return this.hasError()||this.isHidden()?e:this.slotSize?this.slotSize:this.getMaxSize()}getMaxSize(){return this.maxSize}setLogger(e){this.clickDaemon=e}isHidden(){return this._isHidden}hasError(){return this._hasError}wasRendered(){return this._wasRendered}isRequesting(){return this._isRequesting}isFirstRequestEnded(){return this._isFirstRequestEnded}wasDestroyed(){return this._wasDestroyed}setMaxRetries(e){this.maxRetries=Math.max(0,e)}setClickdaemonIds(e){e.adReqId&&(this.adReqId=e.adReqId),e.adSeqId&&(this.adSeqId=e.adSeqId)}getContainerStyles(e,t){if(!(t>0))return{};return{[e===w.width?"maxWidth":"maxHeight"]:`${t}px`}}getContainerClasses(){const e=[S,this.baseClassName];return this.isHidden()&&(e.push("hidden"),e.push(I)),this.hasError()&&e.push(k),e.join(" ")}removeHeightStyle(){this.container&&(this.container.style[this.orientationSize]="")}addClass(e){var t;null==(t=this.container)||t.classList.add(e)}removeClass(e){var t;null==(t=this.container)||t.classList.remove(e)}setAvailableSize(e){if(W("setAvailableSize",e),!(e>0))return;const{container:t,orientationSize:s}=this;if(!t)return;const i=s===w.width?"maxWidth":"maxHeight";this.availableSize=Math.min(e,this.availableMaxSize[s]),W("setAvailableSize availableSize=",this.availableSize),t.style[i]=`${this.availableSize}px`,t.style[s]=`${this.availableSize}px`}removeStyles(){const{container:e,orientationSize:t}=this,s=t===w.width?"maxWidth":"maxHeight";e&&(e.style[s]="",e.style[t]="")}logTryOpen(){this.adSeqId=this.baseParams.onTryOpen()}logRequest(){this.adReqId=this.baseParams.onRequest()}updateSlotSize(){return F(this,null,(function*(){const{orientationSize:e}=this,t=this.slotSize&&this.slotSize.width<Z&&this.slotSize.height<U,s=e===w.width?window.innerWidth:window.innerHeight;if(t||this.slotSize&&this.slotSize[e]>s){const t=yield this.getSlotSizeFromDocument();W("updateSlotSize","size = ",t),this.slotSize=t,this.setAvailableSize(this.slotSize[e])}else W("cancel updateSlotSize")}))}hide(){W("hide"),this._isHidden=!0,this.addClass("hidden")}show(){W("show"),this._isHidden=!1,this.removeClass("hidden")}getSlotSizeFromDocument(e=!1){return F(this,null,(function*(){const{container:t}=this,s=yield N(null==t?void 0:t.firstChild,e);if(s.width>=Z&&s.height>=U)return s;this.removeStyles();const i=yield N(t,e),n=0===i.width&&0===i.height,a=n?"container":"banner";return(0,M.H)({block:$.W.ADV_STICKY,level:"error",message:`AdvStickyBanner error: [${this.serviceType}] ${a} size = 0`}),n?this.maxSize:i}))}setBannerNumber(e){this.bannerNumber=e}getBannerNumber(){return this.bannerNumber}getBannerId(){return this.id}notifyListeners(e,t={}){const s=new CustomEvent(e,{detail:t});this.dispatchEvent(s)}setRequesting(e){this._isRequesting=e,e?this.addClass(T):this.removeClass(T)}render(){return this.wasContainerRendered.resolve(void 0),n().createElement("div",{className:this.getContainerClasses(),"data-block-id":this.getBlockId(),id:this.containerId,key:this.containerId,style:this.getContainerStyles(this.orientationSize,this.availableSize)})}}var z=s(29747),G=s(38512),j=s(77430),V=(e,t,s)=>new Promise(((i,n)=>{var a=e=>{try{o(s.next(e))}catch(e){n(e)}},r=e=>{try{o(s.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,r);o((s=s.apply(e,t)).next())}));class Y extends H{constructor(e){super(e),this.isFirstRequest=!0,this.params=e,this.containerId=this.containerId.replace(".","")}clear(){this.slot&&this.params.provider.promise.then((e=>e.destroySlot(this.slot)))}destroy(){this.clear(),this._wasDestroyed=!0,this.notifyListeners("destroy")}getBlockId(){return this.params.slotId}refresh(){return V(this,null,(function*(){var e,t,s,i;this._isHidden=!1,this._wasDestroyed=!1,this._wasRendered=!1,this.setRequesting(!0),this.show();try{yield this.wasContainerRendered.promise,this.notifyListeners("refresh",{availableSize:this.availableSize});const{slotId:n,clientId:a,maxSize:r}=this.params;this.clickDaemon.request({advBlockId:n});const o=yield this.params.provider.promise,d=Math.max(null!=(t=null==(e=this.container)?void 0:e.clientHeight)?t:50,r.height);let l=null!=(i=null==(s=this.container)?void 0:s.clientWidth)?i:z.K;0,this.slot=yield o.createSlot({blockId:n,clientId:a,divId:this.containerId,height:d,width:l,maxHeight:this.params.isFluid?d:void 0});const{isEmpty:c,slot:h}=yield o.preloadSlot(this.slot);if(yield this.onResponded(),c)throw this.clickDaemon.responseEmpty(),new j.Z("No content",G.uy.NO_CONTENT);this.clickDaemon.response(),yield o.showSlot(h),this.clickDaemon.show(),yield this.onRendered()}catch(e){this.onError(e)}}))}onResponded(){return V(this,null,(function*(){this.setRequesting(!1),this._isFirstRequestEnded=!0,this.notifyListeners("renderEnded",{})}))}onRendered(){return V(this,null,(function*(){this._hasError=!1,this._wasRendered=!0,this.removeClass(k),this.slotSize=yield this.getSlotSizeFromDocument(!1),this.setAvailableSize(this.slotSize[this.orientationSize]),this.notifyListeners("resize",{isFirstRequest:this.isFirstRequest,slotSize:this.slotSize}),this.isFirstRequest=!1}))}onError(e){this._hasError=!0,this._wasRendered=!1,this._isFirstRequestEnded=!0,this.clickDaemon.error(e.message),this.setRequesting(!1),this.addClass(k),this.isHidden()||this.hide(),this.notifyListeners("error",{error:e,isFirstRequest:this.isFirstRequestEnded()}),this.isFirstRequest=!1}show(){super.show(),this.removeClass(I)}hide(){super.hide(),this.addClass(I)}}class K{constructor(e,t){this.scriptInitPromise=void 0,this._isServiceFailed=!1,this.manager=e,this.params=t}isServiceFailed(){return this._isServiceFailed}}var X=s(6330),J=s(35742),Q=(e,t,s)=>new Promise(((i,n)=>{var a=e=>{try{o(s.next(e))}catch(e){n(e)}},r=e=>{try{o(s.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,r);o((s=s.apply(e,t)).next())}));class ee extends K{constructor(e,t){var s;super(e,t),this.serviceType=m.ADSENSE,this.provider=new D.Z,this.blocks=null==(s=e.allAdvBlocks.adsense)?void 0:s.sticky}initProvider(){return this.scriptInitPromise||(this.scriptInitPromise=new Promise(((e,t)=>Q(this,null,(function*(){try{_("Load Adsense script");const t=yield(0,X.l)(J.oO.AdsenseResponsive);_("Adsense script loaded."),this.provider.resolve(t),e(t)}catch(e){(0,M.H)({block:$.W.ADV_STICKY,prefix:"AdvStickyBanner error [adsense]:",message:"script failed to load"}),this.manager.onServiceFailed(this.serviceType),this.provider.reject(e),t(e)}}))))),this.scriptInitPromise}getAvailableBlock({bannerIndex:e,orientation:t}){var s;const{blocks:i}=this;let n;return n=[i.desktop.main,i.desktop.small],null!=(s=n[Math.min(e,1)])?s:null}getBanner(e){const t=this.getAvailableBlock(e);if(!t)return null;const{clientId:s,slotId:i}=t,{provider:n,serviceType:a}=this,{bannerOrientation:r,maxSize:o,orientationSize:d,viewType:l}=e;const c=0!==e.bannerIndex||!1,h=()=>"";return new Y({availableMaxSize:{width:1/0,height:o.height},baseClassName:E,blockId:"none",clientId:s,isAlternateLogs:!0,isFluid:c,maxSize:o,orientationSize:d,onNoContent:h,onError:h,onNoRequest:h,onRequest:h,onResponse:h,onShow:h,onTryOpen:h,provider:n,renderEndedBannerTimeout:this.manager.props.renderEndedBannerTimeout,retries:0,serviceType:a,slotId:i,viewType:l})}onBannersFilled(e){return Q(this,null,(function*(){if(e.length){try{yield this.initProvider()}catch(t){return void e.forEach((e=>e.onError(t)))}e.forEach((e=>e.refresh().catch((()=>{}))))}}))}}var te=s(36529),se=s(87210),ie=s(97553);const ne=(0,O.M$)("GoogleStickyBanner",O.XG.Adv),ae="AdvStickyBanner error [google]:";class re extends H{constructor(e){super(e),this.availableSize=0,this.isFirstRequest=!0,this.params=e}get adUnitPath(){var e;return null==(e=this.slot)?void 0:e.getAdUnitPath()}onSlotRequested(e){this.setRequestTimeoutTimer(),this.resetRefreshTimeoutTimer()}onSlotRenderEnded(e){this.resetRequestTimeoutTimer(),this.resetRefreshTimeoutTimer(),ne("onSlotRenderEnded",this.isRequesting(),this.hasError()),!this.isRequesting()&&this.hasError()||(this.isAlternateLogs&&(e.isEmpty?this.clickDaemon.responseEmpty():this.clickDaemon.response()),this.notifyListeners("renderEnded",{}),e.isEmpty&&this.onNoContent(e))}onImpressionViewable(e){!this.isRequesting()&&this.hasError()||(this.isAlternateLogs&&this.clickDaemon.show(),this.onRender())}onSlotOnload(e){this.resetRequestTimeoutTimer(),this.resetRefreshTimeoutTimer()}onSlotResponseReceived(e){this.resetRequestTimeoutTimer(),this.resetRefreshTimeoutTimer()}onRender(){this._hasError=!1,this._wasRendered=!0,this.notifyListeners("renderEnded",{}),this.params.onResponse(ie.Ud.SUCCESS,this.adReqId),this.params.onShow(!this.isFirstRequest,this.adReqId,this.adSeqId),this.removeClass(k),window.setTimeout((()=>{this.setRequesting(!1),this.finishRender()}),this.params.renderEndedBannerTimeout)}finishRender(){return e=this,t=null,s=function*(){var e;const t=this.params.sizes.some((e=>Array.isArray(e)?e.includes("fluid"):"fluid"===e));this._isFirstRequestEnded=!0,this.slotSize=yield this.getSlotSizeFromDocument(t),ne("onRender google banner","size = ",this.slotSize),this.setAvailableSize(this.slotSize[this.orientationSize]),this.notifyListeners("resize",{isFirstRequest:this.isFirstRequest,slotSize:this.slotSize}),null==(e=this.refreshPromise)||e.resolve(void 0),this.refreshPromise=void 0,this.isFirstRequest=!1},new Promise(((i,n)=>{var a=e=>{try{o(s.next(e))}catch(e){n(e)}},r=e=>{try{o(s.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,r);o((s=s.apply(e,t)).next())}));var e,t,s}onError(e){var t;this._hasError=!0,this._wasRendered=!1,this._isFirstRequestEnded=!0;const s=e instanceof j.Z&&e.code===G.uy.NO_CONTENT,i=`${ie.Ud.ERROR}_${e.message}`;this.isAlternateLogs&&(s?this.clickDaemon.noContent():this.clickDaemon.error(e.message)),this.isRequesting()?s||(this.params.onResponse(i,this.adReqId),this.params.onError(i,this.adReqId,this.adSeqId)):this.params.onNoRequest(e.message),this.setRequesting(!1),this.addClass(k),this.isHidden()||this.hide(),this.notifyListeners("error",{error:e,isFirstRequest:this.isFirstRequest}),null==(t=this.refreshPromise)||t.reject(e),this.refreshPromise=void 0,this.isFirstRequest=!1}onNoContent(e){var t;this.params.onResponse(ie.Ud.EMPTY,this.adReqId),this.params.onNoContent(this.adReqId,this.adSeqId,{});const{slot:s}=e,{maxRetries:i}=this,n=null!=(t=s.stickyRetries)?t:0;if(n>=i)return s.stickyRetries=0,void this.onError(new j.Z(`No content after ${n+1} requests`,G.uy.NO_CONTENT));s.stickyRetries=n+1,this.refreshTimeoutTimer=setTimeout((()=>{this.refresh().catch((e=>{ne("Refresh error",e)}))}),this.params.gptEmptyRefreshTimeout)}clear(){this.slot&&googletag.pubads().clear([this.slot])}destroy(){this.clear(),this._wasDestroyed=!0,this.notifyListeners("destroy")}refresh(){return this._isHidden=!1,this._wasDestroyed=!1,this._wasRendered=!1,this.setRequesting(!0),this.show(),this.refreshPromise||(this.refreshPromise=new D.Z),this.wasContainerRendered.promise.then((()=>{this.slot?(this.notifyListeners("refresh",{availableSize:this.availableSize}),this.isAlternateLogs?this.clickDaemon.request():this.logRequest(),window.googletag.pubads().refresh([this.slot])):(0,M.H)({block:$.W.GOOGLE_ADS,prefix:ae,message:"slot is not defined"})})),this.refreshPromise.promise}createSlot(){return ne("create slot"),this.createSlotPromise||(this.createSlotPromise=(0,se.bT)((e=>{var t;if(this.slot=null==(t=e.defineSlot(this.params.blockId,this.params.sizes,this.containerId))?void 0:t.addService(e.pubads()),!this.slot)throw new Error("slot was not created");return this.slot.stickyBanner=this,this.slot}))),this.createSlotPromise}getBlockId(){return this.params.blockId}resetRefreshTimeoutTimer(){this.refreshTimeoutTimer&&(window.clearTimeout(this.refreshTimeoutTimer),this.refreshTimeoutTimer=null)}resetRequestTimeoutTimer(){this.requestTimeoutTimer&&(window.clearTimeout(this.requestTimeoutTimer),this.requestTimeoutTimer=null)}setRequestTimeoutTimer(){this.resetRequestTimeoutTimer(),this.requestTimeoutTimer=window.setTimeout((()=>{this.requestTimeoutTimer=null,(0,M.H)({block:$.W.GOOGLE_ADS,prefix:ae,message:`${this.params.viewType} timeout error`}),this.onError(new j.Z("Timeout",G.uy.TIMEOUT))}),this.params.requestTimeout)}}var oe=s(65015),de=s(25798),le=s(59886),ce=s(78569),he=s(5e4),ue=s(28705);function pe(e,t,s=1/0){return Math.max(...e.map((e=>{const i=e[function(e){return"width"===e?0:1}(t)];return"number"==typeof i?i:s})))}var ve=s(60295),me=s(45254),ge=s(15771),we=s(90380),ye=(e,t,s)=>new Promise(((i,n)=>{var a=e=>{try{o(s.next(e))}catch(e){n(e)}},r=e=>{try{o(s.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,r);o((s=s.apply(e,t)).next())}));const fe=(0,O.M$)("GoogleAdvStickyService",O.XG.Adv);class be extends K{constructor(e,t){super(e,t),this.serviceType=m.GOOGLE,this.usePrebid=(0,ge.AZ)(this.params.flags),this.useMultipleAuction=(0,ge.Ml)(this.params.flags),this.initReadyPromise=new D.Z,this.currentAdvBlocks=[],this.retries=(0,ge.ff)(this.params.flags),this.retriesByBlockId={},this.allStickyGoogleAdvBlocks=this.manager.allAdvBlocks.google.sticky,this.setAdvBlocks(),this.prebidAdUnits=(0,ue.xZ)({stickyBlocks:this.allStickyGoogleAdvBlocks,flags:this.params.flags,isPlayhop:this.params.secondDomain===me.U.PLAYHOP}),fe("init")}setAdvBlocks(){this.blockIds=this.allStickyGoogleAdvBlocks,this.manager.useHighPortraitBlockIds&&this.allStickyGoogleAdvBlocks.portrait_high&&(this.blockIds.portrait=this.allStickyGoogleAdvBlocks.portrait_high)}updateCurrentAdvBlocks(){const{blockIds:e}=this;this.currentAdvBlocks=[e.desktop.main,e.desktop.small]}tryScriptLoad(e){if(!this.scriptInitPromise){let t=!1;this.scriptInitPromise=new Promise(((s,i)=>{const n=e=>{fe("onScriptsLoaded: false"),t=!0,this.onAdvScriptError(),i(e),this.initReadyPromise.reject(e)},a=()=>{s(void 0),this.manager.onServiceLoaded(this.serviceType),t&&((0,ue.YR)("gptLoadedAfterTimeoutError",!0),this.initBanners({banners:e,withRefresh:!1})),this.initReadyPromise.resolve(void 0)},r=(0,te.D)(se.CX).then((()=>{throw new Error("Timeout script load error")})),o=(0,de.cQ)({cdnUrl:this.manager.context.cdnUrl,flags:this.params.flags,fullUrl:window.location.href,options:{isSlowCountry:this.manager.context.isSlowCountry}}),d=(0,se.xq)({metrikaCounter:this.params.metrikaCounter,parallel:(0,ge.RM)(this.params.flags,we.Z.prebidLoadAfterGpt)||!1,prebidScriptUrl:this.usePrebid?o:void 0});Promise.race([r,d]).then((e=>ye(this,null,(function*(){if(e.prebid||(this.usePrebid=!1),e.prebidError&&fe(e.prebidError),e.gptError)throw e.gptError;fe("onScriptsLoaded: true"),yield this.initGPT(),this.usePrebid?(yield this.initPrebid(),this.useMultipleAuction||(yield this.prebidStartAuction()),a()):a()})))).catch((e=>{n(e)}))}))}return this.scriptInitPromise}onAdvScriptError(){(0,M.H)({block:$.W.ADV_STICKY,message:"AdvStickyBanner error [google]: script failed to load"}),this.manager.onServiceFailed(this.serviceType)}initGPT(){return ye(this,null,(function*(){yield(0,se.Vg)(),yield(0,se.bT)((e=>ye(this,null,(function*(){fe("init googletag"),e.pubads().addEventListener("slotRequested",(e=>{e.slot.stickyBanner&&(fe("slotRequested",e),e.slot.stickyBanner.onSlotRequested(e))})).addEventListener("slotRenderEnded",(e=>{e.slot.stickyBanner&&(fe("onSlotRenderEnded",e),e.slot.stickyBanner.onSlotRenderEnded(e))})).addEventListener("impressionViewable",(e=>{e.slot.stickyBanner&&(fe("impressionViewable",e),e.slot.stickyBanner.onImpressionViewable(e))})).addEventListener("slotOnload",(e=>{e.slot.stickyBanner&&(fe("slotOnload",e),e.slot.stickyBanner.onSlotOnload(e))})).addEventListener("slotResponseReceived",(e=>{e.slot.stickyBanner&&(fe("slotResponseReceived",e),e.slot.stickyBanner.onSlotResponseReceived(e))})),e.enableServices()}))))}))}initPrebid(){return ye(this,null,(function*(){fe("[prebid_sticky] initPrebid"),yield(0,de.OH)(),yield(0,de.BA)((e=>ye(this,null,(function*(){return e.addAdUnits(this.prebidAdUnits)}))))}))}prebidStartAuction(e){return ye(this,null,(function*(){return new Promise((t=>ye(this,null,(function*(){fe("[prebid_sticky] startAuction, banners=",e);const s=e?e.map((e=>e.adUnitPath)).filter(Boolean):(0,ue.Dr)(this.prebidAdUnits);if(!s.length)return void t();const i=Date.now(),n=1.5*le.ZV,a=setTimeout((()=>{fe("[prebid_sticky] No auction handled, call empty function."),r(void 0,!0)}),n),r=(e,n)=>ye(this,null,(function*(){clearTimeout(a),fe("[prebid_sticky] prebidAuctionHandler",e);const r=Date.now()-i;n?((0,oe.fF)(new Error("[prebid_sticky] Auction finished with bidders timed out.")),r>0&&(0,ve.s4)("prebid_sticky_auction_timeout",r)):r>0&&(0,ve.s4)("prebid_sticky_auction_time",r),(0,ce.H)({advTag:he.$.STICKY,adUnitCodes:s,bids:e}),yield(0,de.BA)((e=>{e.setTargetingForGPTAsync(s),t()}))}));yield(0,de.BA)((e=>{e.requestBids({adUnitCodes:s,bidsBackHandler:r,timeout:le.ZV})}))}))))}))}initBanners({banners:e,withRefresh:t}){this.initReadyPromise.promise.then((()=>ye(this,null,(function*(){if(!(googletag&&"pubads"in googletag&&"defineSlot"in googletag))throw new Error("something gone wrong with googletag");fe("create slots");const s=yield Promise.all(e.map((e=>e.createSlot())));s.length&&t&&(fe("refresh slots",s),e.forEach((e=>{e.logTryOpen(),e.logRequest(),this.params.isAlternateLogs&&e.clickDaemon.request(),e.setRequesting(!0)})),this.usePrebid&&this.useMultipleAuction&&e.length&&(yield this.prebidStartAuction(e)),googletag.pubads().refresh(s))})))).catch((t=>{fe("initBanners error",t),this.manager.onServiceFailed(this.serviceType),this.onFailInitBanners(e,t)}))}onFailInitBanners(e,t){e.forEach((e=>e.onError(t)))}onBannersFilled(e){fe("onBannersFilled, banners =",e),0!==e.length&&this.tryScriptLoad(e).then((()=>{fe("onBannersFilled script loaded"),this.initBanners({banners:e,withRefresh:!0})})).catch((t=>{this.onFailInitBanners(e,t)}))}onBannersRefresh(e){return ye(this,null,(function*(){e.length&&this.usePrebid&&this.useMultipleAuction&&(yield this.prebidStartAuction(e))}))}getBanner(e){const{maxSize:t,bannerIndex:s,orientation:i,orientationSize:n,viewType:a}=e;this.updateCurrentAdvBlocks();const r=this.getAvailableSlot(s);if(fe("getGoogleBanner slotData =",r),!r)return null;const o={width:pe(r.availableSlot.sizes,"width",t.width),height:pe(r.availableSlot.sizes,"height",t.height)},d={width:pe(r.availableSlot.sizes,"width"),height:pe(r.availableSlot.sizes,"height")},{blockId:l}=r.block,c=new re({availableMaxSize:d,baseClassName:E,blockId:l,gptEmptyRefreshTimeout:this.manager.props.gptEmptyRefreshTimeout,isAlternateLogs:this.params.isAlternateLogs,maxSize:o,orientationSize:n,onNoContent:(e,t)=>{this.decreaseRetriesForBlockId(l),c.setMaxRetries(this.getRetriesForBlockId(l)),this.manager.logAdvNoContent(this.serviceType,e,t,{})},onTryOpen:()=>this.manager.logAdvTryOpen(this.serviceType,l),onResponse:(e,t)=>{this.manager.logAdvResponse(this.serviceType,e,t)},onError:(e,t,s)=>{this.decreaseRetriesForBlockId(l),c.setMaxRetries(this.getRetriesForBlockId(l)),this.manager.logAdvError(this.serviceType,e,t,s)},onShow:(e,t,s)=>{this.increaseRetriesForBlockId(l),c.setMaxRetries(this.getRetriesForBlockId(l)),this.manager.logAdvShow(this.serviceType,e,t,s)},onRequest:()=>this.manager.logAdvRequest(this.serviceType,l),onNoRequest:e=>{this.manager.logNoRequest(this.serviceType,l,e)},requestTimeout:this.manager.timeToLoadAdv,renderEndedBannerTimeout:this.manager.props.renderEndedBannerTimeout,retries:this.getRetriesForBlockId(l),serviceType:this.serviceType,sizes:r.availableSlot.sizes,viewType:a});return c}getRetriesForBlockId(e){var t;return Math.ceil(null!=(t=this.retriesByBlockId[e])?t:this.retries)}increaseRetriesForBlockId(e){e in this.retriesByBlockId&&(this.retriesByBlockId[e]=Math.min(this.retriesByBlockId[e]+.5,this.retries))}decreaseRetriesForBlockId(e){this.retriesByBlockId[e]=Math.max(this.getRetriesForBlockId(e)-1,0)}getAvailableSlot(e){const t=e<this.currentAdvBlocks.length?e:this.currentAdvBlocks.length-1,s=this.currentAdvBlocks[t];if(s)return fe("getGoogleBanner iteration",s),{availableSlot:{sizes:s.sizes},block:s}}}const Ae=new Set;function Se(e,t){(0,M.H)({block:$.W.ADV_STICKY,message:`${e}: ${t.message}`},t)}function ke(e){Se("NativeStickyApi error",e)}function Ee(e){return`yandexgames:///ads/${e}`}function Ie(e){var t,s;return"function"==typeof(null==(s=null==(t=window.yandex)?void 0:t.ads)?void 0:s[e])}function Re(e){return function(...t){var s,i,n;return Ie(e)?null==(n=null==(i=null==(s=window.yandex)?void 0:s.ads)?void 0:i[e])?void 0:n.call(i,...t).catch((e=>{throw ke(e),e})):function(e){const t=new Error(`Action "${e}" is not available`);return ke(t),Promise.reject(t)}(e)}}const Pe={isActionAvailable:Ie,hideStickyBanner:Re("hideStickyBanner"),refreshStickyBanner:Re("refreshStickyBanner"),showStickyBanner:e=>{const{blockId:t,mediation:s,position:i,orientation:n,dimension:a,revenueData:r}=e;return Re("showStickyBanner")(t,s,i,n,a,r)},stickyBannerIsShowing:Re("stickyBannerIsShowing")};var Te=s(42126);function Ce(e){return e.status>=200&&e.status<300?Promise.resolve(e):Promise.reject(new Error(`Bad response. Status = ${e.status}`))}function Le(e){return e.json()}function De({actionName:e,params:t={}}){const s=(0,Te.Z)({url:Ee(e),params:t});return fetch(s).then(Ce).then(Le).then((e=>(console.info("adv responseJSON:",e),(null==e?void 0:e.error)?Promise.reject(new Error(e.error.message||"empty message")):Promise.resolve()))).catch((e=>{throw Se("NativeStickyApi fetch error",e),e}))}function Oe(e){return function(){return De({actionName:e})}}const Be={isActionAvailable:()=>!0,stickyBannerIsShowing:Oe("stickyBannerIsShowing"),refreshStickyBanner:Oe("refreshStickyBanner"),hideStickyBanner:Oe("hideStickyBanner"),showStickyBanner:e=>{const{blockId:t,mediation:s,position:i,orientation:n,dimension:a,revenueData:r}=e;return De({actionName:"showStickyBanner",params:{blockId:t,position:i,orientation:n,dimension:a,mediation:s,revenueData:r.revenueData}})}},xe=e=>e?Be:Pe;var _e=s(34711),Ne=s(7991),qe=s(97733),Me=s(27859),$e=s(29008),Fe=Object.defineProperty,We=Object.getOwnPropertySymbols,Ze=Object.prototype.hasOwnProperty,Ue=Object.prototype.propertyIsEnumerable,He=(e,t,s)=>t in e?Fe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,ze=(e,t)=>{for(var s in t||(t={}))Ze.call(t,s)&&He(e,s,t[s]);if(We)for(var s of We(t))Ue.call(t,s)&&He(e,s,t[s]);return e},Ge=(e,t,s)=>new Promise(((i,n)=>{var a=e=>{try{o(s.next(e))}catch(e){n(e)}},r=e=>{try{o(s.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,r);o((s=s.apply(e,t)).next())}));const je=(0,O.M$)("NativeAdvStickyService",O.XG.Adv);const Ve=class extends K{constructor(e,t,s){super(e,t),this.serviceType=m.NATIVE,this.isAdvHidden=!1,this.adReqIds={portrait:"",landscape:""},this.adSeqIds={portrait:"",landscape:""},this.refreshTimeoutIds={landscape:0,portrait:0},this.isAdNeedToRefresh={portrait:!1,landscape:!1},this.advHeight={portrait:ue.qi,landscape:ue.qi},this.revenueData={app_id:this.params.appId},this.revenueDataAsString="",this.changeOrientationListener=()=>Ge(this,null,(function*(){const e=Me.Z.isPortrait?"portrait":"landscape";if(je(`changeOrientationListener isAdNeedToRefresh${e}=${this.isAdNeedToRefresh[e]}`),this.isAdNeedToRefresh[e])return void this.updateAdv(e);if(!this.nativeStickyApi.isActionAvailable("stickyBannerIsShowing"))return;const t=yield this.nativeStickyApi.stickyBannerIsShowing();je(`changeOrientationListener isAdvShowing=${t} advHidden=${this.isAdvHidden}`),t||this.isAdvHidden||this.openNativeAdvBanner(e)}));const{isIOS:i}=(0,$e.AK)(this.params.platform);this.nativeStickyApi=xe(i),this.blockIds=(0,ue.AO)({advBlocks:t.advBlocks,flags:t.flags,residenceInfo:t.residenceInfo,withWorldWideAdv:t.withWorldWideAdv,locations:e.stickyBannerLocation,useHighPortraitBlockIds:this.manager.useHighPortraitBlockIds}),this.serviceParams=s,this.library=(0,ue.dF)(t.flags);const n=(0,_e.X)(),a=(0,Ne.W5)(),r=ze(ze({},n?{clid:n}:{}),a?{gclid:a}:{});Object.assign(this.revenueData,r),this.revenueDataAsString=JSON.stringify(this.revenueData);const o=e.isLandscapeSide;this.advHeight={portrait:e.mobileAdvPortraitHeight,landscape:o?e.mobileAdvSideLandscapeWidth:e.mobileAdvLandscapeHeight},this.init()}init(){return Ge(this,null,(function*(){je(`blockIds = ${JSON.stringify(this.blockIds)}\n\n            revenueData=${this.revenueDataAsString}\n        `),yield this.tryShowAdv(),Me.Z.addChangeListener(this.changeOrientationListener)}))}updateAdvVisibility(e){je("updateAdvVisibility, isAdvVisible =",e.isAdvVisible);const t=!e.isAdvVisible;t&&!this.isAdvHidden?this.hideAdv():!t&&this.isAdvHidden&&this.tryShowAdv(),this.isAdvHidden=t}getBanner(){return null}onBannersFilled(){}tryShowAdv(){return Ge(this,null,(function*(){if(!this.nativeStickyApi.isActionAvailable("stickyBannerIsShowing"))return je("tryShowAdv","ads.stickyBannerIsShowing is not a function"),void this.onClose();je("tryShowAdv");const e=yield this.nativeStickyApi.stickyBannerIsShowing();if(je("tryShowAdv, isShowing =",e),this.serviceParams.onAdvShowed(),e)return void je("tryShowAdv","adv is showing");this.clickDaemon=new qe.U({app_id:this.params.appId,tag:he.$.STICKY});const{mobilePortrait:t,mobileLandscape:s}=this.manager.stickyBannerLocation;t&&Me.Z.isPortrait?(this.params.isAlternateLogs?this.clickDaemon.demand({advBlockId:this.blockIds.portrait,depth:-1,provider:this.serviceType,reason:ie.p_.ONSPOT}):this.adSeqIds.portrait=this.manager.logAdvTryOpen(m.NATIVE,this.blockIds.portrait),this.openNativeAdvBanner("portrait")):s&&Me.Z.isLandscape&&(this.params.isAlternateLogs?this.clickDaemon.demand({advBlockId:this.blockIds.landscape,depth:-1,provider:this.serviceType,reason:ie.p_.ONSPOT}):this.adSeqIds.landscape=this.manager.logAdvTryOpen(m.NATIVE,this.blockIds.landscape),this.openNativeAdvBanner("landscape"))}))}hideAdv(){je("hideAdv"),this.nativeStickyApi.isActionAvailable("hideStickyBanner")?(this.nativeStickyApi.hideStickyBanner(),this.serviceParams.onAdvShowed()):je("hideAdv","ads.hideStickyBanner is undefined")}onClose(){this.params.isAlternateLogs?this.clickDaemon.close():(this.adReqIds.portrait&&this.manager.logAdvClose(m.NATIVE,this.adReqIds.portrait,this.adSeqIds.portrait),this.adReqIds.landscape&&this.manager.logAdvClose(m.NATIVE,this.adReqIds.landscape,this.adSeqIds.landscape)),this.hideAdv()}openNativeAdvBanner(e){if(!this.nativeStickyApi.isActionAvailable("showStickyBanner"))return je("openNativeAdvBanner","ads.showStickyBanner is undefined"),void this.onClose();const{stickyBannerLocation:{mobilePortrait:t,mobileLandscape:s}}=this.manager,i="portrait"===e?t:s;if(!i)return void je("openNativeAdvBanner","ad position is a null");const n=function(e,t){return"upper"===t?t="bottom":"left"===t&&(t="right"),`${e}-${t}`}(e,i);if(Ae.has(n))return je("openNativeAdvBanner","The previous show ended with an error"),void this.onClose();je("openNativeAdvBanner",this.blockIds[e],this.library,i,e,this.advHeight[e],this.revenueDataAsString),this.params.isAlternateLogs?this.clickDaemon.request():this.adReqIds[e]=this.manager.logAdvRequest(m.NATIVE,this.blockIds[e]),this.nativeStickyApi.showStickyBanner({blockId:this.blockIds[e],mediation:this.library,position:i,orientation:e,dimension:this.advHeight[e],revenueData:{revenueData:this.revenueDataAsString}}).then((()=>{Ae.delete(n),this.params.isAlternateLogs?(this.clickDaemon.response(),this.clickDaemon.show()):(this.manager.logAdvResponse(m.NATIVE,ie.Ud.SUCCESS,this.adReqIds[e]),this.manager.logAdvShow(m.NATIVE,!1,this.adReqIds[e],this.adSeqIds[e])),this.isAdNeedToRefresh[e]=!1,this.runUpdateAdvTimeout(e)})).catch((t=>{Ae.add(n),this.params.isAlternateLogs?this.clickDaemon.error(t.message||t):(this.manager.logAdvResponse(m.NATIVE,ie.Ud.ERROR,this.adReqIds[e]),this.manager.logAdvError(m.NATIVE,ie.Ud.ERROR,this.adReqIds[e],this.adSeqIds[e])),je(t),this.onClose()}))}runUpdateAdvTimeout(e){const t=Me.Z.isPortrait?"portrait":"landscape";this.refreshTimeoutIds[e]=window.setTimeout((()=>{e===t?this.updateAdv(e):this.isAdNeedToRefresh[e]=!0}),this.manager.intervalBetweenRefreshAd)}updateAdv(e){if(!this.nativeStickyApi.isActionAvailable("refreshStickyBanner"))return void je("updateAdv","ads.refreshAdvert is undefined");let t;this.params.isAlternateLogs?(t=this.clickDaemon=new qe.U({app_id:this.params.appId,tag:he.$.STICKY}),t.tryOpen({provider:this.serviceType,reason:ie.p_.REFRESH}),t.demand({advBlockId:this.blockIds[e],depth:-1,provider:this.serviceType,reason:ie.p_.REFRESH}),t.request()):(this.adSeqIds[e]=this.manager.logAdvTryOpen(m.NATIVE,this.blockIds[e]),this.adReqIds[e]=this.manager.logAdvRequest(m.NATIVE,this.blockIds[e])),this.nativeStickyApi.refreshStickyBanner().then((()=>{this.params.isAlternateLogs?(t.response(),t.show()):(this.manager.logAdvResponse(m.NATIVE,ie.Ud.SUCCESS,this.adReqIds[e]),this.manager.logAdvShow(m.NATIVE,!1,this.adReqIds[e],this.adSeqIds[e])),window.clearTimeout(this.refreshTimeoutIds[e]),this.isAdNeedToRefresh[e]=!1,this.runUpdateAdvTimeout(e)})).catch((s=>{this.params.isAlternateLogs?t.error(s.message||s):(this.manager.logAdvResponse(m.NATIVE,ie.Ud.ERROR,this.adReqIds[e]),this.manager.logAdvError(m.NATIVE,ie.Ud.ERROR,this.adReqIds[e],this.adSeqIds[e])),je(s),this.onClose()}))}};var Ye=s(58432),Ke=Object.defineProperty,Xe=Object.defineProperties,Je=Object.getOwnPropertyDescriptors,Qe=Object.getOwnPropertySymbols,et=Object.prototype.hasOwnProperty,tt=Object.prototype.propertyIsEnumerable,st=(e,t,s)=>t in e?Ke(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,it=(e,t)=>{for(var s in t||(t={}))et.call(t,s)&&st(e,s,t[s]);if(Qe)for(var s of Qe(t))tt.call(t,s)&&st(e,s,t[s]);return e},nt=(e,t)=>Xe(e,Je(t));const at=(0,O.M$)("YandexStickyBanner",O.XG.Adv);let rt=1;class ot extends H{constructor(e){super(e),this.availableSize=0,this.requestNumber=0,this.additionalRequestInfo={},this.renderEndedBannerTimer=null,this.params=e,this.advOptions=this.getAdvOptions(),e.blockId||(0,M.H)({block:$.W.ADV_STICKY,message:"AdvStickyBanner error [yandex]: There is no blockId"})}getAdvOptions(){const{appId:e,blockId:t,deviceId:s}=this.params;return{async:!0,blockId:t,pageNumber:rt++,disableRefresh:!0,extParams:nt(it({},s?{google_aid:s}:{}),{utm_source_service:"games","distr-id":e}),renderTo:this.containerId,statId:(0,Ye.Sn)(),onError:e=>{this.onError(new j.Z(e.text||"Unknown",e.code||G.uy.UNKNOWN))},onRender:e=>{at("render data",e,"hasError =",this._hasError),this._hasError||this.onRender()}}}get isFirstRequest(){return 0===this.requestNumber}clear(){var e,t;at("clear"),this.clearRenderEndedBannerTimer(),null==(t=null==(e=window.Ya)?void 0:e.Context)||t.AdvManager.destroy({renderTo:this.containerId})}destroy(){at("destroy"),this.clear(),this._wasDestroyed=!0,this.notifyListeners("destroy")}refresh(){return at("refresh"),this._hasError=!1,this._wasDestroyed=!1,this._wasRendered=!1,this.setRequesting(!0),this.show(),this.notifyListeners("refresh",{availableSize:this.availableSize}),this.refreshPromise||(this.refreshPromise=new D.Z),this.clear(),this.wasContainerRendered.promise.then((()=>{var e,t;at("refresh render"),this.isAlternateLogs?this.clickDaemon.request():this.logRequest(),this.additionalRequestInfo={banner_width:null==(e=this.container)?void 0:e.clientWidth,banner_height:null==(t=this.container)?void 0:t.clientHeight,banner_number:this.bannerNumber,request_number:this.requestNumber,view_type:this.params.viewType},(0,G.Q$)({abtFlags:{},adOptions:this.advOptions,methodName:G.xn.RENDER,onAdLoadFailed:e=>{this.onError(e)}})})),this.refreshPromise.promise}clearRenderEndedBannerTimer(){this.renderEndedBannerTimer&&(clearTimeout(this.renderEndedBannerTimer),this.renderEndedBannerTimer=null)}onRender(){this._hasError=!1,this._wasRendered=!0,this.isAlternateLogs?(this.clickDaemon.response(),this.clickDaemon.show()):(this.params.onResponse(ie.Ud.SUCCESS,this.adReqId),this.params.onShow(!this.isFirstRequest,this.adReqId,this.adSeqId)),this.removeClass(k),this.notifyListeners("renderEnded"),this.renderEndedBannerTimer=window.setTimeout((()=>{return e=this,t=null,s=function*(){var e;this._isFirstRequestEnded=!0,this.setRequesting(!1);const t=yield this.getSlotSizeFromDocument();at("onRender yandex banner","size = ",t),this.slotSize=t,this.setAvailableSize(t[this.orientationSize]),this.notifyListeners("resize",{isFirstRequest:this.isFirstRequest,slotSize:t}),null==(e=this.refreshPromise)||e.resolve(void 0),this.refreshPromise=void 0,this.requestNumber+=1},new Promise(((i,n)=>{var a=e=>{try{o(s.next(e))}catch(e){n(e)}},r=e=>{try{o(s.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,r);o((s=s.apply(e,t)).next())}));var e,t,s}),this.params.renderEndedBannerTimeout)}onError(e){var t;this._hasError=!0,this._wasRendered=!1,this._isFirstRequestEnded=!0;const s=`${ie.Ud.ERROR}_${e.message}`;this.isRequesting()?(this.params.onResponse(s,this.adReqId),e.code===G.uy.NO_CONTENT?(this.isAlternateLogs&&this.clickDaemon.responseEmpty(),this.params.onNoContent(this.adReqId,this.adSeqId,this.additionalRequestInfo)):(this.isAlternateLogs&&this.clickDaemon.error(e.message),this.params.onError(s,this.adReqId,this.adSeqId))):(this.isAlternateLogs&&this.clickDaemon.error(e.message),this.params.onNoRequest(e.message)),this.setRequesting(!1),at(e.message),this.addClass(k),this.isHidden()||this.hide(),this.notifyListeners("error",{error:e,isFirstRequest:this.isFirstRequest}),null==(t=this.refreshPromise)||t.reject(e),this.refreshPromise=void 0,this.requestNumber+=1}getBlockId(){return this.params.blockId}}var dt=s(79049);const lt=(0,O.M$)("YandexAdvStickyService",O.XG.Adv);class ct extends K{constructor(e,t){super(e,t),this.serviceType=m.YANDEX,this.currentBlockIds=[];const{appId:s}=this.params;this.allPlatformBlockIds=(0,ue.V0)({advBlocks:e.advBlocks,appId:s,flags:this.params.flags,locations:e.stickyBannerLocation,useHighPortraitBlockIds:e.useHighPortraitBlockIds}),lt("init",this.allPlatformBlockIds)}updateCurrentBlockIds(){this.currentBlockIds=[this.allPlatformBlockIds.desktop,this.allPlatformBlockIds.desktop_additional]}tryScriptLoad(){return this.scriptInitPromise||(this.scriptInitPromise=(0,dt.x)({id:"yandexads-context",src:this.params.yaAdsScript}).catch((()=>{const e=new j.Z("AdvStickyBanner error [yandex]: script failed to load","SCRIPT_LOAD_FAILED");throw this.onAdvScriptError(e),e}))),this.scriptInitPromise}onAdvScriptError(e){(0,M.H)({block:$.W.ADV_STICKY},e),this.manager.onServiceFailed(this.serviceType)}getBanner(e){lt("get banner",this.currentBlockIds);const{bannerIndex:t,maxSize:s,orientationSize:i,viewType:n}=e,{appId:a}=this.params;this.updateCurrentBlockIds();const r=t<this.currentBlockIds.length?t:this.currentBlockIds.length-1,o=this.currentBlockIds[r];return new ot({appId:a,availableMaxSize:{width:1/0,height:1/0},bannerIndex:t,baseClassName:L,blockId:o,deviceId:this.manager.deviceId,isAlternateLogs:this.params.isAlternateLogs,maxSize:s,orientationSize:i,onNoContent:(e,t,s)=>{this.manager.logAdvNoContent(this.serviceType,e,t,s)},onTryOpen:()=>this.manager.logAdvTryOpen(this.serviceType,o),onResponse:(e,t)=>{this.manager.logAdvResponse(this.serviceType,e,t)},onError:(e,t,s)=>{this.manager.logAdvError(this.serviceType,e,t,s)},onShow:(e,t,s)=>{this.manager.logAdvShow(this.serviceType,e,t,s)},onRequest:()=>this.manager.logAdvRequest(this.serviceType,o),onNoRequest:e=>{this.manager.logNoRequest(this.serviceType,o,e)},renderEndedBannerTimeout:this.manager.props.renderEndedBannerTimeout,retries:0,serviceType:this.serviceType,viewType:n})}onBannersFilled(e){lt("onBannersFilled",e),0!==e.length&&this.tryScriptLoad().then((()=>{e.forEach((e=>{e.logTryOpen(),e.refresh().catch((()=>{}))}))})).catch((t=>{e.forEach((e=>e.onError(t)))}))}}var ht=s(45331),ut=s(10131),pt=s(85467),vt=s(98589),mt=s(909);const gt=h().with("disable-ad-button"),wt=()=>{const e=(0,pt.T)(),t=(0,i.useRef)(null),s=(0,i.useRef)(null),a=(0,i.useCallback)((()=>{(0,mt.Z)(),vt.Z.params({borrowParams:{adv:{sticky:{disableAdButtonClick:{size:"long"}}}}})}),[]),r=(0,i.useMemo)((()=>e("no-ads.disable.text")),[e]);return n().createElement("div",{className:gt({}),ref:t},n().createElement(ut.z,{className:gt("button"),"data-testid":"DisableAd-Button",ref:s,size:24,view:"primary",onClick:a},r))};var yt=s(78740),ft=s(95968),bt=(e=>(e.LANDSCAPE="landscape",e.PORTRAIT="portrait",e))(bt||{}),At=s(43548),St=s(21466),kt=s(50042),Et=s(61874),It=s(14408);var Rt,Pt=s(92691),Tt=s(17061),Ct=s(35090),Lt=s(65068),Dt=s(39732),Ot=s(4070),Bt=s(40581),xt=s(43190),_t=s(49095),Nt=s(41811),qt=s(40656),Mt=Object.defineProperty,$t=Object.defineProperties,Ft=Object.getOwnPropertyDescriptors,Wt=Object.getOwnPropertySymbols,Zt=Object.prototype.hasOwnProperty,Ut=Object.prototype.propertyIsEnumerable,Ht=(e,t,s)=>t in e?Mt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,zt=(e,t)=>{for(var s in t||(t={}))Zt.call(t,s)&&Ht(e,s,t[s]);if(Wt)for(var s of Wt(t))Ut.call(t,s)&&Ht(e,s,t[s]);return e},Gt=(e,t)=>$t(e,Ft(t)),jt=(e,t,s)=>new Promise(((i,n)=>{var a=e=>{try{o(s.next(e))}catch(e){n(e)}},r=e=>{try{o(s.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,r);o((s=s.apply(e,t)).next())}));let Vt=!0;const Yt=(0,O.M$)("AdvStickyBannerManagerNew",O.XG.Adv),Kt=(0,O.M$)("mainStickyLog",O.XG.Adv),Xt="adv-sticky-banner",Jt=h().with("sticky-banner-container");let Qt=0;class es extends ht.P{constructor(e,t){var s;super(e,t),this.desktopAdvWidth=ue.q5,this.mobileAdvPortraitHeight=ue.qi,this.mobileAdvLandscapeHeight=ue.qi,this.mobileAdvSideLandscapeWidth=ue.HZ,this.intervalBetweenRefreshAd=qt.yR,this.isAdvStickyBannerEnabled=!1,this.isAdvStickyEnabledOnStartByExp=!1,this.minScreenWidthForDesktopAdv=ue.ie,this.isCatalogSticky=!1,this.timeoutAfterOrientationChange=null,this.forcedToHideRelatedAdv=!0===(0,ge.RM)(this.context.abt.flags,we.Z.advStickyBannerForcedHideAd),this.adClosed=!1,this.useHighPortraitBlockIds=!1,this.isLandscapeSide=!1,this.stickyBannerLocation={desktop:null,mobileLandscape:null,mobilePortrait:null},this.services=[],this.failedServices={adsense:!1,google:!1,native:!1,yandex:!1},this.availableServices=[],this.availableSpaceForBanners={height:0,width:0},this.refreshTimer=null,this.clickDaemonAdvLog={},this.shouldRefreshBanners=!1,this.isGameFrameCanBeResizedInLandscape=!1,this.isGameFrameCanBeResizedInPortrait=!1,this.isStickyPrebidEnabled=(0,ge.AZ)(this.context.abt.flags),this.isAlternateLogs=null!=(Rt=(0,ge.RM)(this.context.abt.flags,we.Z.advAlternateLogs))&&Rt,this.timeToLoadAdv=(0,ue.Qt)(this.context.abt.flags),this.deviceId=void 0,this.refreshingOrientations={landscape:!1,portrait:!1},this.allAdvBlocks=this.props.allAdvBlocks,this.state={activeOrientation:this.getCurrentOrientation(),advStickyBannerHidden:!0,banners:{landscape:{horizontal:[],vertical:[]},portrait:{horizontal:[],vertical:[]}},canShowAdvStickyBanner:!1,isPageBlured:!1,isHeaderEnabled:!0,showSpinner:!0},this.isFirstTryOpen=!0,this.onStickyBannerMessage=e=>jt(this,null,(function*(){const{action:t,data:s}=e.data;"hide"!==t||"blur"!==(null==s?void 0:s.reason)?"show"===t&&"blur"===(null==s?void 0:s.reason)&&this.setState({isPageBlured:!1}):this.setState({isPageBlured:!0})})),this.onExternalMessage=(e,t)=>jt(this,null,(function*(){const{action:s}=e.data;switch(s){case"adv-show-sticky-banner":{if(Yt(`onExternalMessage: action: "${s}"`),this.adClosed=!1,!this.isAdvStickyBannerEnabled)return void t({data:{stickyAdvIsShowing:!1,reason:ue.$R.ADV_IS_NOT_CONNECTED}});if(!this.canShowAdv())return void t({data:{stickyAdvIsShowing:!1,reason:ue.$R.UNKNOWN}});this.initAdv();const e=this.state.canShowAdvStickyBanner?{}:{reason:ue.$R.UNKNOWN};t({data:zt({stickyAdvIsShowing:this.state.canShowAdvStickyBanner},e)});break}case"adv-hide-sticky-banner":Yt(`onExternalMessage: action: "${s}"`),this.adClosed=!0,this.hideAdv(),t({data:{stickyAdvIsShowing:!1}});break;case"adv-status-sticky-banner":{if(!this.isAdvStickyBannerEnabled)return void t({data:{stickyAdvIsShowing:!1,reason:ue.$R.ADV_IS_NOT_CONNECTED}});const e=this.state.canShowAdvStickyBanner&&!this.state.advStickyBannerHidden;Yt(`onExternalMessage: action: "${s}", stickyAdvIsShowing: ${e}`),t({data:{stickyAdvIsShowing:e}});break}}})),this.handleVisibilityChange=()=>{"hidden"===document.visibilityState?(this.setHideState(!0),this.sendToStickyMetrika("visibilityState","hidden")):(this.initAdv(),this.sendToStickyMetrika("visibilityState","visible"))},this.handleFullscreenChange=()=>{this.props.isFullscreenActive?this.hideAdv():this.initAdv()},this.handleDesktopResize=()=>{Yt("handleDesktopResize"),this.updateAvailableSpaceForBanners(),(0,Bt.bY)().innerWidth<=this.minScreenWidthForDesktopAdv?this.hideAdv():this.state.canShowAdvStickyBanner&&!this.state.advStickyBannerHidden||this.initAdv()},this.onSubscriptionsMessage=e=>jt(this,null,(function*(){if("changed"===e.data.action){(yield(0,Et.K)())&&this.state.canShowAdvStickyBanner&&this.handleCloseAdv()}})),this.hideAdv=()=>{Yt("hide adv"),Kt({event:"hide sidebar"}),this.removeDefaultClasses(),this.setHideState(!0),Ot.Z.removeResizeBlock(Xt),this.removeBodyStickyResize()},this.handleCloseAdv=()=>{this.removeDefaultClasses(),At.Z.post({type:"sticky-manager",action:"on-hide"}),this.setState({canShowAdvStickyBanner:!1}),Ot.Z.removeResizeBlock(Xt),this.removeBodyStickyResize(),Vt&&(document.body.classList.remove("sticky-desktop-right"),document.body.classList.remove("sticky-desktop")),this.adClosed=!0},this.handleMobileResize=()=>{const e=this.getCurrentOrientation()!==this.state.activeOrientation;Yt("handleMobileResize, isOrientationChanged =",e,"prevOrientation =",this.state.activeOrientation,"currentOrientation =",this.getCurrentOrientation(),"windowWidth =",window.innerWidth,"windowHeight = ",window.innerHeight),Kt({isOrientationChanged:e,currentOrientation:this.getCurrentOrientation(),activeOrientation:this.state.activeOrientation,event:"resize"}),(0,ue.JY)({forcedToHideRelatedAdv:this.forcedToHideRelatedAdv,minLandscapeHeight:this.minHeightToHideLandscapeAdv,minLandscapeWidth:this.isLandscapeSide?ue.rv:void 0,minPortraitHeight:this.minHeightToHidePortraitAdv})?this.hideAdv():this.state.advStickyBannerHidden&&this.initAdv()},Vt=!0;const{advBlocks:i,features:n,pageData:{appId:a,flags:r},placement:o,settings:d}=this.props,{adv:l,stickyAdvDisabledOnStart:c}=(0,ue.Lf)(d);if(this.isAdvStickyEnabledOnStartByExp=(0,ue.KV)({isDesktop:Vt,flags:r}),this.isIOS=(0,$e.AK)(this.context.platform).isIOS,this.isCatalogSticky="catalog"===o,this.isAdvStickyBannerEnabled=!(0,Pt.V)(r)&&(this.isAdvStickyEnabledOnStartByExp||(0,ue.uk)({adv:l,appId:a,isDesktop:Vt,flags:r,orientation:null==n?void 0:n.orientation})),l&&!this.isDisabledBySubscription()&&this.isAdvStickyBannerEnabled){if(this.minScreenWidthForDesktopAdv=null!=(s=(0,ge.$9)(r,we.Z.advStickyMinDesktopWidth))?s:this.minScreenWidthForDesktopAdv,this.deviceId=(0,Tt.V)(Nt.Je,this.context.location),this.advBlocks=i,this.headerSelector="minified"===e.headerType?".play-game-minified-header":".play-game-header",e.intervalBetweenRefreshAd&&(this.intervalBetweenRefreshAd=e.intervalBetweenRefreshAd),this.locations=(0,ue.jx)({adv:l,appId:a,flags:r,orientation:null==n?void 0:n.orientation}),Vt){const e=this.isAdvStickyEnabledOnStartByExp?_t.rq.RIGHT:this.locations.desktop;this.stickyBannerLocation={desktop:e,mobileLandscape:null,mobilePortrait:null}}else this.stickyBannerLocation={desktop:null,mobileLandscape:this.locations.mobileLandscape,mobilePortrait:this.locations.mobilePortrait};this.adClosed=c&&!this.isAdvStickyEnabledOnStartByExp}else this.isAdvStickyBannerEnabled=!1}sendToStickyMetrika(e,t){this.isCatalogSticky||(0,ue.YR)(e,t)}addBodyStickyReady(){this.isCatalogSticky||document.body.classList.add(P)}addBodyStickyIsGoogle(){this.isCatalogSticky||document.body.classList.add(R)}addBodyStickyResize(){this.isCatalogSticky||document.body.classList.add(C)}removeBodyStickyResize(){this.isCatalogSticky||document.body.classList.remove(C)}componentDidMount(){if(!this.isAdvStickyBannerEnabled||(0,Pt.V)(this.context.abt.flags))return this.handleCloseAdv(),void this.addBodyStickyReady();const{abt:{flags:e},allAdvBlocks:t,isGamesApp:s,isGamesLiteApp:i,withWorldWideAdv:n}=this.context,{features:a}=this.props;if(Vt){const{innerWidth:e,innerHeight:t,zoom:s}=(0,Bt.bY)();(0,ue.Ne)("canShowNewManager",{height:t,minScreenWidthForDesktopAdv:this.minScreenWidthForDesktopAdv,width:e,zoom:s})}else{n&&window.clientMetadata.isOnlyRsyaAd;0}Yt("componentDidMount",a,Vt),this.isCatalogSticky||(document.body.classList.add("sticky-inited"),this.removeDefaultClasses()),this.services=function({advBlocks:e,flags:t,isGamesApp:s,isGamesLiteApp:i,isPlayhop:n,withWorldWideAdv:a}){var r;const{isOnlyRsyaAd:o}=window.clientMetadata,d=a&&!o;if(i){let e=(0,ge.RM)(t,we.Z.advStickyBannerNative);if(void 0===e&&(e=d),e)return[he.e.Native]}else if(s)return[];if(n&&o)return[he.e.Yandex];if(d){const s=[];return void 0!==(0,It.Bw)(t)&&(null==(r=null==e?void 0:e.adsense)?void 0:r.sticky)?s.push(he.e.Adsense):s.push((0,ge.AZ)(t)?he.e.Prebid:he.e.Google),(0,ge.gk)(t)||s.push(he.e.Yandex),s}return[he.e.Yandex]}({advBlocks:t,flags:e,isGamesApp:s,isGamesLiteApp:i,isPlayhop:this.context.secondDomain===me.U.PLAYHOP,withWorldWideAdv:n}),this.services.includes(he.e.Native)?this.mainService=m.NATIVE:this.services.includes(he.e.Google)||this.services.includes(he.e.Prebid)?this.mainService=m.GOOGLE:this.services.includes(he.e.Adsense)?this.mainService=m.ADSENSE:this.mainService=m.YANDEX,this.services.includes(he.e.Adsense)&&(this.isAlternateLogs=!0),this.isGameFrameCanBeResizedInLandscape=Boolean(this.locations.mobileLandscape),this.isGameFrameCanBeResizedInPortrait=Boolean(this.locations.mobilePortrait);(this.mainService!==m.NATIVE||(0,kt.zg)(ue.XK))&&this.initParamsByViewport(),this.validateAdvSize(),Vt?this.addDesktopResize():this.resizeMobileGameBlock(),this.init()||this.removeDefaultClasses(),this.addBodyStickyReady()}componentDidUpdate(e,t){if(this.isAdvStickyBannerEnabled){if(t.advStickyBannerHidden!==this.state.advStickyBannerHidden&&At.Z.post({type:"sticky-manager",action:this.state.advStickyBannerHidden?"on-hide":"on-show"}),Vt&&e.isFullscreenActive!==this.props.isFullscreenActive&&this.handleFullscreenChange(),!t.advStickyBannerHidden&&this.state.advStickyBannerHidden||!t.isPageBlured&&this.state.isPageBlured){const e=this.getServiceFromAvailableServices(m.NATIVE);e&&e.updateAdvVisibility({isAdvVisible:!1})}if(t.advStickyBannerHidden&&!this.state.advStickyBannerHidden||t.isPageBlured&&!this.state.isPageBlured){const e=this.getServiceFromAvailableServices(m.NATIVE);e&&e.updateAdvVisibility({isAdvVisible:!0})}}}componentWillUnmount(){window.removeEventListener("resize",this.handleDesktopResize),window.removeEventListener("resize",this.handleMobileResize),document.removeEventListener("visibilitychange",this.handleVisibilityChange),this.resetRefreshTimer()}init(){var e,t;if(Yt("init"),!this.isAdvStickyBannerEnabled)return!1;const{isGamesLiteApp:s}=this.context,{settings:i}=this.props,{adv:n,stickyAdvDisabledOnStart:a}=(0,ue.Lf)(i);if(!n)return!1;const{desktop:r,mobilePortrait:o,mobileLandscape:d}=this.stickyBannerLocation;if((o||d)&&(this.isLandscapeSide=d===_t.Xn.LEFT||d===_t.Xn.RIGHT),this.initExperimentParams(),this.setAvailableServices(),Vt&&r){if(!(null==(t=null==(e=n.sticky)?void 0:e.desktop)?void 0:t.right)&&!this.isAdvStickyEnabledOnStartByExp)return;return a&&!this.isAdvStickyEnabledOnStartByExp||this.initAdv(),this.initMessaging(),document.addEventListener("visibilitychange",this.handleVisibilityChange),window.addEventListener("resize",this.handleDesktopResize),!0}return o||d?(a||this.initAdv(),this.mainService!==m.NATIVE&&(this.minHeightToHidePortraitAdv||this.minHeightToHideLandscapeAdv||this.mobileAdvSideLandscapeWidth)&&window.addEventListener("resize",this.handleMobileResize),Me.Z.addChangeListener((()=>{this.mainService!==m.NATIVE&&!this.state.advStickyBannerHidden&&this.state.canShowAdvStickyBanner&&this.resizeMobileGameBlock(),this.handleOrientationChange()})),this.initMessaging(),s||document.addEventListener("visibilitychange",this.handleVisibilityChange),!0):void 0}getClickdaemon(e){return this.clickDaemonAdvLog[e]||(this.clickDaemonAdvLog[e]=new Lt.i({tag:he.$.STICKY,app_id:this.props.pageData.appId})),this.clickDaemonAdvLog[e]}logAdvNoContent(e,t,s,i){this.isAlternateLogs||this.getClickdaemon(e).noContent(t,s,i)}logAdvResponse(e,t,s){this.isAlternateLogs||this.getClickdaemon(e).response({adReqId:s,reason:t})}logAdvError(e,t,s,i){this.isAlternateLogs||this.getClickdaemon(e).error(s,i,t)}logAdvTryOpen(e,t){return this.isAlternateLogs?this.adSeqId="":(this.adSeqId=this.getClickdaemon(e).tryOpen(t,this.getAdvProviderByServiceType(e)),this.getClickdaemon(e).demand(void 0,0,this.adSeqId),this.isFirstTryOpen&&(this.sendToStickyMetrika("isFirstTryOpen",!0),this.isFirstTryOpen=!1),this.adSeqId)}logAdvRequest(e,t){return this.isAlternateLogs?this.adReqId="":this.adReqId=this.getClickdaemon(e).request({advBlockId:t,advtype:this.getAdvProviderByServiceType(e),reason:ie.p_.ONSPOT}),this.adReqId}logAdvShow(e,t,s,i){this.isAlternateLogs||this.getClickdaemon(e).show(s,i,void 0,t?"refresh":void 0)}logAdvClose(e,t,s){this.isAlternateLogs||this.getClickdaemon(e).close(t,s)}logNoRequest(e,t,s){this.isAlternateLogs||this.getClickdaemon(e).errorNoRequest({adSeqId:this.adSeqId,provider:this.getAdvProviderByServiceType(e),advBlockId:t,error:s||"close without request"})}getAdvProviderByServiceType(e){switch(e){case m.ADSENSE:return he.e.Adsense;case m.GOOGLE:return this.isStickyPrebidEnabled?he.e.Prebid:he.e.Google;case m.NATIVE:return he.e.Native;default:return he.e.Yandex}}getServiceFromAvailableServices(e){return this.availableServices.find((t=>t.serviceType===e))}isEnabled(){var e,t;if(!this.isAdvStickyBannerEnabled)return;const{settings:s}=this.props,{adv:i}=(0,ue.Lf)(s);if(!i)return!1;if((0,Ct._G)())return!0;if((0,ge.Ww)(this.context.abt.flags,d.By.STICKY))return!1;if(Yt(`services = ${this.services}`),!this.services.length)return!1;const n=this.isDisabledBySubscription();if(Yt([`\nisAdDisabledBySubsciption = ${n}`,`settings.adv = ${JSON.stringify(null==s?void 0:s.adv,null,2)}`].join("\n")),n)return!1;const a=new URLSearchParams(this.props.search),r=(0,Dt.E)((0,Tt.V)("utm_medium")),o=(0,Tt.V)("clid")||(null==(e=window.YandexGamesSDK)?void 0:e.clid),l=(0,St.k4)(r,o);return Yt(`isAdDisabledByUtm = ${l},\n\n            params.clid = ${a.get("clid")},\n\n            window.YandexGamesSDK.clid = ${null==(t=window.YandexGamesSDK)?void 0:t.clid},\n\n            clid = ${o},\n\n            utmMedium = ${r}\n        `),!l}canShowAdv(){if((0,Ct._G)())return!0;if(!this.isEnabled())return!1;if(this.adClosed)return Yt("adClosed = true"),!1;if(Vt){if(this.props.isFullscreenActive)return Yt("Desktop on fullscreen mode"),(0,M.H)({block:$.W.ADV_STICKY,message:"AdvStickyBanner error: Desktop window on fullscreen mode",level:"info"}),!1;if((0,Bt.bY)().innerWidth<=this.minScreenWidthForDesktopAdv)return Yt("Desktop width too narrow"),(0,M.H)({block:$.W.ADV_STICKY,message:"AdvStickyBanner error: Desktop width too narrow",level:"info"}),!1}else if((0,ue.JY)({forcedToHideRelatedAdv:this.forcedToHideRelatedAdv,minLandscapeHeight:this.minHeightToHideLandscapeAdv,minLandscapeWidth:this.isLandscapeSide?ue.rv:void 0,minPortraitHeight:this.minHeightToHidePortraitAdv}))return Yt("shouldHideAdvBlock = true"),!1;return!0}get isFullscreenEnabled(){return Boolean(this.props.isFullscreenEnabled||xt.w.available||document[ft.Z.fullscreenEnabled])}addDesktopResize(){if(!this.stickyBannerLocation.desktop||!Vt||!this.canShowAdv())return;const e={width:-this.desktopAdvWidth};Ot.Z.addResizeBlock(Xt,{game:e,[`.${yt.Ek}`]:{width:-this.desktopAdvWidth-yt.UG},[this.headerSelector]:e}),this.addBodyStickyResize()}initContainerToDisplayAdv(){if(this.mainService!==m.NATIVE)return this.stickyBannerLocation.desktop?(this.removeDefaultClasses(),void this.addDesktopResize()):void this.resizeMobileGameBlock()}initMessaging(){At.Z.onAllMessages("adv-manager",this.onExternalMessage),At.Z.onInternalMessage("subscriptions",this.onSubscriptionsMessage,{withHistory:!0}),Vt&&(0,ge.bF)(this.context.abt.flags)&&At.Z.onInternalMessage("sticky-banner",this.onStickyBannerMessage)}initParamsByViewport(){var e;const{flags:t}=this.context.abt;if(Vt)return void(this.mainService===m.GOOGLE?(this.desktopAdvWidth=ue.q5,this.addBodyStickyIsGoogle()):(this.desktopAdvWidth=(0,Bt.bY)().innerWidth*ue.PV/100,this.mainService===m.ADSENSE&&(this.desktopAdvWidth=Math.max(this.desktopAdvWidth,z.K))));const s=null!=(e=(0,ge.$9)(t,we.Z.advStickyBannerMinHeightForHigherAd))?e:ue.Gh,i=this.isFullscreenEnabled?Math.max(window.screen.height,window.screen.width):Math.max((0,Bt.bY)().innerHeight,(0,Bt.bY)().innerWidth);Yt(`initParamsByViewport isFullscreenEnabled=${this.isFullscreenEnabled} portraitHeight=${i}`),i>=s&&(this.mobileAdvPortraitHeight=ue.RH,this.useHighPortraitBlockIds=!0)}initExperimentParams(){var e,t,s,i,n,a,r;const{flags:o}=this.context.abt;this.intervalBetweenRefreshAd=null!=(e=(0,ge.$9)(o,we.Z.advStickyBannerRefreshInterval))?e:this.intervalBetweenRefreshAd,this.minHeightToHidePortraitAdv=null!=(t=(0,ge.$9)(o,we.Z.advStickyBannerMinPortraitViewportHeight))?t:this.minHeightToHidePortraitAdv,this.minHeightToHideLandscapeAdv=null!=(s=(0,ge.$9)(o,we.Z.advStickyBannerMinLandscapeViewportHeight))?s:this.minHeightToHideLandscapeAdv,Vt?this.desktopAdvWidth=null!=(i=(0,ge.$9)(o,we.Z.advStickyBannerDesktopWidth))?i:this.desktopAdvWidth:(this.mobileAdvPortraitHeight=null!=(n=(0,ge.$9)(o,we.Z.advStickyBannerPortraitHeight))?n:this.mobileAdvPortraitHeight,this.mobileAdvLandscapeHeight=null!=(a=(0,ge.$9)(o,we.Z.advStickyBannerLandscapeHeight))?a:this.mobileAdvLandscapeHeight,this.mobileAdvSideLandscapeWidth=null!=(r=(0,ge.$9)(o,we.Z.advStickyBannerLandscapeWidth))?r:this.mobileAdvSideLandscapeWidth)}validateAdvSize(){this.desktopAdvWidth=Math.floor(Math.min(Math.max(this.desktopAdvWidth,ue.Ic),ue.q5)),ue.RH<this.mobileAdvPortraitHeight&&(this.mobileAdvPortraitHeight=ue.qi),ue.VT<this.mobileAdvLandscapeHeight&&(this.mobileAdvLandscapeHeight=ue.qi)}resizeMobileGameBlock(){if(this.mainService===m.NATIVE)return;if(!this.canShowAdv())return;if(this.stickyBannerLocation.desktop)return;const{mobilePortrait:e,mobileLandscape:t}=this.stickyBannerLocation,{isGameFrameCanBeResizedInPortrait:s,isGameFrameCanBeResizedInLandscape:i}=this;if(!s&&Me.Z.isPortrait||!i&&Me.Z.isLandscape)return Ot.Z.removeResizeBlock(Xt),this.removeDefaultClasses(),void this.removeBodyStickyResize();const n=this.isLandscapeSide?this.mobileAdvSideLandscapeWidth:this.mobileAdvLandscapeHeight,a=Me.Z.isPortrait?this.mobileAdvPortraitHeight:n;if(this.isLandscapeSide&&Me.Z.isLandscape){const e=t===_t.Xn.LEFT?-a-ue.gG:-a-2*ue.gG;return Ot.Z.addResizeBlock(Xt,{game:zt({width:e},t===_t.Xn.LEFT?{left:a+ue.gG}:{})}),this.removeDefaultClasses(),void this.addBodyStickyResize()}if(e===_t.Xn.UPPER&&Me.Z.isPortrait||t===_t.Xn.UPPER&&Me.Z.isLandscape){const e={top:a+ue.gG,height:-a-ue.gG};return Ot.Z.addResizeBlock(Xt,zt({game:e},Me.Z.isLandscape&&{[this.headerSelector]:e})),this.removeDefaultClasses(),void this.addBodyStickyResize()}if(e===_t.Xn.BOTTOM&&Me.Z.isPortrait||t===_t.Xn.BOTTOM&&Me.Z.isLandscape){const e={height:-a-2*ue.gG};return Ot.Z.addResizeBlock(Xt,{game:e,[this.headerSelector]:e}),this.removeDefaultClasses(),void this.addBodyStickyResize()}}isDisabledBySubscription(){return!!Boolean(this.props.login)&&this.props.isAdDisabledBySubscription}initAdv(){const e=this.canShowAdv();Kt({event:"init adv"}),Yt("initAdv","canShowAdv =",e),e&&!this.adClosed&&this.setState({advStickyBannerHidden:!1,canShowAdvStickyBanner:!0},(()=>{this.updateAvailableSpaceForBanners(),this.shouldRefreshBanners?this.syncRefreshAllBanners({clearBanners:!0}):(this.isAlternateLogs&&!this.clickDaemon&&(this.clickDaemon=new qe.U({app_id:this.context.playPageData.gameInfo.appId,tag:he.$.STICKY}),this.clickDaemon.tryOpen({provider:this.mainService,reason:ie.p_.ONSPOT})),this.fillBanners()),this.initContainerToDisplayAdv()}))}setHideState(e){this.setState({advStickyBannerHidden:e})}removeDefaultClasses(){var e;"function"==typeof(null==(e=Ot.Z)?void 0:e.removeDefaultClass)&&Ot.Z.removeDefaultClass(["sticky-desktop","sticky-mobile"])}getActiveOrientationSize(){return this.getActiveBannerOrientation()===v.VERTICAL?w.height:w.width}getActiveStickyLocation(){const{activeOrientation:e}=this.state;let t="desktop";return Vt||e!==bt.PORTRAIT?Vt||e!==bt.LANDSCAPE||(t="mobileLandscape"):t="mobilePortrait",this.stickyBannerLocation[t]}getStickyLocationByType(e){let t="desktop";return e===p.PORTRAIT?t="mobilePortrait":e===p.LANDSCAPE&&(t="mobileLandscape"),this.stickyBannerLocation[t]||"right"}getCurrentView(){return Vt?p.DESKTOP:Me.Z.isPortrait?p.PORTRAIT:p.LANDSCAPE}getContainerWidth(e){return e===p.DESKTOP?this.desktopAdvWidth:e===p.LANDSCAPE?this.isLandscapeSide?this.mobileAdvSideLandscapeWidth:"calc(100% + 32px)":0}getBannersStyles(e){return Vt?{width:this.getContainerWidth(e)}:{}}getHeaderOffset(){return this.state.isHeaderEnabled&&!this.props.hideAdvCloseButton?32:0}getContainerStyles(e){const t=this.getContainerWidth(e);return e===p.DESKTOP?{width:t}:e===p.PORTRAIT?{height:this.mobileAdvPortraitHeight,maxHeight:this.mobileAdvPortraitHeight}:e===p.LANDSCAPE?this.isLandscapeSide?{width:t}:{left:this.isCatalogSticky?0:-32,width:t}:{}}updateAvailableSpaceForBanners(){this.availableSpaceForBanners={width:window.innerWidth,height:window.innerHeight-this.getHeaderOffset()},Yt("updateAvailableSpaceForBanners",this.availableSpaceForBanners)}onServiceFailed(e){this.failedServices[e]=!0;const t=Object.values(this.failedServices).reduce(((e,t)=>t?e+1:e),0);this.availableServices.length===t&&this.handleCloseAdv()}onServiceLoaded(e){this.failedServices[e]=!1}setAvailableServices(){var e;const{context:t}=this,s={advBlocks:this.props.advBlocks,appId:this.props.pageData.appId,deviceId:this.deviceId,flags:t.abt.flags,isAlternateLogs:this.isAlternateLogs,lang:t.lang,metrikaCounter:null==(e=(0,o.getDomainConfig)().analytics.counters)?void 0:e.metrika,platform:t.platform,residenceInfo:this.props.pageData.residenceInfo,secondDomain:t.secondDomain,tld:t.tld,withWorldWideAdv:t.withWorldWideAdv,yaAdsScript:this.context.yaAdsScript},i=[];for(let e of this.services)switch(e){case he.e.Adsense:i.push(new ee(this,s));break;case he.e.Google:case he.e.Prebid:i.push(new be(this,s));break;case he.e.Yandex:i.push(new ct(this,s));break;case he.e.Native:i.push(new Ve(this,s,{onAdvShowed:()=>{this.removeDefaultClasses()}}));break;default:Yt("Unknown service",e)}this.availableServices=i}handleOrientationChange(){const e=this.state.activeOrientation,t=this.getActiveBannerOrientation();Yt("handleOrientationChange before, activeOrientation =",e,"activeBannerOrientation =",t,"availableSpaceForBanners =",this.availableSpaceForBanners,"windowWidth =",window.innerWidth,"windowHeight = ",window.innerHeight),this.resetRefreshTimer(),this.updateAvailableSpaceForBanners(),this.setState({activeOrientation:this.getCurrentOrientation()},(()=>this.afterOrientationChange()))}afterOrientationChange(){Yt("handleOrientationChange after, activeOrientation =",this.state.activeOrientation,"activeBannerOrientation =",this.getActiveBannerOrientation(),"availableSpaceForBanners =",this.availableSpaceForBanners,"windowWidth =",window.innerWidth,"windowHeight = ",window.innerHeight),Kt({event:"orientationChange",activeOrientation:this.state.activeOrientation}),this.timeoutAfterOrientationChange&&window.clearTimeout(this.timeoutAfterOrientationChange),this.timeoutAfterOrientationChange=window.setTimeout((()=>{this.updateAvailableSpaceForBanners(),this.canShowAdv()&&(this.banners.forEach((e=>{e.updateSlotSize(),Kt({banner:e,bannerNumber:e.getBannerNumber(),orientation:this.state.activeOrientation,event:"show after orientation change"})})),this.mainService!==m.YANDEX?this.syncRefreshAllBanners({clearBanners:!0}):this.syncRefreshAllBanners({onlyWithErrors:!0}),this.updateSpinner())}),this.isIOS?qt.WT/2:0)}getCurrentOrientation(){return Me.Z.isPortrait?bt.PORTRAIT:bt.LANDSCAPE}getActiveBannerOrientation(){const e=this.getActiveStickyLocation();return e?"right"===e||"left"===e?v.VERTICAL:v.HORIZONTAL:null}get banners(){const e=this.getActiveBannerOrientation();if(!e)return[];const{activeOrientation:t,banners:s}=this.state;return s[t][e]}getPortraitBanners(){const{portrait:e}=this.state.banners;return[...e.horizontal,...e.vertical]}getLandscapeBanners(){const{landscape:e}=this.state.banners;return[...e.horizontal,...e.vertical]}getActiveOrientationBanners(){return this.state.activeOrientation===bt.LANDSCAPE?this.getLandscapeBanners():this.getPortraitBanners()}showSpinner(){Yt("updateSpinner = show"),this.setState({showSpinner:!0})}hideSpinner(){Yt("updateSpinner = hide"),this.setState({showSpinner:!1})}fillBanners(e=0){if(this.isAdvHidden())return void Yt("cancel filling banners, adv is hidden");const t=this.getActiveBannerOrientation();if(!t)return void Yt("activeBannerOrientation = null");if(e>=this.availableServices.length)return void Yt("no more services for waterfall, serviceIndex =",e);const s=this.banners,i=[],n=this.getActiveOrientationSize();let a=this.availableSpaceForBanners[n];for(let e of s)Yt("fillBanners banner size =",e,a,e.getSize()[n]),a-=e.getSize()[n];const r=this.state.activeOrientation;if(Yt("fillBanners",s,r,"isScreenOrientationPortrait =",Me.Z.isPortrait,n,"availableOrientationSize =",a),Me.Z.isPortrait&&r!==bt.PORTRAIT)Yt("wait for orientation change");else{for(let o=e,d=s.length;o<this.availableServices.length;){if(s.length>=5){Yt("max banners");break}let l=this.availableServices[o];const{minBannerSize:c,maxBannerSize:h}=this.getAvailableSpaceForBanner(l.serviceType),u=!Vt&&t===v.VERTICAL&&this.getLandscapeBanners().some((e=>e.serviceType===m.GOOGLE));if(a<c||u&&l.serviceType===m.GOOGLE){Yt("no more space for banners! availableOrientationSize =",a,"requestingBanners"),this.tryToCallWaterfall(o);break}if(this.state.banners[r][t].filter((e=>e.serviceType===l.serviceType)).some((e=>e.hasError()))){Yt("banners of this service has already error, i =",o),this.tryToCallWaterfall(o);break}Yt("try get banner from service =",l,"availableOrientationSize =",a);const p=l.getBanner({bannerIndex:d,bannerOrientation:t,maxSize:{width:this.availableSpaceForBanners.width,height:this.availableSpaceForBanners.height,[n]:Math.min(h,a)},orientationSize:n,orientation:r,viewType:this.getCurrentView()});if(p){this.isAlternateLogs&&(this.clickDaemon.demand({advBlockId:p.getBlockId(),depth:o,provider:l.serviceType,reason:0===o?ie.p_.ONSPOT:ie.p_.WATERFALL}),p.setLogger(this.clickDaemon.copy()));const d=Qt++,c=p.getBannerId(),h=r;p.addEventListener("resize",(t=>{Yt("on banner resize",p,t);const{isFirstRequest:s,slotSize:i}=t.detail;this.startRefreshTimer(),this.updateSpinner(),Kt({banner:p,bannerNumber:d,event:"resize",slotSize:i}),this.sendToStickyMetrika("banner",{[this.state.activeOrientation]:{slotSize:`${null==i?void 0:i.width}:${null==i?void 0:i.height}`}}),s&&h===this.state.activeOrientation&&this.fillBanners(e)})),p.addEventListener("refresh",(e=>{Yt("on banner refresh",p),this.updateSpinner(),Kt({banner:p,bannerNumber:d,event:"refresh",availableSize:e.detail.availableSize})})),p.addEventListener("destroy",(()=>{this.updateSpinner();const e=this.state.banners[r][t].filter((e=>e.getBannerId()!==c));this.setState((s=>({banners:Gt(zt({},s.banners),{[r]:Gt(zt({},s.banners[r]),{[t]:e})})})))})),p.addEventListener("renderEnded",(()=>{this.updateSpinner()})),p.addEventListener("error",(e=>{Yt("on banner error",e,p),Kt({banner:p,bannerNumber:d,event:"error",error:e.detail.error}),this.startRefreshTimer(),e.detail.isFirstRequest&&h===this.state.activeOrientation&&this.tryToCallWaterfall(o),this.updateSpinner()})),Kt({banner:p,bannerNumber:d,event:"push banner",activeOrientation:r,availableOrientationSize:a,sizes:this.banners.map((e=>e.getSize()[n]))}),a-=p.getMaxSize()[n],s.push(p),i.push(p),p.setBannerNumber(d),Yt("push banner",p)}else o++,Yt("try get banner from next service");d++}this.setState((e=>({banners:Gt(zt({},e.banners),{[r]:Gt(zt({},e.banners[r]),{[t]:s})})})),(()=>{this.onBannersFilled(i)}))}}tryToCallWaterfall(e){const t=this.banners.filter((e=>!e.isFirstRequestEnded()));Yt("tryToCallWaterfall, requestingBanners.length =",t.length),0===t.length&&this.fillBanners(e+1)}updateSpinner(){Yt("updateSpinner",this.banners);if(this.banners.filter((e=>e.wasRendered()&&!e.isHidden())).length)return void this.hideSpinner();const e=this.banners.filter((e=>e.hasError()&&!e.isRequesting()));this.banners.length!==e.length?this.showSpinner():this.hideSpinner()}onBannersFilled(e){for(let t of this.availableServices){const s=e.filter((e=>e.serviceType===t.serviceType));t.onBannersFilled(s)}}startRefreshTimer(){this.refreshTimer||this.sendToStickyMetrika("startRefreshTimer",!0),this.resetRefreshTimer(),Yt("refreshTimer start"),this.refreshTimer=window.setTimeout((()=>{this.resetRefreshTimer(),this.sendToStickyMetrika("refreshTimerEnded",!0),this.state.advStickyBannerHidden?(this.shouldRefreshBanners=!0,Yt("shouldRefreshBanners = true")):(Yt("refresh all banners"),Kt({event:"refresh all"}),this.sendToStickyMetrika("refreshAfterTimerEnded",!0),this.syncRefreshAllBanners({clearBanners:!0}))}),this.intervalBetweenRefreshAd)}resetRefreshTimer(){Yt("refreshTimer reset"),this.refreshTimer&&(window.clearTimeout(this.refreshTimer),this.refreshTimer=null)}getAvailableSpaceForBanner(e){const t=this.getCurrentView(),s=this.getActiveOrientationSize(),i=s===w.width?"minWidth":"minHeight",n=s===w.width?"maxWidth":"maxHeight",a=b[t][e]||A;return{minBannerSize:a[i],maxBannerSize:a[n]}}canRefresh(){if(this.isOrientationAlreadyRefreshing())return Yt(`Refresh is already working for ${this.getCurrentOrientation()} orientation`),!1;const e=this.banners.filter((e=>!e.isFirstRequestEnded()));return!e.length||(Yt("Some banners is already requesting",e),!1)}isOrientationAlreadyRefreshing(){return!Vt&&this.refreshingOrientations[this.getCurrentOrientation()]}syncRefreshAllBanners(){return jt(this,arguments,(function*(e={}){if(Yt("syncRefreshAllBanners, params =",e),!this.canRefresh())return;e.clearBanners&&this.banners.forEach((e=>{e.clear(),e.hide()})),this.isAlternateLogs&&!e.onlyWithErrors&&(this.clickDaemon=new qe.U({app_id:this.context.playPageData.gameInfo.appId,tag:he.$.STICKY}),this.clickDaemon.tryOpen({provider:this.mainService,reason:ie.p_.REFRESH}));const t=this.getCurrentOrientation(),s=this.getActiveOrientationSize();this.shouldRefreshBanners=!1,this.refreshingOrientations[t]=!0;for(let e of this.availableServices){if(!e.onBannersRefresh)continue;const t=this.banners.filter((t=>t.serviceType===e.serviceType));yield e.onBannersRefresh(t)}for(let i of this.banners){if(t!==this.getCurrentOrientation())break;if(!i.hasError()&&e.onlyWithErrors)continue;if(this.failedServices[i.serviceType])continue;this.isAlternateLogs&&(this.clickDaemon.demand({advBlockId:i.getBlockId(),depth:0,provider:i.serviceType,reason:e.onlyWithErrors?ie.p_.WATERFALL:ie.p_.REFRESH}),i.setLogger(this.clickDaemon.copy()));const n=i.getSize()[s]+this.getEmptyAreaSize();Yt("syncRefreshAllBanners, availableSpace =",n,i);const{minBannerSize:a}=this.getAvailableSpaceForBanner(i.serviceType);if(n<a)Kt({banner:i,event:"cancel sync refresh"});else{i.setAvailableSize(n),Kt({banner:i,availableSpace:n,event:"sync refresh"});try{i.logTryOpen(),yield i.refresh()}catch(e){Yt(e)}}}Yt("syncRefreshAllBanners ended",t),t===this.getCurrentOrientation()&&(this.updateAvailableSpaceForBanners(),this.fillBanners(),this.destroyBannersOutOfWindow()),this.startRefreshTimer(),this.refreshingOrientations[t]=!1}))}destroyBannersOutOfWindow(){const e=this.banners,t=this.getActiveOrientationSize();let s=this.availableSpaceForBanners[t];Yt("destroyBannersOutOfWindow, initial availableOrientationSize =",s);for(let i of e){const e=i.getSize()[t];Yt("destroyBannersOutOfWindow, availableOrientationSize =",s,i);const{minBannerSize:n}=this.getAvailableSpaceForBanner(i.serviceType);s<=n&&i.wasRendered()&&!i.wasDestroyed()&&(Yt("destroy banner, not enough space to show"),i.destroy(),Kt({banner:i,event:"destroy banner out of window"})),s-=e}}isAdvHidden(){const{advStickyBannerHidden:e,isPageBlured:t}=this.state;return t||e||this.mainService===m.NATIVE}getEmptyAreaSize(){const e=this.banners,t=this.getActiveOrientationSize();let s=this.availableSpaceForBanners[t];for(let i of e)s-=i.getSize()[t];return Math.max(s,0)}renderStickyContainer(e,t){var s;const{showSpinner:i}=this.state,a=this.getStickyLocationByType(e),r=e===p.DESKTOP;return n().createElement("div",{className:Jt("inner",{"with-disable-ad-button":r&&!this.props.hideAdvCloseButton,[e]:!0,[a]:!0}),style:this.getContainerStyles(e)},r&&!this.props.hideAdvCloseButton&&(null==(s=this.props.wrapperRef)?void 0:s.current)&&(0,u.createPortal)(n().createElement("div",{className:Jt("disable-ad-button-wrapper"),style:{width:this.getContainerWidth(e)}},n().createElement(wt,null)),this.props.wrapperRef.current),n().createElement("div",{className:Jt("banners"),style:this.getBannersStyles(e)},t.map((e=>e.render()))),n().createElement(l.y,{className:Jt("spinner"),position:"center",size:28,spinning:i,view:"default"}))}renderContainers(){if(Vt)return this.renderStickyContainer(p.DESKTOP,this.getActiveOrientationBanners());const{stickyBannerLocation:{mobileLandscape:e,mobilePortrait:t}}=this;return n().createElement(n().Fragment,null,t&&this.renderStickyContainer(p.PORTRAIT,this.getPortraitBanners()),e&&this.renderStickyContainer(p.LANDSCAPE,this.getLandscapeBanners()))}render(){const e=this.isAdvStickyBannerEnabled&&this.state.canShowAdvStickyBanner;return!e&&this.isCatalogSticky?n().createElement("div",{className:Jt()}):e?n().createElement("div",{className:Jt({hidden:this.isAdvHidden()})},this.renderContainers()):null}}var ts=s(46211),ss=s(2820),is=Object.defineProperty,ns=Object.defineProperties,as=Object.getOwnPropertyDescriptors,rs=Object.getOwnPropertySymbols,os=Object.prototype.hasOwnProperty,ds=Object.prototype.propertyIsEnumerable,ls=(e,t,s)=>t in e?is(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;class cs extends ht.P{render(){const e=!(0,ss.Fg)(this.props.location.pathname),{advBlocks:t,features:s,pageData:i,settings:a}=e?{advBlocks:{sticky_mobile_landscape_bottom:"R-I-323671-27",sticky_mobile_bottom_wide:"R-I-323671-26",sticky_mobile_bottom:"R-I-323671-28",fullscreen:"",rewarded:""},features:{orientation:"none"},pageData:{appId:"",flags:this.context.abt.flags,residenceInfo:{EU:!1}},settings:{adv:{sticky:{mobile:{portrait:{upper:!1,bottom:!0},landscape:{right:!1,upper:!1,bottom:!0}},desktop:{right:!1}},sticky_adv_disabled_on_start:!1}}}:function(e){var t;const{playPageData:s,abt:i}=e,{advBlocks:n,features:a,settings:r}=s.gameSettings,o=null==(t=s.gameSettings.advInfo)?void 0:t.residence_info,{appId:d}=s.gameInfo;return{advBlocks:n,features:a,pageData:{appId:d,flags:i.flags,residenceInfo:o},settings:r}}(this.context);const r=this.context.allAdvBlocks;return n().createElement(es,((e,t)=>ns(e,as(t)))(((e,t)=>{for(var s in t||(t={}))os.call(t,s)&&ls(e,s,t[s]);if(rs)for(var s of rs(t))ds.call(t,s)&&ls(e,s,t[s]);return e})({},this.props),{advBlocks:t,allAdvBlocks:r,features:s,gptEmptyRefreshTimeout:qt.WT,headerType:this.props.headerType,hideAdvCloseButton:this.props.hideAdvCloseButton,pageData:i,placement:e?"catalog":"app",renderEndedBannerTimeout:qt.WT,search:this.props.location.search,settings:a}))}}const hs=(0,a.E)((0,r.$j)((function(e){return{isFullscreenActive:e.ui.isFullscreenActive,isAdDisabledBySubscription:(0,ts.Ak)(e),isFullscreenEnabled:e.ui.isFullscreenEnabled,login:e.userData.login}}))(cs));var us=s(65751),ps=s(45112);const vs=h().with("google-sticky-adv-banner"),ms=ue.P5.COLUMN,gs=({advLogger:e,block:t,blockType:s,hidden:a,location:r=_t.rq.RIGHT,withSpinner:o,width:d,provider:c,refreshCounter:h,onAdvShowed:u,onClose:p})=>{const v=B+s,m=(0,i.useRef)(void 0),g=(0,i.useMemo)((()=>null==e?void 0:e.copy({advBlockId:t.slotId})),[e,t.slotId]),[w,y]=(0,i.useState)(o),{maxHeight:f,minHeight:b}=(0,i.useMemo)((()=>s===_t.kq.DESKTOP?{minHeight:600}:{maxHeight:250}),[s]),A=(0,i.useMemo)((()=>{let e={maxWidth:d,width:d};return b&&(e.minHeight=b),(0,ue.oi)(e)}),[b,d]);(0,i.useEffect)((()=>()=>{m.current&&c&&c.destroySlot(m.current)}),[c]);const S=(0,i.useCallback)((()=>{return e=void 0,s=null,i=function*(){if(c&&g)try{m.current&&(yield c.destroySlot(m.current)),_(`Create slot for ${v}`),g.demand({advBlockId:t.slotId,depth:0,provider:he.e.Adsense}),m.current=yield c.createSlot({blockId:t.slotId,clientId:t.clientId,divId:v,height:b||250,maxHeight:f,width:d}),g.request();const{isEmpty:e,slot:s}=yield c.preloadSlot(m.current);if(e)return g.responseEmpty(),_(`#${v} empty.`),void p();g.response(),yield c.showSlot(s),g.show(),y(!1),u(),_(`Creative showed for ${v}`)}catch(e){_(`Failed to refresh ${v}`,e),p()}},new Promise(((t,n)=>{var a=e=>{try{o(i.next(e))}catch(e){n(e)}},r=e=>{try{o(i.throw(e))}catch(e){n(e)}},o=e=>e.done?t(e.value):Promise.resolve(e.value).then(a,r);o((i=i.apply(e,s)).next())}));var e,s,i}),[g,t,v,b,f,c,d,u,p]);return(0,i.useEffect)((()=>{!c||!g||h<0||S()}),[c,g,S,h]),n().createElement("div",{className:vs({desktop:!0,[`desktop_${r}`]:!0,direction:ms,hidden:a,"with-disable-ad-button":!0}),id:v,key:v,style:A},w&&n().createElement(l.y,{className:vs("spinner"),key:`${v}-spinner`,position:"center",size:28,spinning:!0,view:"default"}))};var ws=s(62011),ys=s(47802),fs=Object.defineProperty,bs=Object.defineProperties,As=Object.getOwnPropertyDescriptors,Ss=Object.getOwnPropertySymbols,ks=Object.prototype.hasOwnProperty,Es=Object.prototype.propertyIsEnumerable,Is=(e,t,s)=>t in e?fs(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,Rs=(e,t)=>{for(var s in t||(t={}))ks.call(t,s)&&Is(e,s,t[s]);if(Ss)for(var s of Ss(t))Es.call(t,s)&&Is(e,s,t[s]);return e},Ps=(e,t)=>bs(e,As(t));const Ts=h().with("google-sticky-adv-banner"),Cs=(0,ws.Z)((({advHidden:e,advLogger:t,blocks:s,canShowDesktopAdv:a,desktopAdvWidth:r,hideAdvCloseButton:o,innerHeight:d,provider:l,refreshCounter:c,stickyBannerLocation:{desktop:h},onAdvShowed:p,onClose:v,wrapperRef:m})=>{const[g,w]=(0,i.useState)(!(0,ys.Ij)()),y=d>=700;(0,i.useEffect)((()=>{const e=e=>{w("enabled"===e.data.action)};return At.Z.onInternalMessage("header",e),()=>{At.Z.offInternalMessage("header",e)}}),[]);const f=(0,i.useMemo)((()=>({marginTop:g&&!o?-ue.Mz:0,paddingTop:o?0:ue.Mz,width:r})),[r,g,o]),b=(0,i.useMemo)((()=>({marginTop:g?-ue.Mz:0,width:r})),[r,g]),A={advLogger:t,hidden:e||!a,location:h,provider:l,refreshCounter:c,width:r,onAdvShowed:p,onClose:v};return n().createElement("div",{className:Ts("desktop-wrapper",{hidden:e||!a,"with-disable-ad-button":!0}),style:f},!o&&(null==m?void 0:m.current)&&(0,u.createPortal)(n().createElement("div",{className:Ts("desktop-disable-ad-button-wrapper"),style:b},n().createElement(wt,null)),m.current),d>=500&&n().createElement(gs,Ps(Rs({},A),{block:s.desktop.main,blockType:_t.kq.DESKTOP,withSpinner:!0})),y&&n().createElement(gs,Ps(Rs({},A),{block:s.desktop.small,blockType:_t.kq.DESKTOP_ADDITIONAL,withSpinner:!1})))}),ht.Z,{blocks:e=>{var t;return null==(t=e.allAdvBlocks.adsense)?void 0:t.sticky}});var Ls=Object.defineProperty,Ds=Object.defineProperties,Os=Object.getOwnPropertyDescriptors,Bs=Object.getOwnPropertySymbols,xs=Object.prototype.hasOwnProperty,_s=Object.prototype.propertyIsEnumerable,Ns=(e,t,s)=>t in e?Ls(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;const qs=ue.P5.ROW,Ms=({advLogger:e,block:t,blockType:s,placement:a,hidden:r,height:o,location:d,provider:c,refreshCounter:h,withSpinner:u,onAdvShowed:p,onClose:v})=>{const m=a===ue.JK.Landscape,g=B+s,w=(0,i.useRef)(void 0),y=(0,i.useMemo)((()=>null==e?void 0:e.copy({advBlockId:t.slotId})),[e,t.slotId]),[f,b]=(0,i.useState)(u),A=(0,i.useMemo)((()=>{let e={};var t;return o&&(t=((e,t)=>{for(var s in t||(t={}))xs.call(t,s)&&Ns(e,s,t[s]);if(Bs)for(var s of Bs(t))_s.call(t,s)&&Ns(e,s,t[s]);return e})({},e),e=Ds(t,Os({height:o,minHeight:o}))),e}),[o]);(0,i.useEffect)((()=>()=>{w.current&&c&&c.destroySlot(w.current)}),[c]);const S=(0,i.useCallback)((()=>{return e=void 0,s=null,i=function*(){if(c&&y)try{w.current&&(yield c.destroySlot(w.current)),_(`Create slot for ${g}`),y.demand({advBlockId:t.slotId,depth:0,provider:he.e.Adsense}),w.current=yield c.createSlot({blockId:t.slotId,clientId:t.clientId,divId:g,height:o||250,maxHeight:o,width:"100%"}),y.request();const{isEmpty:e,slot:s}=yield c.preloadSlot(w.current);if(e)return y.responseEmpty(),_(`#${g} empty.`),void v();y.response(),yield c.showSlot(s),y.show(),b(!1),p(),_(`Creative showed for ${g}`)}catch(e){_(`Failed to refresh ${g}`,e),v()}},new Promise(((t,n)=>{var a=e=>{try{o(i.next(e))}catch(e){n(e)}},r=e=>{try{o(i.throw(e))}catch(e){n(e)}},o=e=>e.done?t(e.value):Promise.resolve(e.value).then(a,r);o((i=i.apply(e,s)).next())}));var e,s,i}),[y,t,g,o,c,p,v]);return(0,i.useEffect)((()=>{!c||!y||h<0||Me.Z.isLandscape&&a!==ue.JK.Landscape||Me.Z.isPortrait&&a!==ue.JK.Portrait||S()}),[c,y,S,h,a]),n().createElement("div",{className:x({[a]:!0,[`${a}_${d}`]:!0,direction:qs,border_round:!0,hidden:r}),id:g,key:g,style:A},!m&&n().createElement(l.y,{className:x("spinner",{hidden:!f}),key:`${g}-spinner`,position:"center",size:28,spinning:!0,view:"default"}))};var $s=Object.defineProperty,Fs=Object.defineProperties,Ws=Object.getOwnPropertyDescriptors,Zs=Object.getOwnPropertySymbols,Us=Object.prototype.hasOwnProperty,Hs=Object.prototype.propertyIsEnumerable,zs=(e,t,s)=>t in e?$s(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,Gs=(e,t)=>{for(var s in t||(t={}))Us.call(t,s)&&zs(e,s,t[s]);if(Zs)for(var s of Zs(t))Hs.call(t,s)&&zs(e,s,t[s]);return e},js=(e,t)=>Fs(e,Ws(t));(0,ws.Z)((({advHidden:e,advLogger:t,blocks:s,provider:a,canShowLandscapeAdv:r,canShowPortraitAdv:o,mobileAdvLandscapeHeight:d,mobileAdvPortraitHeight:c,mobileAdvSideLandscapeWidth:h,isLandscapeSide:u,refreshCounter:p,stickyBannerLocation:{mobileLandscape:v,mobilePortrait:m},onAdvShowed:g,onClose:w})=>{const y="undefined"!=typeof window&&Math.max(window.innerWidth,window.innerHeight)>=ue.kO,[f]=(0,i.useState)(!0),b=(0,i.useMemo)((()=>u?{width:h}:{height:`${d}px`,left:-ue.Mz,minWidth:`calc(100% + ${ue.Mz}px)`}),[u,d,h]),A=e||!r,S={advLogger:t,provider:a,refreshCounter:p,withSpinner:!0,onAdvShowed:g,onClose:w};return n().createElement(n().Fragment,null,m&&n().createElement(Ms,js(Gs({},S),{block:s.portrait,blockType:_t.kq.PORTRAIT,height:c,hidden:e||!o,location:m,placement:ue.JK.Portrait})),v&&n().createElement("div",{className:x("landscape-wrapper",{[null!=v?v:""]:!0}),style:b},n().createElement(l.y,{className:x("spinner",{hidden:!f}),key:"landscape-spinner",position:"center",size:28,spinning:!0,view:"default"}),u&&n().createElement(Ms,js(Gs({},S),{block:s.landscape,blockType:_t.kq.LANDSCAPE_SIDE,hidden:A,location:v,placement:ue.JK.Landscape})),!u&&n().createElement(n().Fragment,null,n().createElement(Ms,js(Gs({},S),{block:s.landscape,blockType:_t.kq.LANDSCAPE,height:d,hidden:A,location:v,placement:ue.JK.Landscape})),y&&n().createElement(Ms,js(Gs({},S),{block:s.landscape_additional,blockType:_t.kq.LANDSCAPE_TABLET_ADDITIONAL,height:d,hidden:A,location:v,placement:ue.JK.Landscape})),n().createElement(Ms,js(Gs({},S),{block:s.landscape_additional,blockType:_t.kq.LANDSCAPE_ADDITIONAL,height:d,hidden:A,location:v,placement:ue.JK.Landscape})))))}),ht.Z,{blocks:e=>{var t;return null==(t=e.allAdvBlocks.adsense)?void 0:t.sticky}});var Vs=s(99213),Ys=s(5825),Ks=s(93013),Xs=s(73171),Js=Object.defineProperty,Qs=Object.defineProperties,ei=Object.getOwnPropertyDescriptors,ti=Object.getOwnPropertySymbols,si=Object.prototype.hasOwnProperty,ii=Object.prototype.propertyIsEnumerable,ni=(e,t,s)=>t in e?Js(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,ai=(e,t)=>{for(var s in t||(t={}))si.call(t,s)&&ni(e,s,t[s]);if(ti)for(var s of ti(t))ii.call(t,s)&&ni(e,s,t[s]);return e},ri=(e,t)=>Qs(e,ei(t));const oi=({advHidden:e,appId:t,canShowDesktopAdv:s,canShowLandscapeAdv:a,canShowPortraitAdv:r,desktopAdvWidth:o,mobileAdvLandscapeHeight:d,mobileAdvSideLandscapeWidth:l,mobileAdvPortraitHeight:c,onClose:h,onAdvShowed:u,hideAdvCloseButton:p,stickyBannerLocation:v,intervalBetweenRefreshAd:m,isLandscapeSide:g,wrapperRef:w})=>{const y=(0,Ys.C)((e=>e.advGameCanBeLoaded)),[f,b]=(0,i.useState)(),[A,S]=(0,i.useState)("object"==typeof window?window.innerHeight:0),k=(0,i.useRef)(null),E=(0,Xs.D)(e),[I,R]=(0,i.useState)(-1),P=(0,i.useRef)(I),T=(0,i.useRef)(!1),C=(0,i.useRef)(!1);(0,i.useEffect)((()=>{P.current=I}),[I]),(0,i.useEffect)((()=>{const e=(0,Ks.D)((()=>{S(window.innerHeight)}),200);return window.addEventListener("resize",e,!0),()=>{window.removeEventListener("resize",e,!0)}}),[]);const L=(0,i.useCallback)((()=>{return e=void 0,t=null,s=function*(){try{b(yield(0,X.l)(J.oO.AdsenseResponsive)),_("Adsense script loaded.")}catch(e){(0,M.H)({block:$.W.GOOGLE_ADS,prefix:"AdvStickyBanner error [adsense]:",message:"script failed to load"}),h(),u()}},new Promise(((i,n)=>{var a=e=>{try{o(s.next(e))}catch(e){n(e)}},r=e=>{try{o(s.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,r);o((s=s.apply(e,t)).next())}));var e,t,s}),[h,u]);(0,i.useEffect)((()=>{y&&!f&&L()}),[y,f,L]);const D=(0,i.useCallback)((()=>{k.current=new qe.U({app_id:t,tag:he.$.STICKY}),k.current.tryOpen({provider:he.e.Adsense,reason:-1===P.current?ie.p_.ONSPOT:ie.p_.REFRESH}),R((e=>e+1)),T.current=!0,C.current=!1}),[t]),O=(0,i.useCallback)((()=>{C.current=!0,u()}),[u]),B=(0,i.useCallback)((e=>{if(C.current)return;let t;switch(e){case ue.JK.Landscape:t={onlyLandscape:!0};break;case ue.JK.Portrait:t={onlyPortrait:!0}}h(t)}),[h]);(0,Vs.b)(D,Boolean(f)),(0,i.useEffect)((()=>{T.current&&E&&!e&&D()}),[e,E,D]),(0,i.useEffect)((()=>{}),[f,e,v,D]),(0,ps.Yz)(D,!f||e?null:m);const x={advHidden:e,advLogger:k.current,provider:f,refreshCounter:I,stickyBannerLocation:v,onAdvShowed:O,onClose:B};return n().createElement(Cs,ri(ai({},x),{canShowDesktopAdv:s,desktopAdvWidth:o,hideAdvCloseButton:p,innerHeight:A,wrapperRef:w}))};var di=s(74762),li=Object.defineProperty,ci=Object.getOwnPropertySymbols,hi=Object.prototype.hasOwnProperty,ui=Object.prototype.propertyIsEnumerable,pi=(e,t,s)=>t in e?li(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,vi=(e,t,s)=>new Promise(((i,n)=>{var a=e=>{try{o(s.next(e))}catch(e){n(e)}},r=e=>{try{o(s.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,r);o((s=s.apply(e,t)).next())}));const mi=h().with("google-sticky-adv-banner"),gi=(0,O.M$)("GoogleStickyAdvBanner",O.XG.Adv),wi="AdvStickyBanner error [google]:",yi="google-adv-sticky-banner-",fi=500,bi=700,Ai=2*qt.WT,Si=!0;function ki(e,t){vt.Z.params({borrowParams:{adv:{sticky:{[e]:t}}}})}class Ei extends ht.P{constructor(){super(...arguments),this.clickLogger=new Lt.i({tag:he.$.STICKY,app_id:this.props.appId}),this.isAdditionalTabletLandscapeBlockEnabled="undefined"!=typeof window&&!1,this.allStickyGoogleAdvBlocks=this.context.allAdvBlocks.google.sticky,this.usePrebid=(0,ge.AZ)(this.context.abt.flags),this.useMultipleAuction=(0,ge.Ml)(this.context.abt.flags),this.prebidAdUnits=(0,ue.xZ)({stickyBlocks:this.allStickyGoogleAdvBlocks,flags:this.context.abt.flags,isPlayhop:this.context.secondDomain===me.U.PLAYHOP}),this.waitForAuction=null,this.advType=this.usePrebid?he.e.Prebid:he.e.Google,this.retries=(0,ge.ff)(this.context.abt.flags),this.hasBeenShownAtLeastOnce=!1,this.slots={desktop:{},landscape:{},portrait:{}},this.timeToLoadAdv=(0,ue.Qt)(this.context.abt.flags),this.landscapeStyles=((e,t)=>{for(var s in t||(t={}))hi.call(t,s)&&pi(e,s,t[s]);if(ci)for(var s of ci(t))ui.call(t,s)&&pi(e,s,t[s]);return e})({},this.props.isLandscapeSide?{width:this.props.mobileAdvSideLandscapeWidth}:{height:`${this.props.mobileAdvLandscapeHeight}px`,left:-ue.Mz,minWidth:`calc(100% + ${ue.Mz}px)`}),this.state={isHeaderEnabled:!(0,ys.Ij)(),showLandscapeSpinner:!0,showSpinner:!0,windowInnerHeight:"object"==typeof window?window.innerHeight:0},this.isFirstTryOpen=!0,this.onShow=e=>{const{slot:t}=e,{stickyPlacement:s,adReqId:i,adSeqId:n,clickDaemon:a}=t;if(!s)return;this.props.isAlternateLogs?null==a||a.show():this.clickLogger.show(i,n,t.getClickUrl(),undefined)},this.onSlotRenderEnded=e=>{const{slot:t}=e,{stickyPlacement:s,stickyBlockType:i,clickDaemon:n}=t;if(!s||!i)return;gi.spoiler(t.getAdUnitPath())("onSlotRenderEnded",i,`isEmpty = ${e.isEmpty}`),this.props.isAlternateLogs||this.clickLogger.response({adReqId:t.adReqId,depth:0,clickUrl:t.getClickUrl()||"",reason:t.getResponseInformation()?ie.Ud.SUCCESS:ie.Ud.EMPTY});const a=this.slots[s][i];if(clearTimeout(a.loadTimer),this.resetRefreshTimer(),e.isEmpty)return null==n||n.responseEmpty(),void this.onNoContent(t);null==n||n.response(),a.retries&&(a.retries=0),this.hasBeenShownAtLeastOnce=!0},this.resetRefreshTimer=()=>{gi("Reset refresh timer",Date.now()),this.refreshTimer||ki("startRefreshTimer",!0),clearTimeout(this.refreshTimer),this.refreshTimer=setTimeout((()=>{gi.spoiler("refresh timer executed"),ki("refreshTimerEnded",!0),clearTimeout(this.refreshTimer),this.refreshTimer=void 0,this.displaySlotsBatched(!0)}),this.props.intervalBetweenRefreshAd)},this.onSlotLoaded=({slot:e})=>{const{stickyPlacement:t,stickyBlockType:s}=e;if(!t||!s)return;gi.spoiler(e.getAdUnitPath())("onSlotLoaded",s);const i=this.slots[t][s];switch(i.loaded=!0,clearTimeout(i.loadTimer),t){case ue.JK.Desktop:this.setState({showSpinner:!1});break;case ue.JK.Landscape:this.setState({showLandscapeSpinner:!1});break;case ue.JK.Portrait:this.setState({showSpinner:!1})}},this.onSlotRequested=({slot:e})=>{const{stickyPlacement:t,stickyBlockType:s,clickDaemon:i}=e;if(!t||!s)return;gi.spoiler(e.getAdUnitPath())("onSlotRequested",s);const n=this.slots[t][s];clearTimeout(n.loadTimer),n.loadTimer=setTimeout((()=>{n.loaded||((0,M.H)({block:$.W.GOOGLE_ADS,prefix:wi,message:`${t} timeout error`}),this.props.isAlternateLogs?null==i||i.error(`${t} timeout error`):this.clickLogger.error(e.adReqId,e.adSeqId,`${t} timeout error`),this.resetRefreshTimer(),this.onClose(e))}),this.timeToLoadAdv)},this.onSlotResponseReceived=({slot:e})=>{const{stickyPlacement:t,stickyBlockType:s}=e;t&&s&&(gi.spoiler(e.getAdUnitPath())("onSlotResponseReceived",s),clearTimeout(this.slots[t][s].loadTimer))},this.prebidStartAuction=(0,di.P)((()=>vi(this,null,(function*(){null===this.waitForAuction&&(gi("[prebid_sticky] startAuction"),this.waitForAuction=new D.Z,yield(0,de.BA)((e=>{e.requestBids({adUnits:this.prebidAdUnits,bidsBackHandler:this.prebidAuctionHandler,timeout:le.ZV})})),this.prebidAuctionTimeout=setTimeout((()=>{gi("[prebid_sticky] No auction handled, call empty function."),this.prebidAuctionHandler()}),ue.kr))}))),le.kw),this.prebidAuctionHandler=(e,t)=>vi(this,null,(function*(){clearTimeout(this.prebidAuctionTimeout),gi("[prebid_sticky] prebidAuctionHandler",e),t&&(0,oe.fF)(new Error("[prebid_sticky] Auction finished with bidders timed out."));const s=(0,ue.Dr)(this.prebidAdUnits);(0,ce.H)({advTag:he.$.STICKY,adUnitCodes:s,bids:e}),yield(0,de.BA)((e=>{var t;e.setTargetingForGPTAsync(s),null==(t=this.waitForAuction)||t.resolve()}))})),this.onWindowResize=(0,Ks.D)((()=>{this.setState({windowInnerHeight:window.innerHeight})}),200),this.changeOrientationListener=()=>{if(this.props.advHidden)return;let e;if(Me.Z.isPortrait)e=ue.JK.Portrait;else{if(!Me.Z.isLandscape)return;e=ue.JK.Landscape}for(const{slot:t}of Object.values(this.slots[e])){if(!t)return;if(t.stickyBlockType===_t.kq.LANDSCAPE_TABLET_ADDITIONAL&&!this.isAdditionalTabletLandscapeBlockEnabled)return;this.tryShowAdv(t)}}}get slotsArray(){return Object.values(this.slots).map(Object.values).reduce(((e,t)=>e.concat(t)))}componentDidMount(){var e,t;this.setAdvBlocks(),this.setState({windowInnerHeight:window.innerHeight}),gi("blockIds = ",this.blockIds),window.addEventListener("resize",this.onWindowResize,!0);const{desktop:s}=this.props.stickyBannerLocation;s&&(this.desktopAdvMinHeight="number"==typeof(null==(t=null==(e=this.allStickyGoogleAdvBlocks.desktop.main.sizes)?void 0:e[0])?void 0:t[1])?this.allStickyGoogleAdvBlocks.desktop.main.sizes[0][1]:600),this.props.advGameCanBeLoaded&&this.loadScripts(),At.Z.onInternalMessage("header",(e=>{this.setState({isHeaderEnabled:"enabled"===e.data.action})}))}componentWillUnmount(){window.removeEventListener("resize",this.onWindowResize,!0),Me.Z.removeChangeListener(this.changeOrientationListener),clearTimeout(this.refreshTimer);const{googletag:e}=window;e&&(this.removeSlotsEventListeners(),this.slotsArray.forEach((t=>{clearTimeout(t.loadTimer),t.slot&&e.destroySlots([t.slot])})))}setAdvBlocks(){this.blockIds=this.allStickyGoogleAdvBlocks,this.props.useHighPortraitBlockIds&&this.allStickyGoogleAdvBlocks.portrait_high&&(this.blockIds.portrait=this.allStickyGoogleAdvBlocks.portrait_high)}addSlotsEventListeners(){var e;const t=null==(e=googletag.pubads)?void 0:e.call(googletag);t&&"function"==typeof t.addEventListener&&(t.addEventListener("slotRequested",this.onSlotRequested),t.addEventListener("slotResponseReceived",this.onSlotResponseReceived),t.addEventListener("slotOnload",this.onSlotLoaded),t.addEventListener("slotRenderEnded",this.onSlotRenderEnded),t.addEventListener("impressionViewable",this.onShow))}removeSlotsEventListeners(){var e;const t=null==(e=googletag.pubads)?void 0:e.call(googletag);t&&"function"==typeof t.removeEventListener&&(t.removeEventListener("slotRequested",this.onSlotRequested),t.removeEventListener("slotResponseReceived",this.onSlotResponseReceived),t.removeEventListener("slotOnload",this.onSlotLoaded),t.removeEventListener("slotRenderEnded",this.onSlotRenderEnded),t.removeEventListener("impressionViewable",this.onShow))}componentDidUpdate(e,t){var s,i;const{advGameCanBeLoaded:n,stickyBannerLocation:{desktop:a,mobilePortrait:r,mobileLandscape:o}}=this.props;if(e.advGameCanBeLoaded||!n||this.isScriptsLoaded||this.loadScripts(),e.isPageBlured||!this.props.isPageBlured)if(!e.isPageBlured||this.props.isPageBlured){if(this.isScriptsLoaded&&a&&t.windowInnerHeight!==this.state.windowInnerHeight&&((null==(s=this.slots.desktop.desktop)?void 0:s.slot)&&t.windowInnerHeight<fi&&this.state.windowInnerHeight>=fi&&this.tryShowAdv(this.slots.desktop.desktop.slot),(null==(i=this.slots.desktop.desktop_additional)?void 0:i.slot)&&t.windowInnerHeight<bi&&this.state.windowInnerHeight>=bi&&this.tryShowAdv(this.slots.desktop.desktop_additional.slot)),this.isScriptsLoaded&&e.advHidden&&!this.props.advHidden||!e.canShowPortraitAdv&&this.props.canShowPortraitAdv||!e.canShowLandscapeAdv&&this.props.canShowLandscapeAdv){if(a&&Object.values(this.slots.desktop).forEach((e=>{e.slot&&this.tryShowAdv(e.slot)})),r){const e=this.slots.portrait.portrait;(null==e?void 0:e.slot)&&!e.loaded&&this.tryShowAdv(e.slot)}o&&Object.values(this.slots.landscape).forEach((e=>{e.slot&&(e.slot.stickyBlockType!==_t.kq.LANDSCAPE_TABLET_ADDITIONAL||this.isAdditionalTabletLandscapeBlockEnabled)&&this.tryShowAdv(e.slot)}))}}else Object.values(this.slots.desktop).forEach((e=>{e.slot&&this.tryShowAdv(e.slot)}));else Object.values(this.slots.desktop).forEach((e=>{e.slot&&this.hideAdvSlot(e.slot)}))}onClose(e){const{stickyPlacement:t,stickyBlockType:s}=null!=e?e:{};switch(t&&s&&(this.slots[t][s].loaded=!1),this.props.isAlternateLogs&&this.clickDaemon.close(),t){case"desktop":return void this.props.onClose();case"portrait":return void this.props.onClose({onlyPortrait:!0});case"landscape":return void this.props.onClose({onlyLandscape:!0});default:this.props.onClose()}}onNoContent(e){var t;const{stickyPlacement:s,stickyBlockType:i,adReqId:n,adSeqId:a}=e;if(!s||!i)return;this.props.isAlternateLogs||this.clickLogger.noContent(n,a);const r=this.slots[s][i],o=null!=(t=r.retries)?t:0;if(o<this.retries)return gi.spoiler(e.getAdUnitPath())(`${o+1} of ${this.retries} retry to refresh slot ${i}`),r.retries=o+1,clearTimeout(r.loadTimer),void setTimeout((()=>{this.tryShowAdv(e)}),Ai);r.retries&&(r.retries=0),this.hasBeenShownAtLeastOnce||(gi.spoiler(e.getAdUnitPath())(`Hide slot ${i} due no content`),this.onClose(e))}initGPT(){return vi(this,null,(function*(){gi("initGPT"),yield(0,se.Vg)();try{const{googletag:e}=window;this.addSlotsEventListeners(),this.defineSlots(),e.enableServices(),Me.Z.addChangeListener(this.changeOrientationListener)}catch(e){(0,M.H)({message:"Trouble with getting google key values"},e)}}))}defineSlots(){const{stickyBannerLocation:{desktop:e,mobileLandscape:t,mobilePortrait:s},mobileAdvPortraitHeight:i,mobileAdvLandscapeHeight:n}=this.props;if(e)this.defineGPTSlot(this.blockIds.desktop.main.blockId,this.blockIds.desktop.main.sizes,ue.JK.Desktop,_t.kq.DESKTOP),this.defineGPTSlot(this.blockIds.desktop.small.blockId,this.blockIds.desktop.small.sizes,ue.JK.Desktop,_t.kq.DESKTOP_ADDITIONAL);else if(s&&this.defineGPTSlot(this.blockIds.portrait,[[320,i]],ue.JK.Portrait,_t.kq.PORTRAIT),t)switch(t){case _t.Xn.BOTTOM:case _t.Xn.UPPER:this.defineGPTSlot(this.blockIds.landscape,[[320,n]],ue.JK.Landscape,_t.kq.LANDSCAPE),this.defineGPTSlot(this.blockIds.landscape,[[320,n]],ue.JK.Landscape,_t.kq.LANDSCAPE_ADDITIONAL),this.isAdditionalTabletLandscapeBlockEnabled&&this.defineGPTSlot(this.blockIds.landscape,[[320,n]],ue.JK.Landscape,_t.kq.LANDSCAPE_TABLET_ADDITIONAL);break;case _t.Xn.RIGHT:case _t.Xn.LEFT:this.defineGPTSlot(this.blockIds.landscape,["fluid"],ue.JK.Landscape,_t.kq.LANDSCAPE_SIDE)}}defineGPTSlot(e,t,s,i){var n;const{googletag:a}=window;gi.spoiler(e,s,i)("defineAndDisplayGPTSlot",`isErrorOnDisplaySlots = ${!a.pubads||!a.defineSlot}`);const r=null==(n=a.defineSlot(e,t,yi+i))?void 0:n.addService(a.pubads());r?(r.stickyPlacement=s,r.stickyBlockType=i,this.slots[s][i]={loaded:!1,retries:0,slot:r}):((0,M.H)({block:$.W.GOOGLE_ADS,prefix:wi,message:"googletag couldn't create gptSlot"}),this.onClose())}displaySlotsBatched(e){return vi(this,null,(function*(){var t;const s=[];this.props.isAlternateLogs&&(this.clickDaemon=new qe.U({app_id:this.props.appId,tag:he.$.STICKY}),this.clickDaemon.tryOpen({provider:he.e.Google,reason:e?ie.p_.REFRESH:ie.p_.ONSPOT})),this.slotsArray.forEach((e=>{e.slot&&(this.tryShowAdv(e.slot,!0),e.isBatched&&(e.isBatched=!1,s.push(e.slot)))})),this.usePrebid&&(yield this.prebidStartAuction(),yield null==(t=this.waitForAuction)?void 0:t.promise),googletag.pubads().refresh(s),this.usePrebid&&this.useMultipleAuction&&(this.waitForAuction=null)}))}loadScripts(){var e;if(gi("loadScripts isLoaded=",this.isScriptsLoaded),this.isScriptsLoaded)return;this.props.isAlternateLogs&&(this.clickDaemon=new qe.U({app_id:this.props.appId,tag:he.$.STICKY}));const t=(0,te.D)(se.CX).then((()=>{throw new Error(`Scripts load timeout (${se.CX}ms)`)})),s=(0,de.cQ)({cdnUrl:this.context.cdnUrl,flags:this.context.abt.flags,fullUrl:window.location.href,options:{isSlowCountry:this.context.isSlowCountry}}),i=(0,se.xq)({metrikaCounter:null==(e=(0,o.getDomainConfig)().analytics.counters)?void 0:e.metrika,parallel:(0,ge.RM)(this.context.abt.flags,we.Z.prebidLoadAfterGpt)||!1,prebidScriptUrl:this.usePrebid?s:void 0});Promise.race([t,i]).then((e=>vi(this,null,(function*(){var t;if(gi("onScriptsLoaded: true"),e.prebid||(this.usePrebid=!1,null==(t=this.waitForAuction)||t.resolve()),e.gptError)throw e.gptError;this.isScriptsLoaded=!0,yield this.initGPT(),this.usePrebid&&(yield this.initPrebid()),yield this.displaySlotsBatched(!1)})))).catch((e=>{this.onScriptsLoadError(e)}))}onScriptsLoadError(e){gi("onScriptsLoadError",e),(0,M.H)({block:$.W.GOOGLE_ADS,prefix:wi,message:"script failed to load"}),this.onClose(),this.props.onAdvShowed()}initPrebid(){return vi(this,null,(function*(){gi("[prebid_sticky] initPrebid"),yield(0,de.OH)(),yield(0,de.BA)((e=>vi(this,null,(function*(){return e.addAdUnits(this.prebidAdUnits)}))))}))}showAdv(e,t=!1){const{googletag:s}=window,{stickyPlacement:i,stickyBlockType:n,adReqId:a}=e;if(!i||!n)return;gi("showAdv",n);const r=this.slots[i][n];if(!r.retries){if(this.props.isAlternateLogs){const{stickyPlacement:t,stickyBlockType:s}=e,i=t&&s&&this.slots[t][s].loaded;this.clickDaemon.demand({advBlockId:e.getAdUnitPath(),depth:0,provider:he.e.Google,reason:i?ie.p_.REFRESH:ie.p_.ONSPOT})}else e.adSeqId=this.clickLogger.tryOpen(e.getAdUnitPath(),this.advType),this.clickLogger.demand(void 0,0,e.adSeqId);this.isFirstTryOpen&&(ki("isFirstTryOpen",!0),this.isFirstTryOpen=!1)}this.props.isAlternateLogs?(e.clickDaemon=this.clickDaemon.copy(),e.clickDaemon.request()):e.adReqId=this.clickLogger.request({advtype:this.advType,advBlockId:e.getAdUnitPath(),depth:0,reason:ie.p_.ONSPOT,prevReqId:a}),t?r.isBatched=!0:s.pubads().refresh([e]),this.props.onAdvShowed()}tryShowAdv(e,t=!1){const{advHidden:s,canShowDesktopAdv:i,canShowPortraitAdv:n,canShowLandscapeAdv:a}=this.props,{stickyPlacement:r,stickyBlockType:o}=e;if(r&&o)switch(gi("tryShowAdv",o),o){case _t.kq.DESKTOP:i&&!s&&this.state.windowInnerHeight>=fi&&this.showAdv(e,t);break;case _t.kq.DESKTOP_ADDITIONAL:i&&!s&&this.state.windowInnerHeight>=bi&&this.showAdv(e,t);break;case _t.kq.PORTRAIT:n&&!s&&Me.Z.isPortrait&&this.showAdv(e,t);break;case _t.kq.LANDSCAPE_SIDE:case _t.kq.LANDSCAPE:case _t.kq.LANDSCAPE_ADDITIONAL:a&&!s&&Me.Z.isLandscape&&this.showAdv(e,t);break;case _t.kq.LANDSCAPE_TABLET_ADDITIONAL:this.isAdditionalTabletLandscapeBlockEnabled&&a&&!s&&Me.Z.isLandscape&&this.showAdv(e,t)}}hideAdvSlot(e){gi("hideAdvSlot"),googletag.pubads().clear([e])}renderBanner(e,t,s,i,a){const{showSpinner:r}=this.state,o=yi+t,d=e===ue.JK.Desktop,c=e===ue.JK.Landscape,h=d?ue.P5.COLUMN:ue.P5.ROW,u=(0,ue.oi)(i,a),p=this.props.advHidden||t===_t.kq.PORTRAIT&&!this.props.canShowPortraitAdv||c&&!this.props.canShowLandscapeAdv||d&&!this.props.canShowDesktopAdv;return n().createElement("div",{className:mi({[e]:!0,[`${e}_${s}`]:!0,direction:h,border_round:!d,hidden:p,"with-disable-ad-button":Si}),id:o,key:o,style:u},!c&&t!==_t.kq.DESKTOP_ADDITIONAL&&n().createElement(l.y,{className:mi("spinner",{hidden:!r}),key:`${o}-spinner`,position:"center",size:28,spinning:!0,view:"default"}))}render(){var e;const{advHidden:t,canShowDesktopAdv:s,hideAdvCloseButton:i,desktopAdvWidth:a,isLandscapeSide:r,mobileAdvLandscapeHeight:o,mobileAdvSideLandscapeWidth:d,mobileAdvPortraitHeight:c,stickyBannerLocation:{desktop:h,mobileLandscape:p,mobilePortrait:v}}=this.props,{isHeaderEnabled:m,showLandscapeSpinner:g,windowInnerHeight:w}=this.state;if(h){const r={marginTop:m&&!i?-ue.Mz:0,paddingTop:i?0:ue.Mz,width:a},o={width:a,marginTop:m?-ue.Mz:0};return n().createElement("div",{className:mi("desktop-wrapper",{hidden:t||!s,"with-disable-ad-button":Si}),style:r},!this.props.hideAdvCloseButton&&(null==(e=this.props.wrapperRef)?void 0:e.current)&&(0,u.createPortal)(n().createElement("div",{className:mi("desktop-disable-ad-button-wrapper"),style:o},n().createElement(wt,null)),this.props.wrapperRef.current),w>=fi&&this.renderBanner(ue.JK.Desktop,_t.kq.DESKTOP,h,{maxWidth:a,width:a,minHeight:this.desktopAdvMinHeight}),w>=bi&&this.renderBanner(ue.JK.Desktop,_t.kq.DESKTOP_ADDITIONAL,h,{maxWidth:a,width:a}))}const y=(0,ue.Z4)("landscape",this.isAdditionalTabletLandscapeBlockEnabled);return n().createElement(n().Fragment,null,v&&this.renderBanner(ue.JK.Portrait,_t.kq.PORTRAIT,v,{height:c,maxHeight:c}),p&&n().createElement("div",{className:mi("landscape-wrapper",{[p]:!0,"with-disable-ad-button":Si}),style:this.landscapeStyles},n().createElement(l.y,{className:mi("spinner",{hidden:!g}),key:"landscape-spinner",position:"center",size:28,spinning:!0,view:"default"}),r&&this.renderBanner(ue.JK.Landscape,_t.kq.LANDSCAPE_SIDE,p,{width:d}),!r&&this.renderBanner(ue.JK.Landscape,_t.kq.LANDSCAPE,p,{height:o,maxHeight:o,minWidth:y}),!r&&this.isAdditionalTabletLandscapeBlockEnabled&&this.renderBanner(ue.JK.Landscape,_t.kq.LANDSCAPE_TABLET_ADDITIONAL,p,{height:o,maxHeight:o,minWidth:y}),!r&&this.renderBanner(ue.JK.Landscape,_t.kq.LANDSCAPE_ADDITIONAL,p,{height:o,maxHeight:o,minWidth:y})))}}const Ii=(0,r.$j)((function(e){return{advGameCanBeLoaded:e.advGameCanBeLoaded}}))(Ei),Ri=new Set;var Pi=Object.defineProperty,Ti=Object.getOwnPropertySymbols,Ci=Object.prototype.hasOwnProperty,Li=Object.prototype.propertyIsEnumerable,Di=(e,t,s)=>t in e?Pi(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,Oi=(e,t)=>{for(var s in t||(t={}))Ci.call(t,s)&&Di(e,s,t[s]);if(Ti)for(var s of Ti(t))Li.call(t,s)&&Di(e,s,t[s]);return e},Bi=(e,t,s)=>new Promise(((i,n)=>{var a=e=>{try{o(s.next(e))}catch(e){n(e)}},r=e=>{try{o(s.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,r);o((s=s.apply(e,t)).next())}));const xi=(0,O.M$)("NativeStickyAdvBanner",O.XG.Adv);class _i extends ht.P{constructor(e,t){var s;super(e),this.isAdvHidden=n().createRef(),this.adReqIds={portrait:"",landscape:""},this.adSeqIds={portrait:"",landscape:""},this.refreshTimeoutIds={landscape:0,portrait:0},this.isAdNeedToRefresh={portrait:!1,landscape:!1},this.advHeight={portrait:ue.qi,landscape:ue.qi},this.revenueData={app_id:this.props.appId},this.revenueDataAsString="",this.clickLogger=new Lt.i({tag:he.$.STICKY,app_id:this.props.appId}),this.changeOrientationListener=()=>Bi(this,null,(function*(){const e=Me.Z.isPortrait?"portrait":"landscape";if(xi(`changeOrientationListener isAdNeedToRefresh${e}=${this.isAdNeedToRefresh[e]}`),this.isAdNeedToRefresh[e])return void this.updateAdv(e);if(!this.nativeStickyApi.isActionAvailable("stickyBannerIsShowing"))return;const t=yield this.nativeStickyApi.stickyBannerIsShowing();xi(`changeOrientationListener isAdvShowing=${t} advHidden=${this.isAdvHidden.current}`),t||this.isAdvHidden.current||this.openNativeAdvBanner(e)})),this.blockIds=(0,ue.AO)({advBlocks:t.playPageData.gameSettings.advBlocks,flags:t.abt.flags,residenceInfo:null==(s=t.playPageData.gameSettings.advInfo)?void 0:s.residence_info,withWorldWideAdv:t.withWorldWideAdv,locations:this.props.stickyBannerLocation,useHighPortraitBlockIds:this.props.useHighPortraitBlockIds});const{isIOS:i}=(0,$e.AK)(t.platform);this.nativeStickyApi=xe(i),this.library=(0,ue.dF)(t.abt.flags);const a=(0,_e.X)(),r=(0,Ne.W5)(),o=Oi(Oi({},a?{clid:a}:{}),r?{gclid:r}:{});Object.assign(this.revenueData,o),this.revenueDataAsString=JSON.stringify(this.revenueData),this.advHeight={portrait:e.mobileAdvPortraitHeight,landscape:e.isLandscapeSide?e.mobileAdvSideLandscapeWidth:e.mobileAdvLandscapeHeight}}componentDidUpdate(e){e.advHidden&&!this.props.advHidden&&this.tryShowAdv(),!e.advHidden&&this.props.advHidden&&this.hideAdv(),this.isAdvHidden.current=this.props.advHidden}componentWillUnmount(){Me.Z.removeChangeListener(this.changeOrientationListener),window.clearTimeout(this.refreshTimeoutIds.landscape),window.clearTimeout(this.refreshTimeoutIds.portrait),this.onClose(!1)}tryShowAdv(){return Bi(this,null,(function*(){if(this.clickDaemon=new qe.U({tag:he.$.STICKY,app_id:this.props.appId}),!this.nativeStickyApi.isActionAvailable("stickyBannerIsShowing"))return xi("tryShowAdv","ads.stickyBannerIsShowing is not a function"),void this.onClose();const e=yield this.nativeStickyApi.stickyBannerIsShowing();if(this.props.onAdvShowed(),e)return void xi("tryShowAdv","adv is showing");const{mobilePortrait:t,mobileLandscape:s}=this.props.stickyBannerLocation;this.props.isAlternateLogs&&this.clickDaemon.tryOpen({provider:he.e.Native,reason:ie.p_.ONSPOT}),t&&Me.Z.isPortrait?(this.props.isAlternateLogs?this.clickDaemon.demand({advBlockId:this.blockIds.portrait}):(this.adSeqIds.portrait=this.clickLogger.tryOpen(this.blockIds.portrait,he.e.Native),this.clickLogger.demand(void 0,0,this.adSeqIds.portrait)),this.openNativeAdvBanner("portrait")):s&&Me.Z.isLandscape&&(this.props.isAlternateLogs?this.clickDaemon.demand({advBlockId:this.blockIds.landscape}):(this.adSeqIds.landscape=this.clickLogger.tryOpen(this.blockIds.landscape,he.e.Native),this.clickLogger.demand(void 0,0,this.adSeqIds.landscape)),this.openNativeAdvBanner("landscape"))}))}componentDidMount(){return Bi(this,null,(function*(){xi(`blockIds = ${JSON.stringify(this.blockIds)}\n\n            revenueData=${this.revenueDataAsString}\n        `),yield this.tryShowAdv(),Me.Z.addChangeListener(this.changeOrientationListener)}))}hideAdv(){this.nativeStickyApi.isActionAvailable("hideStickyBanner")?(this.nativeStickyApi.hideStickyBanner(),this.props.onAdvShowed()):xi("hideAdv","ads.hideStickyBanner is undefined")}onClose(e=!0){this.props.isAlternateLogs&&e&&this.clickDaemon.close(),this.props.isAlternateLogs||(this.adReqIds.portrait&&this.clickLogger.close(this.adReqIds.portrait,this.adSeqIds.portrait),this.adReqIds.landscape&&this.clickLogger.close(this.adReqIds.landscape,this.adSeqIds.landscape)),this.hideAdv(),this.props.onClose()}openNativeAdvBanner(e){if(!this.nativeStickyApi.isActionAvailable("showStickyBanner"))return xi("openNativeAdvBanner","ads.showStickyBanner is undefined"),void this.onClose();const{stickyBannerLocation:{mobilePortrait:t,mobileLandscape:s}}=this.props,i="portrait"===e?t:s;if(!i)return void xi("openNativeAdvBanner","ad position is a null");const n=function(e,t){return"upper"===t?t="bottom":"left"===t&&(t="right"),`${e}-${t}`}(e,i);if(Ri.has(n))return xi("openNativeAdvBanner","The previous show ended with an error"),void this.onClose();this.props.isAlternateLogs?this.clickDaemon.request({advBlockId:this.blockIds[e],reason:ie.p_.ONSPOT}):this.adReqIds[e]=this.logRequest(e),this.nativeStickyApi.showStickyBanner({blockId:this.blockIds[e],mediation:this.library,position:i,orientation:e,dimension:this.advHeight[e],revenueData:{revenueData:this.revenueDataAsString}}).then((()=>{Ri.delete(n),this.props.isAlternateLogs?(this.clickDaemon.response(),this.clickDaemon.show()):(this.logResponse(e,ie.Ud.SUCCESS),this.clickLogger.show(this.adReqIds[e],this.adSeqIds[e],void 0)),this.isAdNeedToRefresh[e]=!1,this.runUpdateAdvTimeout(e)})).catch((t=>{var s;Ri.add(n),this.props.isAlternateLogs?this.clickDaemon.error(null!=(s=t.message)?s:String(t)):this.logResponse(e,ie.Ud.ERROR),xi(t),this.onClose()}))}runUpdateAdvTimeout(e){const t=Me.Z.isPortrait?"portrait":"landscape";this.refreshTimeoutIds[e]=window.setTimeout((()=>{e===t?this.updateAdv(e):this.isAdNeedToRefresh[e]=!0}),this.props.intervalBetweenRefreshAd)}updateAdv(e){this.nativeStickyApi.isActionAvailable("refreshStickyBanner")?(this.props.isAlternateLogs?(this.clickDaemon=new qe.U({tag:he.$.STICKY,app_id:this.props.appId}),this.clickDaemon.tryOpen({provider:he.e.Native,reason:ie.p_.REFRESH}),this.clickDaemon.demand({advBlockId:this.blockIds[e]}),this.clickDaemon.request()):(this.adSeqIds[e]=this.clickLogger.tryOpen(this.blockIds[e],he.e.Native),this.clickLogger.demand(void 0,0,this.adSeqIds[e]),this.adReqIds[e]=this.logRequest(e)),this.nativeStickyApi.refreshStickyBanner().then((()=>{this.props.isAlternateLogs?(this.clickDaemon.response(),this.clickDaemon.show()):(this.logResponse(e,ie.Ud.SUCCESS),this.clickLogger.show(this.adReqIds[e],this.adSeqIds[e],void 0)),window.clearTimeout(this.refreshTimeoutIds[e]),this.isAdNeedToRefresh[e]=!1,this.runUpdateAdvTimeout(e)})).catch((t=>{var s;this.props.isAlternateLogs?this.clickDaemon.error(null!=(s=t.message)?s:String(t)):this.logResponse(e,ie.Ud.ERROR),xi(t),this.onClose()}))):xi("updateAdv","ads.refreshAdvert is undefined")}logResponse(e,t){this.clickLogger.response({adReqId:this.adReqIds[e],reason:t})}logRequest(e){const t={advtype:he.e.Native,advBlockId:this.blockIds[e],depth:0,reason:ie.p_.ONSPOT};return this.clickLogger.request(t)}render(){return null}}var Ni=s(38508),qi=Object.defineProperty,Mi=Object.defineProperties,$i=Object.getOwnPropertyDescriptors,Fi=Object.getOwnPropertySymbols,Wi=Object.prototype.hasOwnProperty,Zi=Object.prototype.propertyIsEnumerable,Ui=(e,t,s)=>t in e?qi(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,Hi=(e,t)=>{for(var s in t||(t={}))Wi.call(t,s)&&Ui(e,s,t[s]);if(Fi)for(var s of Fi(t))Zi.call(t,s)&&Ui(e,s,t[s]);return e};const zi=!0,Gi=h().with("yandex-sticky-adv-banner"),ji=(0,O.M$)("YandexStickyAdvBanner",O.XG.Adv);class Vi extends ht.P{constructor(){super(...arguments),this.gameBlockIds=(0,ue.V0)({advBlocks:this.context.playPageData.gameSettings.advBlocks,appId:this.props.appId,flags:this.context.abt.flags,locations:this.props.stickyBannerLocation,useHighPortraitBlockIds:this.props.useHighPortraitBlockIds}),this.blockIds={desktop:"",desktop_additional:"",portrait:"",portrait_high:"",landscape:"",landscape_additional:""},this.containerIds={portrait:"yandex-adv-sticky-banner-portrait",portrait_high:"yandex-adv-sticky-banner-portrait",landscape:"yandex-adv-sticky-banner-landscape",landscape_additional:"yandex-adv-sticky-banner-landscape_additional",desktop:"yandex-adv-sticky-banner-desktop",desktop_additional:"yandex-adv-sticky-banner-desktop_additional"},this.useWhiteBackgroundOnDesktop=Boolean((0,ge.pJ)(this.context.abt.flags)&&this.props.stickyBannerLocation.desktop),this.additionalLandscapeBlockEnabled=(0,ge.Vr)(this.context.abt.flags)&&this.props.stickyBannerLocation.mobileLandscape!==_t.Xn.RIGHT,this.timeToLoadAdv=(0,ue.Qt)(this.context.abt.flags),this.clickDaemonAdvLog=new Lt.i({tag:he.$.STICKY,app_id:this.props.appId}),this.clickDaemon=new qe.U({app_id:this.props.appId,tag:he.$.STICKY}),this.loadedFlags={isDesktopAdvLoaded:!1,isLandscapeAdvLoaded:!1,isPortraitAdvLoaded:!1,isRefreshAdv:!1,isRefreshLandscapeAdv:!1},this.hasBeenShownAtLeastOnce=!1,this.scriptLoadPromiseWrapper=new D.Z,this.landscapeWrapperStyles=this.props.isLandscapeSide?{}:{left:-ue.Mz,width:`calc(100% + ${ue.Mz}px)`},this.landscapeBlockStyles=this.props.isLandscapeSide?{width:this.props.mobileAdvSideLandscapeWidth}:{height:this.props.mobileAdvLandscapeHeight,maxHeight:this.props.mobileAdvLandscapeHeight},this.state={isAdditionalLandscapeMediaAdType:!1,isHeaderEnabled:!(0,ys.Ij)(),isLandscapeMediaAdType:!1,isPortraitMediaAdType:!1,showDesktopAdditional:!1,showLandscapeAdditional:!1,showSpinner:!0},this.initAdvStickyBlocks=()=>{const{stickyBannerLocation:{desktop:e,mobileLandscape:t,mobilePortrait:s}}=this.props;if(e)return this.desktopAdvOptions=this.getAdvOptions(_t.kq.DESKTOP,this.blockIds[_t.kq.DESKTOP]),this.desktopAdditionalAdvOptions=this.getAdvOptions(_t.kq.DESKTOP_ADDITIONAL,this.blockIds[_t.kq.DESKTOP_ADDITIONAL]),void this.showAdv(_t.kq.DESKTOP);s&&(this.portraitAdvOptions=this.getAdvOptions(_t.kq.PORTRAIT,this.blockIds[_t.kq.PORTRAIT]),this.showAdv(_t.kq.PORTRAIT)),t&&(this.landscapeAdvOptions=this.getAdvOptions(_t.kq.LANDSCAPE,this.blockIds[_t.kq.LANDSCAPE]),this.additionalLandscapeBlockEnabled&&(this.landscapeAdditionalAdvOptions=this.getAdvOptions(_t.kq.LANDSCAPE_ADDITIONAL,this.blockIds[_t.kq.LANDSCAPE_ADDITIONAL])),this.showAdv(_t.kq.LANDSCAPE)),Me.Z.addChangeListener(this.changeOrientationListener)},this.changeOrientationListener=()=>{Me.Z.isPortrait?this.showAdv(_t.kq.PORTRAIT):Me.Z.isLandscape&&this.showAdv(_t.kq.LANDSCAPE)},this.refreshLandscape=()=>{this.setShowState(_t.kq.LANDSCAPE_ADDITIONAL,!1),this.destroyAdv(this.blockIds[_t.kq.LANDSCAPE_ADDITIONAL]),this.destroyAdv(this.blockIds[_t.kq.LANDSCAPE]),this.loadedFlags.isRefreshLandscapeAdv=!0,this.loadedFlags.isLandscapeAdvLoaded=!1,this.showAdv(_t.kq.LANDSCAPE)},this.refreshPortrait=()=>{this.destroyAdv(this.blockIds[_t.kq.PORTRAIT]),this.loadedFlags.isRefreshAdv=!0,this.loadedFlags.isPortraitAdvLoaded=!1,this.showAdv(_t.kq.PORTRAIT)}}componentWillUnmount(){window.clearTimeout(this.refreshTimeoutId),window.clearTimeout(this.refreshLandscapeTimeoutId),window.clearTimeout(this.rejectTimeoutId),window.clearTimeout(this.additionalBlockTimeoutId),window.clearInterval(this.checkReadyIntervalId),Me.Z.removeChangeListener(this.changeOrientationListener)}handleAdvBlockIdError(e){this.clickDaemonAdvLog.error(this.adReqId,this.adSeqId,"There is no blockId"),(0,M.H)({block:$.W.ADV_STICKY,message:`AdvStickyBanner error [yandex]: There is no blockId for ${e}`})}tryInitAdvBlockId(e,t){return!!t&&(this.blockIds[e]=t,!0)}logTryOpenAndDemand(e){this.adSeqId=this.clickDaemonAdvLog.tryOpen(this.blockIds[e],he.e.Yandex),this.clickDaemonAdvLog.demand(void 0,0,this.adSeqId)}componentDidMount(){const{desktop:e,mobileLandscape:t,mobilePortrait:s}=this.props.stickyBannerLocation;if(e){const e=this.tryInitAdvBlockId(_t.kq.DESKTOP,this.gameBlockIds.desktop);this.tryInitAdvBlockId(_t.kq.DESKTOP_ADDITIONAL,this.gameBlockIds.desktop_additional),e||(this.onClose({error:"desktop block not initialized"}),this.handleAdvBlockIdError(_t.kq.DESKTOP))}if(s){this.tryInitAdvBlockId(_t.kq.PORTRAIT,this.gameBlockIds.portrait)||(this.onClose({onlyPortrait:!0,error:"portrait block not initialized"}),this.handleAdvBlockIdError(_t.kq.PORTRAIT))}if(t){const e=this.tryInitAdvBlockId(_t.kq.LANDSCAPE,this.gameBlockIds.landscape);this.tryInitAdvBlockId(_t.kq.LANDSCAPE_ADDITIONAL,this.gameBlockIds.landscape_additional),e||(this.onClose({onlyLandscape:!0,error:"landscape block not initialized"}),this.handleAdvBlockIdError(_t.kq.LANDSCAPE))}this.props.advGameCanBeLoaded&&this.loadAdvScript(),At.Z.onInternalMessage("header",(e=>{this.setState({isHeaderEnabled:"enabled"===e.data.action})}))}componentDidUpdate(e){const{advGameCanBeLoaded:t,stickyBannerLocation:{desktop:s,mobilePortrait:i,mobileLandscape:n}}=this.props;this.loadedScript?(e.advHidden&&!this.props.advHidden||!e.canShowPortraitAdv&&this.props.canShowPortraitAdv||!e.canShowLandscapeAdv&&this.props.canShowLandscapeAdv)&&(s&&this.showAdv(_t.kq.DESKTOP),i&&this.showAdv(_t.kq.PORTRAIT),n&&this.showAdv(_t.kq.LANDSCAPE)):!e.advGameCanBeLoaded&&t&&this.loadAdvScript()}isAdditionalBlock(e){return[_t.kq.DESKTOP_ADDITIONAL,_t.kq.LANDSCAPE_ADDITIONAL].includes(e)}onAdLoadFailed(e){ji("onAdLoadFailed",e),this.props.isAlternateLogs||this.clickDaemonAdvLog.noContent(this.adReqId,this.adSeqId);if(this.isAdditionalBlock(e))this.setShowState(e,!1);else{const t=e===_t.kq.PORTRAIT,s=e===_t.kq.LANDSCAPE;this.onClose({onlyLandscape:s,onlyPortrait:t})}}destroyAdv(e){var t,s;ji("Ya.Context.AdvManager.destroy",e),null==(s=null==(t=window.Ya)?void 0:t.Context)||s.AdvManager.destroy({blockId:e})}logAdvRequest(e,t){var s;if(this.props.isAlternateLogs){this.clickDaemon=new qe.U({app_id:this.props.appId,tag:he.$.STICKY});const i=this.hasBeenShownAtLeastOnce?ie.p_.REFRESH:ie.p_.ONSPOT;this.clickDaemon.tryOpen({provider:he.e.Yandex,reason:i});const n=this.clickDaemon.copy();return t.clickDaemon=n,null==(s=t.setRequestClickDaemon)||s.call(t,n),n.demand({advBlockId:this.blockIds[e],reason:i,provider:he.e.Yandex,depth:0}),void n.request()}this.logTryOpenAndDemand(e),this.adReqId=this.clickDaemonAdvLog.request({advBlockId:this.blockIds[e],advtype:he.e.Yandex,reason:ie.p_.ONSPOT,depth:0})}onScriptError({onlyLandscape:e,onlyPortrait:t}){this.clickDaemonAdvLog.response({adReqId:this.adReqId,reason:ie.Ud.NOT_IMPL}),this.clickDaemonAdvLog.error(this.adReqId,this.adSeqId,"window.Ya.Context.AdvManager.render is not defined"),ji("window.Ya.Context.AdvManager.render is not defined"),this.onClose({onlyPortrait:t,onlyLandscape:e})}showAdv(e){return t=this,s=null,i=function*(){var t,s,i;if(this.props.advHidden)return void this.props.onAdvShowed();yield this.scriptLoadPromiseWrapper.promise;const{isDesktopAdvLoaded:n,isPortraitAdvLoaded:a,isLandscapeAdvLoaded:r}=this.loadedFlags,{canShowDesktopAdv:o,canShowPortraitAdv:d,canShowLandscapeAdv:l}=this.props;if(!(null==(i=null==(s=null==(t=window.Ya)?void 0:t.Context)?void 0:s.AdvManager)?void 0:i.render))return this.onScriptError({onlyLandscape:e===_t.kq.LANDSCAPE,onlyPortrait:e===_t.kq.PORTRAIT}),void this.props.onAdvShowed();switch(e){case _t.kq.DESKTOP:o&&this.desktopAdvOptions&&!n&&(this.logAdvRequest(e,this.desktopAdvOptions),ji("Ya.Context.AdvManager.render desktop",this.desktopAdvOptions),window.Ya.Context.AdvManager.render(this.desktopAdvOptions,(()=>{var t,s;null==(s=null==(t=this.desktopAdvOptions)?void 0:t.clickDaemon)||s.responseEmpty(),this.onAdLoadFailed(e)})));break;case _t.kq.DESKTOP_ADDITIONAL:this.desktopAdditionalAdvOptions&&(this.logAdvRequest(e,this.desktopAdditionalAdvOptions),ji("Ya.Context.AdvManager.render desktop",this.desktopAdditionalAdvOptions),window.Ya.Context.AdvManager.render(this.desktopAdditionalAdvOptions,(()=>{var t,s;null==(s=null==(t=this.desktopAdvOptions)?void 0:t.clickDaemon)||s.responseEmpty(),this.onAdLoadFailed(e)})));break;case _t.kq.PORTRAIT:d&&this.portraitAdvOptions&&!a&&Me.Z.isPortrait&&(this.logAdvRequest(e,this.portraitAdvOptions),ji("Ya.Context.AdvManager.render portrait",this.portraitAdvOptions),window.Ya.Context.AdvManager.render(this.portraitAdvOptions,(()=>{var t,s;null==(s=null==(t=this.portraitAdvOptions)?void 0:t.clickDaemon)||s.responseEmpty(),this.onAdLoadFailed(e)})));break;case _t.kq.LANDSCAPE:l&&this.landscapeAdvOptions&&!r&&Me.Z.isLandscape&&(this.logAdvRequest(e,this.landscapeAdvOptions),ji("Ya.Context.AdvManager.render landscape",this.landscapeAdvOptions),window.Ya.Context.AdvManager.render(this.landscapeAdvOptions,(()=>{var t,s;null==(s=null==(t=this.landscapeAdvOptions)?void 0:t.clickDaemon)||s.responseEmpty(),this.onAdLoadFailed(e)})));break;case _t.kq.LANDSCAPE_ADDITIONAL:this.landscapeAdditionalAdvOptions&&(this.logAdvRequest(e,this.landscapeAdditionalAdvOptions),ji("Ya.Context.AdvManager.render landscape additional",this.landscapeAdditionalAdvOptions),window.Ya.Context.AdvManager.render(this.landscapeAdditionalAdvOptions,(()=>{var t,s;null==(s=null==(t=this.landscapeAdditionalAdvOptions)?void 0:t.clickDaemon)||s.responseEmpty(),this.onAdLoadFailed(e)})))}this.props.onAdvShowed()},new Promise(((e,n)=>{var a=e=>{try{o(i.next(e))}catch(e){n(e)}},r=e=>{try{o(i.throw(e))}catch(e){n(e)}},o=t=>t.done?e(t.value):Promise.resolve(t.value).then(a,r);o((i=i.apply(t,s)).next())}));var t,s,i}loadAdvScript(){window.yaContextCb?this.onAdvScriptLoaded():(0,dt.x)({id:"yandexads-context",src:this.context.yaAdsScript}).then((()=>{this.onAdvScriptLoaded()})).catch((()=>{this.onAdvScriptError()}))}onAdvScriptLoaded(){var e,t,s;this.loadedScript=!0,this.scriptLoadPromiseWrapper.resolve(void 0),(null==(s=null==(t=null==(e=window.Ya)?void 0:e.Context)?void 0:t.AdvManager)?void 0:s.render)?this.initAdvStickyBlocks():(this.rejectTimeoutId=window.setTimeout((()=>{(0,M.H)({message:"AdvStickyBanner error [yandex]: script failed to load"}),window.clearInterval(this.checkReadyIntervalId),this.onClose({error:"script failed to load"})}),this.timeToLoadAdv),this.checkReadyIntervalId=window.setInterval((()=>{var e,t,s;(null==(s=null==(t=null==(e=window.Ya)?void 0:e.Context)?void 0:t.AdvManager)?void 0:s.render)&&(window.clearInterval(this.checkReadyIntervalId),window.clearTimeout(this.rejectTimeoutId),this.initAdvStickyBlocks())}),200))}setShowState(e,t){switch(e){case _t.kq.DESKTOP_ADDITIONAL:this.setState({showDesktopAdditional:t});break;case _t.kq.LANDSCAPE_ADDITIONAL:this.setState({showLandscapeAdditional:t})}}getAdvOptions(e,t){const s=e===_t.kq.LANDSCAPE,i=e===_t.kq.PORTRAIT,n=this.isAdditionalBlock(e),a=n?2:1,r=this,o=(0,Tt.V)(Nt.Je,this.context.location);let d=this.clickDaemon;var l,c;return{async:!0,blockId:t,clickDaemon:this.clickDaemon,pageNumber:a,disableRefresh:!0,extParams:(l=Hi({},o?{google_aid:o}:{}),c={utm_source_service:"games","distr-id":this.props.appId},Mi(l,$i(c))),renderTo:`${this.containerIds[e]}`,statId:(0,Ye.Sn)(),onError:function(o){ji(`onError code=${o.code}, text=${o.text}, type=${o.type}`);const l=(0,Ni.M)(o,{blockId:t,pageId:a}),c=`${ie.Ud.ERROR}_${l}`;r.props.isAlternateLogs?d.error(l):(r.clickDaemonAdvLog.response({adReqId:r.adReqId,reason:c}),r.clickDaemonAdvLog.error(r.adReqId,r.adSeqId,c)),n?r.setShowState(e,!1):r.onClose({onlyPortrait:i,onlyLandscape:s,clickDaemon:d})},onRender:function(s){ji(`onRender ${t}`,s),r.props.isAlternateLogs?d.response():r.clickDaemonAdvLog.response({adReqId:r.adReqId,reason:ie.Ud.SUCCESS,depth:0}),r.handleAdvRender(e,s.productType,r.props.isAlternateLogs?d:void 0)},setRequestClickDaemon:e=>{d=e}}}handleAdvRender(e,t,s){switch(this.hasBeenShownAtLeastOnce=!0,e){case _t.kq.DESKTOP_ADDITIONAL:s?s.show():this.clickDaemonAdvLog.show(this.adReqId,this.adSeqId,void 0,this.loadedFlags.isRefreshAdv?"refresh":void 0);break;case _t.kq.DESKTOP:{this.loadedFlags.isDesktopAdvLoaded=!0,s?s.show():this.clickDaemonAdvLog.show(this.adReqId,this.adSeqId,void 0,this.loadedFlags.isRefreshAdv?"refresh":void 0);let e=!1;ue.U_.includes(t)||this.state.showDesktopAdditional||(this.additionalBlockTimeoutId=window.setTimeout((()=>this.showAdv(_t.kq.DESKTOP_ADDITIONAL)),ue.fE),e=!0),this.setState({showDesktopAdditional:e,showSpinner:!1}),ji("create refresh timer"),this.refreshTimeoutId=window.setTimeout((()=>{this.loadedFlags.isRefreshAdv=!0,this.loadedFlags.isDesktopAdvLoaded=!1,this.setShowState(_t.kq.DESKTOP_ADDITIONAL,!1),this.destroyAdv(this.blockIds[_t.kq.DESKTOP]),this.destroyAdv(this.blockIds[_t.kq.DESKTOP_ADDITIONAL]),ji("refresh timer executed"),this.showAdv(_t.kq.DESKTOP)}),this.props.intervalBetweenRefreshAd);break}case _t.kq.PORTRAIT:this.setState({showSpinner:!1,isPortraitMediaAdType:"direct"!==t}),this.loadedFlags.isPortraitAdvLoaded=!0,s?s.show():this.clickDaemonAdvLog.show(this.adReqId,this.adSeqId,void 0,this.loadedFlags.isRefreshAdv?"refresh":void 0),this.refreshTimeoutId=window.setTimeout((()=>{this.setState({showSpinner:!0},(()=>{this.refreshPortrait()}))}),this.props.intervalBetweenRefreshAd);break;case _t.kq.LANDSCAPE:let e=!1;const i="direct"!==t;!this.additionalLandscapeBlockEnabled||this.state.showLandscapeAdditional||ue.iv.includes(t)||(this.additionalBlockTimeoutId=window.setTimeout((()=>this.showAdv(_t.kq.LANDSCAPE_ADDITIONAL)),ue.fE),e=!0),this.setState({showSpinner:!1,showLandscapeAdditional:e,isLandscapeMediaAdType:i}),this.loadedFlags.isLandscapeAdvLoaded=!0,s?s.show():this.clickDaemonAdvLog.show(this.adReqId,this.adSeqId,void 0,this.loadedFlags.isRefreshLandscapeAdv?"refresh":void 0),this.refreshLandscapeTimeoutId=window.setTimeout((()=>{this.refreshLandscape()}),this.props.intervalBetweenRefreshAd);break;case _t.kq.LANDSCAPE_ADDITIONAL:"direct"!==t&&this.setState({isAdditionalLandscapeMediaAdType:!0}),s?s.show():this.clickDaemonAdvLog.show(this.adReqId,this.adSeqId,void 0,this.loadedFlags.isRefreshLandscapeAdv?"refresh":void 0)}}onAdvScriptError(){this.scriptLoadPromiseWrapper.reject(void 0),(0,M.H)({block:$.W.ADV_STICKY,message:"AdvStickyBanner error [yandex]: script failed to load"}),this.onClose({error:"script failed to load"}),this.props.onAdvShowed()}onClose(e){if(!this.adReqId){const{desktop:t,mobilePortrait:s}=this.props.stickyBannerLocation;let i;t&&(i=this.gameBlockIds.desktop),i=s?this.gameBlockIds.portrait:this.gameBlockIds.landscape,this.props.isAlternateLogs||this.clickDaemonAdvLog.errorNoRequest({adSeqId:this.adSeqId,provider:he.e.Yandex,advBlockId:i,error:(null==e?void 0:e.error)||"close without request"})}const t=null==e?void 0:e.clickDaemon;t&&!t.hadEvent(ie.zL.REQUEST)&&t.error("Sticky banner close without any requests."),this.props.onClose(e),this.adReqId?this.clickDaemonAdvLog.close(this.adReqId,this.adSeqId):this.props.isAlternateLogs&&(t?t.close():this.clickDaemon.close())}renderBanner(e,t,s,i){const{canShowPortraitAdv:a,canShowLandscapeAdv:r}=this.props,{isPortraitMediaAdType:o,isLandscapeMediaAdType:d,isAdditionalLandscapeMediaAdType:c,showDesktopAdditional:h,showLandscapeAdditional:u,showSpinner:p}=this.state,v=(0,ue.oi)(s,i),m=e===_t.kq.LANDSCAPE||e===_t.kq.LANDSCAPE_ADDITIONAL,g=e===_t.kq.PORTRAIT,w=o&&g||d&&e===_t.kq.LANDSCAPE||c&&e===_t.kq.LANDSCAPE_ADDITIONAL,y=!h&&e===_t.kq.DESKTOP_ADDITIONAL||!u&&e===_t.kq.LANDSCAPE_ADDITIONAL||this.props.advHidden||g&&!a||m&&!r;return n().createElement("div",{className:Gi({media:Boolean(w),[e]:t,border_round:Boolean(w),hidden:y,"white-bg":this.useWhiteBackgroundOnDesktop}),id:this.containerIds[e],key:e,style:v},!m&&n().createElement(l.y,{className:Gi("spinner",{hidden:!p}),key:`${e}-spinner`,position:"center",size:28,spinning:!0,view:"default"}))}render(){var e;const{advHidden:t,canShowDesktopAdv:s,hideAdvCloseButton:i,desktopAdvWidth:a,isLandscapeSide:r,mobileAdvPortraitHeight:o,stickyBannerLocation:{desktop:d,mobileLandscape:l,mobilePortrait:c}}=this.props,{isHeaderEnabled:h}=this.state;if(d){const r={width:a,marginTop:h&&!i?-ue.Mz:0,paddingTop:i?0:ue.Mz},o={width:a,marginTop:h?-ue.Mz:0};return n().createElement("div",{className:Gi("desktop-wrapper",{hidden:t||!s,"with-disable-ad-button":zi}),style:r},!i&&(null==(e=this.props.wrapperRef)?void 0:e.current)&&(0,u.createPortal)(n().createElement("div",{className:Gi("desktop-disable-ad-button-wrapper"),style:o},n().createElement(wt,null)),this.props.wrapperRef.current),this.renderBanner(_t.kq.DESKTOP,d,{}),this.renderBanner(_t.kq.DESKTOP_ADDITIONAL,d,{}))}return n().createElement(n().Fragment,null,c&&this.renderBanner(_t.kq.PORTRAIT,c,{height:o,maxHeight:o}),l&&n().createElement("div",{className:Gi("landscape-wrapper",{[l]:!0}),style:Hi({},this.landscapeWrapperStyles)},this.renderBanner(_t.kq.LANDSCAPE,l,this.landscapeBlockStyles),!r&&this.renderBanner(_t.kq.LANDSCAPE_ADDITIONAL,l,this.landscapeBlockStyles)))}}const Yi=(0,r.$j)((function(e){return{advGameCanBeLoaded:e.advGameCanBeLoaded}}))(Vi);var Ki,Xi=s(8393),Ji=Object.defineProperty,Qi=Object.defineProperties,en=Object.getOwnPropertyDescriptors,tn=Object.getOwnPropertySymbols,sn=Object.prototype.hasOwnProperty,nn=Object.prototype.propertyIsEnumerable,an=(e,t,s)=>t in e?Ji(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,rn=(e,t)=>{for(var s in t||(t={}))sn.call(t,s)&&an(e,s,t[s]);if(tn)for(var s of tn(t))nn.call(t,s)&&an(e,s,t[s]);return e},on=(e,t,s)=>new Promise(((i,n)=>{var a=e=>{try{o(s.next(e))}catch(e){n(e)}},r=e=>{try{o(s.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,r);o((s=s.apply(e,t)).next())}));const dn=!0,ln=(0,O.M$)("AdvStickyBannerManager",O.XG.Adv),cn="adv-sticky-banner";class hn extends ht.P{constructor(e,t){super(e,t),this.desktopAdvWidth=ue.q5,this.mobileAdvPortraitHeight=ue.qi,this.mobileAdvLandscapeHeight=ue.qi,this.mobileAdvSideLandscapeWidth=ue.HZ,this.intervalBetweenRefreshAd=qt.yR,this.isAdvStickyBannerEnabled=!1,this.minScreenWidthForDesktopAdv=ue.ie,this.isAdvStickyEnabledOnStartByExp=!1,this.forcedToHideRelatedAdv=!0===(0,ge.RM)(this.context.abt.flags,we.Z.advStickyBannerForcedHideAd),this.isAlternateLogs=null!=(Ki=(0,ge.RM)(this.context.abt.flags,we.Z.advAlternateLogs))&&Ki,this.adClosed=!1,this.useHighPortraitBlockIds=!1,this.isLandscapeSide=!1,this.stickyBannerLocation={desktop:null,mobileLandscape:null,mobilePortrait:null},this.services=[],this.onStickyBannerMessage=e=>on(this,null,(function*(){const{action:t,data:s}=e.data;"hide"!==t||"blur"!==(null==s?void 0:s.reason)?"show"===t&&"blur"===(null==s?void 0:s.reason)&&this.setState({isPageBlured:!1}):this.setState({isPageBlured:!0})})),this.onExternalMessage=(e,t)=>on(this,null,(function*(){const{action:s}=e.data;switch(s){case"adv-show-sticky-banner":{if(ln(`onExternalMessage: action: "${s}"`),this.adClosed=!1,!this.isAdvStickyBannerEnabled)return void t({data:{stickyAdvIsShowing:!1,reason:ue.$R.ADV_IS_NOT_CONNECTED}});if(!this.canShowAdv())return void t({data:{stickyAdvIsShowing:!1,reason:ue.$R.UNKNOWN}});this.initAdv();const e=this.state.canShowAdvStickyBanner?{}:{reason:ue.$R.UNKNOWN};t({data:rn({stickyAdvIsShowing:this.state.canShowAdvStickyBanner},e)});break}case"adv-hide-sticky-banner":ln(`onExternalMessage: action: "${s}"`),this.adClosed=!0,this.hideAdv(),t({data:{stickyAdvIsShowing:!1}});break;case"adv-status-sticky-banner":{if(!this.isAdvStickyBannerEnabled)return void t({data:{stickyAdvIsShowing:!1,reason:ue.$R.ADV_IS_NOT_CONNECTED}});const e=this.state.canShowAdvStickyBanner&&!this.state.advStickyBannerHidden;ln(`onExternalMessage: action: "${s}", stickyAdvIsShowing: ${e}`),t({data:{stickyAdvIsShowing:e}});break}}})),this.handleVisibilityChange=()=>{"hidden"===(null==document?void 0:document.visibilityState)?this.setHideState(!0):this.initAdv()},this.handleFullscreenChange=()=>{this.props.isFullscreenActive?this.hideAdv():this.initAdv()},this.handleDesktopResize=()=>{(0,Bt.bY)().innerWidth<=this.minScreenWidthForDesktopAdv?this.hideAdv():this.initAdv()},this.handleMobileResize=()=>{ln("handleMobileResize",window.innerWidth,window.innerHeight,ue.rv),this.state.advStickyBannerHidden||!(0,ue.JY)({forcedToHideRelatedAdv:this.forcedToHideRelatedAdv,minLandscapeHeight:this.minHeightToHideLandscapeAdv,minLandscapeWidth:this.isLandscapeSide?ue.rv:void 0,minPortraitHeight:this.minHeightToHidePortraitAdv})?this.state.advStickyBannerHidden&&this.initAdv():this.hideAdv()},this.onSubscriptionsMessage=e=>on(this,null,(function*(){const{action:t}=e.data;if("changed"===t){(yield(0,Et.K)())&&this.state.canShowAdvStickyBanner&&this.handleCloseAdv()}})),this.hideAdv=()=>{this.removeDefaultClasses(),ln("hideAdv"),this.setState({advStickyBannerHidden:!0,isGameFrameCanBeResizedInDesktop:!1,isGameFrameCanBeResizedInLandscape:!1,isGameFrameCanBeResizedInPortrait:!1}),Ot.Z.removeResizeBlock(cn),this.removeBodyStickyResize()},this.handleCloseAdv=e=>{this.removeDefaultClasses(),At.Z.post({type:"sticky-manager",action:"on-hide"}),(null==e?void 0:e.onlyPortrait)&&(this.setState({isGameFrameCanBeResizedInPortrait:!1}),Me.Z.isPortrait&&(Ot.Z.removeResizeBlock(cn),this.removeBodyStickyResize())),(null==e?void 0:e.onlyLandscape)&&(this.setState({isGameFrameCanBeResizedInLandscape:!1}),Me.Z.isLandscape&&(Ot.Z.removeResizeBlock(cn),this.removeBodyStickyResize())),this.state.isGameFrameCanBeResizedInLandscape&&(null==e?void 0:e.onlyPortrait)||this.state.isGameFrameCanBeResizedInPortrait&&(null==e?void 0:e.onlyLandscape)||((0,u.flushSync)((()=>this.setState({canShowAdvStickyBanner:!1,isGameFrameCanBeResizedInDesktop:!1,isGameFrameCanBeResizedInPortrait:!1,isGameFrameCanBeResizedInLandscape:!1}))),Ot.Z.removeResizeBlock(cn),this.removeBodyStickyResize(),this.adClosed=!0)};const{gameSettings:{features:s,settings:i},gameInfo:{appId:n},request:{flags:a}}=this.context.playPageData;this.headerSelector="minified"===e.headerType?".play-game-minified-header":".play-game-header";const{adv:r,stickyAdvDisabledOnStart:o}=(0,ue.Lf)(i);this.isAdvStickyEnabledOnStartByExp=(0,ue.KV)({isDesktop:dn,flags:a}),this.isAdvStickyBannerEnabled=!this.isParentWindow&&!(0,Pt.V)(a)&&(this.isAdvStickyEnabledOnStartByExp||(0,ue.uk)({adv:r,appId:n,isDesktop:dn,flags:a,orientation:null==s?void 0:s.orientation}));const d=(0,ge.$9)(a,we.Z.advStickyMinDesktopWidth);if(d&&(this.minScreenWidthForDesktopAdv=d),!r)return void(this.isAdvStickyBannerEnabled=!1);const l=(0,ue.jx)({adv:r,flags:a,appId:n,orientation:null==s?void 0:s.orientation});this.state={advStickyBannerHidden:!this.canShowAdv(),canShowAdvStickyBanner:!1,isGameFrameCanBeResizedInDesktop:Boolean(l.desktop),isGameFrameCanBeResizedInLandscape:Boolean(l.mobileLandscape),isGameFrameCanBeResizedInPortrait:Boolean(l.mobilePortrait),isPageBlured:!1};{const e=this.isAdvStickyEnabledOnStartByExp?_t.rq.RIGHT:l.desktop;this.stickyBannerLocation={desktop:e,mobilePortrait:null,mobileLandscape:null}}this.adClosed=o&&!this.isAdvStickyEnabledOnStartByExp}addBodyStickyReady(){document.body.classList.add(Xi.S.ready)}addBodyStickyIsGoogle(){document.body.classList.add(Xi.S.isGoogle)}addBodyStickyResize(){document.body.classList.add(Xi.S.resize)}removeBodyStickyResize(){document.body.classList.remove(Xi.S.resize)}canShowAdv(){var e,t;const{abt:s,playPageData:i}=this.context,{settings:n}=i.gameSettings,{adv:a}=(0,ue.Lf)(n);if(!a)return!1;if((0,Ct._G)())return!0;if((0,ge.Ww)(s.flags,d.By.STICKY))return!1;if(ln(`services = ${this.services}`),0===this.services.length)return!1;const r=this.isDisabledBySubscription();if(ln([`\nisAdDisabledBySubsciption = ${r}`,`settings.adv = ${JSON.stringify(null==n?void 0:n.adv,null,2)}`].join("\n")),r)return this.removeDefaultClasses(),!1;const o=us.parse(this.props.location.search.slice(1)),l=(0,Dt.E)((0,Tt.V)("utm_medium")),c=(0,Tt.V)("clid")||(null==(e=window.YandexGamesSDK)?void 0:e.clid),h=(0,St.k4)(l,c);return ln(`isAdDisabledByUtm = ${h},\n\n            params.clid = ${o.clid},\n\n            window.YandexGamesSDK.clid = ${null==(t=window.YandexGamesSDK)?void 0:t.clid},\n\n            clid = ${c},\n\n            utmMedium = ${l}\n        `),!h&&(this.props.isFullscreenActive?(ln("Desktop on fullscreen mode"),(0,M.H)({block:$.W.ADV_STICKY,message:"AdvStickyBanner error: Desktop window on fullscreen mode",level:"info"}),!1):(0,Bt.bY)().innerWidth<=this.minScreenWidthForDesktopAdv?(ln("Desktop width too narrow"),(0,M.H)({block:$.W.ADV_STICKY,message:"AdvStickyBanner error: Desktop width too narrow",level:"info"}),!1):!this.adClosed)}componentDidMount(){var e,t;const{allAdvBlocks:s,playPageData:i,abt:{flags:n},isGamesApp:a,isGamesLiteApp:r,withWorldWideAdv:o}=this.context,{gameSettings:{settings:d}}=i,{adv:l,stickyAdvDisabledOnStart:c}=(0,ue.Lf)(d);if(!l||!this.isAdvStickyBannerEnabled)return void this.removeDefaultClasses();{const{innerWidth:e,innerHeight:t,zoom:s}=(0,Bt.bY)();(0,ue.Ne)("canShow",{height:t,minScreenWidthForDesktopAdv:this.minScreenWidthForDesktopAdv,width:e,zoom:s})}this.services=(0,ue.g)({advBlocks:s,flags:n,isGamesApp:a,isGamesLiteApp:r,isPlayhop:this.context.secondDomain===me.U.PLAYHOP,withWorldWideAdv:o}),this.isAdsense=this.services.includes(he.e.Adsense),this.isGoogle=this.services.includes(he.e.Google),this.isNative=this.services.includes(he.e.Native),this.isParentWindow=this.services.includes(he.e.ParentWindow),this.isYandex=this.services.includes(he.e.Yandex);this.isNative&&!(0,kt.zg)(ue.XK)||this.initParamsByViewport(),this.initExperimentParams(),this.validateAdvSize();const{desktop:h,mobilePortrait:u,mobileLandscape:p}=this.stickyBannerLocation;if(document.body.classList.add("sticky-inited"),h){if(this.addBodyStickyReady(),!(null==(t=null==(e=l.sticky)?void 0:e.desktop)?void 0:t.right)&&!this.isAdvStickyEnabledOnStartByExp)return;return c&&!this.isAdvStickyEnabledOnStartByExp||this.initAdv(),this.initMessaging(),window.addEventListener("resize",this.handleDesktopResize),void(r||document.addEventListener("visibilitychange",this.handleVisibilityChange))}(u||p)&&(this.isLandscapeSide=p===_t.Xn.LEFT||p===_t.Xn.RIGHT,c||this.initAdv(),!this.isNative&&(this.minHeightToHidePortraitAdv||this.minHeightToHideLandscapeAdv||this.mobileAdvSideLandscapeWidth)&&window.addEventListener("resize",this.handleMobileResize),Me.Z.addChangeListener((()=>{(this.minHeightToHidePortraitAdv||this.minHeightToHideLandscapeAdv||this.isNative)&&this.handleMobileResize(),this.isNative||this.state.advStickyBannerHidden||!this.state.canShowAdvStickyBanner||this.resizeMobileGameBlock()})),this.initMessaging(),r||document.addEventListener("visibilitychange",this.handleVisibilityChange)),this.addBodyStickyReady()}componentDidUpdate(e,t){e.isFullscreenActive!==this.props.isFullscreenActive&&this.handleFullscreenChange(),t.advStickyBannerHidden!==this.state.advStickyBannerHidden&&At.Z.post({type:"sticky-manager",action:this.state.advStickyBannerHidden?"on-hide":"on-show"})}get isFullscreenEnabled(){return Boolean(this.props.isFullscreenEnabled||xt.w.available||(null==document?void 0:document[ft.Z.fullscreenEnabled]))}addDesktopResize(){const e={width:-this.desktopAdvWidth};Ot.Z.addResizeBlock(cn,{game:e,[`.${yt.Ek}`]:{width:-this.desktopAdvWidth-yt.UG},[this.headerSelector]:e}),this.addBodyStickyResize()}initContainerToDisplayAdv(){if(this.isNative)return;if(this.isParentWindow)return;const{desktop:e}=this.stickyBannerLocation;if(e)return this.addDesktopResize(),void this.removeDefaultClasses();this.resizeMobileGameBlock()}initMessaging(){At.Z.onAllMessages("adv-manager",this.onExternalMessage),At.Z.onInternalMessage("subscriptions",this.onSubscriptionsMessage,{withHistory:!0}),(0,ge.bF)(this.context.abt.flags)&&At.Z.onInternalMessage("sticky-banner",this.onStickyBannerMessage)}initParamsByViewport(){const{flags:e}=this.context.abt,{innerWidth:t,innerHeight:s}=(0,Bt.bY)();this.isGoogle?(this.desktopAdvWidth=ue.q5,this.addBodyStickyIsGoogle()):(this.desktopAdvWidth=t*ue.PV/100,this.isAdsense&&(this.desktopAdvWidth=Math.max(this.desktopAdvWidth,z.K)))}initExperimentParams(){const{flags:e}=this.context.abt,t=(0,ge.$9)(e,we.Z.advStickyBannerDesktopWidth),s=(0,ge.$9)(e,we.Z.advStickyBannerPortraitHeight),i=(0,ge.$9)(e,we.Z.advStickyBannerLandscapeHeight),n=(0,ge.$9)(e,we.Z.advStickyBannerLandscapeWidth),a=(0,ge.$9)(e,we.Z.advStickyBannerRefreshInterval),r=(0,ge.$9)(e,we.Z.advStickyBannerMinPortraitViewportHeight),o=(0,ge.$9)(e,we.Z.advStickyBannerMinLandscapeViewportHeight);t&&(this.desktopAdvWidth=t),s&&(this.mobileAdvPortraitHeight=s),i&&(this.mobileAdvLandscapeHeight=i),a&&(this.intervalBetweenRefreshAd=a),r&&(this.minHeightToHidePortraitAdv=r),o&&(this.minHeightToHideLandscapeAdv=o),n&&(this.mobileAdvSideLandscapeWidth=n)}validateAdvSize(){if(this.isParentWindow)return this.desktopAdvWidth=0,this.mobileAdvPortraitHeight=0,void(this.mobileAdvLandscapeHeight=0);this.desktopAdvWidth=Math.floor(Math.min(Math.max(this.desktopAdvWidth,ue.Ic),ue.q5)),ue.RH<this.mobileAdvPortraitHeight&&(this.mobileAdvPortraitHeight=ue.qi),ue.VT<this.mobileAdvLandscapeHeight&&(this.mobileAdvLandscapeHeight=ue.qi)}resizeMobileGameBlock(){const{mobilePortrait:e,mobileLandscape:t}=this.stickyBannerLocation,{isGameFrameCanBeResizedInPortrait:s,isGameFrameCanBeResizedInLandscape:i}=this.state;if(!s&&Me.Z.isPortrait||!i&&Me.Z.isLandscape)return Ot.Z.removeResizeBlock(cn),this.removeBodyStickyResize(),void this.removeDefaultClasses();const n=this.isLandscapeSide?this.mobileAdvSideLandscapeWidth:this.mobileAdvLandscapeHeight,a=Me.Z.isPortrait?this.mobileAdvPortraitHeight:n;if(this.isLandscapeSide&&Me.Z.isLandscape){const e=t===_t.Xn.LEFT?-a-ue.gG:-a-2*ue.gG;return Ot.Z.addResizeBlock(cn,{game:rn({width:e},t===_t.Xn.LEFT?{left:a+ue.gG}:{})}),this.removeDefaultClasses(),void this.addBodyStickyResize()}if(e===_t.Xn.UPPER&&Me.Z.isPortrait||t===_t.Xn.UPPER&&Me.Z.isLandscape){const e={top:a+ue.gG,height:-a-ue.gG};Ot.Z.addResizeBlock(cn,rn({game:e},Me.Z.isLandscape&&{[this.headerSelector]:e})),this.removeDefaultClasses(),this.addBodyStickyResize()}if(e===_t.Xn.BOTTOM&&Me.Z.isPortrait||t===_t.Xn.BOTTOM&&Me.Z.isLandscape){const e={height:-a-2*ue.gG};Ot.Z.addResizeBlock(cn,{game:e,[this.headerSelector]:e}),this.removeDefaultClasses(),this.addBodyStickyResize()}}isDisabledBySubscription(){return!!Boolean(this.props.userData.login)&&this.props.isAdDisabledBySubscription}initAdv(){const e=this.canShowAdv();if(ln("initAdv"),e&&!this.adClosed){const{desktop:e,mobileLandscape:t,mobilePortrait:s}=this.stickyBannerLocation;this.setState({advStickyBannerHidden:!1,canShowAdvStickyBanner:!0,isGameFrameCanBeResizedInDesktop:Boolean(e),isGameFrameCanBeResizedInPortrait:Boolean(s),isGameFrameCanBeResizedInLandscape:Boolean(t)},(()=>{this.initContainerToDisplayAdv()}))}}setHideState(e){this.setState({advStickyBannerHidden:e})}removeDefaultClasses(){var e;"function"==typeof(null==(e=Ot.Z)?void 0:e.removeDefaultClass)&&Ot.Z.removeDefaultClass(["sticky-desktop","sticky-mobile"])}renderBanner(){if(!this.state.canShowAdvStickyBanner)return null;if(this.isParentWindow)return null;const{appId:e}=this.context.playPageData.gameInfo,{advStickyBannerHidden:t,isGameFrameCanBeResizedInDesktop:s,isGameFrameCanBeResizedInLandscape:i,isGameFrameCanBeResizedInPortrait:a,isPageBlured:r}=this.state,o={advHidden:r||t,appId:e,intervalBetweenRefreshAd:this.intervalBetweenRefreshAd,isAlternateLogs:this.isAlternateLogs,isPageBlured:r,isLandscapeSide:this.isLandscapeSide,mobileAdvLandscapeHeight:this.mobileAdvLandscapeHeight,mobileAdvPortraitHeight:this.mobileAdvPortraitHeight,mobileAdvSideLandscapeWidth:this.mobileAdvSideLandscapeWidth,stickyBannerLocation:this.stickyBannerLocation,useHighPortraitBlockIds:this.useHighPortraitBlockIds,onAdvShowed:this.removeDefaultClasses,onClose:this.handleCloseAdv};if(this.isNative)return n().createElement(_i,rn({},o));const d={canShowDesktopAdv:s,canShowLandscapeAdv:i,canShowPortraitAdv:a,desktopAdvWidth:this.desktopAdvWidth,hideAdvCloseButton:this.props.hideAdvCloseButton,wrapperRef:this.props.wrapperRef};return this.isAdsense?n().createElement(oi,rn(rn({},o),d)):this.isGoogle?n().createElement(Ii,((e,t)=>Qi(e,en(t)))(rn(rn({},o),d),{isPageBlured:r})):this.isYandex?n().createElement(Yi,rn(rn({},o),d)):null}render(){return n().createElement("div",{className:"sticky-banner-container"},this.isAdvStickyBannerEnabled&&this.renderBanner())}}const un=(0,a.E)((0,r.$j)((function(e){return{isAdDisabledBySubscription:(0,ts.Ak)(e),isFullscreenActive:e.ui.isFullscreenActive,isFullscreenEnabled:e.ui.isFullscreenEnabled,userData:e.userData}}))(hn));var pn=s(53603),vn=s(75217);const mn=n().memo((({hideAdvCloseButton:e,headerType:t,placement:s,wrapperRef:a})=>{const r=(0,i.useContext)(ht.Z),{isReady:o}=(0,pn.s)(),{abt:{flags:d}}=r;return(0,ge.V)(d)&&!o||(0,vn.O)()?null:(0,ge.oI)(d)||"app"!==s?n().createElement(hs,{headerType:t,hideAdvCloseButton:e,wrapperRef:a}):n().createElement(un,{headerType:t,hideAdvCloseButton:e,wrapperRef:a})}))},6330:(e,t,s)=>{"use strict";s.d(t,{l:()=>G});s(26108),s(87363);var i=s(88561),n=s(69110),a=s(35742),r=Object.defineProperty,o=Object.defineProperties,d=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,c=Object.prototype.hasOwnProperty,h=Object.prototype.propertyIsEnumerable,u=(e,t,s)=>t in e?r(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,p=(e,t,s)=>new Promise(((i,n)=>{var a=e=>{try{o(s.next(e))}catch(e){n(e)}},r=e=>{try{o(s.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,r);o((s=s.apply(e,t)).next())}));class v extends n.Z{constructor(){super(),this.providerName=a.oO.AdsenseBlock,this.providerLoaderName=a.Po.Adsense}get isAdBreakReady(){return i.Z.isAdBreakReady}init(){return p(this,null,(function*(){try{yield i.Z.load(),this._loadPromise.resolve(this)}catch(e){this._loadPromise.reject(e)}}))}createSlot(e){return p(this,arguments,(function*({blockId:e}){return{type:"preroll",name:"adsense_block_"+e}}))}preloadSlot(e){return new Promise(((t,s)=>{var i;adBreak((i=((e,t)=>{for(var s in t||(t={}))c.call(t,s)&&u(e,s,t[s]);if(l)for(var s of l(t))h.call(t,s)&&u(e,s,t[s]);return e})({},e),o(i,d({adBreakDone({breakStatus:i}){switch(i){case"notReady":s(new Error("Adsense provider not ready to display adv."));break;case"frequencyCapped":s(new Error("Adsense ad wasn't shown because the frequency cap."));break;case"invalid":s(new Error("Adsense placement was invalid and ignored for subsequent shows."));break;case"viewed":t({isEmpty:!1,slot:e});break;default:t({isEmpty:!0,slot:e})}}}))))}))}showSlot(e){return Promise.resolve(void 0)}destroySlot(e){return Promise.resolve(void 0)}}const m=new v;var g=s(29747),w=s(26667),y=s(73441),f=s(87210);class b extends y.G{init(){(0,f.S$)().then((()=>(0,f.Vg)())).then((()=>(0,f.bT)((e=>{return t=this,s=null,i=function*(){e.enableServices()},new Promise(((e,n)=>{var a=e=>{try{o(i.next(e))}catch(e){n(e)}},r=e=>{try{o(i.throw(e))}catch(e){n(e)}},o=t=>t.done?e(t.value):Promise.resolve(t.value).then(a,r);o((i=i.apply(t,s)).next())}));var t,s,i})))).then((()=>this.loadPromise.resolve(this))).catch((e=>this.loadPromise.reject(e)))}}const A=new b;var S=s(83950);class k extends n.Z{constructor(){super(),this.providerName=a.oO.GoogleAnchor,this.providerLoaderName=a.Po.Google,this.googleSlotEvents={slotRenderEnded:new WeakMap,impressionViewable:new WeakMap},this.toggleAnchor=(e,t,s)=>{const i=new CustomEvent("toggleAnchor",{detail:{slot:e,open:t,creativeHeight:s}});this.dispatchEvent(i)}}init(){return e=this,t=null,s=function*(){var e,t;try{yield A.load(),yield(0,f.bT)((e=>{const t=e.pubads(),s=e=>{t.addEventListener(e,(t=>{const s=this.googleSlotEvents[e].get(t.slot);null==s||s(t)}))};s("slotRenderEnded"),s("impressionViewable")})),this.toggleObserver=(0,S.V)("anchor-toggle-observer",{threshold:[.1,1]}),this.addEventListener("toggleAnchor",this.onToggleAnchor),null==(e=this.loadPromise)||e.resolve(this)}catch(e){null==(t=this.loadPromise)||t.reject(e)}},new Promise(((i,n)=>{var a=e=>{try{o(s.next(e))}catch(e){n(e)}},r=e=>{try{o(s.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,r);o((s=s.apply(e,t)).next())}));var e,t,s}onToggleAnchor(e){const{slot:t,open:s,creativeHeight:i}=e.detail;w.Ah.spoiler(t)("Toggle Anchor",s,"height",i);let n=s?i+24:0;document.documentElement.style.setProperty("--anchor-bottom-height",`${n}px`)}createSlot({blockId:e}){return(0,f.bT)((()=>{const t=googletag.defineOutOfPageSlot(e,googletag.enums.OutOfPageFormat.BOTTOM_ANCHOR);if(!t)throw new Error("Failed to create googletag slot.");const s=googletag.pubads();return t.addService(s),t}))}preloadSlot(e){return new Promise((t=>{this.onGoogleEvent(e,"slotRenderEnded",(s=>{var i,n;if(s.isEmpty)return t({isEmpty:!0,slot:e});const a=document.getElementById(s.slot.getSlotElementId());if(!a)return;const r=null!=(n=null==(i=s.size)?void 0:i[1])?n:0,o="number"==typeof r?r:0;this.toggleObserver.unobserve(a);let d=0;s.slot.isAnchorOpened=!1,this.toggleObserver.observe(a,(e=>{!1===s.slot.isAnchorOpened&&d<=e.intersectionRatio?(this.toggleAnchor(s.slot,!0,o),s.slot.isAnchorOpened=!0):!0===s.slot.isAnchorOpened&&d>=e.intersectionRatio&&(this.toggleAnchor(s.slot,!1,o),s.slot.isAnchorOpened=!1),d=e.intersectionRatio})),t({isEmpty:!1,slot:e})}));googletag.pubads().refresh([e])}))}showSlot(e){return new Promise((t=>{this.onGoogleEvent(e,"impressionViewable",(e=>{t()}))}))}destroySlot(e){return Promise.resolve(void 0)}onGoogleEvent(e,t,s){this.googleSlotEvents[t].set(e,s)}}const E=new k;class I extends n.Z{constructor(){super(),this.providerName=a.oO.GoogleBlock,this.providerLoaderName=a.Po.Google,this.googleSlotEvents={slotRenderEnded:new WeakMap,impressionViewable:new WeakMap}}init(){return e=this,t=null,s=function*(){try{yield A.load(),yield(0,f.bT)((e=>{const t=e.pubads(),s=e=>{t.addEventListener(e,(t=>{const s=this.googleSlotEvents[e].get(t.slot);null==s||s(t)}))};s("slotRenderEnded"),s("impressionViewable")})),this._loadPromise.resolve(this)}catch(e){this._loadPromise.reject(e)}},new Promise(((i,n)=>{var a=e=>{try{o(s.next(e))}catch(e){n(e)}},r=e=>{try{o(s.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,r);o((s=s.apply(e,t)).next())}));var e,t,s}createSlot({blockId:e,divId:t,size:s}){return(0,f.bT)((()=>{const i=googletag.defineSlot(e,s,t);if(!i)throw new Error("Failed to create googletag slot.");const n=googletag.pubads();return i.addService(n),i}))}preloadSlot(e){return new Promise((t=>{this.onGoogleEvent(e,"slotRenderEnded",(s=>{t({isEmpty:s.isEmpty,slot:e})}));googletag.pubads().refresh([e])}))}showSlot(e){return new Promise((t=>{this.onGoogleEvent(e,"impressionViewable",(e=>{t()}))}))}destroySlot(e){return Promise.resolve(void 0)}onGoogleEvent(e,t,s){this.googleSlotEvents[t].set(e,s)}}const R=new I;var P=s(38512),T=s(58432),C=s(17061),L=s(79049),D=s(41811),O=Object.defineProperty,B=Object.defineProperties,x=Object.getOwnPropertyDescriptors,_=Object.getOwnPropertySymbols,N=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable,M=(e,t,s)=>t in e?O(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,$=(e,t)=>{for(var s in t||(t={}))N.call(t,s)&&M(e,s,t[s]);if(_)for(var s of _(t))q.call(t,s)&&M(e,s,t[s]);return e},F=(e,t)=>B(e,x(t)),W=(e,t,s)=>new Promise(((i,n)=>{var a=e=>{try{o(s.next(e))}catch(e){n(e)}},r=e=>{try{o(s.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,r);o((s=s.apply(e,t)).next())}));let Z=0;class U extends n.Z{constructor(){super(),this.providerName=a.oO.YandexBlock,this.providerLoaderName=a.Po.Yandex}init(){return W(this,null,(function*(){try{yield(0,L.x)({id:"yandexads-context",src:window.appData.yaAdsScript}),this._loadPromise.resolve(this)}catch(e){this._loadPromise.reject(e)}}))}createSlot(e){return W(this,arguments,(function*({blockId:e,location:t,renderTo:s}){const i=(0,C.V)(D.Je,t);return{blockId:e,renderTo:s,pageNumber:Z++,async:!0,statId:(0,T.Sn)(),extParams:F($({},i?{google_aid:i}:{}),{utm_source_service:"games"})}}))}preloadSlot(e,t){return W(this,null,(function*(){return new Promise(((s,i)=>{(0,P.Q$)({abtFlags:t,adOptions:F($({},e),{onRender:t=>{s({isEmpty:!1,slot:e})},onError:e=>{i(new Error("Unexpected ad slot error: "+e.text))}}),methodName:P.xn.RENDER,onAdLoadFailed:()=>{s({isEmpty:!0,slot:e})}})}))}))}showSlot(e){return W(this,null,(function*(){}))}destroySlot(e){return Promise.resolve(void 0)}}const H=new U;const z={[a.oO.AdsenseBlock]:m,[a.oO.AdsenseResponsive]:g.Z,[a.oO.GoogleAnchor]:E,[a.oO.GoogleBlock]:R,[a.oO.YandexBlock]:H},G=e=>{return t=void 0,s=null,i=function*(){return z[e].load()},new Promise(((e,n)=>{var a=e=>{try{o(i.next(e))}catch(e){n(e)}},r=e=>{try{o(i.throw(e))}catch(e){n(e)}},o=t=>t.done?e(t.value):Promise.resolve(t.value).then(a,r);o((i=i.apply(t,s)).next())}));var t,s,i}},62011:(e,t,s)=>{"use strict";s.d(t,{Z:()=>h});var i=s(87363),n=s.n(i),a=Object.defineProperty,r=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,d=Object.prototype.propertyIsEnumerable,l=(e,t,s)=>t in e?a(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,c=(e,t)=>{for(var s in t||(t={}))o.call(t,s)&&l(e,s,t[s]);if(r)for(var s of r(t))d.call(t,s)&&l(e,s,t[s]);return e};const h=function(e,t,s){return a=>{const r=(0,i.useContext)(t),o={};for(const e in s)o[e]=s[e](r);return(0,i.useMemo)((()=>n().createElement(e,c(c({},o),a))),[a,...Object.values(o)])}}},88561:(e,t,s)=>{"use strict";s.d(t,{Z:()=>u});var i=s(46210),n=s(26667),a=s(14408),r=s(73441),o=s(37705),d=s(79049),l=s(13377);const c="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js";class h extends r.G{constructor(){super(...arguments),this.isAdBreakReady=!1}init(){return e=this,t=null,s=function*(){var e,t,s,r;window.adsbygoogle=window.adsbygoogle||[],window.adBreak=window.adConfig=function(e){var t;null==(t=window.adsbygoogle)||t.push(e)};try{null==(e=window.clickdaemonLog)||e.call(window,"adv_debug",{scope:"AdsenseProviderLoader",event:"load",step:"1"});const r=(0,i.hF)(window.location.href);yield(0,d.x)({async:!0,src:r?(0,i.zR)(r):c,id:"adsense-script",crossOrigin:"anonymous",onScriptCreated:e=>{var t,s,i,n,r;const{dataset:d}=e,c=null==(i=null==(s=null==(t=window.appData)?void 0:t.allAdvBlocks)?void 0:s.adsense)?void 0:i.interstitial.clientId;c||(0,o.H)({block:l.W.GOOGLE_ADS,message:"No clientId passed in Adsense script."}),d.adClient=c,d.adFormat="auto",d.adFrequencyHint="30s";const h=(0,a.aO)(null==(r=null==(n=window.appData)?void 0:n.abt)?void 0:r.flags);h&&(d.adChannel=h)}}),null==(t=window.clickdaemonLog)||t.call(window,"adv_debug",{scope:"AdsenseProviderLoader",event:"load",step:"2"}),(0,n._y)("Adsense script loaded."),adConfig({sound:"off",onReady:()=>{var e,t;null==(e=window.clickdaemonLog)||e.call(window,"adv_debug",{scope:"AdsenseProviderLoader",event:"load",step:"4"}),(0,n._y)("Adsense adBreak ready."),this.isAdBreakReady=!0,this.loadPromise.resolve(this),null==(t=window.clickdaemonLog)||t.call(window,"adv_debug",{scope:"AdsenseProviderLoader",event:"load",step:"5"})}}),null==(s=window.clickdaemonLog)||s.call(window,"adv_debug",{scope:"AdsenseProviderLoader",event:"load",step:"3"})}catch(e){null==(r=window.clickdaemonLog)||r.call(window,"adv_debug",{scope:"AdsenseProviderLoader",event:"load",step:"error"}),this.loadPromise.reject(e),function(){const e={};fetch(c).then((t=>{e.headers={};for(let[s,i]of t.headers.entries())"expires"!==s&&(e.headers[s]=i.substring(0,1e3));return e.ok=t.ok,e.redirected=t.redirected,e.status=t.status,e.statusText=t.statusText.substring(0,1e3),e.url=t.url.substring(0,1e3),t})).then((e=>e.text())).then((t=>e.text=t.substring(0,1e3))).then((()=>{e.fetched=!0})).catch((()=>e.fetched=!1)).finally((()=>{(0,o.H)({additional:e,block:l.W.GOOGLE_ADS,message:"[adv] checkScriptAvailability [adsbygoogle.js]"})}))}()}},new Promise(((i,n)=>{var a=e=>{try{o(s.next(e))}catch(e){n(e)}},r=e=>{try{o(s.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,r);o((s=s.apply(e,t)).next())}));var e,t,s}}const u=new h},73441:(e,t,s)=>{"use strict";s.d(t,{G:()=>a});var i=s(26108),n=s(3436);class a extends n.R{constructor(){super()}load(){return this.loadPromise||(this.loadPromise=new i.Z,this.init()),this.loadPromise.promise}}},29747:(e,t,s)=>{"use strict";s.d(t,{K:()=>d,Z:()=>c});var i=s(26667),n=s(88561),a=s(69110),r=s(35742),o=(e,t,s)=>new Promise(((i,n)=>{var a=e=>{try{o(s.next(e))}catch(e){n(e)}},r=e=>{try{o(s.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,r);o((s=s.apply(e,t)).next())}));const d=250;class l extends a.Z{constructor(){super(),this.providerName=r.oO.AdsenseResponsive,this.providerLoaderName=r.Po.Adsense}get isAdBreakReady(){return n.Z.isAdBreakReady}init(){return o(this,null,(function*(){var e,t,s,i,a;null==(e=window.clickdaemonLog)||e.call(window,"adv_debug",{scope:"AdsenseResponsiveProvider",event:"init",step:"1"});try{yield n.Z.load(),null==(t=window.clickdaemonLog)||t.call(window,"adv_debug",{scope:"AdsenseResponsiveProvider",event:"init",step:"2"}),this._loadPromise.resolve(this),null==(s=window.clickdaemonLog)||s.call(window,"adv_debug",{scope:"AdsenseResponsiveProvider",event:"init",step:"3"})}catch(e){null==(i=window.clickdaemonLog)||i.call(window,"adv_debug",{scope:"AdsenseResponsiveProvider",event:"init",step:"4"}),this._loadPromise.reject(e)}null==(a=window.clickdaemonLog)||a.call(window,"adv_debug",{scope:"AdsenseResponsiveProvider",event:"init",step:"5"})}))}createSlot(e){return o(this,arguments,(function*({blockId:e,clientId:t,divId:s,height:n,maxHeight:a,width:r}){const o=document.querySelector(`#${s}`);if(!o)throw new Error(`Container #${s} not found`);const d=document.createElement("ins");d.classList.add("adsbygoogle"),d.style.display="block",d.style.margin="auto",d.style.height="number"==typeof n?`${n}px`:n,d.style.width="number"==typeof r?`${r}px`:r,a&&(d.style.maxHeight="number"==typeof a?`${a}px`:a),(0,i._y)(`Create Adsense slot, height: ${n}px, width: ${r}px`);const{dataset:l}=d;return l.adClient=t,l.adSlot=e,l.adFormat=a?"fluid":"auto",l.fullWidthResponsive="true",o.appendChild(d),this.createPreloadPromise(d),d}))}createPreloadPromise(e){this.preloadPromise=new Promise((t=>{const s=new MutationObserver((s=>{for(const i of s){const s=i.target;switch(i.attributeName){case"data-ad-status":{const i=s.dataset.adStatus;return t("filled"===i?{isEmpty:!1,slot:e}:{isEmpty:!0,slot:e})}case"style":s.style.width="",this.fixHeightStyle(s)}}}));s.observe(e,{attributes:!0,attributeFilter:["data-ad-status","style"],attributeOldValue:!0}),e.parentNode&&s.observe(e.parentNode,{attributes:!0,attributeFilter:["style"]})}))}preloadSlot(e){return adBreak({}),this.preloadPromise}showSlot(e){return Promise.resolve(void 0)}destroySlot(e){return o(this,null,(function*(){return e.remove(),Promise.resolve(void 0)}))}fixHeightStyle(e){window.setTimeout((()=>{var t;let s=3,n=e;const a=["minHeight","height","maxHeight"];try{for(;s-- >0&&(n=null!=(t=null==n?void 0:n.parentElement)?t:null);)for(const e of a)n.style.removeProperty(e)}catch(e){(0,i._y)("Failed to fix height styles: ",e.message)}}),0)}}const c=new l},69110:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});var i=s(26108),n=s(3436);class a extends n.R{get loadPromise(){return this._loadPromise}constructor(){super()}load(){return this._loadPromise||(this._loadPromise=new i.Z,this.init()),this._loadPromise.promise}}const r=a},35742:(e,t,s)=>{"use strict";s.d(t,{Po:()=>n,oO:()=>i});var i=(e=>(e.AdsenseBlock="adsense_block",e.AdsenseResponsive="adsense_responsive",e.GoogleAnchor="google_anchor",e.GoogleBlock="google_block",e.ParentWindow="parent_window",e.YandexBlock="yandex_block",e))(i||{}),n=(e=>(e.Adsense="adsense",e.Google="google",e.ParentWindow="parent",e.Yandex="yandex",e))(n||{})},32922:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});const i=s(48225).Z},25827:(e,t,s)=>{"use strict";s.d(t,{Z:()=>p});var i=s(63904),n=s.n(i),a=s(87363),r=s.n(a),o=s(89492),d=s(91605),l=s(82027),c=s(96952),h=s(89592);const u=n().with("close-button");class p extends a.PureComponent{constructor(){super(...arguments),this.handleClick=e=>{e.preventDefault(),e.stopPropagation(),(0,c.D)((()=>{var e;this.props.onClick(l.hz.cross),(0,d.NF)({},h.Ji.CLOSE_BUTTON_CLICK,{source:null!=(e=this.props.source)?e:""})}))}}render(){const{color:e,mix:t,type:s}=this.props;return r().createElement(o.Z,{className:`${u({color:e,type:s})} ${t}`,size:"m",onClick:this.handleClick})}}p.defaultProps={mix:"",onClick:()=>{}}},88372:(e,t,s)=>{"use strict";s.d(t,{Z:()=>P});var i=s(85383),n=s(29994),a=s(45331),r=s(55968),o=s(33119),d=s(16527),l=s(43548),c=s(98343),h=s(74762),u=s(74085),p=s(91605),v=s(77901),m=s(4915),g=s(31085),w=s(70602),y=s(40656),f=s(93298),b=s(15771),A=s(89592);const S=(0,f.M$)("DisplayInstallation",f.XG.Popup),{answerTimeoutToInstallationInMs:k}=c.addToHomeScreenSettings,E=y.IZ,I=["show-api-prompt","show-shortcut-popup","show-standalone-api-prompt"];class R extends a.P{constructor(e,t){super(e,t),this.isPlayToEarn=!1,this.handleVisibilityChange=()=>{return e=this,t=null,s=function*(){!1===document.hidden&&(this.removeVisibilityChangeListener(),this.showInstallationPromptPromise())},new Promise(((i,n)=>{var a=e=>{try{o(s.next(e))}catch(e){n(e)}},r=e=>{try{o(s.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,r);o((s=s.apply(e,t)).next())}));var e,t,s},this.appinstalledHandler=()=>{const e={type:this.props.type};this.sourceShortcut&&(e.source=this.sourceShortcut),S("appinstalled with params:",e),(0,p.NF)({},A.Ji.SHORTCUT_API_APPINSTALLED,e),this.isPlayToEarn&&this.sendPlayToEarnEvent(),w.Fj.apiAppInstalled((0,w.oU)({context:this.context,popupType:"system",source:this.sourceShortcut?(0,w.N7)(this.sourceShortcut):g.pR.CATALOG}))},this.shortcutManagerEventHandler=e=>{const{type:t,action:s,data:i}=e.data;if("shortcut-manager"===t)I.includes(s)&&i.source?this.sourceShortcut=i.source:this.sourceShortcut=void 0},this.disableShortcutButton=()=>{this.props.dispatch((0,o.tm)(!0))},this.waitForUserGestureToInstall=()=>{this.props.dispatch((0,o.I6)(!0))},this.stopWaitingForUserGestureToInstall=()=>{this.props.dispatch((0,o.I6)(!1))},this.showInstallationPromptCommonApi=e=>{const{shortcutEventPrompt:t}=this.props,s=(0,v.RY)();S(`showInstallationPromptCommonApi with source = ${e}, shortcutEventPrompt = ${t}`),t&&(w.Fj.show((0,w.oU)({context:this.context,popupType:"system",source:(0,w.aV)(e)})),t.prompt().then((()=>{this.props.dispatch((0,o.FJ)(void 0)),(0,p.NF)({},A.Ji.SHORTCUT_PROMPT_SHOW,{showPromptSource:e}),this.installationChecker.updateInstallationData(e),t.userChoice.then((t=>{w.Fj.click((0,w.oU)({context:this.context,popupType:"system",source:(0,w.aV)(e),result:"accepted"===t.outcome?"accepted":"rejected"})),"accepted"===t.outcome?((0,p.NF)({},A.Ji.SHORTCUT_USER_CHOICE_ACCEPTED),this.disableShortcutButton(),this.props.dispatch((0,o.w0)()),this.isPlayToEarn&&s&&this.sendPlayToEarnEvent()):(this.props.dispatch((0,o.yf)(!0)),(0,p.NF)({},A.Ji.SHORTCUT_USER_CHOICE_DISMISSED))}))})).catch((()=>{this.waitForUserGestureToInstall()})))},this.showInstallationPromptPromise=()=>{const e={waitingPeriod:y.s2,maxCallCount:3};e.waitingPeriod=E,S("options",e),this.installationChecker.checkInstallationCapability(e)&&(this.showInstallationPrompt(g.Wp.VisibilityChange),window.setTimeout((()=>{this.stopWaitingForUserGestureToInstall()}),k))},this.showInstallationPrompt=e=>{this.showInstallationPromptCommonApi(e)},this.installationChecker=new m.Z}addVisibilityChangeListener(){"catalog"===this.props.type&&((0,b.wy)(this.context.abt.flags).visibilitychange||(S("addEventListener visibilitychange"),document.addEventListener("visibilitychange",this.handleVisibilityChange)))}removeVisibilityChangeListener(){S("removeEventListener visibilitychange"),document.removeEventListener("visibilitychange",this.handleVisibilityChange)}addAppinstalledListener(){S("add appinstalled"),window.addEventListener("appinstalled",this.appinstalledHandler)}removeAppinstalledListener(){S("remove appinstalled"),window.removeEventListener("appinstalled",this.appinstalledHandler)}initMessaging(){"game"===this.props.type&&l.Z.onAllMessages("shortcut-manager",this.shortcutManagerEventHandler,{withHistory:!0})}removeMessaging(){"game"===this.props.type&&l.Z.offAllMessages("shortcut-manager",this.shortcutManagerEventHandler)}sendPlayToEarnEvent(){const{dispatch:e}=this.props;e((0,d.$B)(r.cb.CREATE_LINK_IN_CATALOGUE))}componentDidUpdate(e){this.props.shortcutButtonFlag!==e.shortcutButtonFlag?this.showInstallationPrompt(g.Wp.Button):this.props.shortcutGameFlag!==e.shortcutGameFlag?this.showInstallationPrompt(g.Wp.Game):this.props.shortcutPopupFlag!==e.shortcutPopupFlag?this.showInstallationPrompt(g.Wp.Popup):this.props.shortcutInstallerFlag!==e.shortcutInstallerFlag&&this.showInstallationPrompt(g.Wp.ShortcutInstaller),this.props.shortcutUserGesturePrompt&&!e.shortcutUserGesturePrompt&&this.logUserGesturePrompt()}logUserGesturePrompt(){const{shortcutUserGesturePrompt:e}=this.props;w.Fj.show((0,w.oU)({context:this.context,popupType:"system",source:g.pR.USER_GESTURE})),null==e||e.userChoice.then((e=>{w.Fj.click((0,w.oU)({context:this.context,popupType:"system",source:g.pR.USER_GESTURE,result:"accepted"===e.outcome?"accepted":"rejected"}))})).finally((()=>{this.props.dispatch((0,o.r7)(void 0))}))}componentDidMount(){var e;const{abt:t}=this.context;this.isPlayToEarn=(0,b.XP)(t.flags),this.initMessaging(),this.addVisibilityChangeListener(),this.addAppinstalledListener(),(0,u.Z)()&&(w.Fj.installed(),null==(e=this.props.history)||e.listen((0,h.P)((()=>{w.Fj.installed()}),10*y.WT)))}componentWillUnmount(){this.removeVisibilityChangeListener(),this.removeAppinstalledListener(),this.removeMessaging()}render(){return null}}const P=(0,i.E)((0,n.$j)((function(e){return{shortcutButtonFlag:e.shortcutButtonFlag,shortcutInstallerFlag:e.shortcutInstallerFlag,shortcutEventPrompt:e.shortcutEventPrompt,shortcutGameFlag:e.shortcutGameFlag,shortcutPopupFlag:e.shortcutPopupFlag,shortcutUserGesturePrompt:e.shortcutUserGesturePrompt}}))(R))},6042:(e,t,s)=>{"use strict";s.d(t,{Z:()=>w});var i=s(38096),n=s(63904),a=s.n(n),r=s(87363),o=s.n(r),d=s(4463),l=s(40184),c=s(85467),h=s(5825),u=s(36172),p=s(15771),v=s(2820),m=s(69838);const g=a().with("domain-logo"),w=({lazy:e,imageSize:t="m",textSize:s="m",showImage:n=!0,showText:a=!0,textColor:r,type:w})=>{var y;const f=(0,c.T)(),b=(0,h.C)(u.Up),{cdnUrl:A,abt:S,rtl:k}=(0,l.b)(),{hostname:E,componentsSettings:I}=(0,i.getDomainConfig)(),R=Boolean(null==(y=I.domainLogo)?void 0:y.useSingleLogo),P=(0,d.TH)(),T=(0,p.aL)(S.flags)&&!(0,v.Fg)(P.pathname),C=`${A}/games-static/static-data/images/logo/`,L=f("common.service.name"),D=`${E}-text-${r||b?"light":"dark"}.svg`,O=`${C}${E}${T?"-new-year.png":".svg"}`,B=`${C}${D}`;!n&&R&&(t="single");let x=n||R,_=a&&!R;return w===m.q7.HEADER&&(x=!1,_=!0),o().createElement("div",{className:g()},x&&o().createElement("img",{alt:L,className:g("image",{size:t,png:T,rtl:k,singleLogo:R}),crossOrigin:"anonymous",loading:e?"lazy":void 0,src:O}),_&&o().createElement("img",{alt:L,className:g("text",{size:s}),crossOrigin:"anonymous",id:D,loading:e?"lazy":void 0,src:B}))}},23073:(e,t,s)=>{"use strict";s.d(t,{Z:()=>u});var i=s(63904),n=s.n(i),a=s(87363),r=s.n(a),o=s(45331),d=s(68712),l=s(33489);const c=n().with("game-categories");class h extends a.Component{render(){const{categoryDataMappedByID:e}=this.context,{categoryIDs:t,mix:s="",withLink:i=!0,withIcon:n=!0}=this.props;return r().createElement("ul",{className:`${c()} ${s}`},t.map((t=>{const s=e[t];return s?r().createElement("li",{className:c("category"),key:s.name},r().createElement(d.Z,{name:s.name,title:s.title,type:l.q.CLEAR,withIcon:n,withLink:i})):null})))}}h.contextType=o.Z;const u=h},13571:(e,t,s)=>{"use strict";s.d(t,{Z:()=>F});var i=s(63904),n=s.n(i),a=s(87363),r=s.n(a),o=s(45112),d=s(26108);const l=class{constructor(){this.init()}init(){throw new Error("Not impl")}onLoaded(){throw new Error("Not impl")}};var c=s(87210);class h{static loadProvider(e){if(e in this.initializedProviders)return this.initializedProviders[e].onLoaded();const t=new(0,this.providersDictionary[e]);return this.initializedProviders[e]=t,t.onLoaded()}}h.providersDictionary={google:class extends l{constructor(){super(...arguments),this.providerName="google",this.loadedPromise=new d.Z}init(){(0,c.S$)().then((()=>(0,c.Vg)())).then((()=>(0,c.bT)((e=>{return t=this,s=null,i=function*(){e.enableServices()},new Promise(((e,n)=>{var a=e=>{try{o(i.next(e))}catch(e){n(e)}},r=e=>{try{o(i.throw(e))}catch(e){n(e)}},o=t=>t.done?e(t.value):Promise.resolve(t.value).then(a,r);o((i=i.apply(t,s)).next())}));var t,s,i})))).then((()=>this.loadedPromise.resolve(void 0))).catch((e=>this.loadedPromise.reject(e)))}onLoaded(){return this.loadedPromise.promise}},yandex:class extends l{}},h.initializedProviders={};const u=({blockId:e,containerId:t,debugLog:s,sizes:i,onSlotRendered:n,onImpressionViewable:r,onSlotResponseReceived:o,onSlotRequested:d,onSlotLoaded:l,onNoContent:h})=>{const[u,p]=(0,a.useState)(null),v=(0,a.useCallback)((t=>t.getAdUnitPath()===e),[e]),m=(0,a.useCallback)((()=>{(0,c.bT)((n=>{var a;const r=null==(a=n.defineSlot(e,i,t))?void 0:a.addService(n.pubads());r&&(null==s||s.spoiler(r.getAdUnitPath(),"Slot created"),p(r))}))}),[e,t,i,s]),g=(0,a.useCallback)((()=>{u&&(null==s||s.spoiler(u.getAdUnitPath(),"Destroying GoogleSlot"),googletag.destroySlots([u]),p(null))}),[u,s]),w=(0,a.useCallback)((e=>{var t;null==s||s.spoiler(null==(t=e.slot)?void 0:t.getAdUnitPath())("NoContent"),null==h||h(e)}),[s,h]),y=(0,a.useCallback)((e=>{v(e.slot)&&(null==s||s.spoiler(e.slot.getAdUnitPath())("onSlotRenderEnded",`isEmpty = ${e.isEmpty}`),null==n||n(e),e.isEmpty&&w(e))}),[n,v,w,s]),f=(0,a.useCallback)((e=>{v(e.slot)&&(null==s||s.spoiler(e.slot.getAdUnitPath())("onImpressionViewable"),null==r||r(e))}),[r,v,s]),b=(0,a.useCallback)((e=>{v(e.slot)&&(null==s||s.spoiler(e.slot.getAdUnitPath())("onSlotLoaded"),null==l||l(e))}),[l,v,s]),A=(0,a.useCallback)((e=>{v(e.slot)&&(null==s||s.spoiler(e.slot.getAdUnitPath())("onSlotResponseReceived"),null==o||o(e))}),[o,v,s]),S=(0,a.useCallback)((e=>{v(e.slot)&&(null==s||s.spoiler(e.slot.getAdUnitPath())("onSlotRequested"),null==d||d(e))}),[d,v,s]);return(0,a.useEffect)((()=>{var e;const t=null==(e=googletag.pubads)?void 0:e.call(googletag);if(t&&"function"==typeof t.addEventListener)return t.addEventListener("slotRequested",S),t.addEventListener("slotResponseReceived",A),t.addEventListener("slotOnload",b),t.addEventListener("slotRenderEnded",y),t.addEventListener("impressionViewable",f),()=>{var e;const t=null==(e=googletag.pubads)?void 0:e.call(googletag);t&&"function"==typeof t.removeEventListener&&(t.removeEventListener("slotRequested",S),t.removeEventListener("slotResponseReceived",A),t.removeEventListener("slotOnload",b),t.removeEventListener("slotRenderEnded",y),t.removeEventListener("impressionViewable",f))}}),[S,A,b,y,f]),{createSlot:m,slot:u,destroySlot:g}};var p=s(45331),v=s(5e4),m=s(97553);const g=[300,250],w=({advLogger:e,debugLog:t})=>{const{allAdvBlocks:s}=(0,a.useContext)(p.Z),i=s.prebid.splashScreen,n=(0,a.useCallback)((({slot:t})=>{const{adReqId:s,adSeqId:i}=t||{};e.noContent(s,i)}),[e]),o=(0,a.useCallback)((t=>{e.response({adReqId:t.slot.adReqId,depth:0,clickUrl:t.slot.getClickUrl()||"",reason:t.slot.getResponseInformation()?m.Ud.SUCCESS:m.Ud.EMPTY})}),[e]),d=(0,a.useCallback)((t=>{const{adReqId:s,adSeqId:i}=t.slot;e.show(s,i,t.slot.getClickUrl())}),[e]),{createSlot:l,slot:c,destroySlot:h}=u({blockId:i,sizes:g,containerId:i,onSlotRendered:o,onImpressionViewable:d,onNoContent:n,debugLog:t});return(0,a.useEffect)((()=>(c||l(),()=>h())),[l,h,c]),(0,a.useEffect)((()=>{c&&(c.adSeqId=e.tryOpen(c.getAdUnitPath(),v.e.Google),e.demand(void 0,0,c.adSeqId),c.adReqId=e.request({advtype:v.e.Google,advBlockId:c.getAdUnitPath(),depth:0,reason:m.p_.ONSPOT}),googletag.pubads().refresh([c]))}),[c,e]),r().createElement("div",{className:"splash-google-adv",id:i,style:{width:g[0],height:g[1]}})};var y=s(65068),f=s(93298);const b=(0,f.M$)("SplashAdvManager",f.XG.Adv),A=()=>{const[e,t]=(0,a.useState)(!1),{playPageData:s}=(0,a.useContext)(p.Z),i=(0,a.useRef)(new y.i({app_id:s.gameInfo.appId,tag:v.$.SPLASH}));return(0,a.useEffect)((()=>{h.loadProvider("google").then((()=>t(!0))).catch((()=>b.log("Failed to load GPT script")))}),[]),r().createElement(r().Fragment,null,e&&r().createElement(w,{advLogger:i.current,debugLog:b}))};var S=s(89492);const k=n().with("play-button"),E=({disabled:e,onClick:t,text:s})=>{const i=(0,a.useCallback)((()=>{e||t()}),[t,e]);return r().createElement("div",{className:k({disabled:e}),onClick:i},r().createElement("div",{className:k("icon_container")},r().createElement(S.Z,{type:"play-bordered"})),r().createElement("span",{className:k("text")},s))};var I=s(30367),R=s(43548),P=s(47484);const T=e=>new Promise((t=>e(t))),C=()=>T(P.EE).then((()=>"waitTTI")),L=e=>new Promise((t=>{const s=e=>{I.UD.includes(e.data.action)&&(R.Z.offAllMessages("game-measuring",s),t(e.data.action))};e&&C().then(t),R.Z.onAllMessages("game-measuring",s)})),D=e=>{return t=void 0,s=null,i=function*(){const t=Promise.race([T(P.UQ).then((()=>"waitAllTTI")),L(e)]),[s]=yield Promise.all([t,C()]);return s},new Promise(((e,n)=>{var a=e=>{try{o(i.next(e))}catch(e){n(e)}},r=e=>{try{o(i.throw(e))}catch(e){n(e)}},o=t=>t.done?e(t.value):Promise.resolve(t.value).then(a,r);o((i=i.apply(t,s)).next())}));var t,s,i};var O=s(6466),B=s(64295),x=s(53603),_=s(40184),N=s(85467),q=s(15771),M=s(90380);const $=n().with("adv-game-loader"),F=()=>{const e=(0,_.b)(),{abt:{flags:t}}=e,s=(0,N.T)(),{setIsReady:i}=(0,x.s)(),[n,d]=(0,a.useState)(!1),[l,c]=(0,a.useState)(!1),h=(0,a.useRef)(null),{hideGameLoaderCallback:u}=(0,B.p)(),p=(0,a.useCallback)((e=>{R.Z.post({type:"splash",action:"set-was-closed",data:{result:!0}}),R.Z.post({type:"document-events",action:"hide-splash-screen"}),u(e),i(!0),d(!0)}),[u,i]),v=(0,a.useCallback)((()=>p("play click")),[p]),m=(0,q.RM)(t,M.Z.advGameLoaderStayOnLoad),g=(0,q.RM)(t,M.Z.advGameLoaderButtonAtBottom);return(0,o.qR)((()=>{D().then((e=>{m?c(!0):p(e)}))})),(0,a.useEffect)((()=>{n&&h.current&&clearTimeout(h.current)}),[n]),(0,o.qR)((()=>(h.current=window.setTimeout((()=>{m?c(!0):p("timeout")}),I.Wc),()=>{h.current&&clearTimeout(h.current)}))),n?null:r().createElement("div",{className:$(),"data-type":"game-loader"},r().createElement("div",{className:$("preloading-content-container")},r().createElement(O.Z,null),r().createElement("div",{className:$("text")},s("common.loading"))),r().createElement("div",{className:$("adv-container",{"button-at-bottom":g})},r().createElement(A,null)),m&&r().createElement("div",{className:$("play-button-container",{"button-at-bottom":g})},r().createElement(E,{disabled:!l,text:s("splash-screen.close-adv"),onClick:v})))}},30367:(e,t,s)=>{"use strict";s.d(t,{AK:()=>o,NS:()=>n,UD:()=>a,Wc:()=>d,lt:()=>r});var i=s(70135);i.ur.GameReady;const n={"adv-show-fullscreen":{messageType:"adv-manager",hideReason:"advertisement"},[i.ur.GameReady]:{messageType:"game-measuring",hideReason:"gameReady"}},a=[i.ur.GameInit,i.ur.GameReady,i.ur.GameReadyForce],r=()=>["adv-manager","game-measuring"],o=()=>["adv-show-fullscreen",i.ur.GameReady],d=1e4},47552:(e,t,s)=>{"use strict";s.d(t,{Z:()=>b});var i=s(63904),n=s.n(i),a=s(87363),r=s.n(a),o=s(30367),d=s(6466),l=s(64295),c=s(53603),h=s(40184),u=s(85467),p=s(43548),v=s(70135),m=s(14228),g=s(47484),w=s(15771),y=(e,t,s)=>new Promise(((i,n)=>{var a=e=>{try{o(s.next(e))}catch(e){n(e)}},r=e=>{try{o(s.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,r);o((s=s.apply(e,t)).next())}));const f=n().with("game-loader"),b=()=>{const e=(0,h.b)(),{abt:{flags:t},playPageData:s}=e,i=(0,u.T)(),{setIsReady:n}=(0,c.s)(),[b,A]=(0,a.useState)(!1),[S,k]=(0,a.useState)(null),E=(0,a.useRef)(null),I=(0,a.useCallback)((()=>{k("click")}),[]),R=(0,w.Rg)(t),P=(0,a.useRef)(null),{hideGameLoaderCallback:T}=(0,l.p)(),C=(0,a.useCallback)((()=>y(void 0,null,(function*(){const e=new Promise((e=>y(void 0,null,(function*(){p.Z.onExternalMessage("game-measuring",(t=>{o.UD.includes(t.data.action)&&e(t.data.action)})),(0,g.UQ)((()=>e("waitAllTTI"))),(yield(0,m.y)())&&(0,g.EE)((()=>e("waitTTI")))})))),t=new Promise((e=>{(0,g.EE)((()=>e("waitTTI")))})),[s]=yield Promise.all([e,t]);return s}))),[]);return(0,a.useEffect)((()=>{var e,t,s,i,n;const a=(0,o.AK)(),r=null==(n=null==(i=null==(s=null==(t=null==(e=window.earlyEvents)?void 0:e.messages)?void 0:t.find((e=>{var t,s;return a.includes(null==(s=null==(t=e.data)?void 0:t.originalEvent)?void 0:s.action)})))?void 0:s.data)?void 0:i.originalEvent)?void 0:n.action;r?k(o.NS[r].hideReason):a.includes(v.ur.GameReady)&&C().then((e=>{k(e)}))}),[C]),(0,a.useEffect)((()=>{if(!b){const e=(0,o.lt)(),t=(0,o.AK)(),s=e=>{const{action:s}=e.data;t.includes(s)&&k(o.NS[s].hideReason)};return p.Z.onAllMessages(e,s),()=>{P.current&&p.Z.offAllMessages(e,s)}}}),[b]),(0,a.useEffect)((()=>{b&&E.current&&clearTimeout(E.current)}),[b]),(0,a.useEffect)((()=>{E.current=setTimeout((()=>{k("timeout"),E.current=null}),o.Wc)}),[s.gameInfo.appId]),(0,a.useEffect)((()=>{!P.current&&S&&(P.current=S,p.Z.post({type:"document-events",action:"hide-splash-screen",data:{reason:S}}),n(!0),setTimeout((()=>{A(!0),T(S)}),250))}),[S,t,n,T]),b?null:r().createElement("div",{className:f({hidden:Boolean(S),transparent:R}),"data-type":"game-loader",onClick:I},r().createElement("div",{className:f("content")},r().createElement(d.Z,null)),r().createElement("div",{className:f("text")},i("common.loading")))}},6466:(e,t,s)=>{"use strict";s.d(t,{Z:()=>f});var i=s(9878),n=s(63904),a=s.n(n),r=s(87363),o=s.n(r),d=s(60295);var l=s(40184),c=s(11324),h=s(68199),u=s(41811),p=Object.defineProperty,v=Object.getOwnPropertySymbols,m=Object.prototype.hasOwnProperty,g=Object.prototype.propertyIsEnumerable,w=(e,t,s)=>t in e?p(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;const y=a().with("preloading-content"),f=()=>{var e;const t=(0,l.b)(),{playPageData:s,isSlowCountry:n}=t,a=null==(e=s.gameData)?void 0:e.media,p=(0,r.useRef)(null),[f]=function(e,t){const[s,i]=(0,r.useState)(!1),n=()=>{i(!0)};return(0,r.useEffect)((()=>{var i,a;!s&&(null==(i=null==e?void 0:e.current)?void 0:i.complete)&&(t&&(0,d.bS)(t,null==(a=null==e?void 0:e.current)?void 0:a.src),n())})),[n,s]}(p,"splash-screen");if(!a)return o().createElement(i.y,{size:46,spinning:!0,view:"default"});const b=n?u.xY.SIZE_84_LOW:u.xY.M,A=(0,c.Jn)(a,((e,t)=>{for(var s in t||(t={}))m.call(t,s)&&w(e,s,t[s]);if(v)for(var s of v(t))g.call(t,s)&&w(e,s,t[s]);return e})({size:b},(0,h.R)(n)?{cdnUrl:t.cdnUrl}:{})),S=`drop-shadow(0px 0px 70px ${a.icon.mainColor})`;return o().createElement("img",{alt:s.gameTitle,className:y("game-icon"),crossOrigin:"anonymous",fetchpriority:"high",loading:"eager",ref:p,src:A,style:{filter:S,backgroundColor:(0,c.jl)(a,{size:b})},onLoad:f})}},64295:(e,t,s)=>{"use strict";s.d(t,{p:()=>l});var i=s(87363);const n=e=>()=>e?Date.now()-e:null;var a=s(43548),r=s(47484),o=s(93298);const d=(0,o.M$)("SplashScreen",o.XG.Dev),l=()=>{const e=(0,i.useRef)(null);return(0,i.useEffect)((()=>{if(!o.HQ)return;e.current=Date.now();const t=n(e.current),s=e=>{d("onGameMeasuringEvent",e.data.action)};return a.Z.onExternalMessage("game-measuring",s),(0,r.EE)((()=>d("waitTTI",t()))),(0,r.UQ)((()=>d("waitAllTTI",t()))),()=>{a.Z.offInternalMessage("game-measuring",s)}}),[]),{mountedTime:e,hideGameLoaderCallback:t=>{const s=n(e.current)();d(`Splash screen hide by ${t}. elapsed time: ${s}`)}}}},72875:(e,t,s)=>{"use strict";s.d(t,{Z:()=>h});var i=s(9878),n=s(63904),a=s.n(n),r=s(87363),o=s.n(r),d=s(45331);const l=a().with("image");class c extends r.Component{constructor(e){super(e),this.imgRef=o().createRef(),this.onLoad=()=>{this.setState({status:"loaded"})},this.onError=()=>{this.setState({status:"error"})},this.state={status:e.disableSpinner?"loaded":"loading"}}componentDidMount(){var e;(null==(e=this.imgRef.current)?void 0:e.complete)&&"loaded"!==this.state.status&&this.onLoad()}componentDidUpdate(e){var t;this.props.src!==e.src&&this.setState({status:"loading"}),(null==(t=this.imgRef.current)?void 0:t.complete)&&"loaded"!==this.state.status&&this.onLoad()}render(){const e=`${l("",{state:this.state.status})} ${this.props.className}`.trim();return o().createElement("div",{className:e},o().createElement("img",{alt:this.props.alt||"",className:l("img"),crossOrigin:this.props.crossOrigin,ref:this.imgRef,src:this.props.src,title:this.props.title,onError:this.onError,onLoad:this.onLoad}),o().createElement(i.y,{position:"center",size:this.props.size,spinning:"loading"===this.state.status,view:"default"}))}}c.contextType=d.Z;const h=c},86156:(e,t,s)=>{"use strict";s.d(t,{Z:()=>m});var i=s(87363),n=s.n(i),a=s(29994),r=s(45331),o=s(59389),d=s(78308),l=s(65015),c=s(43548),h=s(91605),u=s(90295),p=s(89592);class v extends i.Component{constructor(){super(...arguments),this.state={conflicts:void 0},this.onExternalMessage=(e,t)=>{"processing"===e.data.action&&this.processing()},this.resolveConflict=e=>{(0,h.NF)({},p.Ji.MERGE_CONFLICTS_RESOLVE);const{conflicts:t}=this.state,{getText:s}=this.props;this.setState({conflicts:void 0});new d.Z(window.YandexGamesSDK.apiData).setResolveConflict({appID:this.context.playPageData.gameInfo.appId,authPriority:"account"===e,iGames:"account"===e?void 0:e}).then((()=>{null==t||t.callback(!0),c.Z.post({type:"message-box",action:"show",data:{message:s("merge-conflicts.success")}})})).catch((e=>{(0,l.fF)(e,{message:`SDK Api request error from ${u.Wv}`,type:"fetch"}),null==t||t.callback(!1),c.Z.post({type:"message-box",action:"show",data:{message:s("merge-conflicts.error"),type:"error"}}),console.warn("Data not applied")}))}}componentDidMount(){c.Z.onAllMessages("merge-conflicts",this.onExternalMessage),this.processing()}componentWillUnmount(){c.Z.offAllMessages("merge-conflicts",this.onExternalMessage)}processing(){var e,t,s;(null==(t=null==(e=window.YandexGamesSDK)?void 0:e.conflicts)?void 0:t.data.conflictInfo)&&(c.Z.offAllMessages("merge-conflicts",this.onExternalMessage),this.setState({conflicts:null==(s=window.YandexGamesSDK)?void 0:s.conflicts}))}render(){var e;const t=null==(e=this.state.conflicts)?void 0:e.data;return t?n().createElement(o.Z,{conflicts:t,onResolve:this.resolveConflict}):null}}v.contextType=r.Z;const m=(0,a.$j)((function(e){return{getText:e.getText}}))(v)},65453:(e,t,s)=>{"use strict";s.d(t,{E6:()=>n,Oe:()=>r,Tp:()=>a,XB:()=>i});var i=(e=>(e.DEBUG="debug",e.ERROR="error",e.INFO="info",e.WARN="warn",e))(i||{});const n=1e4,a=200,r=10},74232:(e,t,s)=>{"use strict";s.d(t,{Z:()=>p});var i=s(10131),n=s(63904),a=s.n(n),r=s(87363),o=s.n(r),d=s(29994),l=s(25827),c=s(65453);const h=a().with("message-box");class u extends r.PureComponent{constructor(){super(...arguments),this.state={destroyed:!1,visible:!1},this.handleClick=()=>{var e,t;this.toggleVisibility(!1),null==(t=(e=this.props).onClick)||t.call(e)},this.onSnooze=()=>{var e,t;this.toggleVisibility(!1),null==(t=(e=this.props).onSnooze)||t.call(e)}}componentDidMount(){const{autohide:e}=this.props;this.openingTimer=window.setTimeout((()=>this.toggleVisibility(!0)),c.Oe),e&&(this.hidingTimer=window.setTimeout((()=>this.toggleVisibility(!1)),c.E6))}componentWillUnmount(){window.clearTimeout(this.openingTimer),this.hidingTimer&&window.clearTimeout(this.hidingTimer),this.destroyTimer&&window.clearTimeout(this.destroyTimer)}toggleVisibility(e){var t,s;this.setState({visible:e}),e||(null==(s=(t=this.props).onClose)||s.call(t),this.destroyTimer=window.setTimeout((()=>{this.setState({destroyed:!0})}),c.Tp))}renderSnoozeButton(){return this.props.onSnooze?o().createElement(i.z,{className:h("snooze"),rounded:!0,size:24,view:"secondary",onClick:this.onSnooze},"ð´ ",o().createElement("span",{className:h("snooze-title")},this.props.getText("common.hide").toLowerCase())):null}renderCloseButton(){return this.props.withCloseButton?o().createElement(l.Z,{type:"popup",onClick:this.handleClick}):null}renderContent(){return o().createElement("div",{className:h("content"),onClick:this.handleClick},this.props.children)}render(){const{level:e=c.XB.INFO}=this.props,{destroyed:t,visible:s}=this.state;return t?null:o().createElement("div",{className:h({level:e,visible:s})},this.renderSnoozeButton(),this.renderCloseButton(),this.renderContent())}}const p=(0,d.$j)((function(e){return{getText:e.getText}}))(u)},23404:(e,t,s)=>{"use strict";s.d(t,{EC:()=>l,Iy:()=>u,Si:()=>c,Sk:()=>o,UG:()=>r,_u:()=>p,hL:()=>a,kn:()=>d,qS:()=>h,wt:()=>m,xd:()=>n,yt:()=>v});var i=s(5e4);const n={fullscreen:"fullscreen",desktop:"desktop"},a=15e3,r=15e3,o=3e4,d={countdown:"play-countdown",headerFix:"with-play-game-header-fix",modal:"play-modal",modalClose:"play-modal-close",modalFullscreen:"play-modal_fullscreen",modalInner:"play-modal__inner",modalVisible:"play-modal_visible",modalWithBlur:"play-modal_with-blur",modalWithHeader:"play-modal_with-header",noClickOverlay:"adv-no-click-overlay",yabroChromeLower79:"play-modal_yabro_chrome_lower_79"},l={start_fullscreen:"R-A-3462885-6",fullscreen:"R-A-3462885-2",rewarded:"R-A-3462885-1"},c="aab-adv_with_disable_adv_button",h="No adv to show now - it can happen sometimes\nTry reload page(Ctrl+F5) or open in different browser",u="No rewarded video to show now - it can happen sometimes\nTry reload page(Ctrl+F5) or open in different browser",p="Trouble with showing adv",v="Adv SDK error",m=[i.e.AdsenseResponsive,i.e.Google,i.e.GoogleInstream,i.e.GoogleManual,i.e.Native,i.e.Prebid,i.e.PrebidTGO,i.e.Yandex]},47802:(e,t,s)=>{"use strict";s.d(t,{lu:()=>ae,KW:()=>be,Sn:()=>Se,fl:()=>Ae,$3:()=>ee,ss:()=>de,qu:()=>V,tq:()=>oe,dh:()=>ce,mx:()=>le,el:()=>ge,TE:()=>he,zw:()=>se,PS:()=>ie,xK:()=>me,uD:()=>we,Ij:()=>ve,g5:()=>ue,ey:()=>Y,SW:()=>te,R4:()=>K,J4:()=>ne,U2:()=>J,gp:()=>ye,WL:()=>Q,HH:()=>pe});var i=s(23404),n=s(54814),a=s(65015),r=s(43548),o=Object.defineProperty,d=Object.defineProperties,l=Object.getOwnPropertyDescriptors,c=Object.getOwnPropertySymbols,h=Object.prototype.hasOwnProperty,u=Object.prototype.propertyIsEnumerable,p=(e,t,s)=>t in e?o(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,v=(e,t)=>{for(var s in t||(t={}))h.call(t,s)&&p(e,s,t[s]);if(c)for(var s of c(t))u.call(t,s)&&p(e,s,t[s]);return e},m=(e,t)=>d(e,l(t));function g(e){if(!(e instanceof Error))try{e=new Error(String(e))}catch(t){e=new Error("Unknown error object")}return m(v({},JSON.parse(JSON.stringify(e,Object.getOwnPropertyNames(e)))),{stack:e.stack,name:e.name})}const w={gamesApp:{worldWide:72e3,default:12e4},web:{worldWide:6e4,default:6e4}};var y=s(50042);const f="screen-manager",b={ExitFullscreen:()=>({type:f,action:"exit-fullscreen"}),RequestFullscreen:()=>({type:f,action:"request-fullscreen"}),ToggleFullscreen:()=>({type:f,action:"toggle-fullscreen"}),GetState:()=>({type:f,action:"get-state"})};var A=s(69543),S=s(98589),k=s(42126),E=s(5e4),I=s(76488),R=s(17061),P=s(77901),T=s(37705),C=s(27859),L=s(41811),D=s(93298),O=s(15771),B=s(90380),x=s(89592),_=s(29008),N=Object.defineProperty,q=Object.defineProperties,M=Object.getOwnPropertyDescriptors,$=Object.getOwnPropertySymbols,F=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable,Z=(e,t,s)=>t in e?N(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,U=(e,t)=>{for(var s in t||(t={}))F.call(t,s)&&Z(e,s,t[s]);if($)for(var s of $(t))W.call(t,s)&&Z(e,s,t[s]);return e},H=(e,t)=>q(e,M(t)),z=(e,t,s)=>new Promise(((i,n)=>{var a=e=>{try{o(s.next(e))}catch(e){n(e)}},r=e=>{try{o(s.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,r);o((s=s.apply(e,t)).next())}));const G=-90,j=90,V=(0,D.M$)("Adv manager",D.XG.Adv);function Y(e){console.warn("There is no partnerID: partnerId provides only on link in console. If you opened link from console then accept agreement in admin panel"),S.Z.params({borrowParams:{advPartnerErrorData:{appId:e},errorText:"Empty partnerId"}})}function K(){const e=(0,k.Z)({url:window.location.href,removed:["a_delay"]});window.history.replaceState(null,document.title,e)}function X(){V("sendAdvClickGoal"),S.Z.reachGoal(x.Ji.ADV_CLICK,{advType:"game",sdkVersion:2})}function J(e,t){r.Z.post({type:"adv-debug-info",action:"set-debug-adv-block",data:{type:e,id:t}})}function Q(){r.Z.post({type:"adv-debug-info",action:"show-debug-info"})}function ee(e,t,s){var i;const n=null!=(i=(0,O.mn)(s,`adv-blocks:${t}`))?i:(0,O.mn)(s,"adv-blocks");if(!n||"object"!=typeof n)return function(e,t,s){var i;const n=s[`adv-block:${t}`]||s["adv-block"]||(null==(i=s["adv-exp"])?void 0:i[t]);if(!n||"object"!=typeof n)return e;if((0,T.H)({additional:{flagValue:n},message:'Deprecated "adv-block" flag'}),!n.fullscreen&&!n.fullscreen_landscape&&!n.rewarded)return(0,a.fF)(new Error(`invalid adv experiment format, expected { fullscreen?: "R-I-12345", fullscreen_landscape?: "R-I-54321", rewarded?: "R-I-54321" } (at least one property), got:', ${n}`)),e;return Object.assign({},e,H(U({},n),{desktop:n,mobile:n}))}(e,t,s);return n.desktop&&"object"==typeof n.desktop&&n.mobile&&"object"==typeof n.mobile||n.native&&"object"==typeof n.native?Object.assign({},e,n):((0,a.fF)(new Error(`Invalid "adv-blocks" experiment format:', ${n}`)),e)}function te(e){if((0,P.qo)()){const t=e.style;t.width=`${window.innerWidth}px`,t.height=`${window.innerHeight}px`}const t=.01*window.innerHeight;document.documentElement.style.setProperty("--vh",`${t}px`);const s=window.pageYOffset;return window.scroll(0,0),s}function se(){function e(){window.orientation===j?document.documentElement.style.removeProperty("--iphone-bangs-adv-padding-left"):document.documentElement.style.setProperty("--iphone-bangs-adv-padding-left","0"),window.orientation===G?document.documentElement.style.setProperty("--iphone-bangs-padding-right","1"):document.documentElement.style.setProperty("--iphone-bangs-padding-right","0")}e(),C.Z.addChangeListener(e)}function ie(){r.Z.post({type:"adv-debug-info",action:"hide-debug-info"})}function ne(e,t){const s=t.querySelector(`.${e.modalContent}`);if(s){const e=s.firstElementChild;e&&e.addEventListener("click",X,!0)}}class ae extends Error{constructor(e,t={isEmpty:!1,isFinal:!1,wasShown:!1}){super(e),this.params=t}}function re(e){try{return String(e.message||e).substring(0,100)}catch(e){}return""}function oe(e,t){return(...s)=>{try{return e(...s)}catch(e){(0,a.Ts)(e,{additional:{origError:re(e)},message:t})}}}function de(e){const{advElement:t,type:s,flags:n,appId:r,isIOS:o}=e,d=n[`no_click_${s}:${r}`]||n[`no_click_${s}`]||(o?100:0);if(!d)return;if(!t)return void(0,a.fF)(new Error("Cannot place no click overlay - advElement is null"));const l=document.createElement("div");l.className=i.kn.noClickOverlay,t.appendChild(l),setTimeout((()=>{t.removeChild(l)}),d)}function le(e,t,s){const i=(0,O.$9)(t,B.Z.newAdvInterval);if(i)return i;return!I.XK&&parseInt(e||"0",10)||((n={withWorldWideAdv:Boolean(s),isGamesApp:(0,y.VP)()}).isGamesApp?n.withWorldWideAdv?w.gamesApp.worldWide:w.gamesApp.default:n.withWorldWideAdv?w.web.worldWide:w.web.default);var n}function ce(e){if(e){const t=parseInt(e,10)||0;if(t>0)return t}const t=(0,R.V)("utm_source");if(t){if(["adv","google","yandex"].includes(t))return L.JH}return 0}function he(e){return`play-modal_view-type_${e}`}function ue(e,t){const{additional:s,error:n,name:r,tag:o}=t;(0,a.fF)(n,{prefix:`${i.yt}: `,additional:{adv:H(U({},s),{name:r,service:e.serviceName,tag:o})}})}function pe(){if(ve())return;r.Z.post({type:"play-game-header",action:"show"});const e=document.querySelector(".header-container"),t=document.querySelector(".stack"),s=document.querySelector(".menu__overlay");e&&(e.style.display=""),s&&(s.style.top=""),t&&(t.style.top="")}function ve(){return"no"===(0,R.V)("header")}function me(){r.Z.post({type:"play-game-header",action:"hide"});const e=document.querySelector(".header-container"),t=document.querySelector(".stack"),s=document.querySelector(".menu__overlay");e&&(e.style.display="none"),s&&(s.style.top="0px"),t&&(t.style.top="0px")}function ge(e){return`${i.kn.modal}_${e}`}function we(e,t,s){var i;const a=null!=(i=t.getTimeoutExtraTime(n.QA.ServiceInit,s))?i:0;let r=(0,O.$9)(e,B.Z.adScriptInitTimeout)||3500+a;const o=(0,O.$9)(e,`adv_${t.serviceName}_init_timeout`);return void 0!==o&&(r=o+a,a&&V(`Note: Service ${t.serviceName} added extra init timeout: ${a} (total: ${r})`)),r}function ye(e,t,s,a){var r;const o=null!=(r=s.getTimeoutExtraTime(t===E.$.INTERSTITIAL?n.QA.ShowFullscreen:n.QA.ShowRewarded,a))?r:0;let d=(t===E.$.INTERSTITIAL?i.hL:i.UG)+o;const l=(0,O.$9)(e,`adv_${s.serviceName}_show_timeout`);return void 0!==l&&(d=l+o,o&&V(`Note: Service ${s.serviceName} added extra showAdv timeout: ${o} (total: ${d})`)),d}function fe(e){r.Z.postToChild(e),r.Z.post(H(U({},e),{action:`debug-action-${e.action}`}))}function be(e,t){(0,O.bF)(t)&&e.addCallbacks({onOpen:()=>{V("hide sticky banner"),r.Z.post({type:"sticky-banner",action:"hide",data:{reason:"blur"}})},onClose:()=>{V("show sticky banner"),r.Z.post({type:"sticky-banner",action:"show",data:{reason:"blur"}})}})}function Ae(e,t,s){return z(this,null,(function*(){if(t!==E.$.REWARDED)return;const i=(0,_.AK)(s);if(!i.isAndroid||i.isStandalone)return;const n=yield r.Z.post(b.GetState()),{screenOrientationWasLocked:a}=n.data;if(a)return;const o=()=>{C.Z.unlock().catch((()=>{}))};e.addCallbacks({onOpen:()=>{C.Z.lock().catch((()=>{}))},onClose:o,onError:o})}))}function Se(e,t){switch(t){case E.$.INTERSTITIAL:e.addCallbacks({onOpen:()=>fe(A.fB.AdvCallbackOpen()),onClose:e=>r.Z.postToChild(A.fB.AdvCallbackClose({wasShown:e})),onError:e=>fe(A.fB.AdvCallbackError({fromMethod:"showFullScreenAdv",error:g(e)})),onOffline:()=>fe(A.fB.AdvCallbackOffline())});break;case E.$.REWARDED:e.addCallbacks({onOpen:()=>fe(A.fB.RewardedVideoCallbackOpen()),onRewarded:()=>fe(A.fB.RewardedVideoCallbackRewarded()),onClose:()=>fe(A.fB.RewardedVideoCallbackClose()),onError:e=>fe(A.fB.RewardedVideoCallbackError({error:g(e),fromMethod:"onError"}))})}}},90268:(e,t,s)=>{"use strict";s.d(t,{Z:()=>ha});var i=s(63904),n=s.n(i),a=s(87363),r=s.n(a),o=s(45331),d=s(43548);const l=n().with("adv-debug-info");let c="",h="";class u extends o.P{constructor(e){super(e),this.switchDebugInfo=()=>{var e,t;const{isOverlayVisible:s}=this.state,{appId:i}=this.props;if(this.setState((e=>({isOverlayVisible:!e.isOverlayVisible}))),s)return;const n=[`ÐÐµÑÑÐ¸Ñ SDK: ${window.appData.version}`,`Ð ÐµÐºÐ»Ð°Ð¼Ð°: ${c} - ${h}`,`Ð­ÐºÑÐ¿ÐµÑÐ¸Ð¼ÐµÐ½ÑÑ: ${JSON.stringify(window.appData.abt.flags,null,2)}`,`UserAgent: ${navigator.userAgent}`,`AppID: ${i}`],a=`https://forms.yandex-team.ru/surveys/73978/?${[`answer_short_text_644835=${encodeURIComponent("ÐÑÐ¾Ð±Ð»ÐµÐ¼Ð° Ñ ÑÐµÐºÐ»Ð°Ð¼Ð¾Ð¹")}`,`answer_long_text_644836=${encodeURIComponent("\n\n===== Ð¾ÑÐ»Ð°Ð´Ð¾ÑÐ½Ð°Ñ Ð¸Ð½ÑÐ¾ÑÐ¼Ð°ÑÐ¸Ñ:\n"+n.join("\n"))}`].join("&")}`,r=()=>{var e;const t="ÐÐ¾Ð³Ð¸ Ð¼ÐµÑÑÐ¸ÐºÐ¸:\n\n"+(null==(e=window.metrikaLogs)?void 0:e.data.map((e=>`${e.type}${e.goal?` ${e.goal}`:""} - ${JSON.stringify(e.data)}`)).slice().reverse().join("\n\n"))||0;this.setState({metrikaLogsText:t}),navigator.clipboard.writeText(n.join("\n")+"\n\n"+t)};r(),window.metrikaLogs.onUpdate=r,null==(t=null==(e=null==window?void 0:window.Ya)?void 0:e.Rum)||t.logEventString("adv","butterfly manual report",{additional:n}),this.setState({logs:n,linkHref:a})},this.state={isVisible:!1,isOverlayVisible:!1,linkHref:"",logs:[],metrikaLogsText:""}}componentDidMount(){this.initMessaging()}initMessaging(){d.Z.onInternalMessage("adv-debug-info",(e=>{const{action:t}=e.data;switch(t){case"show-debug-info":this.setState({isVisible:!0});break;case"hide-debug-info":this.hide();break;case"set-debug-adv-block":c=e.data.data.type,h=e.data.data.id}}))}hide(){window.metrikaLogs.onUpdate=void 0,this.setState({isVisible:!1})}render(){const{logs:e,metrikaLogsText:t,isVisible:s,isOverlayVisible:i,linkHref:n}=this.state,{isDevFeaturesEnabled:a}=this.props;return a&&s?r().createElement("div",{className:l()},r().createElement("button",{className:l("button"),onClick:this.switchDebugInfo},"ð"),i&&r().createElement("div",{className:l("overlay"),onClick:this.switchDebugInfo},r().createElement("div",{className:l("clipboard-notice")},"ÐÐ°Ð½Ð½ÑÐµ ÑÐºÐ¾Ð¿Ð¸ÑÐ¾Ð²Ð°Ð½Ñ Ð² Ð±ÑÑÐµÑ Ð¾Ð±Ð¼ÐµÐ½Ð°"),r().createElement("div",{className:l("data")},e.join("\n")),r().createElement("a",{href:n,target:"_blank"},"Ð¢Ð¸ÐºÐµÑ Ð² StarTrek"),r().createElement("div",{className:l("metrika-logs")},t))):null}}const p=u;var v=s(14408),m=s(38096),g=s(26108),w=s(34235),y=s(99572),f=s(47802),b=s(5e4);const A=["onOpen","onRewarded","onClose","onError","onOffline"];const S=class{constructor(e,t){this.tag=e,this.clickDaemon=t,this.callbacks={},this.isOuterCallbacksMuted=!1,this.onOpen=(e=!0)=>{var t;e&&(null==(t=this.clickDaemon)||t.show()),this.safeCall("onOpen")},this.onRewarded=()=>{var e;null==(e=this.clickDaemon)||e.rewarded(),this.safeCall("onRewarded")},this.onClose=e=>{var t;e&&this.currentTag!==this.tag&&this.currentTag===b.$.INTERSTITIAL&&this.onRewarded(),null==(t=this.clickDaemon)||t.close(),this.safeCall("onClose",void 0,e)},this.onOffline=()=>{this.safeCall("onOffline")},this.onError=e=>{this.safeCall("onError",!1,e)};for(const e of A)this.callbacks[e]||(this.callbacks[e]=[]);this.currentTag=e}safeCall(e,t=!0,...s){if(this.isOuterCallbacksMuted)return void(0,f.qu)(`AdvCallbacks ${e} call skipped, due mute during waterfall.`);const i=this.callbacks[e];if(i)for(let n=0;n<i.length;n++){(0,f.tq)(i[n],`Error in callback ${e}: `).apply(null,s),t&&i.splice(n--,1)}}addCallbacks(e,t=!1){for(const s in e)t&&["onOpen","onRewarded"].includes(s)&&!this.callbacks[s].length?(0,f.tq)(e[s],`Error in callback ${s}`).apply(null):this.callbacks[s].push(e[s])}muteCallbacks(){this.isOuterCallbacksMuted=!0}unmuteCallbacks(){this.isOuterCallbacksMuted=!1}};var k=s(23404),E=s(35090),I=s(40656);const R=I.yR;class P{constructor(){this.setupCanShowAdv()}setupCanShowAdv(){this.canShowAdv=()=>!0,(0,E.FN)()&&(this.canShowAdv=()=>(console.warn(`Warning: please, try to open advertising after ${R}ms`),!1),window.setTimeout((()=>{this.canShowAdv=()=>!0}),R))}}var T=s(54814),C=s(60295);class L{constructor(e,t,s){this.advManager=e,this.options=t,this.serviceName=s,this.initPromise=new g.Z,this.initTime=Date.now(),this.lastAdReqId={[b.$.INTERSTITIAL]:"",[b.$.REWARDED]:""}}getLastAdReqId(e){return this.lastAdReqId[e]}getAdvBlockId(e,t){return"invalid_block"}isTagActive(e){return this.options.tags[e]!==T.pP.Skip}isTagWaterfall(e){return this.options.tags[e]!==T.pP.Onspot}onServiceLoaded(){this.initPromise.resolve(),(0,C.s4)("play_adv_service_init",Date.now()-this.initTime,!0,{"-additional":encodeURIComponent(JSON.stringify({advtype:this.serviceName,options:this.options}))})}onServiceError(e){let t=null!=e?e:new Error("Service not initialized: Unhandled undefined error (safe)");e instanceof Error&&(e.message=`Service not initialized: ${e.message}`),(0,f.g5)(this,{error:t,additional:{error:e}}),this.initPromise.reject(t)}getTimeoutExtraTime(e,t){}checkCanShow(e,t){return T.Kc.Ok}get hasFullscreenAdv(){var e;return null==(e=this.advManager.advUsedBlocks.fullscreen)||e}get hasRewarderdAdv(){var e;return null==(e=this.advManager.advUsedBlocks.rewarded)||e}showRewardedVideo(e){return Promise.reject()}cancelShow(e){}}var D=s(65015),O=s(97553),B=s(65068),x=s(79049),_=(e,t,s)=>new Promise(((i,n)=>{var a=e=>{try{o(s.next(e))}catch(e){n(e)}},r=e=>{try{o(s.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,r);o((s=s.apply(e,t)).next())}));var N=s(93298);const q=(0,N.M$)("GoogleManual",N.XG.Adv,{background:"#0c6c09"});var M=s(87210),$=s(97733),F=(e,t,s)=>new Promise(((i,n)=>{var a=e=>{try{o(s.next(e))}catch(e){n(e)}},r=e=>{try{o(s.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,r);o((s=s.apply(e,t)).next())}));class W{constructor(e){this.service=e,this.waitForSlotReady=void 0,this.gptCallbacks={},(0,M.bT)((e=>{const t=e.pubads();["slotRenderEnded","gameManualInterstitialSlotReady","gameManualInterstitialSlotClosed"].forEach((e=>{t.addEventListener(e,(t=>{var s,i;t.slot===this.slot&&(null==(i=(s=this.gptCallbacks)[e])||i.call(s,t))}))}))}))}defineSlot(){return F(this,null,(function*(){return(0,M.bT)((e=>{const t=e.defineOutOfPageSlot(this.service.getAdvBlockId(b.$.INTERSTITIAL),e.enums.OutOfPageFormat.GAME_MANUAL_INTERSTITIAL);if(!t)throw new Error("Failed to create googletag.Slot.");return t.addService(e.pubads()),this.slot=t,e.enableServices(),t}))}))}preload(){return F(this,arguments,(function*({reason:e=O.p_.PRELOAD,depth:t,clickDaemon:s}={}){if(this.waitForSlotReady)return this.waitForSlotReady.promise;q.spoiler(this)("Preload interstitial slot");const i=new g.Z;try{this.waitForSlotReady=i,s||(s=this.service.advManager.alternateLogs?new $.U({app_id:this.service.advManager.appId,tag:b.$.INTERSTITIAL}):this.service.advManager.getClickdaemonAdvLog(b.$.INTERSTITIAL));let n="";s instanceof B.i?n=null==s?void 0:s.request({advtype:this.service.serviceName,advBlockId:this.service.getAdvBlockId(b.$.INTERSTITIAL),reason:e}):null==s||s.request({provider:this.service.serviceName,advBlockId:this.service.getAdvBlockId(b.$.INTERSTITIAL),reason:e}),this.slot&&googletag.destroySlots([this.slot]),this.slot=yield this.defineSlot(),this.gptCallbacks.slotRenderEnded=e=>{if(e.isEmpty)return s instanceof B.i?null==s||s.response({adReqId:n,depth:t,reason:O.Ud.EMPTY}):null==s||s.responseEmpty(),i.resolve({isEmpty:!0,adReqId:n,clickDaemon:s}),void delete this.waitForSlotReady;s instanceof B.i?s.response({adReqId:n,depth:t,reason:O.Ud.SUCCESS}):null==s||s.response()};const a=new g.Z;this.gptCallbacks.gameManualInterstitialSlotReady=e=>{const{makeGameManualInterstitialVisible:t}=e;i.resolve({isEmpty:!1,adReqId:n,clickDaemon:s,waitForShow:()=>(t(),delete this.waitForSlotReady,a.promise)})},this.gptCallbacks.gameManualInterstitialSlotClosed=()=>{a.resolve()},googletag.pubads().refresh([this.slot])}catch(e){(0,f.g5)(this.service,{error:e})}return i.promise}))}show(){return F(this,null,(function*(){}))}cancel(){var e,t;q("Cancel preload promise"),null==(e=this.waitForSlotReady)||e.resolve({adReqId:"rejected",isEmpty:!1}),delete this.waitForSlotReady,this.slot&&(null==(t=googletag.destroySlots)||t.call(googletag,[this.slot]))}}var Z=s(78308),U=s(59886),H=s(37705),z=s(13377),G=(e,t,s)=>new Promise(((i,n)=>{var a=e=>{try{o(s.next(e))}catch(e){n(e)}},r=e=>{try{o(s.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,r);o((s=s.apply(e,t)).next())}));var j=s(36529),V=s(15771),Y=s(90380);var K=s(17254),X=s(50042),J=s(41811),Q=(e,t,s)=>new Promise(((i,n)=>{var a=e=>{try{o(s.next(e))}catch(e){n(e)}},r=e=>{try{o(s.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,r);o((s=s.apply(e,t)).next())}));const ee={[J.y_.YANDEX]:{fullscreenBlockFlag:Y.Z.nativeFullscreenBlock,rewardedBlockFlag:Y.Z.nativeRewardedBlock},[J.y_.APPODEAL]:{fullscreenBlockFlag:Y.Z.nativeAppodealFullscreenBlock,rewardedBlockFlag:Y.Z.nativeAppodealRewardedBlock},[J.y_.APPLOVIN]:{fullscreenBlockFlag:Y.Z.nativeApplovinFullscreenBlock,rewardedBlockFlag:Y.Z.nativeApplovinRewardedBlock},[J.y_.DEFAULT]:{fullscreenBlockFlag:Y.Z.nativeFullscreenBlock,rewardedBlockFlag:Y.Z.nativeRewardedBlock}};function te(e){return Q(this,arguments,(function*({advBlocks:e,flags:t,residenceInfo:s}){var i,n,a,r;let o=J.y_.DEFAULT,d=String(e.native_interstitial||""),l=String(e.native_rewarded||"");if(!Boolean(null==s?void 0:s.EU)){if((0,X.zg)("22.1.2.848")&&(o=(0,V.di)(t,Y.Z.mediation)||o,d=(0,V.di)(t,Y.Z.nativeFullscreenBlock)||d,l=(0,V.di)(t,Y.Z.nativeRewardedBlock)||l,(0,V.sE)(t))){const e=null!=(a=yield null==(n=null==(i=window.yandex)?void 0:i.ads)?void 0:n.getLibraries())?a:[];o=1===e.length?e[0].name:J.y_.DEFAULT;const s=ee[o];d=(0,V.di)(t,s.fullscreenBlockFlag)||d,l=(0,V.di)(t,s.rewardedBlockFlag)||l}(null==(r=window.clientMetadata)?void 0:r.isOnlyRsyaAd)&&(d=String(e.native_rsya_interstitial||""),l=String(e.native_rsya_rewarded||""),o=J.y_.DEFAULT)}return{mediation:o,fullscreenBlock:d,rewardedBlock:l}}))}const se="0",ie="R-V-5320861-1",ne="R-V-5356156-1";const ae=e=>e.split("-V-")[1].split("-")[0];function re(e,t){return"string"==typeof e&&/R-V-[0-9]+-[0-9]/.test(e)?ae(e):(console.info(`[Native adv TV] Using fallback block ${t}`),ae(t))}var oe=(e,t,s)=>new Promise(((i,n)=>{var a=e=>{try{o(s.next(e))}catch(e){n(e)}},r=e=>{try{o(s.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,r);o((s=s.apply(e,t)).next())}));const de=(0,N.M$)("NativeAdv",N.XG.Adv);function le(e){setTimeout((()=>function(e){return oe(this,arguments,(function*({advBlocks:e,flags:t,residenceInfo:s}){var i;const{mediation:n,fullscreenBlock:a}=yield te({advBlocks:e,flags:t,residenceInfo:s}),r=new B.i({tag:b.$.INTERSTITIAL});de(`Preload. mediation = ${n}, fullscreen = ${a}`);const o=r.request({advBlockId:a,advtype:b.e.Native,reason:O.p_.PRELOAD});try{window.sessionStorage.setItem(J.az,JSON.stringify(r.getRequestByAdReqId(o)))}catch(e){}const d=null==(i=window.yandex)?void 0:i.ads,l=()=>{r.response({adReqId:o,reason:O.Ud.NOT_IMPL})};let c;if((0,K.x)()){const e=re((0,V.Qx)(t)?a:void 0,ie);if(!d||!d.preloadInstreamAdv)return void l();c=d.preloadInstreamAdv(e,se)}else{if(!d||!d.preloadFullscreenAdv)return void l();c=d.preloadFullscreenAdv(a,n)}c.then((()=>{r.response({adReqId:o,reason:O.Ud.SUCCESS})})).catch((e=>{r.response({adReqId:o,reason:`${O.Ud.ERROR}_${e.message}`}),console.error(e)}))}))}(e)),3e3)}var ce=s(34711),he=s(7991),ue=Object.defineProperty,pe=Object.getOwnPropertySymbols,ve=Object.prototype.hasOwnProperty,me=Object.prototype.propertyIsEnumerable,ge=(e,t,s)=>t in e?ue(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,we=(e,t,s)=>new Promise(((i,n)=>{var a=e=>{try{o(s.next(e))}catch(e){n(e)}},r=e=>{try{o(s.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,r);o((s=s.apply(e,t)).next())}));const ye=[];function fe(e,t){return new Promise(((s,i)=>{ye.push({type:e,operation:t,resolve:s,reject:i}),1===ye.length&&function(){we(this,null,(function*(){for(;ye.length>0;){const{operation:e,resolve:t,reject:s}=ye[0];try{t(yield e())}catch(e){s(e)}ye.splice(0,1)}}))}()}))}function be(e){let t;function s(){if(!t){const s=(0,he.W5)();t=JSON.stringify(((e,t)=>{for(var s in t||(t={}))ve.call(t,s)&&ge(e,s,t[s]);if(pe)for(var s of pe(t))me.call(t,s)&&ge(e,s,t[s]);return e})({app_id:e.appId,clid:(0,ce.X)()},s?{gclid:s}:{}))}return t}const i=window.appData.isGamesLiteApp;let n=null;function a(){return we(this,null,(function*(){return null===n&&(n=yield te({advBlocks:e.advBlocks,flags:e.flags,residenceInfo:e.residenceInfo})),n}))}return{getFullscreenBlockId(){return we(this,null,(function*(){const{fullscreenBlock:e}=yield a();return e}))},getRewardedBlockId(){return we(this,null,(function*(){const{rewardedBlock:e}=yield a();return e}))},preloadFullscreenAdv(){return we(this,null,(function*(){const{mediation:e,fullscreenBlock:t}=yield a();if(console.info("[Native adv] preload",e,"fullscreen ad:",t),!t)return Promise.reject(new Error("No fullscreen block for preload"));const s=()=>{var s,i,n;return null==(n=null==(i=null==(s=window.yandex)?void 0:s.ads)?void 0:i.preloadFullscreenAdv)?void 0:n.call(i,t,e)};return i?s():fe("preload",s)}))},preloadRewardedVideo(){return we(this,null,(function*(){const{mediation:e,rewardedBlock:t}=yield a();if(console.info("[Native adv] preload",e,"rewarded video:",t),!t)return Promise.reject(new Error("No rewarded block for preload"));const s=()=>{var s,i,n;return null==(n=null==(i=null==(s=window.yandex)?void 0:s.ads)?void 0:i.preloadRewardedVideo)?void 0:n.call(i,t,e)};return i?s():fe("preload",s)}))},showFullscreenAdv(e){return we(this,arguments,(function*({onShowCalled:e}){const{mediation:t,fullscreenBlock:n}=yield a(),r=s();if(console.info("[Native adv] show",t,"fullscreen ad:",n,r),!n)return Promise.reject(new Error("No fullscreen block for show"));const o=()=>{var s,i,a,o,d;return(null==(i=null==(s=window.yandex)?void 0:s.ads)?void 0:i.showFullscreenAdv)&&e(),null==(d=null==(o=null==(a=window.yandex)?void 0:a.ads)?void 0:o.showFullscreenAdv)?void 0:d.call(o,n,t,{revenueData:r})};return i?o():fe("show",o)}))},showRewardedVideo(e){return we(this,arguments,(function*({onShowCalled:e}){const{mediation:t,rewardedBlock:n}=yield a(),r=s();if(console.info("[Native adv] show",t,"rewarded video:",n,r),!n)return Promise.reject(new Error("No rewarded block for show"));const o=()=>{var s,i,a,o,d;return(null==(i=null==(s=window.yandex)?void 0:s.ads)?void 0:i.showRewardedVideo)&&e(),null==(d=null==(o=null==(a=window.yandex)?void 0:a.ads)?void 0:o.showRewardedVideo)?void 0:d.call(o,n,t,{revenueData:r})};return i?o():fe("show",o)}))}}}var Ae=(e,t,s)=>new Promise(((i,n)=>{var a=e=>{try{o(s.next(e))}catch(e){n(e)}},r=e=>{try{o(s.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,r);o((s=s.apply(e,t)).next())}));var Se=(e,t,s)=>new Promise(((i,n)=>{var a=e=>{try{o(s.next(e))}catch(e){n(e)}},r=e=>{try{o(s.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,r);o((s=s.apply(e,t)).next())}));const ke="Ad request completed successfully, but there are no ads available",Ee=3*I.WT,Ie=3*I.WT;var Re=(e,t,s)=>new Promise(((i,n)=>{var a=e=>{try{o(s.next(e))}catch(e){n(e)}},r=e=>{try{o(s.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,r);o((s=s.apply(e,t)).next())}));const Pe=(0,N.M$)("AdvPromo",void 0,{background:"#0c6c09"});class Te extends L{constructor(e,t,s=b.e.Promo){super(e,t,s),this.lang=e.context.playPageData.request.lang,this.onServiceLoaded()}getAdvBlockId(e,t){return"onboarding_promo"}checkCanShow(e,t){return super.checkCanShow(e,t)}showFullscreenAdv(e){return Re(this,arguments,(function*({callbacks:e,clickDaemon:t,adSeqId:s,reason:i,depth:n}){return new Promise(((a,r)=>Re(this,null,(function*(){Pe.spoiler(i,n)("showFullscreenAdv",e);const o=this.lastAdReqId[b.$.INTERSTITIAL]=t instanceof B.i?t.request({advtype:this.serviceName,depth:n,advBlockId:this.getAdvBlockId(b.$.INTERSTITIAL,i),reason:i}):"";t instanceof $.U&&t.request(),d.Z.post({type:"adv-promo-block",action:"show",data:{advTag:b.$.INTERSTITIAL,reason:i,onError:e=>{"Promo chunk wasnt loaded"===e.message?(t instanceof B.i?t.error(o,s,e.message):t.error(e.message),a()):r(new Error(`PromoBlock error ${e.message}`))},onOpen:()=>{t.response({adReqId:o,depth:n,reason:O.Ud.SUCCESS}),t instanceof B.i&&t.show(o,s),e.onOpen(),a()},onClose:()=>{t instanceof B.i&&t.close(o,s),e.onClose()}}})}))))}))}showRewardedVideo(e){return Re(this,arguments,(function*({callbacks:e,clickDaemon:t,adSeqId:s,reason:i,depth:n}){return new Promise(((a,r)=>Re(this,null,(function*(){Pe("showRewardedVideo",e);const o=this.lastAdReqId[b.$.REWARDED]=t instanceof B.i?t.request({advtype:this.serviceName,depth:n,advBlockId:this.getAdvBlockId(b.$.REWARDED,i),reason:i}):"";t instanceof $.U&&t.request(),d.Z.post({type:"adv-promo-block",action:"show",data:{advTag:b.$.REWARDED,onError:e=>{r(new Error(`PromoBlock error ${e.message}`))},onOpen:()=>{t.response({adReqId:o,depth:n,reason:O.Ud.SUCCESS}),t instanceof B.i&&t.show(o,s),e.onOpen(),a()},onRewarded:()=>{t instanceof B.i&&t.rewarded(o,s),e.onRewarded()},onClose:()=>{t instanceof B.i&&t.close(o,s),e.onClose()}}})}))))}))}}var Ce=s(48810);const Le="count_of_user_visits";function De(){return!(0,Ce.dq)(Le).wasError}var Oe=s(82027),Be=s(31261),xe=s(4915),_e=s(31085),Ne=s(39449);const qe=1,Me=1,$e=5;function Fe(e){return!(e||(0,X.VP)()||(0,Oe.PK)()||!De()||function(){let e,t=(0,Ce.dq)(Le);return De()?(t.value&&(e=Number(t.value)),(!e||e<0)&&(e=0),e):0}()>=$e||!(0,Be.uP)())}function We(){if((0,E.Oo)()||!Fe(null==(e=window.YandexGamesSDK)?void 0:e.game.info.hasWebAppsCategory))return!1;var e;return(new xe.Z).checkShowCapability(_e.Wp.GamePromo,{waitingPeriod:qe*Ne.E$,maxShowCount:Me,considerInstallation:!0})}const Ze="GameEvents";class Ue{constructor(){this.listeners=[],window.addEventListener("message",(e=>{e.data.source===Ze&&this.processEvent(e)}))}addListener(e){return this.listeners.push(e),()=>{this.removeListener(e)}}removeListener(e){this.listeners=this.listeners.filter((t=>t!==e))}processEvent(e){const{responseToId:t}=e.data;for(let s of this.listeners)if(!s.messageId||s.messageId===t){s.fn(e.data)&&this.removeListener(s)}}}function He({action:e,payload:t,responseToId:s,type:i}){const n=`${Date.now()}-${Math.random()}`;return window.parent.postMessage({action:e,id:n,payload:t,responseToId:s,source:Ze,type:i,ver:1},"*"),n}var ze=(e,t,s)=>new Promise(((i,n)=>{var a=e=>{try{o(s.next(e))}catch(e){n(e)}},r=e=>{try{o(s.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,r);o((s=s.apply(e,t)).next())}));const Ge=(0,N.M$)("AdvParentWindow",void 0,{background:"#0c6c09"});var je=s(10131),Ve=s(9878),Ye=s(14375),Ke=s(40184),Xe=s(85467),Je=s(94671),Qe=s(96952),et=s(909);const tt="FullscreenBlock-module__container--suKYF",st="FullscreenBlock-module__hidden--FjMwl",it="FullscreenBlock-module__touchControls--FJKug",nt="FullscreenBlock-module__spinner--ZgJZq",at="FullscreenBlock-module__desktopClose--vu832",rt="FullscreenBlock-module__block--rJxBU",ot="FullscreenBlock-module__placeholder--hKxU_";var dt=Object.defineProperty,lt=Object.defineProperties,ct=Object.getOwnPropertyDescriptors,ht=Object.getOwnPropertySymbols,ut=Object.prototype.hasOwnProperty,pt=Object.prototype.propertyIsEnumerable,vt=(e,t,s)=>t in e?dt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,mt=(e,t)=>{for(var s in t||(t={}))ut.call(t,s)&&vt(e,s,t[s]);if(ht)for(var s of ht(t))pt.call(t,s)&&vt(e,s,t[s]);return e},gt=(e,t)=>lt(e,ct(t));const wt="fullscreenBlock_container";function yt(e){return`${wt}_${e}`}const ft=({advManager:e})=>{const t=(0,Xe.T)(),{abt:{flags:s}}=(0,Ke.b)(),i=(0,a.useMemo)((()=>({usePlaceholder:(0,V.Sf)(s),useLoader:(0,V.Z0)(s),controlsDelay:(0,V.sQ)(s)})),[s]),n=(0,a.useRef)([]),o=(0,a.useRef)(null),[l,c]=(0,a.useState)({isVisible:!1,showControls:!1,isHeaderEnabled:!(0,f.Ij)(),callbacks:{},visibleChange:!1}),[h,u]=(0,a.useState)([wt]),[p,v]=(0,a.useState)(h[0]),m=(0,a.useCallback)((()=>{c((e=>gt(mt({},e),{isVisible:!1,callbacks:{}})))}),[]),g=(0,a.useCallback)((()=>{var e,t;(0,Ye.D)(),null==(t=(e=l.callbacks).onClose)||t.call(e),m()}),[m,l.callbacks]),w=(0,a.useCallback)((e=>{"Escape"===e.key&&l.isVisible&&(0,Qe.D)((()=>{g()}))}),[l.isVisible,g]),y=(0,a.useCallback)(((e,t)=>{const{action:s,data:i}=e.data;switch(s){case"show":{const{onOpen:e,onClose:s}=i;c((t=>gt(mt({},t),{isVisible:!0,visibleChange:!0,showControls:!1,callbacks:{onOpen:e,onClose:s}}))),t();break}case"show-block":{const{blockName:e}=i;v((()=>(t(),yt(e))));break}case"hide":const{blockName:e}=null!=i?i:{};if(e&&p!==yt(e))break;m();break;case"add-block":{const{blockName:e}=i,s=yt(e);if(h.includes(s))return void t();u((e=>(n.current.push(t),[...e,s])));break}case"show-controls":c((e=>gt(mt({},e),{showControls:!0})));break;case"is-visible":t({data:{isVisible:l.isVisible}})}}),[h,p,m,l.isVisible]);(0,a.useEffect)((()=>(window.addEventListener("keydown",w),d.Z.onInternalMessage("adv-fullscreen-block",y),()=>{window.removeEventListener("keydown",w),d.Z.offInternalMessage("adv-fullscreen-block",y),o.current&&clearTimeout(o.current)})),[w,y]),(0,a.useEffect)((()=>{var e,t;l.isVisible&&l.visibleChange&&(null==(t=(e=l.callbacks).onOpen)||t.call(e),i.controlsDelay<1||(c(gt(mt({},l),{showControls:!1,visibleChange:!1})),o.current=window.setTimeout((()=>{c((e=>gt(mt({},e),{showControls:!0})))}),i.controlsDelay)))}),[i.controlsDelay,l]),(0,a.useEffect)((()=>{n.current.length&&(n.current.forEach((e=>{e()})),n.current.length=0)}),[h]);const b=(0,a.useCallback)((()=>{(0,Qe.D)((()=>{g()}))}),[g]),A=(0,a.useCallback)((()=>{(0,et.Z)()}),[]),S=e.isDisableAdButtonEnabled,k=0===i.controlsDelay||l.showControls;return r().createElement("div",{className:(0,Je.E)(tt,void 0,l.isVisible?"visible":st),"data-testid":"adv-fullscreen-container"},r().createElement("div",null,r().createElement("div",{className:(0,Je.E)(at,k?void 0:st),"data-testid":"adv-fullscreen-closeButton",onClick:b}),i.useLoader&&r().createElement(Ve.y,{className:(0,Je.E)(nt,k?st:void 0),key:"landscape-spinner",position:"center",size:32,spinning:!0,view:"default"}),h.map((e=>r().createElement("div",{className:(0,Je.E)(rt,i.usePlaceholder?ot:void 0,p===e?void 0:st),key:e},r().createElement("div",{id:e}))))),S?r().createElement("div",{className:(0,Je.E)(it,k?void 0:st)},S&&r().createElement(je.z,{className:"","data-testid":"adv-fullscreen-closeButton",size:40,view:"secondary",onClick:A},t("header.popup.disable.ads")),r().createElement(je.z,{className:"","data-testid":"adv-fullscreen-closeButton",size:40,view:"primary",onClick:b},t("adv.close"))):null)};function bt(){const e=document.querySelector(`#${wt}`);e&&(e.innerText="")}const At=(0,N.M$)("AdvPrebidTGO",N.XG.Adv,{background:"#0c6c09"});var St=s(25562),kt=(e,t,s)=>new Promise(((i,n)=>{var a=e=>{try{o(s.next(e))}catch(e){n(e)}},r=e=>{try{o(s.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,r);o((s=s.apply(e,t)).next())}));class Et{constructor(e){var t,s;this.service=e,this.waitForSlotReady=void 0,this.retries=0,this.waitForSlotViewable=void 0,this.retries=(t=e.advManager.flags,null!=(s=(0,V.$9)(t,Y.Z.advGoogleInterstitialRetries))?s:2),(0,M.bT)((e=>{e.pubads().addEventListener("slotRenderEnded",(e=>{var t;e.slot===this.slot&&(null==(t=this.onSlotRenderEnded)||t.call(this,e))})).addEventListener("impressionViewable",(e=>{var t;e.slot===this.slot&&(null==(t=this.onImpressionViewable)||t.call(this,e))}))}))}defineSlot(e){return(0,M.bT)((t=>{const s=t.defineSlot(this.service.getAdvBlockId(b.$.INTERSTITIAL,e),(0,St._7)(!0),yt(this.service.serviceName));if(!s)throw new Error(U.XO.NO_SLOT);return s.addService(t.pubads()),s.retry=0,t.enableServices(),s}))}preload(e){return kt(this,arguments,(function*({reason:e=O.p_.PRELOAD,depth:t,clickDaemon:s,beforeRequest:i}){let n=this.retries;if(void 0!==t&&(this.waitForSlotReady&&this.slot&&(At.tag("Retry")("Skip retry, due showAdv call"),this.slot.retry=1/0),n=0),this.waitForSlotReady)return this.waitForSlotReady.promise;void 0===t&&(t=0),At.spoiler(this)("Preload interstitial slot");const a=new g.Z;this.waitForSlotReady=a;const r=new g.Z;this.waitForSlotViewable=r,this.slot?this.slot.retry=0:(yield d.Z.post({type:"adv-fullscreen-block",action:"add-block",data:{blockName:this.service.serviceName},timeout:I.WT}),this.slot=yield this.defineSlot(e)),i&&(yield i()),s||(s=this.service.advManager.alternateLogs?new $.U({app_id:this.service.advManager.appId,tag:b.$.INTERSTITIAL}):this.service.advManager.getClickdaemonAdvLog(b.$.INTERSTITIAL));let o="";return s instanceof B.i?o=s.request({advtype:this.service.serviceName,advBlockId:this.service.getAdvBlockId(b.$.INTERSTITIAL,e),reason:e}):s&&s.request({provider:this.service.serviceName,advBlockId:this.service.getAdvBlockId(b.$.INTERSTITIAL,e),reason:e}),this.onSlotRenderEnded=i=>{if(a.state===g.C.Pending)if(i.isEmpty){if(s instanceof B.i?null==s||s.response({adReqId:o,depth:t,reason:O.Ud.EMPTY}):null==s||s.responseEmpty(),i.slot.retry<n)return At.tag("Retry")(`Retrying request, ${i.slot.retry+1} of ${this.retries}`),s instanceof B.i?o=s.request({advtype:this.service.serviceName,advBlockId:this.service.getAdvBlockId(b.$.INTERSTITIAL,e),reason:e}):null==s||s.request({provider:this.service.serviceName,advBlockId:this.service.getAdvBlockId(b.$.INTERSTITIAL,e),reason:e}),i.slot.retry++,void googletag.pubads().refresh([this.slot]);a.resolve({isEmpty:!0,adReqId:o,clickDaemon:s}),delete this.waitForSlotReady,delete this.waitForSlotViewable}else null==s||s.response({adReqId:o,depth:t,reason:O.Ud.SUCCESS}),a.resolve({isEmpty:!1,adReqId:o,clickDaemon:s});else At("Ignore slot response, preload canceled.")},this.onImpressionViewable=()=>{r.resolve()},googletag.pubads().refresh([this.slot]),this.waitForSlotReady.promise}))}show(){return kt(this,null,(function*(){if(!this.waitForSlotViewable)throw new Error("Call Preload.show() before preload()");At.spoiler(this)("Show interstitial slot"),yield d.Z.post({type:"adv-fullscreen-block",action:"show-block",data:{blockName:this.service.serviceName}}),yield this.waitForSlotViewable.promise,delete this.waitForSlotReady,delete this.waitForSlotViewable}))}cancel(){var e,t;At("Cancel preload promises"),null==(e=this.waitForSlotReady)||e.resolve({adReqId:"rejected",isEmpty:!1,clickDaemon:null}),null==(t=this.waitForSlotViewable)||t.resolve(),delete this.waitForSlotReady,delete this.waitForSlotViewable}}var It=s(27859),Rt=(e,t,s)=>new Promise(((i,n)=>{var a=e=>{try{o(s.next(e))}catch(e){n(e)}},r=e=>{try{o(s.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,r);o((s=s.apply(e,t)).next())}));const Pt={slotRenderEnded:"onSlotRenderEnded",rewardedSlotReady:"onRewardedSlotReady",rewardedSlotGranted:"onRewardedSlotGranted",rewardedSlotClosed:"onRewardedSlotClosed"};class Tt{constructor(e){var t,s;this.service=e,this.slot=void 0,this.waitForSlotReady=void 0,this.retries=(t=this.service.advManager.flags,null!=(s=(0,V.$9)(t,Y.Z.advGoogleRewardedRetries))?s:0),(0,M.bT)((()=>{const e=googletag.pubads();for(const t in Pt)e.addEventListener(t,(e=>{var s;const{slot:i}=e;i===this.slot&&(null==(s=this[Pt[t]])||s.call(this,e))}))})),It.Z.addChangeListener((()=>{var e;null==(e=this.onOrientationChange)||e.call(this)}))}defineSlot({retry:e}){return(0,M.bT)((()=>{const t=googletag.defineOutOfPageSlot(this.service.getAdvBlockId(b.$.REWARDED),googletag.enums.OutOfPageFormat.REWARDED);if(!t)throw new Error(U.XO.NO_SLOT);return t.addService(googletag.pubads()),t.retry=e,t}))}preload(){return Rt(this,arguments,(function*({depth:e,clickDaemon:t,reason:s=O.p_.PRELOAD}={}){var i;if(this.waitForSlotReady)return this.retries&&this.slot&&void 0!==e&&(At.tag(["Retry","Rewarded"])("Skip retry, due showAdv call"),this.slot.retry=0),this.waitForSlotReady.promise;At.spoiler(this)("Preload rewarded slot");const n=new g.Z;this.waitForSlotReady=n;const a=new g.Z;let r,o=!1,d=!1;try{t||(t=this.service.advManager.alternateLogs?new $.U({app_id:this.service.advManager.appId,tag:b.$.REWARDED}):this.service.advManager.getClickdaemonAdvLog(b.$.REWARDED)),this.slot&&googletag.destroySlots([this.slot]),this.slot=yield this.defineSlot({retry:void 0===e?this.retries:0}),void 0===e&&(e=0);let l=null!=(i=t.request({advBlockId:this.service.getAdvBlockId(b.$.REWARDED,s),advtype:this.service.serviceName,provider:this.service.serviceName,depth:e,reason:s}))?i:"";const c=(i=0)=>Rt(this,null,(function*(){var n;this.slot&&googletag.destroySlots([this.slot]),this.slot=yield this.defineSlot({retry:i}),l=null!=(n=null==t?void 0:t.request({advBlockId:this.service.getAdvBlockId(b.$.REWARDED,s),advtype:this.service.serviceName,depth:e,reason:s}))?n:"",googletag.pubads().refresh([this.slot])}));this.onOrientationChange=()=>{if(At.spoiler("orientationChange",d),o&&d&&this.slot)return googletag.destroySlots([this.slot]),a.resolve({wasShown:!0}),void delete this.waitForSlotReady;delete this.waitForSlotReady,c(0)},this.onSlotRenderEnded=s=>{if(s.isEmpty)return t instanceof $.U?t.responseEmpty():null==t||t.response({adReqId:l,depth:e,reason:O.Ud.EMPTY}),this.retries&&s.slot.retry?(At.tag(["Retry","Interstitial"])(`Retrying request, ${this.retries-s.slot.retry+1} of ${this.retries}`),void c(s.slot.retry-1)):(n.resolve({adReqId:l,clickDaemon:t,isEmpty:!0}),delete this.waitForSlotReady,void(o&&a.resolve({wasShown:!0})));t instanceof $.U?t.response():null==t||t.response({adReqId:l,depth:e,reason:O.Ud.SUCCESS})},this.onRewardedSlotReady=e=>{o?e.makeRewardedVisible():n.resolve({isEmpty:!1,adReqId:l,clickDaemon:t,waitForShow:t=>(r=t,o=!0,e.makeRewardedVisible(),a.promise)})},this.onRewardedSlotGranted=()=>{var e;null==(e=null==r?void 0:r.onRewarded)||e.call(r),d=!0},this.onRewardedSlotClosed=()=>{a.resolve({wasShown:!0}),delete this.waitForSlotReady},googletag.pubads().refresh([this.slot])}catch(e){(0,f.g5)(this.service,{error:e})}return this.waitForSlotReady.promise}))}show(){return Rt(this,null,(function*(){}))}cancel(){var e,t;At("Cancel rewarded preload"),null==(e=this.waitForSlotReady)||e.resolve({adReqId:"canceled",isEmpty:!1}),delete this.waitForSlotReady,this.slot&&(null==(t=googletag.destroySlots)||t.call(googletag,[this.slot]))}}var Ct=s(25798),Lt=s(78569),Dt=s(74762),Ot=s(45254),Bt=s(89592),xt=Object.defineProperty,_t=Object.defineProperties,Nt=Object.getOwnPropertyDescriptors,qt=Object.getOwnPropertySymbols,Mt=Object.prototype.hasOwnProperty,$t=Object.prototype.propertyIsEnumerable,Ft=(e,t,s)=>t in e?xt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,Wt=(e,t,s)=>new Promise(((i,n)=>{var a=e=>{try{o(s.next(e))}catch(e){n(e)}},r=e=>{try{o(s.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,r);o((s=s.apply(e,t)).next())}));const Zt="ca-pub-7899932632484219";var Ut=(e,t,s)=>new Promise(((i,n)=>{var a=e=>{try{o(s.next(e))}catch(e){n(e)}},r=e=>{try{o(s.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,r);o((s=s.apply(e,t)).next())}));var Ht=s(26256);const zt={modal:"modal",rewardedVideo:"rewarded_video",modalVisible:"modal_visible",modalVisiblePreroll:"modal_visible_preroll",modalMedia:"modal__media",modalClose:"modal__close",modalBottom:"modal__bottom",modalButton:"modal__button",modalButtonClose:"modal__button_close",modalButtonDisableAdv:"modal__button_disable_adv",fullscreenButtonTop:"fullscreen_button_top",modalAdvCountdown:"modal__advCountdown",modalAdvCountdownCircle:"modal__advCountdownCircle",modalContent:"modal_content",modalContentOld:"modal__content_old",mobileCloseButton:"mobile_close_button",modalRewarded:"modal__rewarded",modalDesktopCountdown:"modal__desktop_countdown",modalWrap:"modal__wrap",modalContentSearchApplication:"modal__content_search-application",modalCloseSearchApplication:"modal__close_search-application",yandexAdaptive:"yandex-adaptive",withNativeClose:"with-native-close"},Gt=20;var jt=s(98589),Vt=s(76958);const Yt=(0,N.M$)("YandexAdv",[N.XG.Adv],{background:"#d7bc29"});function Kt(){return Object.keys(zt).reduce(((e,t)=>(e[t]=`play-yandex-${zt[t]}`,e)),{})}function Xt(e,t,s){const i=e[`${t}SearchApplication`];return`${e[t]} ${s?i:""}`}function Jt(){var e,t,s;jt.Z.params({borrowParams:{adv:{yaContextScriptLoad:Boolean(null==(s=null==(t=null==(e=window.Ya)?void 0:e.Context)?void 0:t.AdvManager)?void 0:s.render)}}})}function Qt({advBlocks:e,deviceType:t,reason:s}){var i,n,a,r,o,d,l,c;if((0,K.x)())return s===O.p_.START_FULLSCREEN?k.EC.start_fullscreen:k.EC.fullscreen;if(t===Vt.n.desktop){const t=null!=(i=e.desktop)?i:e;let a=t.fullscreen;return s===O.p_.START_FULLSCREEN&&(a=null!=(n=t.start_fullscreen)?n:a),a}const h=null!=(a=e.mobile)?a:e;let u=h.fullscreen;return s===O.p_.START_FULLSCREEN?(u=null!=(r=h.start_fullscreen)?r:u,u=It.Z.isLandscape?null!=(o=h.start_fullscreen_landscape)?o:u:null!=(d=h.start_fullscreen_portrait)?d:u):u=It.Z.isLandscape?null!=(l=h.fullscreen_landscape)?l:u:null!=(c=h.fullscreen_portrait)?c:u,u}function es({advBlocks:e,deviceType:t}){var s,i;if((0,K.x)())return k.EC.rewarded;if(t===Vt.n.desktop){return(null!=(s=e.desktop)?s:e).rewarded}return(null!=(i=e.mobile)?i:e).rewarded}class ts{ready(){return(0,f.qu)("[adv.prerender] ready"),this.promise}}var ss=s(38512),is=Object.defineProperty,ns=Object.getOwnPropertySymbols,as=Object.prototype.hasOwnProperty,rs=Object.prototype.propertyIsEnumerable,os=(e,t,s)=>t in e?is(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;class ds extends Error{constructor({type:e,text:t,code:s},i,n={}){super(),this.message=`${i}: err.code=${s}`,this.additional=((e,t)=>{for(var s in t||(t={}))as.call(t,s)&&os(e,s,t[s]);if(ns)for(var s of ns(t))rs.call(t,s)&&os(e,s,t[s]);return e})({adv:{text:null==t?void 0:t.substr(0,100),code:s,type:e}},n)}}var ls=s(38508),cs=s(58432);function hs({querySelector:e,interval:t=100,rejectTimeout:s=3e3}){return new Promise(((i,n)=>{function a(){try{let t=document.querySelector(e);if(t)return i(t),!0}catch(e){return n(e),!1}}if(a())return;const r=window.setTimeout((()=>{d(),n(new Error("Can not find element"))}),s),o=window.setInterval((()=>{a()&&d()}),t);function d(){clearInterval(o),clearTimeout(r)}}))}var us=Object.defineProperty,ps=Object.defineProperties,vs=Object.getOwnPropertyDescriptors,ms=Object.getOwnPropertySymbols,gs=Object.prototype.hasOwnProperty,ws=Object.prototype.propertyIsEnumerable,ys=(e,t,s)=>t in e?us(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,fs=(e,t)=>{for(var s in t||(t={}))gs.call(t,s)&&ys(e,s,t[s]);if(ms)for(var s of ms(t))ws.call(t,s)&&ys(e,s,t[s]);return e},bs=(e,t)=>ps(e,vs(t));class As extends ts{constructor(e,t,s){super(),this.yandexAdvService=e,this._previousReason=O.p_.PRELOAD,this.previousPageNumber=0,this.depth=0;const{advBlocks:i}=e.advManager;Yt(`[adv.prerender] yandex init with advBlocks = ${JSON.stringify(i,null,"\t")}`),Yt(`[adv.prerender] reason = ${t}`),e.savedPageYOffset=(0,f.SW)(e.advContainer),this.promise=new Promise(((e,i)=>{this.next(t,s).then(e).catch(i)}))}get adReqId(){return this._adReqId}get previousReason(){return this._previousReason}next(e=this._previousReason,t){Yt("[adv.prerender] next"),this._previousReason!==e&&(this._previousReason=e);const{yandexAdvService:s}=this,i=s.advManager,{advBlocks:n,deviceType:a}=i;return this.promise=new Promise(((s,i)=>{this.previousPageNumber+=1;const r=Qt({advBlocks:n,deviceType:a,reason:e});Yt(`[adv.prerender] advBlockId = ${r}`),d.Z.post({type:"yandex-fullscreen-render",action:"update-block-id",data:{blockId:r,pageNumber:this.previousPageNumber},timeout:1e3}).then((({data:e})=>{const{blockId:t}=e;return hs({querySelector:`#${t}`,interval:100,rejectTimeout:1500})})).then((n=>{this.renderYaAdv(s,i,{advBlockId:r,reason:e,renderTo:n.id,clickDaemon:t})})).catch((e=>{s({hasContent:!1,err:e})}))})).catch((e=>({hasContent:!1,err:e}))),this.promise}renderYaAdv(e,t,{advBlockId:s,clickDaemon:i,reason:n,renderTo:a}){var r,o,l,c,h;Yt("[adv.prerender] renderYaAdv");const{depth:u}=this,p=this.yandexAdvService.advManager,{flags:v,isAdvDisabled:m}=p;null==(o=(r=this.yandexAdvService).destroyAdv)||o.call(r);try{if(m)return void e({hasContent:!1,noRequest:!0});if(this._adReqId=i instanceof B.i?i.request({advBlockId:s,advtype:this.yandexAdvService.serviceName,depth:u,reason:n}):"",!(null==(h=null==(c=null==(l=window.Ya)?void 0:l.Context)?void 0:c.AdvManager)?void 0:h.render)){const e="window.Ya.Context.AdvManager.render is not defined";throw i instanceof B.i&&(i.response({adReqId:this.adReqId,reason:O.Ud.NOT_IMPL}),i.error(this.adReqId,this.adSeqId,e)),new Error(e)}const{appId:t,deviceId:r}=this.yandexAdvService.advManager,o=this.previousPageNumber%Gt;(0,f.U2)("Ð Ð¡Ð¯ fullscreen",`${o}`),i instanceof $.U&&(n===O.p_.WATERFALL?i.request():i.request({advBlockId:s,provider:this.yandexAdvService.serviceName,reason:n}));const p=fs(bs(fs({async:!0},(0,K.x)()?{type:"fullscreen"}:{}),{blockId:s,disableRefresh:!0,extParams:bs(fs({},r?{google_aid:r}:{}),{utm_source_service:"games","distr-id":t}),pageNumber:o,renderTo:a,statId:(0,cs.Sn)(),lazyLoad:!1,onError:t=>{Yt("[adv.prerender] onError");const n=(0,ls.M)(t,{blockId:s,pageId:o});i instanceof B.i&&i.response({adReqId:this.adReqId,depth:u,reason:`${O.Ud.ERROR}_${n}`}),(0,D.fF)(new ds(t,"Callback onError in fullscreen"),{additional:{advBlockId:s,pageId:o},prefix:k.yt}),e({hasContent:!1,err:new Error(n),clickDaemon:i})},onRender:t=>{i instanceof B.i?i.response({adReqId:this.adReqId,depth:u,reason:O.Ud.SUCCESS}):i.response(),this.yandexAdvService.destroyAdv=()=>{var e,t;this.yandexAdvService.destroyAdv=void 0,null==(t=null==(e=window.Ya)?void 0:e.Context)||t.AdvManager.destroy({blockId:s})},e({hasContent:!0,isMediaAdv:"rtb"===t.product,clickDaemon:i})}}),(0,K.x)()?{onClose:()=>{(0,Qe.D)((()=>{d.Z.post({type:"yandex-adv-service",action:"close-adv"})}))}}:{}),g=()=>{i instanceof B.i?i.response({adReqId:this.adReqId,depth:u,reason:O.Ud.EMPTY}):null==i||i.responseEmpty(),e({hasContent:!1,clickDaemon:i})};Yt("[adv.prerender] Preload fullscreen ad - AdvManager.render"),(0,ss.Q$)({abtFlags:v,adOptions:p,methodName:ss.xn.RENDER,onAdLoadFailed:g})}catch(e){t(e)}}}var Ss=Object.defineProperty,ks=Object.defineProperties,Es=Object.getOwnPropertyDescriptors,Is=Object.getOwnPropertySymbols,Rs=Object.prototype.hasOwnProperty,Ps=Object.prototype.propertyIsEnumerable,Ts=(e,t,s)=>t in e?Ss(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,Cs=(e,t)=>{for(var s in t||(t={}))Rs.call(t,s)&&Ts(e,s,t[s]);if(Is)for(var s of Is(t))Ps.call(t,s)&&Ts(e,s,t[s]);return e},Ls=(e,t)=>ks(e,Es(t));class Ds extends ts{constructor(e,t,s){super(),this.yandexAdvService=e,this._previousReason=O.p_.PRELOAD,this.previousPageNumber=0,this.isProcessing=!1,this.depth=0;const{advBlocks:i}=e.advManager;Yt(`[adv.prerender] yandex init with advBlocks = ${JSON.stringify(i,null,"\t")}`),Yt(`[adv.prerender] startReason = ${t}`),e.savedPageYOffset=(0,f.SW)(e.advContainer),this.promise=new Promise(((e,i)=>{this.next(t,s).then(e).catch(i)}))}get adReqId(){return this._adReqId}get previousReason(){return this._previousReason}next(e=this._previousReason,t){var s;Yt("[adv.prerender] next"),this._previousReason!==e&&(this._previousReason=e);const{yandexAdvService:i}=this,n=i.advManager,{advBlocks:a}=n;return null==(s=i.destroyAdv)||s.call(i),Yt("[adv.prerender] isProcessing =",this.isProcessing),this.promise=new Promise(((s,i)=>{this.isProcessing=!0,this.previousPageNumber+=1;const n=Qt({advBlocks:a,deviceType:this.getPlatform(),reason:e});Yt(`[adv.prerender] advBlockId = ${n}`),d.Z.post({type:"yandex-fullscreen-render",action:"update-block-id",data:{blockId:n,pageNumber:this.previousPageNumber},timeout:1e3}).then((({data:e})=>{const{blockId:t}=e;return hs({querySelector:`#${t}`,interval:100,rejectTimeout:1500})})).then((a=>{this.renderYaAdv(s,i,{advBlockId:n,reason:e,renderTo:a.id,clickDaemon:t})})).catch((e=>{s({hasContent:!1,err:e})}))})).catch((e=>(this.isProcessing=!1,{hasContent:!1,err:e}))),this.promise}getRsyaPlatform(){var e,t,s,i;const n=null==(i=null==(s=null==(t=null==(e=window.Ya)?void 0:e.Context)?void 0:t.AdvManager)?void 0:s.getPlatform)?void 0:i.call(s);return null!=n?n:"desktop"}getPlatform(){return"touch"===this.getRsyaPlatform()?"mobile":"desktop"}renderYaAdv(e,t,{advBlockId:s,clickDaemon:i,reason:n,renderTo:a}){var r,o,d,l,c;Yt("[adv.prerender] renderYaAdv");const{depth:h}=this,u=this.yandexAdvService.advManager,{isAdvDisabled:p,flags:v}=u;let m=e;null==(o=(r=this.yandexAdvService).destroyAdv)||o.call(r);try{if(p)return void m({hasContent:!1,noRequest:!0});if(this._adReqId=i instanceof B.i?i.request({advBlockId:s,advtype:this.yandexAdvService.serviceName,depth:h,reason:n}):"",!(null==(c=null==(l=null==(d=window.Ya)?void 0:d.Context)?void 0:l.AdvManager)?void 0:c.preload)){const e="window.Ya.Context.AdvManager.preload is not defined";throw i instanceof $.U?i.error(e):(i.response({adReqId:this.adReqId,reason:O.Ud.NOT_IMPL}),i.error(this.adReqId,this.adSeqId,e)),new Error(e)}(0,f.U2)("Ð Ð¡Ð¯ fullscreen",`${s}/${this.previousPageNumber%Gt}`),i instanceof $.U&&(n===O.p_.WATERFALL?i.request():i.request({advBlockId:s,provider:this.yandexAdvService.serviceName,reason:n}));let e,t=!1;const r=new Promise((t=>e=t));let o=!1;const{appId:u,deviceId:g}=this.yandexAdvService.advManager,w=this.previousPageNumber%Gt,y={async:!0,blockId:s,disableRefresh:!0,extParams:Ls(Cs({},g?{google_aid:g}:{}),{utm_source_service:"games","distr-id":u}),lazyLoad:!1,pageNumber:w,platform:this.getRsyaPlatform(),renderTo:a,statId:(0,cs.Sn)(),type:"fullscreen",onClose:()=>{Yt("[adv.prerender] onClose"),this.isProcessing=!1,o=!1,this.yandexAdvService.hideFullscreenAdv(t)},onError:e=>{Yt("[adv.prerender] onError"),this.isProcessing=!1,o=!1;const t=String(e.text);(0,D.fF)(new ds(e,"Callback onError in fullscreen"),{additional:{advBlockId:s,pageId:w},prefix:k.yt}),i instanceof $.U||i.response({adReqId:this._adReqId,depth:h,reason:`${O.Ud.ERROR}_${e.text}`}),m({hasContent:!1,err:new Error(t),clickDaemon:i})},onPreload:t=>{Yt("[adv.prerender] onPreload",m),o=!0,null==i||i.response({adReqId:this._adReqId,depth:h,reason:O.Ud.SUCCESS}),m({showPrerenderedAd:()=>(Yt("[adv.prerender] showPrerenderedAd"),t(),r),clickDaemon:i}),m=e},onRender:e=>{if(Yt("[adv.prerender] onRender; isPreloaded =",o),!o)return Yt("[adv.prerender] Called `onRender` before `onPreload`. Abort. Call `onAdLoadFailed`."),void b();this.yandexAdvService.destroyAdv=()=>{var e,t;this.yandexAdvService.destroyAdv=void 0,Yt("[adv.prerender] yandexAdvService.destroyAdv called"),null==(t=null==(e=window.Ya)?void 0:e.Context)||t.AdvManager.destroy({blockId:s})},t=!0,m({hasContent:!0,isMediaAdv:"rtb"===e.product,clickDaemon:i})}},b=()=>{Yt("[adv.prerender] onAdLoadFailed"),i instanceof B.i?i.response({adReqId:this._adReqId,depth:h,reason:O.Ud.EMPTY}):null==i||i.responseEmpty(),this.isProcessing=!1,o=!1,m({hasContent:!1,clickDaemon:i})};Yt("[adv.prerender] Preload fullscreen ad - AdvManager.preload"),(0,ss.Q$)({abtFlags:v,adOptions:y,methodName:ss.xn.PRELOAD,onAdLoadFailed:b})}catch(e){t(e)}}}var Os=s(26667),Bs=s(75217),xs=s(17061),_s=s(2820);const Ns=!0,qs=["2753282","2753277"];function Ms({advConfig:e,flags:t,secondDomain:s,withWorldWideAdv:i}){if((0,Bs.O)()){return{[b.$.INTERSTITIAL]:[{provider:b.e.ParentWindow}],[b.$.REWARDED]:[{provider:b.e.ParentWindow}]}}const n={[b.$.INTERSTITIAL]:Vs(b.$.INTERSTITIAL,t),[b.$.REWARDED]:Vs(b.$.REWARDED,t)},a={[b.$.INTERSTITIAL]:n[b.$.INTERSTITIAL]||Gs(b.$.INTERSTITIAL,{flags:t,withWorldWideAdv:i}),[b.$.REWARDED]:n[b.$.REWARDED]||Gs(b.$.REWARDED,{flags:t,withWorldWideAdv:i})};return n[b.$.INTERSTITIAL]&&function(e){const t=window.firstSeen;if(!t||!t.utm_source||!J.os.includes(t.utm_source))return;const s=Fs(e,b.e.GoogleManual);-1!==s&&e.splice(s,1)}(a[b.$.INTERSTITIAL]),Hs(t)?a:(n[b.$.INTERSTITIAL]||(Ws(a[b.$.INTERSTITIAL],b.$.INTERSTITIAL,{flags:t,advConfig:e,withWorldWideAdv:i}),function(e,{secondDomain:t}){const{name:s}=(0,m.getDomainConfig)();if(t===Ot.U.PLAYHOP||s===m.EDomain.Allwebgames)return;if(!We())return;e[b.$.INTERSTITIAL].unshift({provider:b.e.OnboardingPromo})}(a,{secondDomain:s}),Zs(a[b.$.INTERSTITIAL],{flags:t}),Us(a[b.$.INTERSTITIAL],{secondDomain:s})),n[b.$.REWARDED]||(Ws(a[b.$.REWARDED],b.$.REWARDED,{flags:t,advConfig:e,withWorldWideAdv:i}),function(e,{flags:t}){if(!(0,V.dA)(t))return;const s=Fs(e,b.e.PrebidTGO);if(-1===s)return;e.splice(s+1,0,{provider:b.e.PrebidTGO,tag:b.$.INTERSTITIAL})}(a[b.$.REWARDED],{flags:t}),Zs(a[b.$.REWARDED],{flags:t}),Us(a[b.$.REWARDED],{secondDomain:s})),Ys(a[b.$.INTERSTITIAL],t),Ys(a[b.$.REWARDED],t),function(e){const t=(0,cs.KT)();if(!Os.xF.includes(t))return;e.length=0,e.push({provider:b.e.AdsenseResponsive})}(a[b.$.INTERSTITIAL]),{[b.$.INTERSTITIAL]:a[b.$.INTERSTITIAL],[b.$.REWARDED]:a[b.$.REWARDED]})}function $s(e,t){const s=e[e.length-1];return(null==s?void 0:s.provider)===t}function Fs(e,t){return e.findIndex((e=>e.provider===t))}function Ws(e,t,{advConfig:s,flags:i,withWorldWideAdv:n}){var a;if(zs(n))return;const r=null==(a=s[t].google.instream)?void 0:a.desktop,o=t===b.$.INTERSTITIAL?(0,V.oO)(i):(0,v.CE)(i);(null!=o?o:null==r?void 0:r.enabled)&&e.unshift({provider:b.e.GoogleInstream})}function Zs(e,{flags:t}){const s=(0,V.RM)(t,Y.Z.disableYandexWaterfall)||!1,i=(0,cs.KT)();s||qs.includes(i)||$s(e,b.e.Yandex)||e.push({provider:b.e.Yandex})}function Us(e,{secondDomain:t}){const{name:s}=(0,m.getDomainConfig)();(0,Be.uP)()&&t!==Ot.U.PLAYHOP&&s!==m.EDomain.Allwebgames&&e.push({provider:b.e.Promo})}function Hs(e){var t;if((0,V.RM)(e,Y.Z.disableNativeAdv)||!1)return!1;return!!((null==(t=window.yandex)?void 0:t.ads)&&(0,X.zg)("21.9.0.1638")&&(0,X.VP)())}function zs(e){var t;return!e||(null==(t=window.clientMetadata)?void 0:t.isOnlyRsyaAd)}function Gs(e,{flags:t,withWorldWideAdv:s}){if(Hs(t)){return(0,K.x)()&&(0,V.LI)(t)?[{provider:b.e.Yandex}]:[{provider:b.e.Native}]}const i=(0,xs.V)("utm_source");return i===b.e.Transsion?[{provider:b.e.Transsion}]:i===b.e.CrazyGames?[{provider:b.e.CrazyGames}]:zs(s)?[{provider:b.e.Yandex}]:[{provider:b.e.PrebidTGO}]}function js(e){return e&&"object"==typeof e&&e.provider&&"string"==typeof e.provider}function Vs(e,t){const s=(0,V.QR)(t,`adv_${e}_waterfall`);return s&&s.every(js)?s:null}function Ys(e,t){if("undefined"==typeof window)return e;const{pathname:s}=window.location,i=(0,_s.eT)(s),n=(0,_s.Fg)(s)&&(0,V.bV)(t);return!i&&!n||(0,V.VG)(t)||[...e].forEach((t=>{if(!k.wt.includes(t.provider)){const s=e.indexOf(t);-1!==s&&e.splice(s,1)}})),e}function Ks({advBlocks:e,flags:t,withWorldWideAdv:s}){var i;const n=Vs("start_fullscreen",t);if(n)return Ys(n,t);const a=function({flags:e}){if(Ns)return null;const t=(0,V.QR)(e,Y.Z.advPrerollPerClid);if(!t)return null;const s=(0,cs.KT)();return s&&(i=s,t.some((e=>i===String(e))))?[{provider:b.e.PrebidTGO}]:null;var i}({flags:t});return a?Ys([...a],t):e.start_fullscreen?Hs(t)?[{provider:b.e.Native}]:!s||(null==(i=window.clientMetadata)?void 0:i.isOnlyRsyaAd)?[{provider:b.e.Yandex},{provider:b.e.Promo}]:null:null}var Xs=s(77901),Js=Object.defineProperty,Qs=Object.defineProperties,ei=Object.getOwnPropertyDescriptors,ti=Object.getOwnPropertySymbols,si=Object.prototype.hasOwnProperty,ii=Object.prototype.propertyIsEnumerable,ni=(e,t,s)=>t in e?Js(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,ai=(e,t)=>{for(var s in t||(t={}))si.call(t,s)&&ni(e,s,t[s]);if(ti)for(var s of ti(t))ii.call(t,s)&&ni(e,s,t[s]);return e},ri=(e,t)=>Qs(e,ei(t));const oi=["direct","media-smart","media-image","media-creative","video-smart","auto-video-irect","video-creative","video-motion","media-creative-survey","video-creative-survey"];class di{constructor(e,t){this.yandexAdvService=e,this.pageNumber=0,this.isYandexSearchApp=(0,Xs.qo)()}get adReqId(){return this._adReqId}next(e){const{flags:t}=this.yandexAdvService.advManager;t[Y.Z.preloadRewardedVideo]&&(this.preloadedRewardedVideo=this.preloadRewardedVideo())}getOnCloseOptionForTV(){return(0,K.x)()?{onClose:()=>{var e,t;null==(t=null==(e=this.yandexAdvService)?void 0:e.advManager)||t.getClickdaemonAdvLog(b.$.REWARDED).close(this.adReqId,this.adSeqId),this.hideVideoAdv(),"function"==typeof this.onClose&&this.onClose()}}:{}}preloadRewardedVideo(){const{advBlocks:e,appId:t,deviceId:s,deviceType:i}=this.yandexAdvService.advManager,n=es({advBlocks:e,deviceType:i});let a=()=>{},r=()=>{};const o=new Promise(((e,t)=>{a=e,r=t})),d=new Promise((e=>{var i,o,d;try{if(!(null==(d=null==(o=null==(i=window.Ya)?void 0:i.Context)?void 0:o.AdvManager)?void 0:d.preload))throw new Error("window.Ya.Context.AdvManager.preload is not defined");Yt("[adv.rerender] Preload rewarded video - AdvManager.preload");const r=ai(ri(ai({blockId:n},(0,K.x)()?{type:"rewarded"}:{}),{disableRefresh:!0,renderTo:`yandex_rtb_rewarded_${n}`,pageNumber:this.pageNumber,async:!0,statId:(0,cs.Sn)(),extParams:ri(ai({},s?{google_aid:s}:{}),{utm_source_service:"games","distr-id":t}),onError:(e={})=>{(0,D.fF)(new ds(e,"Callback onError in rewarded"),{prefix:k.yt})},onRender:e=>{e?e.product||(0,D.fF)(new Error("Adv Rewarded: there is no data.product")):(0,D.fF)(new Error("Adv Rewarded: there is no data")),Yt("[adv.rerender] Render preloaded rewarded"),a({hasContent:!0,productType:e.productType})},onPreload:t=>e({showRewardedCallback:t})}),this.getOnCloseOptionForTV()),l=()=>{(0,D.fF)(new Error("Adv Rewarded: no content")),e({}),a({hasContent:!1})};(0,ss.Q$)({abtFlags:this.yandexAdvService.advManager.flags,adOptions:r,methodName:ss.xn.PRELOAD,onAdLoadFailed:l})}catch(t){e({}),r(t)}}));return function(){return d.then((({showRewardedCallback:e})=>(null==e||e(),o)))}}resizeAdv(){this.yandexAdvService&&(this.yandexAdvService.savedPageYOffset=(0,f.SW)(this.yandexAdvService.advContainer))}hideVideoAdv(){var e,t;const{advManager:s}=this.yandexAdvService,{deviceType:i,advBlocks:n}=s,a=(0,K.x)()?k.EC.rewarded:n.rewarded;(0,f.PS)(),i!==Vt.n.desktop&&(0,f.HH)(),d.Z.post({type:"yandex-rewarded-render",action:"hide-rewarded"}),window.removeEventListener("resize",this.resizeAdv),window.scroll(0,this.yandexAdvService.savedPageYOffset),null==(t=null==(e=window.Ya)?void 0:e.Context)||t.AdvManager.destroy({blockId:a}),this.yandexAdvService.preloadRewardedAdv(O.p_.PRELOAD)}renderFakeRewarded({advBlockId:e,clickDaemon:t,depth:s,onRewardedForTV:i,previousRewardedPageNumber:n,reason:a}){const{advManager:r}=this.yandexAdvService,{appId:o,deviceId:d}=r;return new Promise(((r,l)=>{var c,h,u;try{if(this._adReqId=t instanceof $.U?"":t.request({advBlockId:e,advtype:this.yandexAdvService.serviceName,depth:s,reason:a}),!(null==(u=null==(h=null==(c=window.Ya)?void 0:c.Context)?void 0:h.AdvManager)?void 0:u.render))throw t instanceof $.U||t.response({adReqId:this.adReqId,reason:O.Ud.NOT_IMPL}),new Error("window.Ya.Context.AdvManager.render is not defined");t instanceof $.U&&t.request({advBlockId:e,reason:a,provider:this.yandexAdvService.serviceName});const p=n%Gt;(0,f.U2)("Ð Ð¡Ð¯ rewarded",`${e}/${p}`),(0,f.WL)();const v=ai(ai(ri(ai({blockId:e},(0,K.x)()?{type:"rewarded"}:{}),{disableRefresh:!0,renderTo:`yandex_rtb_rewarded_${e}`,pageNumber:p,async:!0,statId:(0,cs.Sn)(),extParams:ri(ai({},d?{google_aid:d}:{}),{utm_source_service:"games","distr-id":o}),lazyLoad:!1,onError:(i={})=>{const n=(0,ls.M)(i,{blockId:e,pageId:p});t instanceof $.U||t.response({adReqId:this.adReqId,depth:s,reason:`${O.Ud.ERROR}_${n}`}),l(new ds(i,"Callback onError in rewarded"))},onRender:e=>{e?e.product||(0,D.fF)(new Error("Adv Rewarded: there is no data.product")):(0,D.fF)(new Error("Adv Rewarded: there is no data")),t instanceof $.U?t.response():t.response({adReqId:this.adReqId,depth:s,reason:(null==e?void 0:e.product)?O.Ud.SUCCESS:`${O.Ud.ERROR}_no-data-or-product`}),r({hasContent:!0,productType:e.productType})}}),(0,K.x)()?{onRewarded:i}:{}),this.getOnCloseOptionForTV()),m=()=>{t instanceof $.U||t.response({adReqId:this.adReqId,depth:s,reason:O.Ud.EMPTY}),(0,D.fF)(new Error("Adv Rewarded: no content")),r({hasContent:!1})};(0,ss.Q$)({abtFlags:this.yandexAdvService.advManager.flags,adOptions:v,methodName:ss.xn.RENDER,onAdLoadFailed:m})}catch(e){l(e)}}))}showRewardedVideo({callbacks:e,clickDaemon:t,adSeqId:s,depth:i}){const{onOpen:n,onRewarded:a,onClose:r}=e,o=Boolean(this.isYandexSearchApp),{advManager:l,cssClasses:c}=this.yandexAdvService,{deviceType:h,advBlocks:u,viewType:p,flags:v}=l,m=(0,K.x)()?k.EC.rewarded:u.rewarded,g=document.querySelector(`.${c.rewardedVideo}`),w=Number(v[Y.Z.rewardedVideoTimeout]);let y;this.adSeqId=s,this.onClose=r,y=!isNaN(w)&&w>0?w:20;let A=y;return window.addEventListener("resize",this.resizeAdv),h!==Vt.n.desktop&&(0,f.xK)(),(p===k.xd.fullscreen||o)&&this.resizeAdv(),new Promise(((e,n)=>{this.pageNumber=((this.pageNumber||0)+1)%Gt;const r=()=>{(v[Y.Z.preloadRewardedVideo]?this.preloadedRewardedVideo.bind(this):this.renderFakeRewarded.bind(this))({advBlockId:m,clickDaemon:t,depth:i,onRewardedForTV:(0,K.x)()?e=>{t instanceof $.U||l.getClickdaemonAdvLog(b.$.REWARDED).rewarded(this.adReqId,s),!0===e&&(null==a||a())}:void 0,previousRewardedPageNumber:this.pageNumber,reason:O.p_.ONSPOT}).then(e).catch(n)};window.yaContextCb?(window.yaContextCb.push(r),Yt("[adv.rerender] new rewarded render on")):r()})).then((({hasContent:e,productType:i})=>{var o;if(Yt(`[adv.rerender] hasContent = ${e}, productType = ${i}`),!e)throw l.alternateLogs||l.getClickdaemonAdvLog(b.$.REWARDED).noContent(this.adReqId,this.adSeqId),$s(l.waterfallQueue[b.$.REWARDED],b.e.Promo)||null==a||a(),new Error(k.Iy);i&&oi.includes(i)&&(y=7,A-=13),t instanceof $.U||l.getClickdaemonAdvLog(b.$.REWARDED).show(this.adReqId,this.adSeqId),d.Z.post({type:"yandex-rewarded-render",action:"show-rewarded",data:{seconds:A}}).then((()=>{t instanceof $.U||l.getClickdaemonAdvLog(b.$.REWARDED).close(this.adReqId,s),this.hideVideoAdv(),null==r||r()})),(0,K.x)()||d.Z.post({type:"yandex-rewarded-render",action:"on-rewarded"}).then((()=>{t instanceof $.U||l.getClickdaemonAdvLog(b.$.REWARDED).rewarded(this.adReqId,s),null==a||a()}));const h=(null==(o=this.yandexAdvService.advManager.context.uatraits)?void 0:o.OSFamily)===J.k8.IOS;(0,f.ss)({advElement:document.querySelector(`#yandex_rtb_rewarded_${m}`),type:b.$.REWARDED,flags:l.flags,appId:l.appId,isIOS:h}),(0,f.J4)(c,g),null==n||n()})).catch((e=>{throw this.hideVideoAdv(),e}))}}var li=Object.defineProperty,ci=Object.defineProperties,hi=Object.getOwnPropertyDescriptors,ui=Object.getOwnPropertySymbols,pi=Object.prototype.hasOwnProperty,vi=Object.prototype.propertyIsEnumerable,mi=(e,t,s)=>t in e?li(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,gi=(e,t)=>{for(var s in t||(t={}))pi.call(t,s)&&mi(e,s,t[s]);if(ui)for(var s of ui(t))vi.call(t,s)&&mi(e,s,t[s]);return e},wi=(e,t)=>ci(e,hi(t));const yi=["media-creative-reach","media-image","media-creative","video-creative"];class fi{constructor(e,t){this.yandexAdvService=e,this.advContainer=null,this.currentProductType="",this.pageNumber=0,It.Z.addChangeListener((()=>{this.rerenderAdv()}))}get adReqId(){return this._adReqId}next(){}getRsyaPlatform(){var e,t,s,i;const n=null==(i=null==(s=null==(t=null==(e=window.Ya)?void 0:e.Context)?void 0:t.AdvManager)?void 0:s.getPlatform)?void 0:i.call(s);return null!=n?n:"desktop"}getPlatform(){return"touch"===this.getRsyaPlatform()?"mobile":"desktop"}rerenderAdv(){var e,t;const{advManager:s}=this.yandexAdvService,i=s.advBlocks.rewarded;if(!this.yandexAdvService.isRewardedShowing||yi.includes(this.currentProductType))return;null==(t=null==(e=window.Ya)?void 0:e.Context)||t.AdvManager.destroy({blockId:i});const n=s.getClickdaemonAdvLog(b.$.REWARDED),a=n.rerender(this.yandexAdvService.getAdvBlockId(b.$.REWARDED),this.yandexAdvService.serviceName);n.demand(void 0,0,a),this.showRewardedVideo({callbacks:this.yandexAdvService.showAdvCallbacks[b.$.REWARDED],clickDaemon:n,adSeqId:a,reason:O.p_.PRELOAD,tag:b.$.REWARDED,initialTag:b.$.REWARDED,depth:0})}hideRewarded(){var e,t;const{advManager:s}=this.yandexAdvService,{advBlocks:i,deviceType:n,flags:a}=s,r=i.rewarded;(0,f.PS)(),n!==Vt.n.desktop&&(0,f.HH)(),d.Z.post({type:"yandex-rewarded-render",action:"hide-rewarded"}),null==(t=null==(e=window.Ya)?void 0:e.Context)||t.AdvManager.destroy({blockId:r}),!1!==(0,V.RM)(a,Y.Z.rewardedPCodeAdvPreloadFs)&&(0,V.iH)(a)&&this.yandexAdvService.preloadFullscreenAdv(O.p_.PRELOAD)}renderRewarded({advBlockId:e,previousRewardedPageNumber:t,callbacks:s,depth:i,clickDaemon:n}){const{advManager:a}=this.yandexAdvService,{flags:r}=a;return new Promise(((a,o)=>{var d,l,c;try{if(this._adReqId=n instanceof $.U?"":n.request({advBlockId:e,advtype:this.yandexAdvService.serviceName,depth:0,reason:O.p_.ONSPOT}),!(null==(c=null==(l=null==(d=window.Ya)?void 0:d.Context)?void 0:l.AdvManager)?void 0:c.render))throw n instanceof $.U||n.response({adReqId:this.adReqId,reason:O.Ud.NOT_IMPL}),new Error("window.Ya.Context.AdvManager.render is not defined");n instanceof $.U&&n.request({advBlockId:e,reason:O.p_.ONSPOT,provider:this.yandexAdvService.serviceName});const h=t%Gt;(0,f.U2)("Ð Ð¡Ð¯ rewarded",`${e}/${h}`),(0,f.WL)();const{appId:u,deviceId:p}=this.yandexAdvService.advManager,v={async:!0,blockId:e,disableRefresh:!0,extParams:wi(gi({},p?{google_aid:p}:{}),{utm_source_service:"games","distr-id":u}),lazyLoad:!1,pageNumber:h,platform:this.getRsyaPlatform(),statId:(0,cs.Sn)(),type:"rewarded",onError:(t={})=>{const s=(0,ls.M)(t,{blockId:e,pageId:h});n instanceof $.U||n.response({adReqId:this.adReqId,depth:i,reason:`${O.Ud.ERROR}_${s}`}),o(new ds(t,"Callback onError in rewarded"))},onClose:()=>{var e;this.currentProductType="",this.yandexAdvService.isRewardedShowing=!1,n instanceof $.U||n.close(this.adReqId,this.adSeqId),this.hideRewarded(),null==(e=s.onClose)||e.call(s)},onRewarded:e=>{e&&s.onRewarded&&(n instanceof $.U||n.rewarded(this.adReqId,this.adSeqId),s.onRewarded())},onRender:e=>{e?e.product||(0,D.fF)(new Error("Adv Rewarded: there is no data.product")):(0,D.fF)(new Error("Adv Rewarded: there is no data")),n instanceof $.U?n.response():n.response({adReqId:this.adReqId,depth:i,reason:(null==e?void 0:e.product)?O.Ud.SUCCESS:`${O.Ud.ERROR}_no-data-or-product`}),a({hasContent:!0,productType:e.productType})}},m=()=>{n instanceof $.U||n.response({adReqId:this.adReqId,depth:i,reason:O.Ud.EMPTY}),(0,D.fF)(new Error("Adv Rewarded: no content")),a({hasContent:!1})};(0,ss.Q$)({abtFlags:r,adOptions:v,methodName:ss.xn.RENDER,onAdLoadFailed:m})}catch(e){o(e)}}))}showRewardedVideo({callbacks:e,clickDaemon:t,adSeqId:s,depth:i}){const{onRewarded:n,onOpen:a}=e,{advManager:r,cssClasses:o}=this.yandexAdvService,{deviceType:l,advBlocks:c}=r,h=es({advBlocks:c,deviceType:this.getPlatform()});return this.adSeqId=s,this.advContainer=document.querySelector(`.${o.rewardedVideo}`),l!==Vt.n.desktop&&(0,f.xK)(),this.yandexAdvService.isRewardedShowing=!0,new Promise(((s,n)=>{this.pageNumber=((this.pageNumber||0)+1)%Gt,window.yaContextCb?(window.yaContextCb.push((()=>{this.renderRewarded({advBlockId:h,previousRewardedPageNumber:this.pageNumber,callbacks:e,depth:i,clickDaemon:t}).then(s).catch(n)})),Yt("new rewarded render on")):this.renderRewarded({advBlockId:h,previousRewardedPageNumber:this.pageNumber,callbacks:e,depth:i,clickDaemon:t}).then(s).catch(n)})).then((({hasContent:e,productType:i})=>{if(Yt(`[adv.rerender] hasContent = ${e}, productType = ${i}`),!e)throw t instanceof $.U||r.getClickdaemonAdvLog(b.$.REWARDED).noContent(this.adReqId,this.adSeqId),$s(r.waterfallQueue[b.$.REWARDED],b.e.Promo)||null==n||n(),new Error(k.Iy);t instanceof $.U||r.getClickdaemonAdvLog(b.$.REWARDED).show(this.adReqId,s),d.Z.post({type:"yandex-rewarded-render",action:"show-rewarded"}),this.currentProductType=i||"",null==a||a()})).catch((e=>{throw this.hideRewarded(),this.currentProductType="",this.yandexAdvService.isRewardedShowing=!1,e}))}}fi.contextType=o.Z;var bi=s(93013),Ai=(e,t,s)=>new Promise(((i,n)=>{var a=e=>{try{o(s.next(e))}catch(e){n(e)}},r=e=>{try{o(s.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,r);o((s=s.apply(e,t)).next())}));s(16280);var Si=s(6330),ki=s(35742);const Ei=(0,N.M$)("AdvAdsense",N.XG.Adv,{background:"#0c6c09"});var Ii=(e,t,s)=>new Promise(((i,n)=>{var a=e=>{try{o(s.next(e))}catch(e){n(e)}},r=e=>{try{o(s.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,r);o((s=s.apply(e,t)).next())}));class Ri extends L{constructor(e,t){var s,i;const{serviceName:n}=t;if(![b.e.Adsense,b.e.AdsenseResponsive].includes(n))throw new Error(`Invalid service name: ${n}, kind of 'adsense' expected.`);super(e,t,n),this.isResponsive=!1,this.isResponsive=n===b.e.AdsenseResponsive;const{clientId:a,slotId:r}=null!=(i=null==(s=e.allAdvBlocks.adsense)?void 0:s.interstitial)?i:{};this.clientId=null!=a?a:"invalid_block",this.slotId=null!=r?r:"invalid_block",this.init()}init(){return Ii(this,null,(function*(){try{this.provider=yield(0,Si.l)(this.isResponsive?ki.oO.AdsenseResponsive:ki.oO.AdsenseBlock),yield d.Z.post({type:"adv-fullscreen-block",action:"add-block",data:{blockName:this.serviceName},timeout:I.WT}),this.onServiceLoaded()}catch(e){this.onServiceError(e)}}))}getTimeoutExtraTime(e,t){switch(e){case T.QA.ServiceInit:return 3*I.WT;case T.QA.ShowFullscreen:return 5*I.yR}return super.getTimeoutExtraTime(e,t)}getAdvBlockId(e,t){return e===b.$.INTERSTITIAL?this.isResponsive?this.slotId:this.clientId:super.getAdvBlockId(e,t)}showFullscreenAdv(e){return Ii(this,arguments,(function*({adSeqId:e,callbacks:t,clickDaemon:s,depth:i,reason:n}){return new Promise(((a,r)=>Ii(this,null,(function*(){try{const{serviceName:o,isResponsive:l,clientId:c}=this,h=this.provider;if(!h)return void r(new Error("Adsense provider not loaded."));const u=this.getAdvBlockId(b.$.INTERSTITIAL,n);let p,v="none",m=!1;l&&(yield d.Z.post({type:"adv-fullscreen-block",action:"show-block",data:{blockName:o},timeout:I.WT}),yield d.Z.post({type:"adv-fullscreen-block",action:"show",data:{onClose:()=>{m&&(s instanceof $.U||s.close(v,e),t.onClose(m)),p&&h.destroySlot(p)}}})),t.onOpen(!1),s instanceof $.U?s.request({advBlockId:u}):v=s.request({advBlockId:u,advtype:this.serviceName,depth:i,reason:n}),Ei("Create slot",u,c,yt(o)),p=yield h.createSlot({blockId:u,clientId:c,divId:yt(o),height:window.innerHeight-192,width:window.innerWidth-144});const{isEmpty:g,slot:w}=yield h.preloadSlot(p);if(g)throw s instanceof $.U?s.responseEmpty():s.response({adReqId:v,reason:O.Ud.EMPTY}),new f.lu("Slot is empty",{isEmpty:!0});s instanceof $.U?s.response():s.response({adReqId:v,reason:O.Ud.SUCCESS}),m=!0,yield h.showSlot(w),s instanceof $.U?s.show():(s.show(v,e),l||s.close(v,e)),l||t.onClose(!0),a()}catch(e){r(e)}}))))}))}showRewardedVideo(){return Promise.reject("Not implemented")}cancelShow(e){if(e===b.$.INTERSTITIAL)d.Z.post({type:"adv-fullscreen-block",action:"hide",data:{blockName:this.serviceName}})}}const Pi="//imasdk.googleapis.com/js/sdkloader/ima3.js",Ti=[{width:1280,height:720},{width:854,height:480},{width:960,height:720},{width:640,height:480}];class Ci{constructor(e,t){this.adsManager=e,this.adReqId=t,this.isComplete=!1,this.readyPromise=new g.Z,this.startedPromise=new g.Z,this.showPromise=new g.Z,this.onAdError=e=>{this.isComplete=!0,this.destroy(e)},this.onAdLoaded=()=>{this.readyPromise.resolve()},this.onAdStarted=()=>{this.startedPromise.resolve()},this.onAdComplete=()=>{this.isComplete||(this.isComplete=!0,this.showPromise.resolve())},this.destroy=e=>{this.readyPromise.reject(e),this.showPromise.reject(e),this.startedPromise.reject(e)},this.start=()=>{try{this.adsManager.start()}catch(e){return e}},this.adsManager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,this.onAdError),this.adsManager.addEventListener(google.ima.AdEvent.Type.LOADED,this.onAdLoaded),this.adsManager.addEventListener(google.ima.AdEvent.Type.STARTED,this.onAdStarted),this.adsManager.addEventListener(google.ima.AdEvent.Type.ALL_ADS_COMPLETED,this.onAdComplete),this.adsManager.addEventListener(google.ima.AdEvent.Type.SKIPPED,this.onAdComplete),this.readyPromise.promise.catch((()=>{})),this.startedPromise.promise.catch((()=>{})),this.showPromise.promise.catch((()=>{}))}}var Li=s(65751),Di=s(31136);function Oi(e){return(e=>`https://pubads.g.doubleclick.net/gampad/ads?iu=${encodeURIComponent(e)}&description_url=https%3A%2F%2Fyandex.com&tfcd=0&sz=640x360%7C640x480&gdfp_req=1&output=vast&unviewed_position_start=1&env=vp&vpos=midroll&vad_type=linear&max_ad_duration=50000&vpa=auto&vpmute=0&nofb=1&plcmt=1`)(e.blockId)+function(e){const t={appID:e},s=(0,ce.X)();return void 0!==s&&(t.clid=s),"&cust_params="+encodeURIComponent(Li.stringify(t))}(e.appID)}const Bi=(e,t)=>{const s=(0,Di.D)(e).then((()=>!0));return e=>{return i=void 0,n=null,a=function*(){(yield Promise.race([s,e]))&&t()},new Promise(((e,t)=>{var s=e=>{try{o(a.next(e))}catch(e){t(e)}},r=e=>{try{o(a.throw(e))}catch(e){t(e)}},o=t=>t.done?e(t.value):Promise.resolve(t.value).then(s,r);o((a=a.apply(i,n)).next())}));var i,n,a}};const xi=(0,N.M$)("GoogleInstreamPrerender",N.XG.Adv,{background:"#d486f2"});class _i{constructor(e,t){this.service=e,this.adContainer=t,this.videoPlayer=document.createElement("video"),this.depth=0,this.createAdDisplayContainer=()=>{this.adDisplayContainer=new google.ima.AdDisplayContainer(this.adContainer,this.videoPlayer),this.adContainer.addEventListener("click",this.adContainerClick)},this.adContainerClick=()=>{this.adsManager&&this.adsManager.resume()},this.initAdsLoader=()=>{this.adsLoader=new google.ima.AdsLoader(this.adDisplayContainer),this.adsLoader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,this.onAdsManagerLoaded,!1),this.adsLoader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,this.onAdError,!1)},this.onAdError=e=>{var t;const s=e.getError();xi(s.getMessage()),(0,D.fF)(s),null==(t=this.currentAdLoading)||t.reject(s),this.currentAdLoading=void 0,this.resetSDK()},this.resetSDK=()=>{var e,t,s;xi("resetting sdk state"),null==(e=this.adsManager)||e.destroy(),null==(t=this.adsLoader)||t.contentComplete(),null==(s=this.adsLoader)||s.destroy(),this.initAdsLoader(),this.currentShow=void 0},this.onAdsManagerLoaded=e=>{var t;xi("ad manager loaded");const s=new google.ima.AdsRenderingSettings;s.enablePreloading=!(0,V.Rb)(this.service.advManager.flags),this.adsManager=e.getAdsManager(this.videoPlayer,s),this.currentShow=new Ci(this.adsManager,this.adReqId);const{width:i,height:n}=this.getRendererSize();this.adsManager.init(i,n,google.ima.ViewMode.NORMAL);this.service.advManager.getClickdaemonAdvLog(b.$.INTERSTITIAL).response({adReqId:this.adReqId,depth:this.depth,reason:O.Ud.SUCCESS}),null==(t=this.currentAdLoading)||t.resolve(),this.currentAdLoading=void 0},this.setRendererSize=({width:e,height:t})=>{d.Z.post({type:"instream-fullscreen-render",action:"set-size",data:{width:e,height:t}})},this.getRendererSize=()=>{const e=this.isHeaderEnabled?-32:0,t=(It.Z.isLandscape,e),s={width:window.innerWidth-4+0,height:window.innerHeight+t};return Ti.find((({width:e,height:t})=>e<=s.width&&t<=s.height))||s},this.onResizeHandler=()=>{var e;const t=this.getRendererSize();this.setRendererSize(t),null==(e=this.adsManager)||e.resize(t.width,t.height,google.ima.ViewMode.NORMAL)},this.videoPlayer.setAttribute("playsinline","true"),this.isHeaderEnabled=!(0,f.Ij)(),this.createAdDisplayContainer(),this.initAdsLoader(),this.setRendererSize(this.getRendererSize()),It.Z.addChangeListener(this.onResizeHandler),window.addEventListener("resize",this.onResizeHandler)}prefetchAd(){var e;(0,V.Rb)(this.service.advManager.flags)||(this.loadAd(O.p_.PRELOAD),null==(e=this.currentAdLoading)||e.promise.catch((e=>{var t;xi("prefetching failed");this.service.advManager.getClickdaemonAdvLog(b.$.INTERSTITIAL).error(this.adReqId,this.adSeqId||"",(null==(t=null==e?void 0:e.getMessage)?void 0:t.call(e))||"")})))}loadAd(e){if(xi(`asked to load an ad for ${e}`),this.currentAdLoading||this.currentShow)return;const t=new google.ima.AdsRequest,{advManager:s}=this.service,i=this.service.getAdvBlockId();t.adTagUrl=Oi({blockId:i,appID:s.appId});const n=this.getRendererSize();t.linearAdSlotWidth=n.width,t.linearAdSlotHeight=n.height,t.nonLinearAdSlotWidth=n.width,t.nonLinearAdSlotHeight=n.height,t.forceNonLinearFullSlot=!0,t.pageUrl="https://yandex.com/games";const a=s.getClickdaemonAdvLog(b.$.INTERSTITIAL);this.adReqId=a.request({advBlockId:i,advtype:b.e.GoogleInstream,depth:this.depth,reason:e}),this.currentAdLoading=new g.Z,this.adsLoader.requestAds(t)}getAdToShow(e,t){return s=this,i=null,n=function*(){if(xi("got call to show ads"),this.adSeqId=e,this.depth=t,this.currentShow||(this.currentAdLoading?xi("ad is already loading, waiting for it"):(xi("dont have any ad ready, trying to load it"),this.loadAd(O.p_.ONSPOT)),yield this.currentAdLoading.promise),this.adDisplayContainer.initialize(),xi("ad display container initialized!"),!this.currentShow)throw new Error("there is no current show, that should not happen");xi("ad data is ready, returning");const s=this.currentShow;return{showPromise:s.showPromise.promise.finally((()=>{this.resetSDK(),this.prefetchAd()})).catch((()=>{})),adReqId:s.adReqId,readyPromise:s.readyPromise.promise,startedPromise:s.startedPromise.promise,destroy:()=>s.destroy(),startAd:()=>{const e=s.start();if(e)throw xi("error starting an ad"),(0,D.fF)(e),s.destroy(),e}}},new Promise(((e,t)=>{var a=e=>{try{o(n.next(e))}catch(e){t(e)}},r=e=>{try{o(n.throw(e))}catch(e){t(e)}},o=t=>t.done?e(t.value):Promise.resolve(t.value).then(a,r);o((n=n.apply(s,i)).next())}));var s,i,n}}var Ni=s(46210);function qi({fullUrl:e}){const t=(0,Ni.Qs)(e);return t?(0,Ni.d2)(t):Pi}var Mi=(e,t,s)=>new Promise(((i,n)=>{var a=e=>{try{o(s.next(e))}catch(e){n(e)}},r=e=>{try{o(s.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,r);o((s=s.apply(e,t)).next())}));const $i=(0,N.M$)("GoogleInstream",N.XG.Adv,{background:"#d486f2"});const Fi="adv-instream-render",Wi=e=>({type:Fi,action:"show",data:e}),Zi=e=>({type:Fi,action:"hide",data:e}),Ui=e=>({type:Fi,action:"get-size",data:e});var Hi=(e,t,s)=>new Promise(((i,n)=>{var a=e=>{try{o(s.next(e))}catch(e){n(e)}},r=e=>{try{o(s.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,r);o((s=s.apply(e,t)).next())}));class zi{constructor(e,t){this.service=e,this.tag=t,this.imaAdsManager=null,this.waitForPreload=void 0,this.onImaAdsLoaderLoaded=null,this.onImaAdsLoaderError=null,this.debugLog=(0,N.M$)("GoogleInstreamPrerender",[N.XG.Adv,this.tag],{background:"#d486f2"}),this.onResizeHandler=()=>Hi(this,null,(function*(){var e;const{width:t,height:s}=yield this.getRendererSize();null==(e=this.imaAdsManager)||e.resize(t,s,google.ima.ViewMode.NORMAL)})),this.preload=e=>Hi(this,[e],(function*({advLogger:e=new $.U({app_id:this.service.advManager.appId,tag:this.tag}),reason:t=O.p_.PRELOAD,depth:s=0}){var i,n;if(this.waitForPreload)return this.waitForPreload.promise;this.debugLog(`preload called (reason: ${t})`),e||(e=this.service.advManager.alternateLogs?new $.U({app_id:this.service.advManager.appId,tag:this.tag}):this.service.advManager.getClickdaemonAdvLog(this.tag));const a=this.service.getAdvBlockId(this.tag,t),r=null!=(i=e.request({advBlockId:a,advtype:this.service.serviceName,provider:this.service.serviceName,depth:s,reason:t}))?i:"",o=new g.Z;this.waitForPreload=o;try{const i=new g.Z;o.promise.catch((()=>{this.debugLog("Resolve show promise due preload's promise rejection"),i.resolve()}));const{height:d,width:l}=yield this.getRendererSize(),c=new google.ima.AdsRequest;c.adTagUrl=Oi({blockId:a,appID:this.service.advManager.appId}),c.linearAdSlotWidth=c.nonLinearAdSlotWidth=l,c.linearAdSlotHeight=c.nonLinearAdSlotHeight=d,c.forceNonLinearFullSlot=!0,c.pageUrl="https://yandex.com/games",this.onImaAdsLoaderLoaded=t=>Hi(this,null,(function*(){var n;this.debugLog("preload response received",t);const a=new google.ima.AdsRenderingSettings,d=t.getAdsManager({currentTime:0,duration:0},a);d.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,(e=>{const t=e.getError(),s=new Error(`${t.getMessage()} [${t.getType()}]`);(0,f.g5)(this.service,{error:s}),o.state===g.C.Pending?o.reject(s):i.reject(s)})),d.addEventListener(google.ima.AdEvent.Type.LOADED,(t=>{this.debugLog("preload adv loaded (ready for playing)",t),o.resolve({adReqId:r,isEmpty:!1,advLogger:e,show:()=>(this.debugLog("show called"),d.start(),i.promise)})})),d.addEventListener(google.ima.AdEvent.Type.STARTED,(e=>{this.debugLog("adv started (video playing)",e)})),d.addEventListener(google.ima.AdEvent.Type.SKIPPED,(e=>{this.debugLog("adv skipped (clicked close button)",e)})),d.addEventListener(google.ima.AdEvent.Type.ALL_ADS_COMPLETED,(e=>{this.debugLog("adv finished (closed)",e),i.resolve()})),this.imaAdsManager=d,e instanceof $.U?e.response():null==e||e.response({adReqId:r,depth:s,reason:O.Ud.SUCCESS}),this.imaDisplayContainer.initialize();const{height:l,width:c}=yield this.getRendererSize();this.debugLog(`rendererSize height: ${l}, width: ${c}`),null==(n=this.imaAdsManager)||n.init(c,l,google.ima.ViewMode.NORMAL)})),this.onImaAdsLoaderError=i=>{var n;null==(n=this.imaAdsManager)||n.destroy();const a=i.getError(),d=`${a.getMessage()} [${a.getType()}]`;if(this.debugLog("preload load error",d),a.getErrorCode()===google.ima.AdError.ErrorCode.VAST_NO_ADS_AFTER_WRAPPER)return e instanceof $.U?e.responseEmpty():null==e||e.response({adReqId:r,depth:s,reason:O.Ud.EMPTY}),void o.resolve({adReqId:r,isEmpty:!0,advLogger:e});t===O.p_.PRELOAD&&(e instanceof $.U?null==e||e.error(d):e.error(r,"",d)),o.reject(new Error(d))},null==(n=this.imaAdsLoader)||n.requestAds(c)}catch(e){o.reject(e)}return o.promise})),this.getRendererSize=()=>Hi(this,null,(function*(){const e=yield d.Z.post(Ui({tag:this.tag})),{data:{width:t,height:s}}=e;const i=(0,f.Ij)()?0:32,n={width:window.innerWidth,height:window.innerHeight-i};return Ti.find((({width:e,height:t})=>e<=n.width&&t<=n.height))||n})),this.debugLog("init"),this.videoElement=document.createElement("video"),this.videoElement.setAttribute("playsinline","true"),this.videoContainer=document.querySelector(`#advBlock_${b.e.GoogleInstream}_${this.tag}`),this.videoContainer.addEventListener("click",(()=>{var e;try{null==(e=this.imaAdsManager)||e.resume()}catch(e){this.debugLog("videoContainer click resume error",e)}})),this.imaDisplayContainer=new google.ima.AdDisplayContainer(this.videoContainer,this.videoElement),this.imaAdsLoader=new google.ima.AdsLoader(this.imaDisplayContainer),this.imaAdsLoader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,(e=>{var t;return null==(t=this.onImaAdsLoaderLoaded)?void 0:t.call(this,e)}),!1),this.imaAdsLoader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,(e=>{var t;return null==(t=this.onImaAdsLoaderError)?void 0:t.call(this,e)}),!1),It.Z.addChangeListener(this.onResizeHandler),window.addEventListener("resize",this.onResizeHandler)}clear(){var e,t;null==(e=this.imaAdsManager)||e.destroy(),null==(t=this.waitForPreload)||t.resolve({adReqId:"",advLogger:void 0,isEmpty:!0}),delete this.waitForPreload}}var Gi=(e,t,s)=>new Promise(((i,n)=>{var a=e=>{try{o(s.next(e))}catch(e){n(e)}},r=e=>{try{o(s.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,r);o((s=s.apply(e,t)).next())}));const ji=(0,N.M$)("GoogleInstream",N.XG.Adv,{background:"#d486f2"});const Vi="undefined"!=typeof document&&(0,v.vV)(window.appData.abt.flags)?class extends L{constructor(e,t){super(e,t,b.e.GoogleInstream),this.isNoShow=!0,this.showFullscreenAdv=e=>Gi(this,[e],(function*({adSeqId:e,callbacks:t,clickDaemon:s,depth:i,reason:n,tag:a}){return new Promise(((r,o)=>Gi(this,null,(function*(){try{if(!this.interstitialPreload)throw new Error(`No ${a} preload created.`);const{adReqId:o,advLogger:l,isEmpty:c,show:h}=yield this.interstitialPreload.preload({advLogger:s,reason:n,depth:i});let u=this.lastAdReqId[b.$.REWARDED]=null!=o?o:"";if(s instanceof $.U&&l instanceof $.U&&s.bindRequest(l),c||!h)throw new f.lu(U.XO.INSTREAM_EMPTY,{isEmpty:!0});r((()=>Gi(this,null,(function*(){s instanceof B.i&&s.show(u,e),t.onOpen(!0),d.Z.post(Wi({tag:b.$.INTERSTITIAL})),yield h(),s instanceof B.i&&s.close(u,e),t.onClose(!0)}))))}catch(e){o(e)}}))))})),this.showRewardedVideo=e=>Gi(this,[e],(function*({adSeqId:e,callbacks:t,clickDaemon:s,depth:i,reason:n,tag:a}){return new Promise(((r,o)=>Gi(this,null,(function*(){try{if(!this.rewardedPreload)throw new Error(`No ${a} preload created.`);const{adReqId:o,advLogger:l,isEmpty:c,show:h}=yield this.rewardedPreload.preload({advLogger:s,reason:n,depth:i});let u=this.lastAdReqId[b.$.REWARDED]=null!=o?o:"";if(s instanceof $.U&&l instanceof $.U&&s.bindRequest(l),c||!h)throw new f.lu(U.XO.INSTREAM_EMPTY,{isEmpty:!0});r((()=>Gi(this,null,(function*(){s instanceof B.i&&s.show(u,e),t.onOpen(!0),d.Z.post(Wi({tag:b.$.REWARDED})),yield h(),s instanceof B.i&&s.rewarded(u,e),t.onRewarded(),s instanceof B.i&&s.close(u,e),t.onClose(!0)}))))}catch(e){o(e)}}))))})),(0,Di.D)(1e4).then((()=>{this.isNoShow=!1,ji("NoShow timeout elapsed")})),this.init()}getAdvBlockId(e,t){const s=e===b.$.REWARDED?(0,v.$7)(this.advManager.flags):(0,V.Jx)(this.advManager.flags);if(s)return s;return(0,m.getDomainConfig)().adv.interstitial.google.instream.desktop.blockId}checkCanShow(e,t){return this.isNoShow?T.Kc.Next:T.Kc.Ok}init(){return Gi(this,null,(function*(){try{yield(0,x.x)({id:"ima",src:Pi}),google.ima.settings.setLocale(this.advManager.lang),google.ima.settings.setDisableCustomPlaybackForIOS10Plus(!0),google.ima.settings.setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED),this.isTagActive(b.$.INTERSTITIAL)&&(yield hs({querySelector:`#advBlock_${b.e.GoogleInstream}_${b.$.INTERSTITIAL}`,interval:100,rejectTimeout:1500}),this.interstitialPreload=new zi(this,b.$.INTERSTITIAL),(0,V.Rb)(this.advManager.flags)||this.interstitialPreload.preload({}).catch((e=>(0,f.g5)(this,{error:e})))),this.isTagActive(b.$.REWARDED)&&(yield hs({querySelector:`#advBlock_${b.e.GoogleInstream}_${b.$.REWARDED}`,interval:100,rejectTimeout:1500}),this.rewardedPreload=new zi(this,b.$.REWARDED),this.rewardedPreload.preload({}).catch((e=>(0,f.g5)(this,{error:e})))),this.onServiceLoaded()}catch(e){ji(e),this.onServiceError(e)}}))}onShowAdvFinished({tag:e}){var t,s;switch(this.cancelShow(e),e){case b.$.INTERSTITIAL:(0,V.Rb)(this.advManager.flags)||null==(t=this.interstitialPreload)||t.preload({}).catch((e=>(0,f.g5)(this,{error:e,tag:b.$.INTERSTITIAL})));break;case b.$.REWARDED:null==(s=this.rewardedPreload)||s.preload({}).catch((e=>(0,f.g5)(this,{error:e,tag:b.$.REWARDED})))}}cancelShow(e){var t,s;switch(d.Z.post(Zi({tag:e})),e){case b.$.INTERSTITIAL:null==(t=this.interstitialPreload)||t.clear();break;case b.$.REWARDED:null==(s=this.rewardedPreload)||s.clear()}}}:class extends L{constructor(e,t){super(e,t,b.e.GoogleInstream),this.allScriptsInited=new g.Z,this.isNoShow=!0,(0,Di.D)(1e4).then((()=>{this.isNoShow=!1})),this.allScriptsInited.promise.catch((()=>{})),this.init()}getAdvBlockId(){const e=(0,V.Jx)(this.advManager.flags);if(e)return e;return(0,m.getDomainConfig)().adv.interstitial.google.instream.desktop.blockId}checkCanShow(e,t){return this.isNoShow?T.Kc.Next:T.Kc.Ok}init(){return Mi(this,null,(function*(){try{yield(0,x.x)({id:"ima",src:qi({fullUrl:window.location.href})});const{data:e}=yield d.Z.post({action:"update-block-id",data:{blockId:"advBlock_"+b.e.GoogleInstream},type:"instream-fullscreen-render",timeout:1e3}),{blockId:t}=e,s=yield hs({querySelector:`#${t}`,interval:100,rejectTimeout:1500});google.ima.settings.setLocale(this.advManager.lang),google.ima.settings.setDisableCustomPlaybackForIOS10Plus(!0),google.ima.settings.setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED),this.adContainer=s,this.adPrerender=new _i(this,this.adContainer),this.adPrerender.prefetchAd(),this.allScriptsInited.resolve(),this.onServiceLoaded()}catch(e){$i(e),(0,D.fF)(e),this.allScriptsInited.reject(),this.onServiceError()}}))}showFullscreenAdv({callbacks:e,clickDaemon:t,adSeqId:s,depth:i}){return new Promise(((n,a)=>Mi(this,null,(function*(){var r;let o;try{yield this.allScriptsInited.promise,o=yield this.adPrerender.getAdToShow(s,i)}catch(e){return void a()}try{const{startAd:i,destroy:a,adReqId:l,showPromise:c,readyPromise:h,startedPromise:u}=o;this.lastAdReqId.interstitial=l;const p=Bi(7e3,(()=>{throw $i("Timer cutoff!"),a(),new Error("Video ad cutoff by timer")}));$i("waiting for ad to be ready"),yield p(h),$i("ad ready, playing");let v=!1;c.then((()=>{t.close(l,s)})).catch((()=>{})).finally((()=>{var t;null==(t=e.onClose)||t.call(e,v),d.Z.post({type:"instream-fullscreen-render",action:"hide"})})),$i("calling manager to start ad"),i(),t.show(l,s),d.Z.post({type:"instream-fullscreen-render",action:"show"}),null==(r=e.onOpen)||r.call(e),v=!0,$i("waiting for playback to start"),yield p(u),n(),$i("ad playback started"),yield c}catch(e){a(e)}}))))}showRewardedVideo(){return Mi(this,null,(function*(){return Promise.reject()}))}};var Yi=s(92389),Ki=s(21466),Xi=s(69543),Ji=s(70135);var Qi=s(92691),en=s(14228),tn=s(37918),sn=Object.defineProperty,nn=Object.defineProperties,an=Object.getOwnPropertyDescriptors,rn=Object.getOwnPropertySymbols,on=Object.prototype.hasOwnProperty,dn=Object.prototype.propertyIsEnumerable,ln=(e,t,s)=>t in e?sn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,cn=(e,t,s)=>new Promise(((i,n)=>{var a=e=>{try{o(s.next(e))}catch(e){n(e)}},r=e=>{try{o(s.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,r);o((s=s.apply(e,t)).next())}));const hn={adsense:Ri,adsense_responsive:Ri,crazy_games:class extends L{constructor(e,t){super(e,t,b.e.CrazyGames),this.processShowResult=(e,t,s,i,n)=>{if("viewed"===s)return void i.response({adReqId:this.lastAdReqId[e],depth:t,clickUrl:"",reason:O.Ud.SUCCESS});const a=["error"].includes(s);i instanceof B.i?i.response({adReqId:this.lastAdReqId[e],depth:t,clickUrl:"",reason:a?`${O.Ud.ERROR}_${s}`:O.Ud.EMPTY}):i.responseEmpty(),n(new f.lu(`CrazyGames returned ${s} status`,{isEmpty:!a}))},this.openWithLog=(e,t,s,i)=>{e instanceof B.i&&e.show(t,s),null==i||i()},this.closeWithLog=(e,t,s,i)=>{e instanceof B.i&&e.close(t,s),null==i||i(!0)},this.showFullscreenAdv=e=>_(this,[e],(function*({callbacks:e,clickDaemon:t,adSeqId:s,reason:i,depth:n}){return new Promise(((a,r)=>{var o;const d=this.lastAdReqId[b.$.INTERSTITIAL]=t instanceof B.i?t.request({advBlockId:this.getAdvBlockId(b.$.INTERSTITIAL),advtype:this.serviceName,depth:n,reason:i}):"";try{null==(o=window.CrazyGames)||o.SDK.ad.requestAd("midgame",{adError:e=>{(0,f.qu)("[CrazyGames] showFullscreenAdv error",e),this.processShowResult(b.$.INTERSTITIAL,n,"error",t,r)},adFinished:()=>{this.closeWithLog(t,d,s,e.onClose),this.processShowResult(b.$.INTERSTITIAL,n,"viewed",t,r)},adStarted:()=>{this.openWithLog(t,d,s,e.onOpen),a()}})}catch(e){this.processShowResult(b.$.INTERSTITIAL,n,"error",t,r)}}))})),this.showRewardedVideo=e=>_(this,[e],(function*({callbacks:e,clickDaemon:t,adSeqId:s,reason:i,depth:n}){return new Promise(((a,r)=>{var o;const d=this.lastAdReqId[b.$.REWARDED]=t instanceof B.i?t.request({advBlockId:this.getAdvBlockId(b.$.REWARDED),advtype:this.serviceName,depth:n,reason:i}):"";try{null==(o=window.CrazyGames)||o.SDK.ad.requestAd("rewarded",{adError:e=>{(0,f.qu)("[CrazyGames] showRewardedVideo error",e),this.processShowResult(b.$.REWARDED,n,"error",t,r)},adFinished:()=>{this.closeWithLog(t,d,s,e.onClose),this.processShowResult(b.$.REWARDED,n,"viewed",t,r)},adStarted:()=>{this.openWithLog(t,d,s,e.onOpen),a()}})}catch(e){this.processShowResult(b.$.REWARDED,n,"error",t,r)}}))})),this.loadCrazyGamesSDKScript()}loadCrazyGamesSDKScript(){return _(this,null,(function*(){var e;try{if(yield(0,x.x)({id:"crazy-games-sdk",src:"https://sdk.crazygames.com/crazygames-sdk-v3.js"}),!(null==(e=window.CrazyGames)?void 0:e.SDK))throw new Error("No window.CrazyGames.SDK");yield window.CrazyGames.SDK.init();const{environment:t}=window.CrazyGames.SDK;if(!t||!["crazygames","local"].includes(t))throw new Error("Unexpected SDK environment: "+t);this.onServiceLoaded()}catch(e){(0,D.fF)(e),this.onServiceError()}}))}getAdvBlockId(e,t){return"crazy_games_block_id"}},google_instream:Vi,google_manual:class extends L{constructor(e,t){super(e,t,b.e.GoogleManual),this.lastShowTime=-1,this.interstitialPreload=new W(this),this.showFullscreenAdv=e=>G(this,[e],(function*({callbacks:e,clickDaemon:t,adSeqId:s,reason:i,depth:n}){return new Promise(((a,r)=>G(this,null,(function*(){const{isEmpty:o,adReqId:d,clickDaemon:l,waitForShow:c}=yield this.interstitialPreload.preload({reason:i,depth:n,clickDaemon:t});this.lastAdReqId[b.$.INTERSTITIAL]=d,t instanceof $.U&&l instanceof $.U&&t.bindRequest(l);const h=()=>{window.setTimeout((()=>{this.interstitialPreload.preload()}),.75*this.advManager.minIntervalBetweenAds)};if(o||!c)return h(),void r(new f.lu(U.XO.EMPTY_SLOT,{isEmpty:!0}));this.lastShowTime=Date.now(),a(),t instanceof B.i&&t.show(d,s),e.onOpen(!0),yield c(),t instanceof B.i&&t.close(d,s),e.onClose(!0),h()}))))})),this.showRewardedVideo=()=>G(this,null,(function*(){return Promise.reject("Not implemented")})),this.init()}init(){return G(this,null,(function*(){try{yield(0,M.S$)(),yield this.initGPT(),this.onServiceLoaded(),this.interstitialPreload.preload()}catch(e){this.onServiceError(e.message)}}))}checkCanShow(e,t){return Math.abs(Date.now()-this.lastShowTime)<2*I.yR?T.Kc.Next:super.checkCanShow(e,t)}getAdvBlockId(e){if(e===b.$.INTERSTITIAL)return this.advManager.allAdvBlocks.google.manual;throw new Error(`AdvTag ${e} not supported by this service.`)}initGPT(){return G(this,null,(function*(){yield(0,M.Vg)(),yield(0,M.bT)((e=>G(this,null,(function*(){const{advManager:t}=this,s=yield new Z.Z(window.appData.apiData).getGoogleKeyValues({appID:t.appId,platform:t.context.platform,lang:t.lang}).catch((e=>{throw(0,H.H)({block:z.W.GOOGLE_ADS,message:"Trouble with getting google key values"},e),e})),i=e.pubads();Object.entries(s).forEach((([e,t])=>{i.setTargeting(e,t)}))}))))}))}cancelShow(e){if(e===b.$.INTERSTITIAL)this.interstitialPreload.cancel()}},native:class extends L{constructor(e,t){super(e,t,b.e.Native),this.fullscreenPreloadAdStatus="not_preloaded",this.rewardedPreloadAdStatus="not_preloaded",this.fullscreenShowAdNumber=0,this.rewardedShowAdNumber=0,this.depth=0,this.adReqIds={fullscreen:"",rewarded:""},this.showFullscreenAdv=e=>Se(this,[e],(function*({adSeqId:e,callbacks:t,clickDaemon:s}){return new Promise(((i,n)=>Se(this,null,(function*(){var a;const{advManager:r}=this;this.fullscreenShowAdNumber+=1;const o=i=>{var n;t.onClose(i),r.callOnAdvClose(i),!i||s instanceof $.U||s.close(this.adReqIds.fullscreen,e),"preloading"!==this.fullscreenPreloadAdStatus&&(this.preloadFullscreenAdvPromise=void 0),n=r.flags,!1!==(0,V.RM)(n,Y.Z.enablePreloadNativeFullscreen)&&this.preloadFullscreenAdv({clickDaemon:s})};try{t.onOpen(!1),i();const n=yield Promise.race([this.preloadFullscreenAdv({clickDaemon:s}),(0,j.D)(Ee).then((()=>{throw new Error("Fullscreen preload timeout")}))]);s instanceof $.U&&n instanceof $.U&&s.bindRequest(n),yield this.nativeAdv.showFullscreenAdv({onShowCalled:()=>{s instanceof $.U?s.show():s.show(this.adReqIds.fullscreen,e)}}),o(!0)}catch(i){String(i.message).includes(ke)||String(null==(a=this.lastFullscreenError)?void 0:a.message).includes(ke)?s instanceof $.U||s.noContent(this.adReqIds.fullscreen,e):s instanceof $.U?s.error(i.message):s.error(this.adReqIds.fullscreen,e,i.message),(0,f.g5)(this,{tag:b.$.INTERSTITIAL,error:i,name:"Native fullscreen adv error",additional:{adNumber:this.fullscreenShowAdNumber}}),"not_preloaded"===this.fullscreenPreloadAdStatus?(0,f.g5)(this,{tag:b.$.INTERSTITIAL,error:i,name:"ad was not preloaded",additional:{adNumber:this.fullscreenShowAdNumber}}):"preloading"===this.fullscreenPreloadAdStatus&&(0,f.g5)(this,{tag:b.$.INTERSTITIAL,error:i,name:"ad is still preloading",additional:{adNumber:this.fullscreenShowAdNumber}}),t.onError(i),o(!1),n(i)}}))))})),this.showRewardedVideo=e=>Se(this,[e],(function*({adSeqId:e,callbacks:t,clickDaemon:s}){return new Promise(((i,n)=>Se(this,null,(function*(){var a;this.rewardedShowAdNumber+=1;const r=()=>{var e;t.onClose(),"preloading"!==this.rewardedPreloadAdStatus&&(this.preloadRewardedAdvPromise=void 0),e=this.advManager.flags,!1!==(0,V.RM)(e,Y.Z.enablePreloadNativeRewarded)&&this.preloadRewardedAdv({clickDaemon:s,reason:O.p_.PRELOAD})};try{t.onOpen(!1),i();const n=yield Promise.race([this.preloadRewardedAdv({clickDaemon:s,reason:O.p_.ONSPOT}),(0,j.D)(Ie).then((()=>{throw new Error("Rewarded preload timeout")}))]);s instanceof $.U&&n instanceof $.U&&s.bindRequest(n),yield this.nativeAdv.showRewardedVideo({onShowCalled:()=>{s instanceof $.U?s.show():s.show(this.adReqIds.rewarded,e)}}),s instanceof $.U||(s.rewarded(this.adReqIds.rewarded,e),s.close(this.adReqIds.rewarded,e)),t.onRewarded(),r()}catch(i){String(i.message).includes(ke)||String(null==(a=this.lastRewardedError)?void 0:a.message).includes(ke)?s instanceof $.U||s.noContent(this.adReqIds.rewarded,e):s instanceof $.U?s.error(i.message):s.error(this.adReqIds.rewarded,e,i.message),String(i.message).includes("User closed ad before it's end.")&&(s instanceof $.U?s.close():s.close(this.adReqIds.rewarded,e)),(0,f.g5)(this,{tag:b.$.REWARDED,error:i,name:"Native rewarded video error",additional:{adNumber:this.rewardedShowAdNumber}}),"not_preloaded"===this.rewardedPreloadAdStatus?(0,f.g5)(this,{tag:b.$.REWARDED,error:i,name:"ad was not preloaded",additional:{adNumber:this.rewardedShowAdNumber}}):"preloading"===this.rewardedPreloadAdStatus&&(0,f.g5)(this,{tag:b.$.REWARDED,error:i,name:"ad is still preloading",additional:{adNumber:this.rewardedShowAdNumber}}),t.onError(i),r(),n(i)}}))))})),(0,K.x)()?this.nativeAdv=function(e){const t=window.appData.isGamesLiteApp;let s=null;function i(){return Ae(this,null,(function*(){return null!==s||(s=yield te({advBlocks:e.advBlocks,flags:e.flags,residenceInfo:e.residenceInfo})),s}))}function n(t,s){return re((0,V.Qx)(e.flags)?t:void 0,s)}return{getFullscreenBlockId(){return Ae(this,null,(function*(){const{fullscreenBlock:e}=yield i();return e}))},getRewardedBlockId(){return Ae(this,null,(function*(){const{rewardedBlock:e}=yield i();return e}))},preloadFullscreenAdv(){return Ae(this,null,(function*(){const{fullscreenBlock:e}=yield i(),s=n(e,ie);console.info("[Native adv TV] preload","fullscreen instream pageId:",s);const a=()=>{var e,t,i;return null==(i=null==(t=null==(e=window.yandex)?void 0:e.ads)?void 0:t.preloadInstreamAdv)?void 0:i.call(t,s,se)};return t?a():fe("preload",a)}))},preloadRewardedVideo(){return Ae(this,null,(function*(){const{rewardedBlock:e}=yield i(),s=n(e,ne);console.info("[Native adv TV] preload","rewarded instream pageId:",s);const a=()=>{var e,t,i;return null==(i=null==(t=null==(e=window.yandex)?void 0:e.ads)?void 0:t.preloadInstreamAdv)?void 0:i.call(t,s,se)};return t?a():fe("preload",a)}))},showFullscreenAdv(e){return Ae(this,arguments,(function*({onShowCalled:e}){const{fullscreenBlock:s}=yield i(),a=n(s,ie);if(console.info("[Native adv TV] show","fullscreen instream pageId:",a,s),!s&&!a)return Promise.reject(new Error("No fullscreen block for show"));const r=()=>{var t,s,i,n,r;return(null==(s=null==(t=window.yandex)?void 0:t.ads)?void 0:s.showInstreamAdv)&&e(),null==(r=null==(n=null==(i=window.yandex)?void 0:i.ads)?void 0:n.showInstreamAdv)?void 0:r.call(n,a)};return t?r():fe("show",r)}))},showRewardedVideo(e){return Ae(this,arguments,(function*({onShowCalled:e}){const{rewardedBlock:s}=yield i(),a=n(s,ne);if(console.info("[Native adv TV] show","rewarded instream pageId:",a),!s)return Promise.reject(new Error("No rewarded block for show"));const r=()=>{var t,s,i,n,r;return(null==(s=null==(t=window.yandex)?void 0:t.ads)?void 0:s.showInstreamAdv)&&e(),null==(r=null==(n=null==(i=window.yandex)?void 0:i.ads)?void 0:n.showInstreamAdv)?void 0:r.call(n,a)};return t?r():fe("show",r)}))}}}(this.advManager):this.nativeAdv=be(this.advManager),(0,K.x)()&&!(0,V.dx)(e.flags)||this.init()}init(){this.onServiceLoaded();const{flags:e}=this.advManager;!this.hasFullscreenAdv||this.advManager.isInterstitialAdsTurnOff||function(e){return!1===(0,V.RM)(e,Y.Z.enablePreloadNativeFullscreenOnStart)}(e)||this.preloadFullscreenAdv({clickDaemon:this.advManager.alternateLogs?new $.U({app_id:this.advManager.appId,tag:b.$.INTERSTITIAL}):this.advManager.getClickdaemonAdvLog(b.$.INTERSTITIAL)}),this.hasRewarderdAdv&&this.advManager.advBlocks.rewarded&&!function(e){return!1===(0,V.RM)(e,Y.Z.enablePreloadNativeRewardedOnStart)}(e)&&(this.preloadRewardedAdvTimer=setTimeout((()=>{this.preloadRewardedAdv({clickDaemon:this.advManager.alternateLogs?new $.U({app_id:this.advManager.appId,tag:b.$.REWARDED}):this.advManager.getClickdaemonAdvLog(b.$.REWARDED),reason:O.p_.PRELOAD}),this.preloadRewardedAdvTimer=null}),15*I.WT))}getAdvBlockId(e){var t,s;return e===b.$.REWARDED?null!=(t=this.rewardedBlock)?t:super.getAdvBlockId(e):null!=(s=this.fullscreenBlock)?s:super.getAdvBlockId(e)}getTimeoutExtraTime(e,t){return e===T.QA.ShowFullscreen||e===T.QA.ShowRewarded?5e3:super.getTimeoutExtraTime(e,t)}withFullscreenBlockId(e){this.fullscreenBlock?e(this.fullscreenBlock):this.nativeAdv.getFullscreenBlockId().then((t=>{this.fullscreenBlock=t,e(t)}))}withRewardedBlockId(e){this.rewardedBlock?e(this.rewardedBlock):this.nativeAdv.getRewardedBlockId().then((t=>{this.rewardedBlock=t,e(t)}))}preloadFullscreenAdv({clickDaemon:e}){return this.preloadFullscreenAdvPromise||(this.preloadFullscreenAdvPromise=new Promise(((t,s)=>{this.withFullscreenBlockId((i=>{this.rawPreloadFullscreenAdv({fullscreenBlock:i,clickDaemon:e}).then((e=>{t(e)})).catch(s)}))}))),this.preloadFullscreenAdvPromise}rawPreloadFullscreenAdv(e){return Se(this,arguments,(function*({fullscreenBlock:e,clickDaemon:t}){this.lastFullscreenError=void 0,this.fullscreenPreloadAdStatus="preloading";try{const s=window.sessionStorage.getItem(J.az),i=s?JSON.parse(s):void 0,n=null==i?void 0:i.ad_req_id;if(n)return sessionStorage.removeItem(J.az),this.adReqIds.fullscreen=n,t instanceof B.i?t.restoreRequest(i):t.request({adReqId:n,advBlockId:e}),this.fullscreenPreloadAdStatus="preloaded",t}catch(e){(0,f.g5)(this,{tag:b.$.INTERSTITIAL,error:e,name:"Error while restore request from sessionStorage"})}return this.adReqIds.fullscreen=t instanceof $.U?"":t.request({depth:this.depth,reason:O.p_.PRELOAD,advBlockId:e,advtype:b.e.Native}),t instanceof $.U&&t.request({advBlockId:e,provider:b.e.Native,reason:O.p_.PRELOAD}),this.nativeAdv.preloadFullscreenAdv().then((()=>(t.response({adReqId:this.adReqIds.fullscreen,depth:this.depth,reason:O.Ud.SUCCESS}),this.fullscreenPreloadAdStatus="preloaded",t))).catch((e=>{throw this.lastFullscreenError=e,t instanceof B.i?t.response({adReqId:this.adReqIds.fullscreen,depth:this.depth,reason:`${O.Ud.ERROR}_${e.message}`}):t.error(e.message),(0,f.g5)(this,{tag:b.$.INTERSTITIAL,error:e,name:"preloading failed"}),this.fullscreenPreloadAdStatus="not_preloaded",de("preloadFullscreenAdv",e.message),e}))}))}preloadRewardedAdv({clickDaemon:e,reason:t}){return this.preloadRewardedAdvTimer&&(clearTimeout(this.preloadRewardedAdvTimer),this.preloadRewardedAdvTimer=null),this.preloadRewardedAdvPromise||(this.preloadRewardedAdvPromise=new Promise(((s,i)=>{this.withRewardedBlockId((n=>{this.rawPreloadRewardedAdv({rewardedBlock:n,clickDaemon:e,reason:t}).then((e=>{s(e)})).catch(i)}))}))),this.preloadRewardedAdvPromise}rawPreloadRewardedAdv({rewardedBlock:e,clickDaemon:t,reason:s}){return this.lastRewardedError=void 0,this.rewardedPreloadAdStatus="preloading",this.adReqIds.rewarded=t instanceof $.U?"":t.request({depth:this.depth,reason:s,advBlockId:e,advtype:b.e.Native}),t instanceof $.U&&t.request({advBlockId:e,provider:b.e.Native,reason:s}),this.nativeAdv.preloadRewardedVideo().then((()=>(t.response({adReqId:this.adReqIds.rewarded,depth:this.depth,reason:O.Ud.SUCCESS}),this.rewardedPreloadAdStatus="preloaded",t))).catch((e=>{throw this.lastRewardedError=e,t instanceof $.U?t.error(e.message):t.response({adReqId:this.adReqIds.rewarded,depth:this.depth,reason:`${O.Ud.ERROR}_${e.message}`}),(0,f.g5)(this,{tag:b.$.REWARDED,error:e,name:"preloading failed"}),this.rewardedPreloadAdStatus="not_preloaded",de("preloadRewardedVideo",e.message),e}))}},onboarding_promo:class extends Te{constructor(e,t){super(e,t,b.e.OnboardingPromo),this.isNonWaterfallPromoTimeoutReady=!1,setTimeout((()=>{this.isNonWaterfallPromoTimeoutReady=!0}),15e3)}checkCanShow(e,t){return e===b.$.REWARDED?super.checkCanShow(e,t):this.isOnboardingPromoReady()?We()?super.checkCanShow(e,t):T.Kc.NextRemove:T.Kc.Next}isOnboardingPromoReady(){const{firstShowGuard:e}=this.advManager;return this.isNonWaterfallPromoTimeoutReady&&e.canShowAdv()}},parent_window:class extends L{constructor(e,t){if(super(e,t,b.e.ParentWindow),window===window.parent)return this.parentWindowApiIsAlive=!1,void this.onServiceError(new Error("No parent window"));this.messageListener=new Ue,this.onServiceLoaded(),this.addStartLivenessListener()}addStartLivenessListener(){const e=He({action:"ping",type:"liveness"}),t=this.messageListener.addListener({fn:e=>{const{action:t,payload:i,type:n}=e;switch(n){case"liveness":"pong"===t&&(window.clearTimeout(s),this.parentWindowApiIsAlive=!0);break;case"error":this.parentWindowApiIsAlive=!1,Ge("error",e);break;default:this.parentWindowApiIsAlive=!1,Ge(`[${Date.now()}] Unknown message "${n}:${t}", payload = ${JSON.stringify(i)}`)}return!0},messageId:e}),s=window.setTimeout((()=>{t(),this.parentWindowApiIsAlive=!1}),2e3)}getAdvBlockId(e,t){return"parent_window"}checkCanShow(e,t){return void 0===this.parentWindowApiIsAlive?T.Kc.Next:this.parentWindowApiIsAlive?T.Kc.Ok:T.Kc.NextRemove}showFullscreenAdv(e){return ze(this,arguments,(function*({callbacks:e,clickDaemon:t,adSeqId:s,reason:i,depth:n}){return new Promise(((a,r)=>ze(this,null,(function*(){Ge.spoiler(i,n)("showFullscreenAdv",e);const o=this.lastAdReqId[b.$.INTERSTITIAL]=t instanceof B.i?t.request({advtype:this.serviceName,depth:n,advBlockId:this.getAdvBlockId(b.$.INTERSTITIAL,i),reason:i}):"";t instanceof $.U&&t.request();const d=He({action:"showInterstitial",type:"adv"}),l=this.messageListener.addListener({fn:i=>{const{action:d,payload:l,type:h}=i;switch(h){case"adv":if("showInterstitial"===d)switch(window.clearTimeout(c),Ge("showInterstitial callback",i),l.status){case"close":return t instanceof B.i&&t.close(o,s),e.onClose(),!0;case"empty":return t instanceof $.U&&t.responseEmpty(),r(new f.lu(k.qS,{isEmpty:!0})),!0;case"error":return t instanceof B.i&&t.error(o,s,l.error||""),t instanceof $.U&&t.error(l.error||""),r(new Error(`ParentWindow error ${l.error||""}`)),!0;case"open":case"start":break;case"show":t.response({adReqId:o,depth:n,reason:O.Ud.SUCCESS}),t instanceof B.i&&t.show(o,s),e.onOpen(),a();break;default:Ge(`Unknown payload.status = "${l.status}"`)}break;case"error":return window.clearTimeout(c),Ge("error",i),r(new Error(`ParentWindow error ${l.error||""}`)),!0;default:Ge(`[${Date.now()}] Unknown message "${h}:${d}", payload = ${JSON.stringify(l)}`)}return!1},messageId:d}),c=window.setTimeout((()=>{l(),this.parentWindowApiIsAlive=!1,r(new Error("showInterstitial is not started"))}),5e3)}))))}))}showRewardedVideo(e){return ze(this,arguments,(function*({callbacks:e,clickDaemon:t,adSeqId:s,reason:i,depth:n}){return new Promise(((a,r)=>ze(this,null,(function*(){Ge.spoiler(i,n)("showRewardedVideo",e);const o=this.lastAdReqId[b.$.REWARDED]=t instanceof B.i?t.request({advtype:this.serviceName,depth:n,advBlockId:this.getAdvBlockId(b.$.REWARDED,i),reason:i}):"";t instanceof $.U&&t.request();const d=He({action:"showRewarded",type:"adv"}),l=this.messageListener.addListener({fn:i=>{const{action:d,payload:l,type:h}=i;switch(h){case"adv":if("showRewarded"===d)switch(window.clearTimeout(c),Ge("showRewarded callback",i),l.status){case"close":return t instanceof B.i&&t.close(o,s),e.onClose(),!0;case"empty":return t instanceof $.U&&t.responseEmpty(),r(new f.lu(k.qS,{isEmpty:!0})),!0;case"error":return t instanceof B.i&&t.error(o,s,l.error||""),t instanceof $.U&&t.error(l.error||""),r(new Error(`ParentWindow error ${l.error||""}`)),!0;case"open":case"start":break;case"rewarded":t instanceof B.i&&t.rewarded(o,s),e.onRewarded();break;case"show":t.response({adReqId:o,depth:n,reason:O.Ud.SUCCESS}),t instanceof B.i&&t.show(o,s),e.onOpen(),a();break;default:Ge(`Unknown payload.status = "${l.status}"`)}break;case"error":return window.clearTimeout(c),Ge("error",i),r(new Error(`ParentWindow error ${l.error||""}`)),!0;default:Ge(`[${Date.now()}] Unknown message "${h}:${d}", payload = ${JSON.stringify(l)}`)}return!1},messageId:d}),c=window.setTimeout((()=>{l(),this.parentWindowApiIsAlive=!1,r(new Error("showRewarded is not started"))}),5e3)}))))}))}},prebid_tgo:class extends L{constructor(e,t){super(e,t,b.e.PrebidTGO),this.fullscreenSlot=null,this.isPlayhop=!1,this.useRewarded=!1,this.usePrebid=!0,this.usePreload=!1,this.useMultiAuction=!1,this.waitForAuction=new g.Z,this.startPrebidAuction=(0,Dt.P)((()=>{if(At("Start prebid auction"),this.isPrebidAuctionRunning)return;this.isPrebidAuctionRunning=!0;const{pbjs:e}=window;this.prebidAuctionTimeout=window.setTimeout((()=>{At("No auction handled, call empty function."),this.prebidAuctionHandler()}),U.XI),e.que.push((()=>Wt(this,null,(function*(){e.requestBids({adUnitCodes:[this.getAdvBlockId(b.$.INTERSTITIAL)],bidsBackHandler:this.prebidAuctionHandler,timeout:U.ZV})}))))}),U.kw),this.prebidAuctionHandler=(e,t)=>{clearTimeout(this.prebidAuctionTimeout),t&&(0,D.fF)(new Error("[prebid_sticky] Auction finished with bidders timed out.")),(0,Lt.H)({advTag:b.$.INTERSTITIAL,adUnitCodes:[this.getAdvBlockId(b.$.INTERSTITIAL)],bids:e});const{pbjs:s,googletag:i}=window;i.cmd.push((()=>{s.que.push((()=>{s.setTargetingForGPTAsync([this.getAdvBlockId(b.$.INTERSTITIAL)]),At("End prebid auction"),this.waitForAuction.resolve(),this.isPrebidAuctionRunning=!1}))}))},this.showFullscreenAdv=e=>Wt(this,[e],(function*({callbacks:e,clickDaemon:t,adSeqId:s,reason:i,depth:n,initialTag:a}){return new Promise(((r,o)=>Wt(this,null,(function*(){this.clearPreloadInterstitialTimer();let l="";this.usePreload||(l=this.lastAdReqId[b.$.INTERSTITIAL]=t instanceof B.i?t.request({advBlockId:this.getAdvBlockId(b.$.INTERSTITIAL,i),advtype:this.serviceName,depth:n,reason:i}):"",this.usePrebid&&this.useMultiAuction&&(yield this.waitForAuction.promise)),yield(0,M.bT)((()=>Wt(this,null,(function*(){try{if(!this.usePreload){if(null===this.fullscreenSlot)return void o(new Error("Called showFullscreenAdv, while gptSlot not ready"));!function({slot:e,method:t,debugLog:s}){t===V.qb.CLEAR_BEFORE_REFRESH?e?(s("Clearing slot before refresh with googletag.pubads().clear"),googletag.pubads().clear([e])):s("No slot to clear"):t===V.qb.INNER_TEXT_BEFORE_REFRESH&&(s("Clearing slot before refresh with el.innerText"),bt())}({method:this.clearSlotMethod,slot:this.fullscreenSlot,debugLog:At})}let c=!1;if(At("Call fullscreen show"),d.Z.post({type:"adv-fullscreen-block",action:"show",data:{onOpen:()=>{e.onOpen(!1)},onClose:()=>{t instanceof B.i&&c&&(a===b.$.REWARDED&&t.rewarded(l,s),t.close(l,s)),function({slot:e,method:t,debugLog:s}){t===V.qb.CLEAR_AFTER_ONCLOSE?e?(s("Clearing slot after onClose with googletag.pubads().clear"),googletag.pubads().clear([e])):(s("Clearing slot after onClose with googletag.pubads().clear"),s("No slot to clear")):t===V.qb.INNER_TEXT_AFTER_ONCLOSE&&(s("Clearing slot after onClose with el.innerText"),bt())}({method:this.clearSlotMethod,slot:this.fullscreenSlot,debugLog:At}),(a!==b.$.REWARDED||c)&&(e.onClose(c),this.preloadInterstitial())}}}),this.usePreload){const{isEmpty:e,adReqId:a,clickDaemon:o}=yield this.interstitialPreload.preload({reason:i,depth:n,clickDaemon:t});if(l=this.lastAdReqId[b.$.INTERSTITIAL]=null!=a?a:"",t instanceof $.U&&o instanceof $.U&&t.bindRequest(o),e)throw new f.lu(U.XO.EMPTY_SLOT,{isEmpty:!0});c=!0,r(),yield this.interstitialPreload.show(),t instanceof $.U?t.show():t instanceof B.i&&t.show(l,s),d.Z.post({type:"adv-fullscreen-block",action:"show-controls",data:{blockName:this.serviceName}})}else{const e=Date.now();this.slotRenderEndedCallback=i=>{const a=Date.now()-e;At(`Googletag slot render time: ${a}ms`),(0,C.s4)("play_prebid_interstitial_slot_render_time",a),i.isEmpty?(t instanceof $.U?t.responseEmpty():(t.response({adReqId:l,depth:n,reason:O.Ud.EMPTY}),t.noContent(l,s)),o(new f.lu(U.XO.EMPTY_SLOT,{isEmpty:!0}))):(c=!0,t instanceof $.U?t.response():t.response({adReqId:l,depth:n,reason:O.Ud.SUCCESS}),r()),this.usePrebid&&this.useMultiAuction&&googletag.cmd.push((()=>{this.startPrebidAuction()}))},t instanceof $.U?(this.slotImpressionViewableCallback=()=>{t.show()},t.request()):t instanceof B.i&&(this.slotImpressionViewableCallback=()=>{t.show(l,s)}),googletag.pubads().refresh([this.fullscreenSlot])}}catch(e){this.preloadInterstitial(),o(e)}}))))}))))})),this.showRewardedVideo=e=>Wt(this,[e],(function*({callbacks:e,clickDaemon:t,adSeqId:s,depth:i,reason:n}){return new Promise(((a,r)=>Wt(this,null,(function*(){try{const{isEmpty:r,adReqId:o,waitForShow:d,clickDaemon:l}=yield this.rewardedPreload.preload({depth:i,clickDaemon:t,reason:n});let c=this.lastAdReqId[b.$.REWARDED]=null!=o?o:"";if(t instanceof $.U&&l instanceof $.U&&t.bindRequest(l),r||!d)throw new f.lu(U.XO.EMPTY_SLOT,{isEmpty:!0});a(),t instanceof B.i&&t.show(c,s),e.onOpen(!0);const{wasShown:h}=yield d({onRewarded:()=>{t instanceof B.i&&t.rewarded(c,s),e.onRewarded()}});t instanceof B.i&&t.close(c,s),e.onClose(h)}catch(e){r(e)}}))))}));const{flags:s}=e;this.isPlayhop=e.context.secondDomain===Ot.U.PLAYHOP,this.isTagActive(b.$.INTERSTITIAL)&&(0,V.Wv)(s)||(this.usePrebid=!1),this.useMultiAuction=(0,V.A)(s),this.isTagActive(b.$.REWARDED)&&(this.useRewarded=!0,this.rewardedPreload=new Tt(this)),this.usePreload=!(0,V.Ye)(s),this.usePreload&&(this.interstitialPreload=new Et(this)),this.clearSlotMethod=this.isPlayhop?V.qb.CLEAR_BEFORE_REFRESH:(0,V.hs)(s),this.api=new Z.Z(window.appData.apiData),this.init()}getTimeoutExtraTime(e,t){if(e===T.QA.ShowFullscreen&&t===O.p_.START_FULLSCREEN)return 2e3}getAdvBlockId(e,t=O.p_.ONSPOT){switch(e){case b.$.INTERSTITIAL:return t===O.p_.START_FULLSCREEN?this.advManager.allPrebidAdvBlocks.preroll:this.advManager.allPrebidAdvBlocks.interstitial;case b.$.REWARDED:return this.advManager.allPrebidAdvBlocks.rewarded;default:throw new Error(`AdvTag ${e} not supported by this service.`)}}init(){return Wt(this,null,(function*(){var e,t;const s=(0,Ct.cQ)({cdnUrl:this.advManager.context.cdnUrl,flags:this.advManager.flags,fullUrl:window.location.href,options:{isSlowCountry:this.advManager.context.isSlowCountry}});yield(0,M.xq)({metrikaCounter:null==(e=(0,m.getDomainConfig)().analytics.counters)?void 0:e.metrika,parallel:null!=(t=(0,V.RM)(this.advManager.flags,Y.Z.prebidLoadAfterGpt))&&t,prebidScriptUrl:this.usePrebid?s:void 0}).then((e=>{e.prebid||(this.usePrebid=!1,this.waitForAuction.resolve(),e.prebidError&&(0,f.g5)(this,{error:new Error(`Failed to load Prebid.js: ${e.prebidError.message}`)})),e.gpt?window.setTimeout((()=>{this.initGPT().then((()=>this.usePrebid?this.initPrebid():void 0)).then((()=>{this.preloadInterstitial(),this.useRewarded&&this.hasRewarderdAdv&&this.rewardedPreload.preload().catch((e=>At("Preload error",e)))})).catch((e=>{At(e),this.onServiceError(e)}))}),0):(At(e.gptError),this.onServiceError(e.gptError))}))}))}initGPT(){return Wt(this,null,(function*(){return yield(0,M.Vg)(),(0,M.bT)((e=>{var t,s;const i=e.pubads(),n=this.options.tags[b.$.INTERSTITIAL]===T.pP.Start?O.p_.START_FULLSCREEN:O.p_.ONSPOT;if(!this.usePreload){if(this.fullscreenSlot=null!=(s=null==(t=e.defineSlot(this.getAdvBlockId(b.$.INTERSTITIAL,n),U.xH,wt))?void 0:t.addService(i))?s:null,!this.fullscreenSlot)throw new Error(U.XO.NO_SLOT);i.addEventListener("slotRenderEnded",(e=>{var t;const{slot:s}=e;s===this.fullscreenSlot&&(null==(t=this.slotRenderEndedCallback)||t.call(this,e))})).addEventListener("impressionViewable",(e=>{var t;const{slot:s}=e;s===this.fullscreenSlot&&(null==(t=this.slotImpressionViewableCallback)||t.call(this,e),d.Z.post({type:"adv-fullscreen-block",action:"show-controls"}))}))}e.enableServices(),this.onServiceLoaded()}))}))}initPrebid(){return Wt(this,null,(function*(){yield(0,Ct.BA)((e=>Wt(this,null,(function*(){yield(0,Ct.OH)();const t=(0,V.Ed)(this.advManager.flags)?"dsail":"default",s=((e,t)=>_t(e,Nt(t)))(((e,t)=>{for(var s in t||(t={}))Mt.call(t,s)&&Ft(e,s,t[s]);if(qt)for(var s of qt(t))$t.call(t,s)&&Ft(e,s,t[s]);return e})({},(0,U.Vc)(this.isPlayhop,"desktop",t)),{code:this.getAdvBlockId(b.$.INTERSTITIAL)}),i=(0,V.QR)(this.advManager.flags,Y.Z.prebidExtraBids);if((0,Bt.GI)(i)){const e=i.reduce(((e,t)=>(U.Hf[t]&&e.push(U.Hf[t]),e)),[]);s.bids=[...s.bids,...e]}const n=(0,V.QR)(this.advManager.flags,Y.Z.prebidDisabledBids);(0,Bt.GI)(n)&&(s.bids=s.bids.filter((({bidder:e})=>!n.includes(e)))),At("interstitial ad units react",s),e.addAdUnits(s),e.onEvent("auctionEnd",(e=>{const t=e.auctionEnd-e.timestamp;At(`Prebid auction took: ${t}ms`),(0,C.s4)("play_prebid_interstitial_auction_time",t)})),this.usePreload||window.googletag.cmd.push((()=>{this.startPrebidAuction()}))}))))}))}clearPreloadInterstitialTimer(){clearTimeout(this.interstitialPreloadTimeout)}preloadInterstitial(){this.usePreload&&(this.clearPreloadInterstitialTimer(),this.interstitialPreloadTimeout=window.setTimeout((()=>{this.interstitialPreload.preload({beforeRequest:this.usePrebid?()=>(this.waitForAuction.resolve(),this.waitForAuction=new g.Z,this.startPrebidAuction(),this.waitForAuction.promise):void 0})}),.75*this.advManager.minIntervalBetweenAds))}cancelShow(e){switch(e){case b.$.INTERSTITIAL:d.Z.post({type:"adv-fullscreen-block",action:"hide"});break;case b.$.REWARDED:this.rewardedPreload.cancel()}}onShowAdvFinished({tag:e}){switch(e){case b.$.INTERSTITIAL:break;case b.$.REWARDED:window.setTimeout((()=>{this.rewardedPreload.preload().catch((e=>At("Preload error",e)))}),.75*this.advManager.minIntervalBetweenAds)}}},promo:Te,transsion:class extends L{constructor(e,t){super(e,t,b.e.Transsion),this.onScriptLoaded=e=>{var t,s;const{advManager:i}=this,{playPageData:n}=i.context;null==(s=window.h5sdk)||s.init(parseInt(n.gameInfo.appId,10),"","","","",{float:{env:"pre"},ga:{id:null==(t=(0,m.getDomainConfig)().analytics.counters)?void 0:t.ga},adsense:{client:e.dataset.adClient,"data-ad-channel":e.dataset.adChannel,"data-ad-frequency-hint":e.dataset.adFrequencyHint,callback:()=>{var e;null==(e=window.h5sdk)||e.adConfig({preloadAdBreaks:"on",sound:"off",onReady:()=>{this.onServiceLoaded()}})}}})},this.onScriptLoadedWithError=e=>{this.onServiceError(e)},this.processShowResult=({clickDaemon:e,depth:t,info:s,reject:i,resolve:n,tag:a})=>{if(["viewed","dismissed"].includes(s.breakStatus))return e.response({adReqId:this.lastAdReqId[a],depth:t,clickUrl:"",reason:O.Ud.SUCCESS}),void n();const r=!["noAdPreloaded","other","timeout"].includes(s.breakStatus);e.response({adReqId:this.lastAdReqId[a],depth:t,clickUrl:"",reason:r?`${O.Ud.ERROR}_${s.breakStatus}`:O.Ud.EMPTY}),i(new f.lu(`Transsion AdBreak returned ${s.breakStatus} status`,{isEmpty:!r}))},this.openWithLog=(e,t,s,i)=>()=>{e instanceof B.i&&e.show(t,s),null==i||i(),this.api.sendAdvShow({advService:this.serviceName,googleKeyValues:this.googleKeyValues})},this.closeWithLog=(e,t,s,i)=>()=>{e instanceof B.i&&e.close(t,s),null==i||i(!0)},this.showFullscreenAdv=e=>Ut(this,[e],(function*({callbacks:e,clickDaemon:t,adSeqId:s,reason:i,depth:n}){return new Promise(((a,r)=>{var o,d,l;const{advManager:c}=this,h=null!=(o=(0,V.di)(c.flags,Y.Z.transsionFullscreenPlacementType))?o:"preroll",u=t instanceof B.i?t.request({advBlockId:Zt,advtype:this.serviceName,depth:n,reason:i}):"";"preroll"===h?null==(d=window.h5sdk)||d.adBreak({adBreakDone:i=>{"viewed"!==i.breakStatus&&"dismissed"!==i.breakStatus||(this.openWithLog(t,u,s,e.onOpen)(),this.closeWithLog(t,u,s,e.onClose)()),this.processShowResult({tag:b.$.INTERSTITIAL,depth:n,info:i,clickDaemon:t,resolve:a,reject:r})},type:h}):null==(l=window.h5sdk)||l.adBreak({afterAd:this.closeWithLog(t,u,s,e.onClose),adBreakDone:e=>{this.processShowResult({tag:b.$.INTERSTITIAL,depth:n,info:e,clickDaemon:t,resolve:a,reject:r})},beforeAd:()=>{this.openWithLog(t,u,s,e.onOpen)},type:h})}))})),this.showRewardedVideo=e=>Ut(this,[e],(function*({callbacks:e,clickDaemon:t,adSeqId:s,reason:i,depth:n}){return new Promise(((a,r)=>{var o;const d=this.lastAdReqId[b.$.REWARDED]=t instanceof B.i?t.request({advBlockId:Zt,advtype:this.serviceName,depth:n,reason:i}):"";null==(o=window.h5sdk)||o.adBreak({adDismissed:this.closeWithLog(t,d,s,e.onClose),afterAd:this.closeWithLog(t,d,s,e.onClose),adBreakDone:e=>{this.processShowResult({tag:b.$.REWARDED,depth:n,info:e,clickDaemon:t,resolve:a,reject:r})},adViewed:e.onRewarded,beforeAd:()=>{this.openWithLog(t,d,s,e.onOpen)},beforeReward:e=>{e()},type:"reward"})}))})),this.api=new Z.Z(window.appData.apiData),this.init()}getAdvBlockId(e){return Zt}getTimeoutExtraTime(e){return e===T.QA.ServiceInit?5e3:1e4}init(){this.loadScript(),(0,M.N5)().then((e=>{this.googleKeyValues=e}))}loadScript(){var e,t,s;window.t3wgame=!0;const{advManager:i}=this,{playPageData:n}=i.context;let a=(0,V.di)(i.flags,Y.Z.transsionAdChannel);if(!a){const{gameSettings:i}=n;(null==(s=null==(t=null==(e=null==i?void 0:i.advInfo)?void 0:e.adsense)?void 0:t.channel)?void 0:s.id)&&(a=i.advInfo.adsense.channel.id)}(0,x.x)({id:"transsion-script",dataset:{adChannel:a,adClient:Zt,adFrequencyHint:"50s"},src:"//www.hippoobox.com/static/sdk/adsdk_1.4.0.0.js"}).then((e=>{this.validateH5SdkObject(window.h5sdk)&&this.onScriptLoaded(e)})).catch((e=>{this.onScriptLoadedWithError(e)}))}validateH5SdkObject(e){if(!e||"object"!=typeof e)throw new Error("Can not find valid window.h5sdk");if("function"!=typeof e.init)throw new Error("window.h5sdk.init method is not a function");return!0}},yandex:class extends L{constructor(e,t){super(e,t,b.e.Yandex),this.isFullscreenShowing=!1,this.isRewardedShowing=!1,this.showAdvCallbacks={[b.$.INTERSTITIAL]:null,[b.$.REWARDED]:null},this.closeAdvOnEscape=null,this.onScriptLoadedSuccessful=()=>{this.onScriptFinish((()=>{this.isTagActive(b.$.INTERSTITIAL)&&!this.isTagWaterfall(b.$.INTERSTITIAL)&&this.hasFullscreenAdv&&(this.fullscreenPrerender=this.initFullscreenPrerender(this.options.tags[b.$.INTERSTITIAL]===T.pP.Start?O.p_.START_FULLSCREEN:O.p_.PRELOAD,this.getClickDaemon(b.$.INTERSTITIAL))),this.isTagActive(b.$.REWARDED)&&!this.isTagWaterfall(b.$.REWARDED)&&this.hasRewarderdAdv&&this.initRewardedPrerender()})),this.onServiceLoaded()},this.onScriptLoadedWithError=e=>{Jt(),this.onServiceError(e)},this.debounceNewFullscreenAdvLoad=()=>{this.isRewardedShowing||(0,V.iH)(this.advManager.flags)||this.preloadFullscreenAdv(O.p_.PRELOAD)},this.cssClasses=Kt(),this.cssViewTypeClass=(0,f.TE)(e.viewType),this.debounceNewFullscreenAdvLoad=(0,bi.D)(this.debounceNewFullscreenAdvLoad,1e3),this.init()}init(){this.closeOnEscape(),this.initMessaging()}initMessaging(){d.Z.onAllMessages("yandex-adv-service",(e=>{const{action:t}=e.data;"close-adv"!==t&&"bottom-button-close-adv"!==t?"adv-container-mounted"===t&&(this.advContainer=document.querySelector(`.${k.kn.modal}.${(0,f.el)("yandex")}.${k.kn.modalFullscreen}`),this.loadScript(),this.initDOMEvents()):this.hideFullscreenAdv(!0)}))}initDOMEvents(){const{advManager:e}=this,{viewType:t,flags:s}=e;t===k.xd.fullscreen&&(window.addEventListener("resize",(()=>{this.savedPageYOffset=(0,f.SW)(this.advContainer)})),It.Z.addChangeListener((()=>{this.isFullscreenShowing&&(0,V.iH)(s)?(Yt("Screen orientation was changed, set `rerenderForced = true` and hide/show."),this.hideFullscreenAdv(void 0,!0)):this.debounceNewFullscreenAdvLoad()})),(0,f.zw)())}loadScript(){Array.isArray(window.yandexContextAsyncCallbacks)||(window.yandexContextAsyncCallbacks=[]),window.yandexContextAsyncCallbacks.push(this.onScriptLoadedSuccessful),(0,x.x)({id:"yandexads-context",src:this.advManager.context.yaAdsScript}).catch(this.onScriptLoadedWithError)}getLastAdReqId(e){var t,s;return e===b.$.INTERSTITIAL?null==(t=this.fullscreenPrerender)?void 0:t.adReqId:e===b.$.REWARDED?null==(s=this.rewardedPrerender)?void 0:s.adReqId:this.lastAdReqId[e]}getTimeoutExtraTime(e,t){if(e===T.QA.ShowFullscreen&&t===O.p_.WATERFALL)return 1500}startPrerenderDelayPromise(e){this.prerenderDelayPromise=new Promise((t=>{setTimeout((()=>{null==e||e(),t()}),2e3)}))}initFullscreenPrerender(e,t){if(this.fullscreenPrerender)return this.fullscreenPrerender;const{flags:s}=this.advManager;return Yt("initFullscreenPrerender, reason =",e),Yt(`isPreloadFullscreenAdvExperimentEnabled = ${(0,V.iH)(s)}`),(0,V.iH)(s)?new Ds(this,e,t):new As(this,e,t)}initRewardedPrerender(e=O.p_.PRELOAD){if(this.rewardedPrerender)return;const{advBlocks:t,flags:s}=this.advManager;t.rewarded&&(this.rewardedPrerender=(0,V.lv)(s)?new fi(this,e):new di(this,e),this.preloadRewardedAdv(e))}onScriptFinish(e){Jt(),this.startPrerenderDelayPromise(e)}getAdvBlockId(e,t){if((0,K.x)())return e===b.$.REWARDED?k.EC.rewarded:k.EC.fullscreen;const{advBlocks:s,deviceType:i}=this.advManager;return e===b.$.REWARDED?es({advBlocks:s,deviceType:i}):Qt({advBlocks:s,deviceType:i,reason:t})}closeOnEscape(){this.closeAdvOnEscape=e=>{"Escape"===e.key&&this.hideFullscreenAdv(!0)},window.addEventListener("keydown",this.closeAdvOnEscape)}hideFullscreenAdv(e,t){var s,i,n,a,r,o;this.screenUnlock(),this.isFullscreenShowing=!1,Yt("hideFullscreenAdv, rerenderForced =",t);const{advManager:l}=this;null==(s=this.destroyAdv)||s.call(this);const c=this.getClickDaemon(b.$.INTERSTITIAL);if(t){this.preloadFullscreenAdv();const e=null!=(n=null==(i=this.fullscreenPrerender)?void 0:i.previousReason)?n:O.p_.PRELOAD;let t="";return c instanceof B.i&&(t=c.tryOpen(this.getAdvBlockId(b.$.INTERSTITIAL,e),this.serviceName),c.demand(void 0,0,t)),void this.showFullscreenAdv({callbacks:this.showAdvCallbacks[b.$.INTERSTITIAL],clickDaemon:c,adSeqId:t,reason:e,depth:0,tag:b.$.INTERSTITIAL,initialTag:b.$.INTERSTITIAL})}(0,f.PS)(),this.closeAdvOnEscape&&(window.removeEventListener("keydown",this.closeAdvOnEscape),this.closeAdvOnEscape=null),l.deviceType!==Vt.n.desktop&&(0,f.HH)(),d.Z.post({type:"yandex-fullscreen-render",action:"hide-fullscreen"}),window.scroll(0,this.savedPageYOffset),null==(a=this.fullscreenPrerender)||a.next(this.options.tags[b.$.INTERSTITIAL]===T.pP.Start?O.p_.PRELOAD:O.p_.PRELOAD_WATERFALL,c),e&&(null==(r=this.showAdvCallbacks[b.$.INTERSTITIAL])||r.onClose(e),l.callOnAdvClose(e),(null==(o=this.fullscreenPrerender)?void 0:o.adSeqId)&&c.close(this.fullscreenPrerender.adReqId,this.fullscreenPrerender.adSeqId),(0,Ye.D)())}showAdvContainer(){const{advManager:e}=this,{flags:t}=e;this.isFullscreenShowing=!0;const{deviceType:s}=this.advManager;setTimeout((()=>{var i;window.focus(),s!==Vt.n.desktop&&(0,f.xK)(),d.Z.post({type:"yandex-fullscreen-render",action:"show-fullscreen"}),this.savedPageYOffset=(0,f.SW)(this.advContainer);const n=(null==(i=this.advManager.context.uatraits)?void 0:i.OSFamily)===Ht.k.IOS;s===Vt.n.desktop?(0,f.ss)({advElement:this.advContainer.querySelector(`.${this.cssClasses.modalWrap}`),type:"fullscreen",flags:e.flags,appId:e.appId,isIOS:n}):(0,f.ss)({advElement:this.advContainer,type:"fullscreen",flags:e.flags,appId:e.appId,isIOS:n}),t.autoclose_adv&&setTimeout((()=>{this.hideFullscreenAdv(!0)}),t.autoclose_adv)}),0)}preloadFullscreenAdv(e){var t;null==(t=this.fullscreenPrerender)||t.next(e,this.getClickDaemon(b.$.INTERSTITIAL))}preloadRewardedAdv(e){var t;null==(t=this.rewardedPrerender)||t.next(e)}showFullscreenAdv(e){return Ai(this,arguments,(function*({callbacks:e,clickDaemon:t,adSeqId:s,reason:i}){return new Promise(((n,a)=>Ai(this,null,(function*(){try{this.showAdvCallbacks[b.$.INTERSTITIAL]=e,Yt("showFullscreenAdv"),this.screenLock(),this.fullscreenPrerender||(this.fullscreenPrerender=this.initFullscreenPrerender(i,t));const{fullscreenPrerender:a}=this;a.adSeqId=s,yield this.prerenderDelayPromise;const{hasContent:r,noRequest:o,err:d,clickDaemon:l}=yield a.ready().then((e=>e.showPrerenderedAd?e.showPrerenderedAd():e));if(l&&t instanceof $.U&&t.bindRequest(l),d)throw d;if(r)t instanceof B.i&&t.show(a.adReqId,s),e.onOpen(),(0,f.WL)(),this.showAdvContainer(),n();else if(!o)throw new f.lu(k.qS,{isEmpty:!0})}catch(e){this.screenUnlock(),a(e)}}))))}))}showRewardedVideo(e){return Ai(this,arguments,(function*({callbacks:e,clickDaemon:t,adSeqId:s,reason:i,depth:n}){return new Promise(((a,r)=>Ai(this,null,(function*(){var o;try{const{advManager:r}=this;if(this.showAdvCallbacks[b.$.REWARDED]=e,!this.rewardedPrerender&&r.advBlocks.rewarded&&this.initRewardedPrerender(i),yield this.prerenderDelayPromise,!r.advBlocks.rewarded)throw new Error("partnerId is not defined, no rewarded video adv block available");yield null==(o=this.rewardedPrerender)?void 0:o.showRewardedVideo({callbacks:e,clickDaemon:t,adSeqId:s,reason:i,tag:b.$.REWARDED,initialTag:b.$.REWARDED,depth:n}),a()}catch(e){r(e)}}))))}))}screenLock(){const{advManager:{flags:e}}=this;(0,V.F7)(e)&&It.Z.lock().catch((()=>{}))}screenUnlock(){const{advManager:{flags:e}}=this;(0,V.F7)(e)&&It.Z.unlock().catch((()=>{}))}getClickDaemon(e){const{advManager:t}=this;return t.alternateLogs?new $.U({app_id:t.appId,tag:e}):t.getClickdaemonAdvLog(e)}}},un=(0,N.M$)("AdvManager",N.XG.Adv,{background:"seagreen"}),pn=un.tag("showAdv");class vn{constructor(e){var t,s,i,n,a,r,o,l;this.context=e,this.callbacksToSdk={[b.$.INTERSTITIAL]:null,[b.$.REWARDED]:null},this.guardClosedPromiseWrapper=new g.Z,this.clickdaemonAdvLogs={},this._showAdvLock={[b.$.INTERSTITIAL]:!1,[b.$.REWARDED]:!1},this._lastShowTime={[b.$.INTERSTITIAL]:0,[b.$.REWARDED]:0},this.serviceInstances=void 0,this.splashScreenPromise=new g.Z,this.servicesBlocks={[b.$.INTERSTITIAL]:{},[b.$.REWARDED]:{}},this.handleVisibilityChange=()=>{un("handleVisibilityChange",document.visibilityState);const e=(0,V.$9)(this.flags,Y.Z.minInactivePlayTabTimeToShowAd);e&&("hidden"===document.visibilityState?this.inactiveTabTime=Date.now():this.inactiveTabTime>0&&Date.now()-this.inactiveTabTime>=e&&(un("show interstitial after inactive state"),this.showAdv(b.$.INTERSTITIAL,{reason:O.p_.ONSPOT})))},this.onAdvManagerExternalMessage=(e,t)=>{const{action:s}=e.data;"get-disabled-state"===s&&t({data:{value:this.isInterstitialAdsDisabled}})},this.onGuardMessage=e=>{const{action:t}=e.data;"set-was-showed"===t&&this.resolveGuardPromise()},this.onSplashMessage=e=>{const{action:t}=e.data;"set-was-closed"===t&&this.resolveSplashScreenPromise()},this.onSubscriptionsMessage=e=>{const{action:t}=e.data;"changed"===t&&this.readNoAdsSubscriptionValue()},this.onFrameMessage=e=>{const{action:t}=e.data;t===Ji.ur.IframeLoaded&&(this.initServices(b.$.INTERSTITIAL),this.initServices(b.$.REWARDED),d.Z.offInternalMessage("frame",this.onFrameMessage))},this.deviceType=e.deviceType,this.allAdvBlocks=e.allAdvBlocks,this.allPrebidAdvBlocks=e.allAdvBlocks.prebid;const c=e.playPageData.gameSettings,h={advBlocks:c.advBlocks,partnerId:null!=(s=null==(t=c.advBlocks.desktop)?void 0:t.fullscreen)?s:c.advBlocks.fullscreen,rewardedVideoPartnerId:null!=(n=null==(i=c.advBlocks.desktop)?void 0:i.rewarded)?n:c.advBlocks.rewarded},{advBlocks:u={fullscreen:h.partnerId,rewarded:h.rewardedVideoPartnerId}}=h,{flags:p}=e.abt;this.flags=p,this.alternateLogs=null!=(a=(0,V.RM)(p,Y.Z.advAlternateLogs))&&a,this.withWorldWideAdv=Boolean(e.withWorldWideAdv);const v=(0,E.pN)(["a_delay","clid",J.Je,"min-interval-between-ads","utm_medium"]),y=(0,Ki.k4)(v.utm_medium,v.clid);var A,S;this.deviceId=v[J.Je],this.appId=e.playPageData.gameInfo.appId,this.viewType=this.deviceType===Vt.n.desktop?k.xd.desktop:k.xd.fullscreen,this.advBlocks=(0,f.$3)(u,this.appId,p),this.residenceInfo=null==(r=c.advInfo)?void 0:r.residence_info,this.advUsedBlocks=c.advUsedBlocks,this.startTime=Date.now(),this.lang=e.playPageData.request.lang,this.minIntervalBetweenAds=(0,f.mx)(v["min-interval-between-ads"],p,this.withWorldWideAdv),this.advDelay=(0,f.dh)(v.a_delay)||(0,V.$9)(p,Y.Z.advDelay)||tn.JV[(0,cs.KT)()]||e.isTranssion?k.Sk:0,this.isAllAdvDisabledByPartnersKit=(0,Qi.V)(p),this.isRewardedAdsDisabled=y,this.isInterstitialAdsDisabled=y,this.isInterstitialAdsTurnOff=(0,V.Ww)(p,w.By.FULLSCREEN),this.isRewardedAdsTurnOff=(0,V.Ww)(p,w.By.REWARDED),this.isDisableAdButtonEnabled=(0,V.RM)(p,Y.Z.disableAdButton)||!1,this.firstShowGuard=new P,this.advBlocks.fullscreen||(null==(o=this.advBlocks.desktop)?void 0:o.fullscreen)||(null==(l=this.advBlocks.mobile)?void 0:l.fullscreen)||(0,f.ey)(this.appId),void 0!==v.a_delay&&(0,f.R4)(),y&&(this.reasonForDisablingAd="utm",this.sendAdvDisabledToChild(this.reasonForDisablingAd)),this.readNoAdsSubscriptionValue(),un("advUsedBlocks",this.advUsedBlocks),this.waterfallQueue=Ms({advConfig:(0,m.getDomainConfig)().adv,flags:this.flags,withWorldWideAdv:this.withWorldWideAdv,secondDomain:this.context.secondDomain}),un("waterfallQueue",this.waterfallQueue),this.initMessaging(),this.showStartFullscreenAdv(),(0,en.y)().then((e=>{e||this.resolveGuardPromise()})),e.isGamesApp&&!this.isInterstitialAdsTurnOff&&(A=this.waterfallQueue.interstitial,S=b.e.Native,A.some((e=>e.provider===S)))&&le({advBlocks:this.advBlocks,flags:p,residenceInfo:this.residenceInfo}),this.guardClosedPromiseWrapper.promise.then((()=>{document.addEventListener("visibilitychange",this.handleVisibilityChange)}))}get adOpenedType(){return this._adOpenedType}set adOpenedType(e){un(`Set adOpenedType to: ${e}`),this._adOpenedType=e}get showAdvLock(){return this._showAdvLock}get lastShowTime(){return this._lastShowTime}showStartFullscreenAdv(){if((0,V.Ww)(this.flags,w.By.START_FULLSCREEN))return;const e=Ks({advBlocks:this.advBlocks,flags:this.flags,withWorldWideAdv:this.withWorldWideAdv});e&&(un("Show fullscreen on start (preroll)"),this.callOnAdvClose(),this.showAdv(b.$.INTERSTITIAL,{reason:O.p_.START_FULLSCREEN,sendToSDK:!1},e))}get isAdvDisabled(){return this.isInterstitialAdsDisabled||this.isInterstitialAdsTurnOff||this.isAllAdvDisabledByPartnersKit}initServices(e,t=this.waterfallQueue[e],s=O.p_.ONSPOT){var i;const n=(i,n)=>{if(s===O.p_.START_FULLSCREEN&&e===n)return T.pP.Start;switch(Fs(e===n?t:this.waterfallQueue[n],i)){case-1:return T.pP.Skip;case 0:return T.pP.Onspot;default:return T.pP.Waterfall}},a=new Set;if(t.forEach((e=>a.add(e.provider))),this.serviceInstances=[...a].reduce(((e,t)=>{if(e[t])return e;try{const s=hn[t];e[t]=new s(this,{tags:{[b.$.INTERSTITIAL]:n(t,b.$.INTERSTITIAL),[b.$.REWARDED]:n(t,b.$.REWARDED)},serviceName:t}),e[t].initPromise.promise.catch((()=>{})),un(`Service ${t} inited.`)}catch(e){(0,D.fF)(e)}return e}),null!=(i=this.serviceInstances)?i:{}),!t.every((({provider:t})=>this.servicesBlocks[e][t]))){un.spoiler(this.serviceInstances)(`Services for tag ${e}:${s} inited`);for(const{provider:s}of t)this.servicesBlocks[e][s]=!0;d.Z.post({type:"play-adv-manager",action:"update-adv-services-list",data:this.servicesBlocks})}}updateDisableAdvButtonVisibility(e){if(!this.isDisableAdButtonEnabled)return;const t=(0,Yi._)("aab-adv");e?t.classList.contains(k.Si)&&t.classList.remove(k.Si):t.classList.contains(k.Si)||t.classList.add(k.Si)}sendAdvDisabledToChild(e){un("readNoAdsSubscriptionValue, this.isInterstitialAdsDisabled = ",this.isInterstitialAdsDisabled,", reason = ",e),d.Z.hasChild()&&d.Z.postToChild(Xi.fB.SetDisabledState({reason:e,value:this.isInterstitialAdsDisabled}))}readNoAdsSubscriptionValue(){d.Z.post({type:"subscriptions",action:"has",data:{key:"no_ads"}}).then((e=>{const{res:t}=e.data;this.updateDisableAdvButtonVisibility(t),"utm"!==this.reasonForDisablingAd&&this.isInterstitialAdsDisabled!==t&&(this.isInterstitialAdsDisabled=t,this.reasonForDisablingAd="subscription",this.sendAdvDisabledToChild(this.reasonForDisablingAd))}))}resolveGuardPromise(){this.guardClosedPromiseWrapper.resolve(void 0),d.Z.offInternalMessage("guard",this.onGuardMessage)}resolveSplashScreenPromise(){this.splashScreenPromise.resolve(void 0),d.Z.offInternalMessage("splash",this.onSplashMessage)}initMessaging(){d.Z.onInternalMessage("guard",this.onGuardMessage,{withHistory:!0}),d.Z.onInternalMessage("subscriptions",this.onSubscriptionsMessage,{withHistory:!0}),d.Z.onExternalMessage("adv-manager",this.onAdvManagerExternalMessage),d.Z.onInternalMessage("frame",this.onFrameMessage,{withHistory:!0}),y.Z.shouldLoad(this.flags,this.context.location)?d.Z.onInternalMessage("splash",this.onSplashMessage):this.splashScreenPromise.resolve(void 0),d.Z.onExternalMessage("adv-manager",((e,t)=>{switch(e.data.action){case"adv-show-fullscreen":this.callbacksToSdk[b.$.INTERSTITIAL]=t,this.showAdv(b.$.INTERSTITIAL,{reason:O.p_.ONSPOT});break;case"adv-show-rewarded-video":this.callbacksToSdk[b.$.REWARDED]=t,this.showAdv(b.$.REWARDED,{reason:O.p_.ONSPOT})}}))}callOnAdvClose(e=!1){un("callOnAdvClose",e),d.Z.post({type:"adv-manager",action:"on-adv-close",data:{wasShown:e}})}waitServiceInit(e,t){const{serviceName:s}=e;return e.initPromise.state!==g.C.Pending?e.initPromise.promise:Promise.race([e.initPromise.promise,(0,Di.D)((0,f.uD)(this.flags,e,t)).then((()=>{throw new Error(`Ad script init timeout, serviceName: ${s}`)}))])}waitShowAdv(e,t,s){const i=(t===b.$.INTERSTITIAL?e.showFullscreenAdv:e.showRewardedVideo).bind(e);return Promise.race([i(s),(0,Di.D)((0,f.gp)(this.flags,t,e,s.reason)).then((()=>{throw new Error(`Ad showAdv(${t}) timeout, serviceName: ${e.serviceName}`)}))])}getClickdaemonAdvLog(e){let t=this.clickdaemonAdvLogs[e];return t||(t=new B.i({tag:e,app_id:this.appId}),this.clickdaemonAdvLogs[e]=t),t}sendCallbackToSdk(e,t){var s,i;null==(i=(s=this.callbacksToSdk)[e])||i.call(s,{data:{error:t}}),this.callbacksToSdk[e]=null}showServiceAdv(e,t,s){return cn(this,arguments,(function*(e,t,s,{adSeqId:i,clickDaemon:n,depth:a,reason:r,initialTag:o}=s){var d;try{pn(`Service ${e.serviceName} start processing ${t}:${r}`),n instanceof B.i?n.demand(O.o9.SKIP,a,i,{advtype:e.serviceName,advBlockId:e.getAdvBlockId(t,r)}):a?n.waterfall({provider:e.serviceName,advBlockId:e.getAdvBlockId(t,r),depth:a,reason:r,tag:o}):n.demand({provider:e.serviceName,advBlockId:e.getAdvBlockId(t,r),depth:0,reason:r}),yield Promise.all([this.guardClosedPromiseWrapper.promise,this.splashScreenPromise.promise,this.waitServiceInit(e,r)]);const d=yield this.waitShowAdv(e,t,s);if("function"==typeof d)try{yield d()}catch(e){if(e instanceof Error){const t=new f.lu(e.message,((e,t)=>nn(e,an(t)))(((e,t)=>{for(var s in t||(t={}))on.call(t,s)&&ln(e,s,t[s]);if(rn)for(var s of rn(t))dn.call(t,s)&&ln(e,s,t[s]);return e})({},e.params),{wasShown:!0}));throw t.stack=e.stack,t}throw e}return pn(`Service ${e.serviceName} processed ${t}:${r}`),{status:T.mb.Ok}}catch(a){pn(`Service ${e.serviceName} ${t}:${r} error:`,a),s.callbacks.muteCallbacks(),a instanceof Error||(a=new Error("Unhandled undefined error (safe)")),null==(d=e.cancelShow)||d.call(e,t),(0,f.g5)(e,{additional:{adv:{advBlockId:e.getAdvBlockId(t,r)}},error:a,name:k._u,tag:t});const o=e.getLastAdReqId(t);return n instanceof $.U?a instanceof f.lu&&a.params.isEmpty||n.error(a.message):o?n.error(o,i,a.message):n.errorNoRequest({adSeqId:i,advBlockId:e.getAdvBlockId(t,r),provider:e.serviceName,error:a.message}),a instanceof f.lu&&a.params.isEmpty?{status:T.mb.Empty,error:a}:a instanceof f.lu&&a.params.wasShown?{status:T.mb.FailedShow,error:a}:{status:T.mb.Failed,error:a}}}))}mergeShowAdv(e,t,s,i){let n=this.showAdvLock[e];if(n){const[a,r]=n;if(a===O.p_.START_FULLSCREEN)return r.addCallbacks(t,!0),i&&(0,f.Sn)(r,e),pn(`showAdv ${e}:${s} was merged with ${e}:${a}`),!0}return!1}showAdv(e,t){return cn(this,arguments,(function*(e,t,s=this.waterfallQueue[e]){var i,n;pn.spoiler(t)(`showAdv ${e}:${t.reason}`);let a,{reason:r}=t,{callbacks:o={},sendToSDK:d=!0}=t;if(this.mergeShowAdv(e,o,r,d))return;this.initServices(e,s,r);let l,c="";l=this.alternateLogs?new $.U({tag:e,app_id:this.appId}):this.getClickdaemonAdvLog(e);const h=new S(e,l instanceof $.U?l:void 0);h.addCallbacks(o),(0,f.fl)(h,e,this.context.platform).catch((()=>{})),(0,f.KW)(h,this.flags),d&&(0,f.Sn)(h,e);const u=()=>this.adOpenedType=null;h.addCallbacks({onClose:u,onError:u,onOffline:u});let p=0,v=0,m=T.mb.Failed,g=e,w=l,y=[];h.addCallbacks({onClose:()=>{var t;pn("callOnShowAdvFinished");try{for(const i of y){const n=null==(t=this.serviceInstances)?void 0:t[i.provider];n&&n.onShowAdvFinished&&n.onShowAdvFinished({tag:i.tag||e,latestTag:g,initialTag:e,status:m,waterfallItems:s})}}catch(e){un("Failed to call AdvService.onShowAdvFinished, error:",e.message)}}});try{const t=()=>{var t,i;const n=s[p];if(!n)throw new f.lu(`No available waterfall item for tag ${e}:${r}`,{isFinal:!0});const a=null==(t=this.serviceInstances)?void 0:t[null==n?void 0:n.provider];if(!a)throw new f.lu(`No available service for tag ${e}:${r}, waterfall provider: ${null!=(i=null==n?void 0:n.provider)?i:b.e.None}`,{isFinal:!0});return[a,n]};do{h.unmuteCallbacks();const[s,i]=t();if(a)pn(`Service ${a.serviceName} failed to show adv, go to waterfall. Next service: ${null==s?void 0:s.serviceName}`);else{l instanceof $.U?l.tryOpen({reason:r,provider:s.serviceName}):c=l.tryOpen(s.getAdvBlockId(e,r),s.serviceName);const t=this.advDisabledCheck(e,c,h,l);if(t)return void this.sendCallbackToSdk(e,t);this._showAdvLock[e]=[r,h],this._lastShowTime[e]=Date.now()}this.adOpenedType=e,this.sendCallbackToSdk(e),a=s,[g,w]=i.tag?[i.tag,this.getClickdaemonAdvLog(e)]:[e,l],g!==h.currentTag&&(h.currentTag=g),v>0&&(r=O.p_.WATERFALL);const n=a.checkCanShow(e,r);if(n!==T.Kc.Ok){pn(`Skip service ${a.serviceName} due canShowCheck: ${n}`),p++;continue}y.push(i);const{status:o,error:d}=yield this.showServiceAdv(a,g,{adSeqId:c,callbacks:h,clickDaemon:this.alternateLogs?l:w,depth:v++,tag:g,initialTag:e,reason:r});if(m=o,m===T.mb.Ok)return;if(m===T.mb.FailedRemove)this.waterfallQueue[e].splice(p,1);else{if(m===T.mb.FailedShow)throw d||new f.lu(`Error after ${g} showAdv (service: ${a.serviceName})`,{isFinal:!0,wasShown:!0});p++}}while(a);throw new f.lu("No adv providers left.",{isFinal:!0})}catch(t){this.sendCallbackToSdk(e),this._lastShowTime[e]=0,h.unmuteCallbacks(),h.onError(t),t instanceof f.lu&&(t.params.isFinal||t.params.wasShown)&&(m===T.mb.Empty?l.noContent(null!=(i=null==a?void 0:a.getLastAdReqId(e))?i:"",c):l instanceof $.U?l.fail(t.message):l.fail(null!=(n=null==a?void 0:a.getLastAdReqId(e))?n:"",c,t.message)),h.onClose(!1),this.callOnAdvClose(!1),(0,D.Ts)(t,{prefix:"Please, send this error sdk developers: "})}finally{this._showAdvLock[e]=!1}}))}advDisabledCheck(e,t,s,i){if(this.adOpenedType)return i.skip(O.Jm.ANOTHER_AD_OPENED,t),new Error("Another ad already opened");if(e===b.$.INTERSTITIAL){if(this.isAdvDisabled){if(this.isInterstitialAdsDisabled)i.noAdv(t);else{let e;e=this.isInterstitialAdsTurnOff?O.Jm.INTERSTITIAL_ADS_TURN_OFF:this.isAllAdvDisabledByPartnersKit?O.Jm.ALL_ADS_DISABLED_BY_PARTNERS_KIT:O.Jm.UNKNOWN,i.skip(e,t)}return this.callOnAdvClose(!1),new Error("Skip interstitial.")}if(!this.firstShowGuard.canShowAdv()){const e=new Error("Cannot open the advertisement. Try again later.");return i.rateLimited("rate",t),this.callOnAdvClose(!1),e}const e=this.canOpenAdv(s);if(e)return i.rateLimited("rate",t),this.callOnAdvClose(!1),e}const n=new Error("Skip rewarded.");if(e===b.$.REWARDED){if(this.isRewardedAdsTurnOff)return un("Skip rewarded"),this.skipRewarded({adSeqId:t,callbacks:s,reason:O.Jm.REWARDED_ADS_TURN_OFF}),n;if(this.isRewardedAdsDisabled)return un("Skip rewarded"),this.skipRewarded({adSeqId:t,callbacks:s,reason:O.Jm.UTM}),n;if(this.isAllAdvDisabledByPartnersKit)return un("Skip rewarded"),this.skipRewarded({adSeqId:t,callbacks:s,reason:O.Jm.ALL_ADS_DISABLED_BY_PARTNERS_KIT}),n}return null}skipRewarded({adSeqId:e,callbacks:t,reason:s}){["onOpen","onRewarded","onClose"].filter(Boolean).forEach(((e,s)=>{window.setTimeout((()=>{var s;return null==(s=t[e])?void 0:s.call(t)}),100*s)})),this.getClickdaemonAdvLog(b.$.REWARDED).skip(s,e)}canOpenAdv(e){var t,s;const i=Date.now();if(!this.advBlocks.fullscreen&&!(null==(t=this.advBlocks.desktop)?void 0:t.fullscreen)&&!(null==(s=this.advBlocks.mobile)?void 0:s.fullscreen)){const e=`${k._u}: can not find block id`,t=`https://games.yandex.ru/console/application/${this.appId}`;return(0,D.Ts)(new Error(`\nWhat you can do:\n1. Enable monetization: https://yandex.ru/dev/games/doc/dg/console/enable-monetization-docpage/\n2. Fill all fields in your draft ${t}#application-info-draft\n3. Ensure in Ads section ${t}#application-info-draft (bottom)\nthere is block id (like R-A-123456).\nIf state != work (created, for example), just wait 24 hours: block creation might take time\n`)),new Error(e)}if(this.lastShowTime[b.$.INTERSTITIAL]&&i-this.lastShowTime[b.$.INTERSTITIAL]<this.minIntervalBetweenAds){const e="Please, don't try to open advertising often than once per "+((n=this.minIntervalBetweenAds)<I.WT?`${n} ms`:n%I.WT!=0?`${Math.floor(n/I.WT)} ${n%I.WT} ms`:n/I.WT+" s");return d.Z.post({action:"debug-action-guard",type:"adv-manager",data:{type:b.$.INTERSTITIAL,minInterval:this.minIntervalBetweenAds,reason:"Called too often"}}),new Error(e)}var n;if(Math.abs(i-this.startTime)<this.advDelay){const e=`Adv was delayed on ${this.advDelay}ms`;return new Error(e)}if(!navigator.onLine&&!1===(0,V.RM)(this.context.abt.flags,Y.Z.advShowOnOffline)){const t="Adv can't be shown offline";return e.onOffline(),new Error(t)}return null}}const mn="GoogleInstreamBlock-module__block--UThhL",gn="GoogleInstreamBlock-module__hidden--w4W3T",wn="advBlock_"+b.e.GoogleInstream,yn=({tag:e})=>{const t=(0,a.useRef)(null),[s,i]=(0,a.useState)(!1),n=(0,a.useCallback)(((s,n)=>{var a,r,o,d;const{action:l,data:{tag:c}}=s.data;if(c===e)switch(l){case"show":i(!0);break;case"hide":i(!1);break;case"get-size":n({data:{width:null!=(r=null==(a=t.current)?void 0:a.clientWidth)?r:null,height:null!=(d=null==(o=t.current)?void 0:o.clientHeight)?d:null}})}}),[e]);(0,a.useEffect)((()=>(d.Z.onInternalMessage("adv-instream-render",n),()=>{d.Z.offInternalMessage("adv-instream-render",n)})),[n]);const o=[mn,s?void 0:gn];return r().createElement("div",{className:(0,Je.E)(...o),id:wn+"_"+e,ref:t})};const fn=s(33196).Z;var bn=s(91605),An=s(4070),Sn=Object.defineProperty,kn=Object.defineProperties,En=Object.getOwnPropertyDescriptors,In=Object.getOwnPropertySymbols,Rn=Object.prototype.hasOwnProperty,Pn=Object.prototype.propertyIsEnumerable,Tn=(e,t,s)=>t in e?Sn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,Cn=(e,t)=>{for(var s in t||(t={}))Rn.call(t,s)&&Tn(e,s,t[s]);if(In)for(var s of In(t))Pn.call(t,s)&&Tn(e,s,t[s]);return e},Ln=(e,t)=>kn(e,En(t));const Dn=n().with("prowo-container"),On=()=>{const e=(0,a.useRef)(null),{isLegalEmbedPartner:t}=(0,Ke.b)(),s=(0,a.useRef)(new xe.Z),[i,n]=(0,a.useState)(0),[o,l]=(0,a.useState)({advTag:b.$.INTERSTITIAL,callbacks:{},reason:O.p_.ONSPOT,visible:!1}),c=(0,a.useCallback)(((e,s,i)=>{var n;t?null==(n=i.onClose)||n.call(i):l((()=>({advTag:e,callbacks:i,reason:s,visible:!0})))}),[t]),h=(0,a.useCallback)((()=>{var e,t;(0,bn.NF)({},Bt.Ji.GAME_PROMO_OPEN),s.current.updateShowData(_e.Wp.GamePromo),null==(t=(e=o.callbacks).onOpen)||t.call(e)}),[o]),u=(0,a.useCallback)((()=>{var e,t;null==(t=(e=o.callbacks).onClose)||t.call(e),l(Ln(Cn({},o),{visible:!1}))}),[o]),p=(0,a.useCallback)((e=>{var t,s,i,n;null==(s=(t=o.callbacks).onClose)||s.call(t),null==(n=(i=o.callbacks).onError)||n.call(i,e),l(Ln(Cn({},o),{visible:!1}))}),[o]),v=(0,a.useCallback)(((e,t)=>{const{action:s,data:i}=e.data;if("show"!==s);else{const{advTag:e,reason:t,onOpen:s,onRewarded:n,onClose:a,onError:r}=i;c(e,t,{onError:r,onOpen:s,onRewarded:n,onClose:a})}}),[c]),m=(0,a.useCallback)(((e,t)=>{t.height!==i&&n(t.height)}),[i]);(0,a.useEffect)((()=>(d.Z.onInternalMessage("adv-promo-block",v),An.Z.addResizeBlockListener("game",m,!0),()=>{d.Z.offInternalMessage("adv-promo-block",v),An.Z.removeResizeBlockListener("game",m)})),[m,v]);const{advTag:g,reason:w,visible:y,callbacks:{onRewarded:f}}=o;return y?r().createElement("div",{className:Dn({advType:g,"with-blur":!0}),ref:e,style:{height:i?`calc(100% + ${i}px)`:void 0}},r().createElement(fn,{advTag:g,auto:void 0,containerRef:e,errorProps:{onError:p},hide:u,reason:w,onRewarded:f,onShow:h})):null};var Bn=s(61533),xn=Object.defineProperty,_n=Object.defineProperties,Nn=Object.getOwnPropertyDescriptors,qn=Object.getOwnPropertySymbols,Mn=Object.prototype.hasOwnProperty,$n=Object.prototype.propertyIsEnumerable,Fn=(e,t,s)=>t in e?xn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,Wn=(e,t)=>{for(var s in t||(t={}))Mn.call(t,s)&&Fn(e,s,t[s]);if(qn)for(var s of qn(t))$n.call(t,s)&&Fn(e,s,t[s]);return e},Zn=(e,t)=>_n(e,Nn(t));const Un=n().with("instream-renderer"),Hn=({advManager:e})=>{const[t,s]=(0,a.useState)({isVisible:!1,blockId:"",isHeaderEnabled:!(0,f.Ij)(),width:0,height:0}),i=(0,a.useCallback)(((e,t)=>{const{action:i}=e.data;switch(i){case"show":s((e=>Zn(Wn({},e),{isVisible:!0})));break;case"hide":s((e=>Zn(Wn({},e),{isVisible:!1})));break;case"set-size":{const{width:t,height:i}=e.data.data;s((e=>Zn(Wn({},e),{width:t,height:i})));break}case"update-block-id":{const{blockId:i}=e.data.data;(0,Bn.flushSync)((()=>s((e=>Zn(Wn({},e),{blockId:i}))))),t({data:{blockId:i}});break}}}),[]);(0,a.useEffect)((()=>(d.Z.onInternalMessage("instream-fullscreen-render",i),()=>{d.Z.offInternalMessage("instream-fullscreen-render",i)})),[i]);const{viewType:n}=e,o=[k.kn.modal,k.kn.modalFullscreen,k.kn.modalWithBlur,(0,f.TE)(n),t.isVisible?k.kn.modalVisible:void 0,t.isHeaderEnabled?k.kn.modalWithHeader:void 0,t.isHeaderEnabled?k.kn.headerFix:void 0];return r().createElement("div",{className:(0,Je.E)(...o)},r().createElement("div",{className:Un("content"),style:{width:t.width,height:t.height}},r().createElement("div",{id:t.blockId})))};var zn=s(45112),Gn=s(62011),jn=s(28705);const Vn=(0,N.M$)("AdvStickyParentWindow",void 0,{background:"#0c6c09"}),Yn=(0,Gn.Z)((({appId:e,features:t,flags:s,settings:i})=>{const n=(0,a.useMemo)((()=>new Ue),[]),[r,o]=(0,a.useState)(!0),[l,c]=(0,a.useState)(!1),{adv:h}=(0,jn.Lf)(i),u=(0,a.useMemo)((()=>!(0,V.Ww)(s,w.By.STICKY)&&(0,jn.uk)({adv:h,appId:e,isDesktop:!0,flags:s,orientation:null==t?void 0:t.orientation})),[h,e,t,s]);return(0,a.useEffect)((()=>{const e=(e,t)=>{return s=void 0,i=null,a=function*(){const{action:s}=e.data;switch(s){case"adv-show-sticky-banner":{if(Vn(`onExternalMessage: action: "${s}"`),!u)return void t({data:{reason:jn.$R.ADV_IS_NOT_CONNECTED,stickyAdvIsShowing:!1}});const e=He({action:"setBannerAdvStatus",type:"adv",payload:{stickyAdvIsShowing:!0}});n.addListener({fn:e=>{var s;const{payload:i}=e,n=null==(s=i.stickyAdvIsShowing)||s;return c(!n),t({data:{reason:i.reason,stickyAdvIsShowing:n}}),!0},messageId:e});break}case"adv-hide-sticky-banner":{Vn(`onExternalMessage: action: "${s}"`);const e=He({action:"setBannerAdvStatus",type:"adv",payload:{stickyAdvIsShowing:!1}});n.addListener({fn:e=>{var s;const{payload:i}=e,n=null!=(s=i.stickyAdvIsShowing)&&s;return c(!n),t({data:{reason:i.reason,stickyAdvIsShowing:n}}),!0},messageId:e});break}case"adv-status-sticky-banner":if(Vn(`onExternalMessage: action: "${s}"`),!u)return void t({data:{reason:jn.$R.ADV_IS_NOT_CONNECTED,stickyAdvIsShowing:!1}});Vn(`Get stickyAdvIsShowing: ${!l}`),t({data:{stickyAdvIsShowing:!l}})}},new Promise(((e,t)=>{var n=e=>{try{o(a.next(e))}catch(e){t(e)}},r=e=>{try{o(a.throw(e))}catch(e){t(e)}},o=t=>t.done?e(t.value):Promise.resolve(t.value).then(n,r);o((a=a.apply(s,i)).next())}));var s,i,a};return Vn("ParentWindowStickyAdvService init"),d.Z.onAllMessages("adv-manager",e),()=>{d.Z.offAllMessages("adv-manager",e)}}),[u,l,n]),(0,zn.qR)((()=>{const i=(0,jn.jx)({adv:h,appId:e,flags:s,orientation:null==t?void 0:t.orientation}),a={desktop:{landscape:i.desktop,portrait:i.desktop},mobile:{landscape:i.mobileLandscape,portrait:i.mobilePortrait}};He({action:"setBannerAdvSettings",type:"adv",payload:{enabled:u,locations:a}});const r=He({action:"ping",type:"liveness"}),d=n.addListener({fn:e=>{const{action:t,type:s}=e;switch(s){case"liveness":"pong"===t&&(window.clearTimeout(l),o(!0));break;case"error":o(!1),Vn("error",e)}return!0},messageId:r}),l=window.setTimeout((()=>{d(),o(!1)}),2e3)})),null}),o.Z,{appId:e=>e.playPageData.gameInfo.appId,features:e=>e.playPageData.gameSettings.features,flags:e=>e.abt.flags,settings:e=>e.playPageData.gameSettings.settings});var Kn=s(29994),Xn=s(25827),Jn=s(14872);class Qn extends a.Component{constructor(e){super(e),this.additionalClasses="",this.onYandexFullscreenRenderMessage=(e,t)=>{const{action:s}=e.data;switch(s){case"update-block-id":this.setState({advBlockId:e.data.data.blockId,pageNumber:e.data.data.pageNumber},(()=>{t({data:{blockId:this.getBlockId()}})}));break;case"show-fullscreen":this.setState({isVisible:!0,seconds:0,withTimer:!1});break;case"hide-fullscreen":this.setState({isVisible:!1})}},this.handleClose=()=>{(0,Qe.D)((()=>{d.Z.post({type:"yandex-adv-service",action:"close-adv"})}))},this.handleBottomButtonClose=()=>{(0,Qe.D)((()=>{d.Z.post({type:"yandex-adv-service",action:"bottom-button-close-adv"})}))},this.handleTouchMove=e=>{e.stopPropagation(),e.preventDefault()},this.handleButtonDisableAdvClick=()=>{(0,et.Z)()},this.setModalRef=()=>{d.Z.post({type:"yandex-adv-service",action:"adv-container-mounted"})},this.isYandexSearchApp=(0,Xs.qo)(),this.state={advBlockId:"",pageNumber:1,isVisible:!1,inited:!1,seconds:0,withTimer:!1,isHeaderEnabled:!(0,f.Ij)()}}componentDidMount(){this.init(),this.initMessaging()}init(){const{advManager:e}=this.props,{flags:t}=this.context.abt,{viewType:s}=e;this.cssClasses=Kt();const i=[];s===k.xd.fullscreen&&t.new_adv_block&&i.push(`new_adv_block-${t.new_adv_block}`),this.additionalClasses=i.join(" "),this.setState({inited:!0})}initMessaging(){d.Z.onAllMessages("yandex-fullscreen-render",this.onYandexFullscreenRenderMessage)}getBlockId(){const{advBlockId:e,pageNumber:t}=this.state;return`yandex_rtb_${e}_${t}`}renderModalContent(){const{cssClasses:e}=this,{advBlockId:t,isVisible:s,withTimer:i}=this.state;if(!t||!e)return null;const{deviceType:n,isDisableAdButtonEnabled:a}=this.props.advManager,o=Boolean(this.isYandexSearchApp),{abt:{flags:d}}=this.context,{getText:l}=this.props,c=(0,V.qf)(d)||(0,V.iH)(d),h=r().createElement("span",{"aria-hidden":"true",className:`${Xt(e,"modalBottom",o)}`},r().createElement("span",{className:`${e.modalButton} ${e.modalButtonDisableAdv}`,onClick:this.handleButtonDisableAdvClick},l("header.popup.disable.ads")),r().createElement("span",{className:`${e.modalButton} ${e.modalButtonClose}`,onClick:this.handleBottomButtonClose},l("adv.close")));return n===Vt.n.desktop?c?r().createElement("div",{className:`${k.kn.modalInner}`},r().createElement("div",{className:`${e.modalWrap} with-native-close`},r().createElement("div",{className:`${e.modalContent} ${e.yandexAdaptive} with-native-close`,id:this.getBlockId()}))):r().createElement("div",{className:`${k.kn.modalInner}`},r().createElement("div",{className:`${e.modalWrap}`},s&&i&&r().createElement("div",{className:k.kn.countdown},r().createElement(Jn.Z,{seconds:this.state.seconds,text:l("adv.timed.allow.skip.text"),onClose:this.handleClose})),r().createElement("div",{className:`${e.modalContent} ${e.yandexAdaptive}`,id:this.getBlockId()}),!i&&r().createElement(Xn.Z,{source:J.h0.REWARDED_COUNTER,type:"adv-fullscreen",onClick:this.handleClose}),a?h:"")):c?r().createElement("div",{className:`${k.kn.modalInner}`},r().createElement("div",{className:`${Xt(e,"modalContent",o)} ${e.yandexAdaptive} with-native-close`,id:this.getBlockId()})):r().createElement("div",{className:`${k.kn.modalInner}`},r().createElement("div",{className:`${Xt(e,"modalContent",o)} ${e.yandexAdaptive}`,id:this.getBlockId()}),!(0,K.x)()&&r().createElement("span",{"aria-hidden":"true",className:`${Xt(e,"modalClose",o)}`,onClick:this.handleClose},r().createElement(je.z,{className:e.mobileCloseButton,"data-testid":"YandexFullscreenRender-Button",size:40,view:"primary",width:"max"},l("adv.close"))),a?h:"")}render(){const{additionalClasses:e,cssClasses:t}=this,{isVisible:s,inited:i,isHeaderEnabled:n}=this.state,{viewType:a}=this.props.advManager;if(!i)return null;const o=s?`${t.modalVisible} ${k.kn.modalVisible}`:"",d=[k.kn.modal,(0,f.el)("yandex"),k.kn.modalFullscreen,(0,f.TE)(a),t.modalMedia,o,e,k.kn.modalWithBlur,n?k.kn.modalWithHeader:void 0,n?k.kn.headerFix:void 0].join(" ").trim();return r().createElement("div",{className:d,ref:this.setModalRef,onTouchMove:this.handleTouchMove},this.renderModalContent())}}Qn.contextType=o.Z;const ea=(0,Kn.$j)((function(e){return{getText:e.getText}}))(Qn);var ta=s(54093);class sa extends a.Component{constructor(e){super(e),this.isYaBroChromeLower79=window.appData.isYaBroOrSearchApp&&!(0,ta.LR)(window.navigator.userAgent,ta.t_,{major:79,minor:0}),this.onYandexRewardedRenderMessage=(e,t)=>{var s;const{action:i}=e.data;switch(i){case"show-rewarded":this.setState({isVisible:!0,seconds:(null==(s=e.data.data)?void 0:s.seconds)||0}),this.onAdvCloseMessagingCallback=t;break;case"on-rewarded":this.onRewardedMessagingCallback=t;break;case"hide-rewarded":this.setState({isVisible:!1})}},this.handleAdvClose=()=>{var e;null==(e=this.onAdvCloseMessagingCallback)||e.call(this)},this.handleRewardedDone=()=>{var e;null==(e=this.onRewardedMessagingCallback)||e.call(this)},this.handleTouchMove=e=>{e.stopPropagation(),e.preventDefault()},this.setModalRef=()=>{d.Z.post({type:"yandex-adv-service",action:"adv-container-mounted"})},this.isYandexSearchApp=(0,Xs.qo)(),this.state={inited:!1,isVisible:!1,seconds:0,isHeaderEnabled:!(0,f.Ij)()}}componentDidMount(){this.init(),this.initMessaging()}init(){const{advManager:e}=this.props;this.isPCodeModal=(0,V.lv)(this.context.abt.flags),this.cssClasses=Kt(),this.advBlockId=(0,K.x)()?k.EC.rewarded:e.advBlocks.rewarded,this.setState({inited:!0})}initMessaging(){d.Z.onAllMessages("yandex-rewarded-render",this.onYandexRewardedRenderMessage)}renderModalContent(){const{cssClasses:e,advBlockId:t}=this,{isVisible:s,seconds:i}=this.state,{advManager:{deviceType:n}}=this.props;return n===Vt.n.desktop?r().createElement("div",{className:`${e.modalWrap}`},s&&r().createElement("div",{className:k.kn.countdown},r().createElement(Jn.Z,{seconds:i,onClose:this.handleAdvClose,onDone:this.handleRewardedDone})),r().createElement("div",{className:`${e.modalContent}`,id:`yandex_rtb_rewarded_${t}`})):r().createElement(r().Fragment,null,r().createElement("div",{className:Xt(e,"modalContent",Boolean(this.isYandexSearchApp)),id:`yandex_rtb_rewarded_${t}`}),s&&!(0,K.x)()&&r().createElement(Jn.Z,{seconds:i,onClose:this.handleAdvClose,onDone:this.handleRewardedDone}))}renderModal(){const{advManager:e}=this.props,{cssClasses:t}=this,{isVisible:s,isHeaderEnabled:i}=this.state,n=s?`${t.modalVisible} ${k.kn.modalVisible}`:"",a=[k.kn.modal,t.rewardedVideo,t.yandexAdaptive,(0,f.TE)(e.viewType),t.modalMedia,n,k.kn.modalWithBlur,i?k.kn.modalWithHeader:void 0,i?k.kn.headerFix:void 0,this.isYaBroChromeLower79?k.kn.yabroChromeLower79:void 0].join(" ").trim();return r().createElement("div",{className:a,ref:this.setModalRef,onTouchMove:this.handleTouchMove},this.renderModalContent())}renderPCodeModal(){const{cssClasses:e}=this,{isVisible:t}=this.state,s=t?`${k.kn.modalVisible}`:"",i=[k.kn.modal,e.rewardedVideo,s,k.kn.modalWithBlur].join(" ").trim();return r().createElement("div",{className:i})}render(){const{inited:e}=this.state;return e?this.isPCodeModal?this.renderPCodeModal():this.renderModal():null}}sa.contextType=o.Z;var ia=s(53603),na=Object.defineProperty,aa=Object.getOwnPropertySymbols,ra=Object.prototype.hasOwnProperty,oa=Object.prototype.propertyIsEnumerable,da=(e,t,s)=>t in e?na(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;const la=n().with("aab-adv"),ca=(0,N.M$)("PlayAdvManager",N.XG.Adv),ha=()=>{const e=(0,Ke.b)(),{isReady:t}=(0,ia.s)(),{abt:{flags:s},location:i}=e,[n,o]=(0,a.useState)(null),l=(0,a.useRef)(null);(0,a.useEffect)((()=>{const t=e=>{"update-adv-services-list"===e.data.action&&o(((e,t)=>{for(var s in t||(t={}))ra.call(t,s)&&da(e,s,t[s]);if(aa)for(var s of aa(t))oa.call(t,s)&&da(e,s,t[s]);return e})({},e.data.data))};return d.Z.onInternalMessage("play-adv-manager",t),ca("Create AdvManager instance"),l.current=new vn(e),()=>{d.Z.offInternalMessage("play-adv-manager",t),ca("Destroy AdvManager instance")}}),[e]);const c=(0,a.useMemo)((()=>(0,Bs.O)(i)),[i]),h=l.current,u=(0,a.useMemo)((()=>{if(!h||!n)return null;const e=n[b.$.INTERSTITIAL],t=e[b.e.PrebidTGO]||e[b.e.Adsense]||e[b.e.AdsenseResponsive];return r().createElement(r().Fragment,null,e[b.e.Yandex]&&r().createElement(ea,{advManager:h}),n[b.$.REWARDED][b.e.Yandex]&&r().createElement(sa,{advManager:h}),t&&r().createElement(ft,{advManager:h}),e[b.e.GoogleInstream]&&((0,v.vV)(s)?r().createElement(yn,{advManager:h,tag:b.$.INTERSTITIAL}):r().createElement(Hn,{advManager:h})),n[b.$.REWARDED][b.e.GoogleInstream]&&r().createElement(yn,{advManager:h,tag:b.$.REWARDED}),r().createElement(On,null),c&&r().createElement(Yn,null))}),[h,s,c,n]);return(0,V.V)(s)&&!t?null:h?r().createElement("div",{className:la()},r().createElement(p,{appId:h.appId,isDevFeaturesEnabled:!1}),u):null}},38512:(e,t,s)=>{"use strict";s.d(t,{Q$:()=>S,uy:()=>y,xn:()=>A});var i=s(47802),n=s(69106),a=s(17254),r=s(40656),o=s(77430),d=s(15771),l=s(90380),c=Object.defineProperty,h=Object.defineProperties,u=Object.getOwnPropertyDescriptors,p=Object.getOwnPropertySymbols,v=Object.prototype.hasOwnProperty,m=Object.prototype.propertyIsEnumerable,g=(e,t,s)=>t in e?c(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,w=(e,t)=>{for(var s in t||(t={}))v.call(t,s)&&g(e,s,t[s]);if(p)for(var s of p(t))m.call(t,s)&&g(e,s,t[s]);return e},y=(e=>(e.NO_CONTENT="NO_CONTENT",e.NO_SUCH_METHOD="NO_SUCH_METHOD",e.TIMEOUT="TIMEOUT",e.UNKNOWN="UNKNOWN",e))(y||{});const f=20*r.WT,b=["blockId","extParams"];const A={RENDER:"render",PRELOAD:"preload"},S=({abtFlags:e,adOptions:t,methodName:s,onAdLoadFailed:r,timeoutMs:c})=>{var p;const v=(0,n.Z)(r),m=(e=>{var t,s,n;const a=null==(s=null==(t=null==window?void 0:window.Ya)?void 0:t.Context)?void 0:s.AdvManager;if(a&&"object"==typeof a)return e in a||(0,i.qu)(`[adv.safeGuard] AdvManager method ${e} is undefined`),null==(n=a[e])?void 0:n.bind(a);(0,i.qu)("[adv.safeGuard] AdvManager is undefined")})(s);if(!m)return void v(new o.Z("No such method","NO_SUCH_METHOD"));void 0===c&&(c=null!=(p=(0,d.$9)(e,l.Z.rsyaDefaultLoadTimeout))?p:f);const g=setTimeout((()=>{(0,i.qu)(`[adv.safeGuard] Error: No events were raised after Ya.Context.AdvManager.${s} in ${c} ms.`,{blockId:t.blockId}),v(new o.Z("Timeout","TIMEOUT"))}),c),y=e=>(...s)=>(clearTimeout(g),(0,i.qu)("[adv.safeGuard] Timer cleared",{blockId:t.blockId}),null==e?void 0:e(...s));(0,i.qu)(`[adv.safeGuard] call "${s}" with options = `,function(e){return b.reduce(((t,s)=>(t[s]=e[s],t)),{})}(t));var A,S;m((A=w(w({},t),(0,a.x)()?{onRewarded:y(t.onRewarded)}:{}),S={onError:y(t.onError),onRender:y(t.onRender),onPreload:y(t.onPreload),onClose:y(t.onClose)},h(A,u(S))),y((()=>v(new o.Z("No content","NO_CONTENT")))))}},54814:(e,t,s)=>{"use strict";s.d(t,{Kc:()=>n,QA:()=>r,mb:()=>a,pP:()=>i});var i=(e=>(e.Onspot="onspot",e.Skip="skip",e.Start="start",e.Waterfall="waterfall",e))(i||{}),n=(e=>(e.Next="next",e.NextRemove="next_remove",e.Ok="ok",e))(n||{}),a=(e=>(e.Empty="empty",e.Failed="failed",e.FailedRemove="failed_remove",e.FailedShow="failed_show",e.Ok="ok",e))(a||{}),r=(e=>(e.ServiceInit="serviceInit",e.ShowFullscreen="showFullscreen",e.ShowRewarded="showRewarded",e))(r||{})},40532:(e,t,s)=>{"use strict";s.d(t,{Z:()=>g});var i=s(87363),n=s.n(i),a=s(29994),r=s(74232),o=s(65453),d=s(65015),l=s(43548),c=s(71522),h=s(93298);const u="fetch-limits";var p=(e=>(e.LIMIT_EXCEEDING="limit-exceeding",e))(p||{});const v=(0,h.M$)("PlayFetchLimits",h.XG.Popup);class m extends i.Component{constructor(e){super(e),this.onFetchInternalMessage=e=>{const{action:t}=e.data;if(t!==p.LIMIT_EXCEEDING)return;const{data:{url:s}}=e.data;this.onLimitExceeding(s)},this.onMessageBoxClick=()=>{const{warningMessage:e}=this.state;if(e)try{navigator.clipboard.writeText(e)}catch(e){}},this.onMessageBoxClose=()=>{this.setState({warningMessage:void 0})},this.onMessageBoxSnooze=()=>{this.onMessageBoxClose(),this.setState({snooze:!0})},this.state={snooze:!1,warningMessage:void 0}}componentDidMount(){l.Z.onInternalMessage(u,this.onFetchInternalMessage)}componentWillUnmount(){l.Z.offInternalMessage(u,this.onFetchInternalMessage)}onLimitExceeding(e){let t=e;try{t=new URL(e).pathname}catch(e){}const s=this.props.getText("game-sdk.fetch-limits.warn.text").replace("{url}",t);v(`onLimitExceeding, url = ${e}`),(0,d.Ts)(new Error(s)),((0,c.m)()||h.HQ)&&this.setState({warningMessage:s})}render(){const{snooze:e,warningMessage:t}=this.state;return e||!t?null:n().createElement(r.Z,{autohide:!1,level:o.XB.ERROR,withCloseButton:!0,onClick:this.onMessageBoxClick,onClose:this.onMessageBoxClose,onSnooze:this.onMessageBoxSnooze},t)}}const g=(0,a.$j)((function(e){return{getText:e.getText}}))(m)},85510:(e,t,s)=>{"use strict";s.d(t,{Z:()=>A});var i=s(38096),n=s(87363),a=s.n(n),r=s(63904),o=s.n(r),d=s(45331),l=s(85467),c=s(5825),h=s(36172),u=s(68108),p=s(15771),v=s(69838),m=s(29008),g=s(44865);const w=o().with("play-game-logo"),y=({type:e})=>{const t=(0,c.C)(h.Up),{lang:s,referrer:i,abt:r,cdnUrl:o,playPageData:{gameInfo:{categoryNames:y}},rtl:f}=(0,n.useContext)(d.Z),b=(0,l.T)(),A=b("common.company.name"),S=b("common.service.short_name"),k=(0,p.XP)(r.flags),E=(0,v._B)({cdnUrl:o,darkTheme:t,fullLogo:e!==v.q7.GUARD&&e!==v.q7.AVATAR,text:A,type:e,lang:s,rtl:f}),I=(0,m.KS)(s),R=(0,n.useMemo)((()=>(0,u.sD)(i)),[i]);if(e===v.q7.GUARD){const{serviceType:i}=(0,g.Vk)(y),n=(i===v.CF.WEBAPPS_CATEGORY_SERVICE_NAME?b("common.service.app_name"):b("common.service.short_name")).replace(/\s/g,"%20"),r=(0,v._B)({cdnUrl:o,darkTheme:t,isWhiteLabelPartner:R,text:n,type:e,lang:s,rtl:f});return a().createElement("span",{className:w()},a().createElement("img",{alt:S,className:w("service",{type:e,lang_ru:I}),crossOrigin:"anonymous",loading:"lazy",src:r}))}if(e===v.q7.AVATAR)return R?null:a().createElement("div",{className:w()},a().createElement("img",{alt:A,className:w("company",{type:e,lang_ru:I}),crossOrigin:"anonymous",src:E}));const P=(0,v._B)({cdnUrl:o,darkTheme:t,isWhiteLabelPartner:R,text:S,type:e,lang:s,rtl:f});return a().createElement(a().Fragment,null,a().createElement("img",{alt:S,className:w("service",{type:e,lang_ru:I,small:k,whitelabel:R}),crossOrigin:"anonymous",src:P}))};var f=s(6042);const b=({type:e})=>{switch(e){case v.q7.MENU:return a().createElement(f.Z,{showImage:!1,textSize:"m"});case v.q7.HEADER:return a().createElement(f.Z,{showImage:!1,textColor:"light",textSize:"s",type:e});case v.q7.GUARD:return a().createElement(f.Z,{imageSize:"s",textSize:"m"});case v.q7.AVATAR:return a().createElement(f.Z,{imageSize:"m",showText:!1});default:return a().createElement(f.Z,{showImage:!1,textSize:"m"})}},A=({type:e})=>{const{hostname:t}=(0,i.getDomainConfig)();return t!==i.DEFAULT_DOMAIN?a().createElement(b,{type:e}):a().createElement(y,{type:e})}},27102:(e,t,s)=>{"use strict";s.d(t,{Z:()=>G});var i=s(63904),n=s.n(i),a=s(87363),r=s.n(a),o=s(4463),d=s(29994),l=s(77123),c=s(45331),h=s(43548),u=s(58432),p=s(43190),v=s(41811),m=s(93298);const g=n().with("screen-manager-cover"),w=(0,m.M$)("ScreenManagerCover",m.XG.Popup);class y extends a.Component{constructor(){super(...arguments),this.state={visible:!0,playit:!1},this.onVisibilityChange=()=>{document.hidden&&this.setState({visible:!0})},this.onClick=()=>{this.setState({visible:!1}),h.Z.post({type:"screen-manager",action:"request-fullscreen"})}}componentDidMount(){if(w("componentDidMount"),p.w.available)return void this.setState({visible:!1});const e=(0,u.KT)();v.AY.includes(e)&&"landscape"===this.gameOrientation&&this.setState({playit:!0}),this.addListeners()}get gameOrientation(){var e;return null==(e=this.context.playPageData.gameSettings.features)?void 0:e.orientation}componentDidUpdate(e){!e.isFullscreenActive&&this.props.isFullscreenActive&&this.setState({visible:!0})}componentWillUnmount(){w("componentWillUnmount"),this.removeListeners()}addListeners(){document.addEventListener("visibilitychange",this.onVisibilityChange)}removeListeners(){document.removeEventListener("visibilitychange",this.onVisibilityChange)}render(){return this.state.visible&&!this.props.isFullscreenActive?r().createElement("div",{className:g({playit:this.state.playit}),onClick:this.onClick,onTouchEnd:this.onClick}):null}}y.contextType=c.Z;const f=(0,d.$j)((function(e){return{isFullscreenActive:e.ui.isFullscreenActive}}))(y);var b=s(95968),A=s(90043),S=s(65015),k=s(69543),E=s(98589),I=s(35090),R=s(77901),P=s(27859),T=s(40656),C=s(15771);const L=(0,m.M$)("ScreenManager",m.XG.Dev);class D extends a.Component{constructor(e){super(e),this.onMessage=(e,t)=>{switch(e.data.action){case"request-fullscreen":this.requestFullscreen({force:!0}).then((()=>{t()})).catch((e=>{t({error:e})}));break;case"exit-fullscreen":this.exitFullscreen().then((()=>{this.unlockScreenOrientation(),t()})).catch((e=>{t({error:e})}));break;case"toggle-fullscreen":this.toggleFullscreen().then((()=>{this.unlockScreenOrientation(),t()})).catch((e=>{t({error:e})}));break;case"rotate-banner-add":this.addScreenOrientationBanner();break;case"rotate-banner-remove":this.removeScreenOrientationBanner();break;case"get-state":this.isFullscreen().then((e=>{t({data:{isFullscreen:e,screenOrientationWasLocked:this.state.screenOrientationWasLocked}})})).catch((()=>{t({data:{isFullscreen:!1,screenOrientationWasLocked:this.state.screenOrientationWasLocked}})}));break;case"fullscreen-supported":t({data:{isFullscreenSupported:this.isFullscreenSupported}})}},this.updateFullscreenState=()=>{this.isFullscreen().then((e=>this.props.setIsFullscreenActive(e)))},this.state={screenOrientationWasLocked:!1,withCover:!1}}get gameFeatures(){return this.context.playPageData.gameSettings.features||{}}get fullScreenValue(){const{fullscreen:e}=this.gameFeatures;return"boolean"==typeof e?e:"desktop"!==this.context.deviceType}get gameOrientation(){const{orientation:e}=this.gameFeatures;if("landscape"===e||"portrait"===e)return e}componentDidMount(){L("componentDidMount"),this.props.setIsFullscreenEnabled(this.isFullscreenSupported()),this.addFullscreenListener(),this.updateFullscreenState(),this.initMessaging(),this.initCover(),this.initFullscreen(),this.initScreenOrientation()}componentWillUnmount(){L("componentWillUnmount"),this.removeFullscreenListener(),this.destroyMessaging()}addFullscreenListener(){var e;p.w.available?null==(e=(0,p.u)())||e.addEventListener("fullscreenchange",this):document.addEventListener(b.Z.fullscreenchange,this)}removeFullscreenListener(){var e;p.w.available?null==(e=(0,p.u)())||e.removeEventListener("fullscreenchange",this):document.removeEventListener(b.Z.fullscreenchange,this)}initMessaging(){h.Z.onExternalMessage("screen-manager",this.onMessage),h.Z.onInternalMessage("screen-manager",this.onMessage)}destroyMessaging(){h.Z.offExternalMessage("screen-manager",this.onMessage),h.Z.offInternalMessage("screen-manager",this.onMessage)}initCover(){this.isFullscreenEnabled()&&(p.w.available||(this.setState({withCover:!0}),(0,I.g)()||this.requestFullscreen().catch((()=>{}))))}initFullscreen(){this.isFullscreenEnabled()&&((0,I.g)()||this.requestFullscreenForYandexPlatforms(),window.addEventListener("blur",this))}initScreenOrientation(){this.updateScreenOrientationBanner(),P.Z.isSupported&&P.Z.addChangeListener(this)}handleEvent(e){const{type:t}=e;t===P.Z.changeEventName?this.handleScreenOrientationChange():t===b.Z.fullscreenchange?(this.updateFullscreenState(),this.handleFullscreenChange()):"blur"===t?(window.removeEventListener("blur",this),window.setTimeout((()=>{var e,t,s;!(null==(e=document.activeElement)?void 0:e.toString().includes("HTMLIFrameElement"))&&"IFRAME"!==(null==(s=null==(t=document.activeElement)?void 0:t.tagName)?void 0:s.toUpperCase())||(0,I.g)()||this.requestFullscreen().catch((()=>{}))}),0)):(0,S.fF)(new Error(`Unknown event '${t}'`))}handleScreenOrientationChange(){!1===this.updateScreenOrientationBanner()&&this.requestFullscreen().catch((()=>{}))}handleFullscreenChange(){this.isFullscreen().then((e=>{h.Z.hasChild()&&h.Z.postToChild(k.vP.Fullscreenchange({isFullscreen:e})),h.Z.post({type:"screen-manager",action:"fullscreenchange",data:{isFullscreen:e}}),window.setTimeout((()=>{e&&this.lockScreenOrientation()}),T.WT)})).catch((e=>{(0,S.fF)(e)}))}isFullscreenSupported(){return p.w.available||Boolean(document[b.Z.fullscreenEnabled])}needScreenCover(){const e=(0,u.KT)();return v.AY.includes(e)&&"landscape"===this.gameOrientation}isFullscreenEnabled(){const{abt:{flags:e},playPageData:{gameInfo:t}}=this.context,{appId:s}=t;if((0,C.Nm)(e))return!1;if(function(e){return["100714"].includes(e)}(s))return!1;if(window.parent!==window)return!1;const i=(0,u.KT)();return!v.XL.includes(i)&&((!v.AY.includes(i)||"portrait"!==this.gameOrientation)&&Boolean(this.fullScreenValue&&this.isFullscreenSupported()))}get fullscreenElement(){return document[b.Z.fullscreenElement]}isFullscreen(){return p.w.available?p.w.isFullscreen():Promise.resolve(Boolean(this.fullscreenElement))}requestFullscreen({force:e}={}){return e||this.isFullscreenEnabled()?new Promise(((e,t)=>{this.isFullscreen().then((s=>{s?e():this.fullscreenMethodCallWrapper("requestFullscreen").then(e).catch(t)})).catch(t)})):Promise.resolve()}requestFullscreenForYandexPlatforms(){((0,R.RY)()||(0,R.XQ)()||(0,R.V5)())&&this.requestFullscreen().catch((()=>{}))}exitFullscreen(){return this.fullscreenMethodCallWrapper("exitFullscreen")}toggleFullscreen(){return this.isFullscreen().then((e=>e?this.exitFullscreen().then((()=>{this.needScreenCover()||this.setState({withCover:!1}),this.unlockScreenOrientation()})):this.requestFullscreen({force:!0})))}fullscreenMethodCallWrapper(e){return new Promise(((t,s)=>{if(p.w.available)return void p.w[e]().then(t).catch(s);let i,n;if("exitFullscreen"===e?(i=document,n=document[b.Z.exitFullscreen]):(i=document.documentElement,n=i[b.Z[e]]),n)try{Promise.resolve(n.call(i,{navigationUI:"hide"})).then((()=>t())).catch((e=>s(e)))}catch(e){s(e)}else s(new Error("Fullscreen is not supported"))}))}isScreenOrientationSupported(){const{deviceType:e}=this.context;return"desktop"!==e&&"tv"!==e&&P.Z.isSupported}isScreenOrientationEnabled(){return Boolean(this.gameOrientation&&this.isScreenOrientationSupported()&&!(0,C.t7)(this.context.abt.flags))}addScreenOrientationBanner(){E.Z.params({orientationBanner:{show:!0,correctOrientation:this.gameOrientation,currentOrientation:P.Z.isSupported?(0,P.a)(P.Z.type):void 0}}),this.props.setIsOrientationBannerVisible(Boolean(this.gameOrientation))}removeScreenOrientationBanner(){E.Z.params({orientationBanner:{show:!1,isLockedForcefully:this.state.screenOrientationWasLocked,correctOrientation:this.gameOrientation,currentOrientation:P.Z.isSupported?(0,P.a)(P.Z.type):void 0}}),this.props.setIsOrientationBannerVisible(!1)}updateScreenOrientationBanner(){if(this.isScreenOrientationEnabled())return P.Z.type.startsWith(String(this.gameOrientation))?(this.removeScreenOrientationBanner(),!1):(this.addScreenOrientationBanner(),!0)}screenOrientationIsLockable(){return P.Z.isLockable&&this.fullscreenElement&&this.isScreenOrientationEnabled()}lockScreenOrientation(){this.screenOrientationIsLockable()&&P.Z.lock(this.gameOrientation).then((()=>{this.setState({screenOrientationWasLocked:!0}),this.props.setScreenOrientationLocked(!0)})).catch((e=>{console.debug(e),this.updateScreenOrientationBanner()}))}unlockScreenOrientation(){this.state.screenOrientationWasLocked&&P.Z.unlock().then((()=>{this.setState({screenOrientationWasLocked:!1}),this.props.setScreenOrientationLocked(!1)})).catch((e=>{console.debug(e)}))}render(){const{withCover:e}=this.state;return[e&&r().createElement(f,{key:"screen-manager-cover"})]}}D.contextType=c.Z;const O=(0,d.$j)(null,(function(e){return(0,l.DE)({setIsFullscreenActive:A.hu,setIsFullscreenEnabled:A.rV,setScreenOrientationLocked:A.ht,setIsOrientationBannerVisible:A.f_},e)}))(D);var B=s(40184),x=s(26891),_=s(26256);function N({abt:e,appId:t,deviceType:s,baseHost:i,baseUrl:n,gameSrc:a,s3PreloaderHelperPath:r,sdkHash:o,search:d,uatraits:l}){var c;const h=["draft"],u=new URL(a),p=new URLSearchParams(u.hash.slice(1));Array.from(new URLSearchParams(d.slice(1)).entries()).forEach((([e,t])=>{h.includes(e)&&null!==t?p.append(e,t):u.searchParams.has(e)||u.searchParams.append(e,t)})),u.searchParams.set("sdk",`/sdk/_/v2.${o}.js`),p.has("app-id")||p.append("app-id",t),p.append("device-type",s),u.hash=p.toString(),/[?&]csp_test=true/.test(d)&&(u.pathname=u.pathname.replace("index.html","index-csp.html"));const v=u.toString();let m=v;if((e=>Boolean((null==e?void 0:e.BrowserName)&&/Safari/i.test(e.BrowserName)))(l)||(e=>(null==e?void 0:e.OSFamily)===_.k.IOS)(l)){const e=(0,x.V)(m);if(e){m=e+(r.startsWith("/")?r.substring(1):r)+"?retpath="+encodeURIComponent(v)}}return m=(null==(c=null==e?void 0:e.flags)?void 0:c.clear_iframe_utm)?(e=>{const t=new URL(e);return Array.from(t.searchParams.keys()).forEach((e=>{0===e.indexOf("utm_")&&t.searchParams.delete(e)})),t.href})(m):m,{frameSrc:m,originSrc:v}}var q=Object.defineProperty,M=Object.defineProperties,$=Object.getOwnPropertyDescriptors,F=Object.getOwnPropertySymbols,W=Object.prototype.hasOwnProperty,Z=Object.prototype.propertyIsEnumerable,U=(e,t,s)=>t in e?q(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;const H=n().with("game"),z=()=>{const e=(0,B.b)(),t=(0,o.TH)(),{abt:s,playPageData:i,baseHost:n,baseUrl:d,requestId:l,uatraits:c,isAndroidTV:h,deviceType:u,isTranssion:p}=e,{gameSrcDocument:v}=i;let m,g=i.iframeAllow+"accelerometer; gyroscope;";const w=(0,a.useMemo)((()=>(0,C.MA)(s.flags)||p&&(0,C.f4)(s.flags)),[s.flags,p]);let y=(0,a.useMemo)((()=>t.search),[]),f=(0,a.useMemo)((()=>{const{frameSrc:e}=N({abt:s,appId:i.gameInfo.appId,baseHost:n,baseUrl:d,deviceType:u,gameSrc:i.gameSrc,s3PreloaderHelperPath:i.s3PreloaderHelperPath,sdkHash:i.sdkHash,search:w?y:t.search,uatraits:c});return e}),[s,u,n,d,t.search,i.gameInfo.appId,i.gameSrc,i.s3PreloaderHelperPath,i.sdkHash,y,w,c]);const b=(0,a.useCallback)((()=>{var e;"undefined"!=typeof window&&(null==(e=window.onGameFrameLoad)||e.call(window))}),[]),A=(0,a.useCallback)((e=>{var t;"undefined"!=typeof window&&(null==(t=window.onGameFrameError)||t.call(window,e))}),[]);let S=f;if(v){const e=new URL(f),t=new URL(v);t.hash=e.hash,S=t.toString()}return r().createElement("div",{className:H()},r().createElement(O,null),r().createElement("iframe",(k=((e,t)=>{for(var s in t||(t={}))W.call(t,s)&&U(e,s,t[s]);if(F)for(var s of F(t))Z.call(t,s)&&U(e,s,t[s]);return e})({},(0,C.B7)((null==s?void 0:s.flags)||{})&&{"referrer-policy":"no-referrer"}),E={allow:g,"data-allowed-origins":JSON.stringify([i.gameOrigin,n]),"data-origin-src":f,id:"game-frame",name:l,sandbox:m,src:S,style:{},onError:A,onLoad:b},M(k,$(E)))));var k,E},G=z},82346:(e,t,s)=>{"use strict";s.d(t,{G0:()=>S,GP:()=>k,IR:()=>E,QU:()=>R,WM:()=>P,Xp:()=>w,Zn:()=>I,qj:()=>b,wv:()=>y});var i=s(75856),n=s(59986),a=s(65015),r=s(11815),o=s(80856),d=s(42126),l=s(34711),c=s(76488),h=s(40656),u=s(93298),p=s(89592);const v=60*h.WT;let m={time:0,data:{products:[]}};const g=(0,u.M$)("Payments",u.XG.Dev);function w(e){const t=m.lang||e.lang;return new Promise(((e,s)=>{Math.abs(m.time-Date.now())<v&&m.lang===t?e({products:m.data.products}):(0,n.ix)(`products?lang=${encodeURIComponent(t)}`).then((s=>{m={data:s,lang:t,time:Date.now()},e({products:m.data.products})})).catch((e=>{(0,a.fF)(e,{sourceMethod:"getProducts",message:`${p.EW} getProducts error`,type:"fetch"}),s(e)}))}))}const y=(0,i.Z)((function({id:e,lang:t}){return new Promise(((s,i)=>{(0,n.ix)(`products?id=${encodeURIComponent(e)}&lang=${encodeURIComponent(t)}`).then((e=>{var t,i;if(!c.XK){const s=null==(t=window.YandexGamesSDK)?void 0:t.request.experiments.new_payments_balance;void 0!==s&&""!==s&&(e.balance=parseInt(s,10)||0);const n=null==(i=window.YandexGamesSDK)?void 0:i.request.experiments.new_payments_mockable;void 0!==n&&(e.mockable=n||!1)}g("getProduct responseData",e),s(e)})).catch((e=>{(0,a.fF)(e,{sourceMethod:"getProduct",message:`${p.EW} getProduct error`,type:"fetch"}),i(e)}))}))}));function f(e){const t=String((0,l.X)()||"");return t?(0,d.Z)({url:e,params:{clid:t}}):e}const b=(0,i.Z)((function({developer_payload:e,id:t,mock:s,signed:i=!1}){return new Promise(((r,o)=>{(0,n.hB)(f("buy"+(i?"-signed":"")),{id:t,mock:s,developer_payload:e}).then((e=>{"error"in e?o(new Error(e.error)):r(e)})).catch((e=>{(0,a.fF)(e,{sourceMethod:"buyProduct",message:`${p.EW} buyProduct error`,type:"fetch"}),o(e)}))}))})),A=Object.create(null),S=(0,i.Z)((function({token:e}){return g("consumePurchase",e),e in A||(A[e]=new Promise(((t,s)=>{(0,n.hB)("consume",{token:e}).then((i=>{delete A[e],g("consumePurchase responseData",i),i.token?t(i.token):s(new r.Z({code:"CANNOT_CONSUME_PURCHASE",message:"Can not consume purchase."}))})).catch((t=>{delete A[e],(0,a.fF)(t,{sourceMethod:"consumePurchase",message:`${p.EW} consumePurchase error`,type:"fetch"}),s(t)}))}))),A[e]}));function k({paymentsConfig:e,defaultLang:t}){return new Promise(((s,i)=>{(0,n.ix)(`purchased${e.signed?"-signed":""}?lang=${encodeURIComponent(e.lang||t)}`).then((e=>{const{data:t,signature:i}=(0,o.c)(e);s({data:t,signature:i})})).catch((e=>{(0,a.fF)(e,{sourceMethod:"getPurchases",message:`${p.EW} getPurchases error`,type:"fetch"}),i(e)}))}))}function E({lang:e}){return new Promise(((t,s)=>{(0,n.w$)(`products?lang=${encodeURIComponent(e)}`).then((({data:e})=>{g("fetchCurrencyData response",e),t(e)})).catch((e=>{(0,a.fF)(e,{sourceMethod:"getCurrencyProducts",message:`${p.EW} getCurrencyProducts error`,type:"fetch"}),s(e)}))}))}function I({id:e,lang:t,getText:s,cdnUrl:i}){return new Promise(((r,o)=>{(0,n.lB)(`products?lang=${encodeURIComponent(t)}`).then((t=>{var d,l,h,u,v;const m=t.data.find((t=>t.id===e));if(!m)return void o(new Error(`Product with id "${e}" not found.`));const g=m.info.price,w=m.info.pricePlus,y=Boolean(null==(h=null==(l=null==(d=window.YandexGamesSDK)?void 0:d.game)?void 0:l.player)?void 0:h.hasYaPlus)&&"number"==typeof w&&w<g&&w>=0?w:g,f={balance:-1,product:{description:s(`purchase.description.${e}`),id:e,image:{url_prefix:`${i}/games-static/static-data/images/payments/subscriptions/${e}.svg`},price:y,pricePlus:w,priceRegular:g,title:s(`purchase.title.${e}`)}};if(!c.XK){const{experiments:e={}}=null==(u=window.YandexGamesSDK)?void 0:u.request,t=e.new_payments_balance;void 0!==t&&""!==t&&(f.balance=parseInt(t,10)||0);const s=e.new_payments_mockable;void 0!==s&&(f.mockable=s||!1)}(null==(v=window.YandexGamesSDK)?void 0:v.isSearchCrawler)||new Promise(((e,t)=>{(0,n.EG)().then((t=>{e(t.value)})).catch((e=>{(0,a.fF)(e,{sourceMethod:"getBalance",message:`${p.EW} getBalance error`,type:"fetch"}),t(e)}))})).then((e=>{f.balance=e,r(f)})).catch(o)})).catch((e=>{(0,a.fF)(e,{sourceMethod:"getPlatformProduct",message:`${p.EW} getPlatformProduct error`,type:"fetch"}),o(e)}))}))}const R=(0,i.Z)((function({developer_payload:e,id:t,mock:s}){return new Promise(((i,r)=>{(0,n.$)(f("buy"),{id:t,mock:s,developer_payload:e}).then((e=>{"failure"===e.status?r(new Error(e.message)):i(e)})).catch((e=>{(0,a.fF)(e,{sourceMethod:"buyPlatformProduct",message:`${p.EW} buyPlatformProduct error`,type:"fetch"}),r(e)}))}))}));function P(){return new Promise(((e,t)=>{(0,n.KL)().then((t=>{e(t.code)})).catch((e=>{(0,a.fF)(e,{sourceMethod:"getRecoveryCode",message:`${p.EW} getRecoveryCode error`,type:"fetch"}),t(e)}))}))}},75856:(e,t,s)=>{"use strict";s.d(t,{Z:()=>m});var i=s(96452),n=s(43548),a=Object.defineProperty,r=Object.defineProperties,o=Object.getOwnPropertyDescriptors,d=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,c=Object.prototype.propertyIsEnumerable,h=(e,t,s)=>t in e?a(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,u=(e,t)=>{for(var s in t||(t={}))l.call(t,s)&&h(e,s,t[s]);if(d)for(var s of d(t))c.call(t,s)&&h(e,s,t[s]);return e},p=(e,t)=>r(e,o(t));function v(e,t={}){return n.Z.post({type:"auth",action:e,data:p(u({},t),{initializer:"auth-fetch-wrapper"})})}function m(e){return function(...t){return new Promise(((s,n)=>{e(...t).then(((...e)=>{s(...e)})).catch((a=>{(0,i.ZR)(a)?(v("set-auth",{hasAuth:!1}),v("auth-dialog-open").then((({errorInstance:i})=>{if(i)throw i;e(...t).then(s).catch(n)})).catch(n)):n(a)}))}))}}},59986:(e,t,s)=>{"use strict";s.d(t,{$:()=>D,EG:()=>I,KL:()=>L,U:()=>T,hB:()=>R,ix:()=>E,lB:()=>C,w$:()=>P});var i=s(31320),n=s(75856),a=s(24890),r=s(40656),o=s(93298),d=s(90295),l=Object.defineProperty,c=Object.getOwnPropertySymbols,h=Object.prototype.hasOwnProperty,u=Object.prototype.propertyIsEnumerable,p=(e,t,s)=>t in e?l(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,v=(e,t)=>{for(var s in t||(t={}))h.call(t,s)&&p(e,s,t[s]);if(c)for(var s of c(t))u.call(t,s)&&p(e,s,t[s]);return e};const m="/purchases/app",g="/purchases/platform",w="/purchases/currency",y=2*r.yR,f=()=>y*(0,i.n)(),b="/currency/balance",A=3*r.WT,S=()=>A*(0,i.n)(),k=(0,o.M$)("Payments fetch",o.XG.Dev);function E(e){return(0,a.rQ)({apiPath:`${m}/${e}`,timeout:f(),options:{credentials:"include",headers:{Accept:"application/json"},method:"GET",referrerPolicy:"no-referrer-when-downgrade"}})}function I(){return(0,a.rQ)({apiPath:b,timeout:S(),options:{credentials:"include",headers:{Accept:"application/json"},method:"GET",referrerPolicy:"no-referrer-when-downgrade"}})}const R=(0,n.Z)((function(e,t){return(0,a.rQ)({apiPath:`${m}/${e}`,timeout:f(),options:{body:JSON.stringify(t),credentials:"include",headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",referrerPolicy:"no-referrer-when-downgrade"}})}));function P(e){return(0,a.rQ)({apiPath:`${w}/${e}`,timeout:f(),options:{credentials:"include",headers:{Accept:"application/json"},method:"GET",referrerPolicy:"no-referrer-when-downgrade"}})}const T=(0,n.Z)((function(e,t,s={}){return k("postCurrencyData",JSON.stringify(t,null,"\t")),(0,a.rQ)({apiPath:`${w}/${e}`,timeout:f(),options:{body:JSON.stringify(t),credentials:"include",headers:v({Accept:"application/json","Content-Type":"application/json"},s),method:"POST",referrerPolicy:"no-referrer-when-downgrade"}})}));function C(e){return(0,a.rQ)({apiPath:`${g}/${e}`,timeout:f(),options:{credentials:"include",headers:{Accept:"application/json"},method:"GET",referrerPolicy:"no-referrer-when-downgrade"}})}function L(){return(0,a.rQ)({apiPath:`/${d.tw}`,timeout:f(),options:{credentials:"include",headers:{Accept:"application/json"},method:"GET",referrerPolicy:"no-referrer-when-downgrade"}})}const D=(0,n.Z)((function(e,t){return(0,a.rQ)({apiPath:`${g}/${e}`,timeout:f(),options:{body:JSON.stringify(t),credentials:"include",headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",referrerPolicy:"no-referrer-when-downgrade"}})}))},58e3:(e,t,s)=>{"use strict";s.d(t,{E:()=>n});var i=s(96452);function n(e){return(0,i.f1)(e)?new i.ZP.AuthError({code:"UNAUTHORIZED",message:"Unauthorized"}):new i.ZP.PaymentsError({code:"PAYMENT_FAILURE",message:"Payment failure"})}},41917:(e,t,s)=>{"use strict";s.d(t,{Z:()=>k});var i=s(63904),n=s.n(i),a=s(87363),r=s.n(a),o=s(29994),d=s(45331),l=s(32922),c=s(82346),h=s(58e3);const u=s(69833).Z;var p=s(83388),v=s(68409),m=s(43548),g=s(65015),w=s(50042);const y=function(){const e=(0,w.Au)(),t=(0,w.H$)(),s=(0,w.Um)(),i=(0,w.q7)();try{if(window.yandex&&window.yandex.app&&"function"==typeof PaymentRequest&&t&&(e||i&&s))return!0}catch(e){(0,g.fF)(e)}return!1};var f=s(76488),b=s(41952);const A=n().with("play-payments");class S extends d.P{constructor(e,t){super(e),this.paymentsRootRef=r().createRef(),this.onExternalPaymentsMessage=(e,t)=>{const{action:s,data:i}=e.data;switch(s){case"get-env":t({data:{paymentMode:y()?"":void 0}});break;case"get-catalog":const{lang:e}=i;(0,c.Xp)({lang:e||this.state.defaultLang}).then((e=>{t({data:e})})).catch((e=>{t({error:(0,h.E)(e)})}));break;case"purchase-start":{if(this.state.purchaseDialog||this.state.balanceDialog)return void this.trembleDialog();const{paymentsConfig:e,purchaseConfig:s}=i;this.purchaseStartMessagingCallback=t,this.setState({dialogType:p.Z.PURCHASE,balanceDialog:null,purchaseDialog:{basicSupportPaymentRequest:this.state.basicSupportPaymentRequest,isPlatformPurchase:!1,paymentsConfig:e,purchaseConfig:s}});break}case"get-purchases":{const{paymentsConfig:e}=i;(0,c.GP)({paymentsConfig:e,defaultLang:this.state.defaultLang}).then((({data:e,signature:s})=>{t({data:{data:e,signature:s}})})).catch((e=>{t({error:(0,h.E)(e)})}));break}case"purchase-consume":{const{token:e}=i;(0,c.G0)({token:e}).then((e=>{t({data:{token:e}})})).catch((e=>{t({error:(0,h.E)(e)})}));break}}},this.onInternalPaymentsMessage=(e,t)=>{const{action:s,data:i}=e.data;switch(s){case"balance-refill":{const{paymentsConfig:e}=i;this.openBalanceDialog(e);break}case"purchase-start":this.onExternalPaymentsMessage(e,t);break;case"platform-purchase-start":this.startPlatformPurchase(i,t)}},this.onBalanceSuccess=()=>{this.setState({balanceDialog:null})},this.onBalanceError=e=>{f.XK||console.warn(e),this.setState({balanceDialog:null})},this.onPurchaseSuccess=e=>{var t;null==(t=this.purchaseStartMessagingCallback)||t.call(this,{data:e}),this.setState({purchaseDialog:null})},this.onPurchaseError=e=>{var t;null==(t=this.purchaseStartMessagingCallback)||t.call(this,e),this.setState({purchaseDialog:null})},this.onPlatformPurchaseSuccess=e=>{var t;null==(t=this.startPlatformMessagingCallback)||t.call(this,{data:e}),this.setState({purchaseDialog:null}),m.Z.post({type:"payments",action:"platform-purchase-success",data:e})},this.onPlatformPurchaseError=e=>{var t;null==(t=this.startPlatformMessagingCallback)||t.call(this,e),this.setState({purchaseDialog:null})},this.trembleDialog=()=>{this.setState({isTrembling:!1},(()=>{requestAnimationFrame((()=>{this.setState({isTrembling:!0}),window.setTimeout((()=>{this.setState({isTrembling:!1})}),2e3)}))}))},this.handleCreateBalanceRefilled=e=>{this.setState({balanceRefilled:e})},this.handleBalanceRefilledClose=()=>{var e,t;null==(t=null==(e=this.state.balanceRefilled)?void 0:e.onClose)||t.call(e),this.setState({balanceRefilled:null})},this.handleBalanceRefilledBuyMore=()=>{m.Z.post({type:"payments",action:"balance-refill",data:{paymentsConfig:{lang:this.context.lang}}}),this.handleBalanceRefilledClose()},this.renderContent=()=>r().createElement(r().Fragment,null,this.renderBalanceRefilled(),this.renderDialog()),this.state={balanceDialog:null,balanceRefilled:null,dialogType:p.Z.BALANCE,purchaseDialog:null,basicSupportPaymentRequest:!1,isTrembling:!1,defaultLang:t.lang,hasMounted:!1}}componentDidMount(){this.setState({basicSupportPaymentRequest:y(),hasMounted:!0}),this.initMessaging()}initMessaging(){m.Z.onExternalMessage("payments",this.onExternalPaymentsMessage),m.Z.onInternalMessage("payments",this.onInternalPaymentsMessage)}startPlatformPurchase(e,t){if(this.props.disablePlatformPurchase)return;if(this.state.purchaseDialog||this.state.balanceDialog)return void this.trembleDialog();const{paymentsConfig:s,purchaseConfig:i}=e;this.startPlatformMessagingCallback=t,this.setState({dialogType:p.Z.PURCHASE,balanceDialog:null,purchaseDialog:{basicSupportPaymentRequest:this.state.basicSupportPaymentRequest,paymentsConfig:s,purchaseConfig:i,isPlatformPurchase:!0}})}openBalanceDialog(e){this.state.purchaseDialog||this.state.balanceDialog?this.trembleDialog():this.setState({dialogType:p.Z.BALANCE,purchaseDialog:null,balanceDialog:{basicSupportPaymentRequest:this.state.basicSupportPaymentRequest,paymentsConfig:e}})}renderBalanceRefilled(){const{balanceRefilled:e,purchaseDialog:t}=this.state,{balance:s}=this.props;if(e){const i=t?"balance-refilled.ok":"balance-refilled.return-to-game";return r().createElement(l.Z,{balance:"number"==typeof s?s:void 0,diff:Number(e.diff),imgSrc:e.img,isPurchase:Boolean(t),isRetpathUser:!0,orderPrice:e.orderPrice,passportOrigin:b._4.GamesBalanceRefilled,playRecoveryCode:e.recoveryCode,returnButtonText:this.props.getText(i),onBuyMore:this.handleBalanceRefilledBuyMore,onClose:this.handleBalanceRefilledClose})}return null}renderDialog(){const{hideAuthDialog:e}=this.props,{balanceDialog:t,purchaseDialog:s,isTrembling:i,dialogType:n}=this.state;return t?r().createElement(u,{basicSupportPaymentRequest:t.basicSupportPaymentRequest,dialogType:n,hideAuthDialog:e,isTrembling:i,paymentsConfig:t.paymentsConfig,rootRef:this.paymentsRootRef,onBalanceError:this.onBalanceError,onBalanceSuccess:this.onBalanceSuccess,onCreateBalanceRefilled:this.handleCreateBalanceRefilled}):s?r().createElement(u,{basicSupportPaymentRequest:s.basicSupportPaymentRequest,dialogType:n,hideAuthDialog:e,isPlatformPurchase:s.isPlatformPurchase,isTrembling:i,paymentsConfig:s.paymentsConfig,purchaseConfig:s.purchaseConfig,rootRef:this.paymentsRootRef,onCreateBalanceRefilled:this.handleCreateBalanceRefilled,onPlatformPurchaseError:this.onPlatformPurchaseError,onPlatformPurchaseSuccess:this.onPlatformPurchaseSuccess,onPurchaseError:this.onPurchaseError,onPurchaseSuccess:this.onPurchaseSuccess}):null}render(){return this.state.hasMounted?r().createElement("div",{className:A(),ref:this.paymentsRootRef},this.renderContent()):null}}const k=(0,o.$j)((function(e){return{balance:(0,v.n)(e),getText:e.getText}}))(S)},83388:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});var i=(e=>(e.BALANCE="balance",e.PURCHASE="purchase",e))(i||{})},78740:(e,t,s)=>{"use strict";s.d(t,{Ek:()=>r,SA:()=>a,UG:()=>d,VM:()=>u,Vs:()=>l,_W:()=>h,b3:()=>i,cC:()=>c,gK:()=>n,lX:()=>o});const i="similar_games",n="game_promo_similar_games",a="play-similar-games",r="play-similar-games-stubs",o=107,d=20,l="similar_games_count",c="similar_games_proxy",h="yandexGames_similar_games_close",u="yandexGames_similar_games_close"},4230:(e,t,s)=>{"use strict";s.d(t,{_Z:()=>k,ii:()=>E,kr:()=>S,xG:()=>A});var i=s(67748),n=s.n(i),a=s(34711),r=s(83242),o=s(35090),d=s(48810),l=s(78740),c=Object.defineProperty,h=Object.defineProperties,u=Object.getOwnPropertyDescriptors,p=Object.getOwnPropertySymbols,v=Object.prototype.hasOwnProperty,m=Object.prototype.propertyIsEnumerable,g=(e,t,s)=>t in e?c(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,w=(e,t)=>{for(var s in t||(t={}))v.call(t,s)&&g(e,s,t[s]);if(p)for(var s of p(t))m.call(t,s)&&g(e,s,t[s]);return e},y=(e,t)=>h(e,u(t));const f=e=>{let t;try{t=JSON.parse(e)}catch(e){t=[]}return Array.isArray(t)?t:[]},b=(e,t)=>{const s=Array.isArray(e)?e:f(e);t&&s.push(t),(0,d.Ur)(l.VM,JSON.stringify(s))};function A(e){const t=(0,d.dq)(l.VM);t.wasError||!t.value?(0,d.Ur)(l.VM,JSON.stringify([e])):b(t.value,e)}function S(e,t){return void 0===e||0===t.length?t:t.length>e?t=t.slice(0,e):(t.length<e&&(t=[...Array(Math.ceil(e/t.length))].reduce(((e,s,i)=>e.concat(t.map(((e,s)=>y(w({},e),{appID:e.appID+i,title:e.title+` (${i*t.length+s+1})`}))))),[]).slice(0,e)),t)}function k({appId:e,inGamePage:t,hasMounted:s,isDistGame:i,search:c,showOnRedirectFromCatalog:h}){if(i)return!1;const u=n().parse(c.slice(1));if("distrib"===u.utm_source||u.clid)return!1;if(t)return!0;if(!s)return!0;if((0,a.X)()||!h&&(0,o.Oo)())return!1;const p=(0,r.e)(l._W);if(p){const t=f(p);if(t.length&&b(t),document.cookie=`${l._W}=; path=/; Secure; Max-age=-1; domain=.${window.location.hostname};`,t.includes(e))return!1}const v=(0,d.dq)(l.VM);if(!v.wasError&&v.value){if(f(v.value).includes(e))return!1}return!0}function E(){"undefined"!=typeof document&&document.body.classList.contains("with-similar-games")&&document.body.classList.remove("with-similar-games")}},1481:(e,t,s)=>{"use strict";s.d(t,{Z:()=>n});var i=s(87363);const n=({onError:e})=>((0,i.useEffect)((()=>{null==e||e(new Error("Promo chunk wasnt loaded"))}),[e]),null)},14872:(e,t,s)=>{"use strict";s.d(t,{Z:()=>b});var i=s(46210),n=(s(10131),s(63904)),a=s.n(n),r=s(87363),o=s.n(r),d=s(45112),l=s(25827),c=s(45331);const h=a().with("progress-ring");class u extends r.Component{render(){const e=100-Math.min(100,((this.props.current||0)-1)/(this.props.total-1)*100),t=24,s=42*Math.PI,i=s-e/100*s;return o().createElement("div",{className:h()},o().createElement("svg",{height:48,width:48},o().createElement("circle",{className:h("circle-background"),cx:t,cy:t,fill:"transparent",r:21,strokeDasharray:`${s} ${s}`,strokeWidth:3}),o().createElement("circle",{className:h("circle"),cx:t,cy:t,fill:"transparent",r:21,strokeDasharray:`${s} ${s}`,strokeDashoffset:i,strokeWidth:3})),o().createElement("span",{className:h("countdown")},this.props.current))}}u.contextType=c.Z;var p=s(40184),v=s(85467),m=s(41811),g=s(40656),w=s(15771),y=s(90380);const f=a().with("rewarded-counter"),b=({onClose:e,onDone:t,paused:s=!1,seconds:n,text:a})=>{const c=(0,v.T)(),{abt:{flags:h}}=(0,p.b)(),{current:b}=(0,r.useRef)(null!==(0,i.mm)(window.location.href)),[A,S]=(0,r.useState)(b?1:Math.floor(n)),k=A>0;return(0,d.Yz)((()=>{(!0!==(0,w.RM)(h,y.Z.advStopRewardedCounterOnLeave)||!document.hidden&&document.hasFocus())&&S((e=>e-1))}),k&&!s?g.WT:null),(0,r.useEffect)((()=>{k||null==t||t()}),[k,t]),k?o().createElement("div",{className:f()},o().createElement("span",{className:f("text")},a||c("adv.rewarded.countdown.text")),o().createElement(u,{current:Math.max(0,A),total:n})):o().createElement("div",{className:f()},o().createElement(l.Z,{source:m.h0.REWARDED_COUNTER,type:"rewarded",onClick:e}))}},95968:(e,t,s)=>{"use strict";s.d(t,{Z:()=>n});var i=s(95178);const n={fullscreenEnabled:(0,i.Z)("fullscreenEnabled"),fullscreenElement:(0,i.Z)("fullscreenElement"),requestFullscreen:(0,i.Z)("requestFullscreen"),exitFullscreen:(0,i.Z)("exitFullscreen"),fullscreenchange:(0,i.Z)("fullscreenchange")}},15987:(e,t,s)=>{"use strict";s.d(t,{w:()=>i});var i=(e=>(e.MENU="menu",e.TIMER="timer",e))(i||{})},29810:(e,t,s)=>{"use strict";s.d(t,{Z:()=>l});var i=s(87363),n=s(29994),a=s(77123),r=s(46986),o=s(96821),d=s(69136);const l=(0,n.$j)((function(e){return{appState:e}}),(function(e){return(0,a.DE)({fetchUserBalance:r.Zc,setUserBalance:r.v},e)}))((e=>{const{fetchUserBalance:t,setUserBalance:s}=e,n="undefined"!=typeof window,{appState:a}=e,r=a.userData.uid,l=(0,i.useRef)(r),c=(0,i.useMemo)((()=>{if(!n)return!1;return(0,o.Z)((()=>a)).sse||!1}),[a,n]);return(0,i.useEffect)((()=>{c&&l.current!==r&&(l.current=r,c.changeAuth(r))}),[c,r]),(0,i.useEffect)((()=>{if(!c)return;const e=[],i=c.subscribe(d.Xn.BALANCE_CHANGED,(()=>{a.user.balance.ignoreBalanceEvents||t({forceFetch:!0})})),n=c.subscribe(d.Xn.BALANCE_UPDATE,(e=>{a.user.balance.ignoreBalanceEvents||s(e.value)}));return e.push(i),e.push(n),()=>{e.forEach((e=>e()))}}),[t,s,c,a.user.balance.ignoreBalanceEvents]),null}))},68316:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});const i=s(89775).Z},22263:(e,t,s)=>{"use strict";s.d(t,{c:()=>a});var i=s(38096),n=s(90380);const a=(e,t)=>{var s;if(t)return!0;const{abt:{flags:a}}=e,r=(null==(s=(0,i.getDomainConfig)().feedbackSettings)?void 0:s.flagName)||"";return Boolean(a[n.Z[r]])}},53603:(e,t,s)=>{"use strict";s.d(t,{I:()=>o,s:()=>d});var i=s(87363),n=s.n(i),a=s(78675);const r=(0,i.createContext)(null),o=e=>{const[t,s]=(0,i.useState)(!1);return n().createElement(r.Provider,{value:{isReady:t,setIsReady:s}},e.children)},d=()=>(0,a.C)({context:r,hookName:"useWithReady",contextName:"WithReadyContext"})},99213:(e,t,s)=>{"use strict";s.d(t,{b:()=>n});var i=s(87363);const n=(e,t)=>{const s=(0,i.useRef)(!1);(0,i.useEffect)((()=>{!s.current&&t&&(s.current=!0,e())}),[t,e])}},77976:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});var i=s(87363),n=s.n(i),a=s(53564);const r=()=>n().createElement(a.Z,{isFullscreen:!0})},90043:(e,t,s)=>{"use strict";s.d(t,{f_:()=>r,ht:()=>n,hu:()=>a,ls:()=>d,rV:()=>o,zN:()=>l});var i=s(2203);const n=e=>({type:i.esH,payload:{value:e}}),a=e=>({type:i.iZl,payload:{value:e}}),r=e=>({type:i.OSx,payload:{value:e}}),o=e=>({type:i.E_7,payload:{value:e}}),d=e=>({type:i.WjI,payload:{value:e}}),l=e=>({type:i.D3C,payload:{value:e}})},92389:(e,t,s)=>{"use strict";function i(e){var t;let s=document.querySelector(`.stack .${e}`);return s||(s=document.createElement("div"),s.setAttribute("class",e),null==(t=document.querySelector(".stack"))||t.appendChild(s)),s}s.d(t,{_:()=>i})},91521:(e,t,s)=>{"use strict";s.d(t,{Z:()=>n,b:()=>i});const i="yandexGames_leaderboard_clicked",n="yandexGames_no_ads_clicked"},87210:(e,t,s)=>{"use strict";s.d(t,{CX:()=>f,N5:()=>P,bT:()=>k,Vg:()=>I,S$:()=>A,xq:()=>S});var i=s(46210),n=s(14408);const a={hostname:()=>window.location.hostname,pathname:()=>window.location.pathname,protocol:()=>window.location.protocol,rootHostname:()=>window.location.hostname.split(".").slice(-2).join(".")},r=e=>e.replace(/{(\w+)}/g,((e,t)=>{var s,i;return null!=(i=null==(s=a[t])?void 0:s.call(a))?i:""}));var o=s(78308),d=s(40656),l=s(93298),c=s(15771);const h=(0,l.M$)("googlefc",l.XG.Adv,{background:"#123896",text:"white"}),u=()=>{window.googlefc=window.googlefc||{callbackQueue:[]};const{googlefc:e}=window;e.controlledMessagingFunction||(e.controlledMessagingFunction=e=>{return t=void 0,s=null,i=function*(){var t,s;if(window.appData.isGamesLiteApp)return e.proceed(!1),void h("googlefc.controlledMessagingFunction message.proceed(false).\n(window.appData.isGamesLiteApp === true)");(0,c.c6)((null==(s=null==(t=window.appData)?void 0:t.abt)?void 0:s.flags)||{})&&(h("googlefc.controlledMessagingFunction delay"),yield new Promise((e=>{var t;null==(t=window.tti)||t.ready((()=>{e()})),setTimeout((()=>{e()}),15*d.WT)}))),e.proceed(!0),h("googlefc.controlledMessagingFunction default behaviour.")},new Promise(((e,n)=>{var a=e=>{try{o(i.next(e))}catch(e){n(e)}},r=e=>{try{o(i.throw(e))}catch(e){n(e)}},o=t=>t.done?e(t.value):Promise.resolve(t.value).then(a,r);o((i=i.apply(t,s)).next())}));var t,s,i})};var p=s(76488),v=s(37705),m=s(79049),g=s(13377),w=(e,t,s)=>new Promise(((i,n)=>{var a=e=>{try{o(s.next(e))}catch(e){n(e)}},r=e=>{try{o(s.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,r);o((s=s.apply(e,t)).next())}));const y=(0,l.M$)("GoogleTagUtils",l.XG.Adv,{background:"#0c6c09",text:"#ccc"}),f=8*d.WT;let b;const A=()=>{if(b)return b;u();const e=(0,i.gw)(window.location.href);return b=(0,m.x)({id:"gpt-script",loadTest:()=>{var e;return Boolean(null==(e=window.googletag)?void 0:e.apiReady)},src:e?(0,i.DL)(e):"https://securepubads.g.doubleclick.net/tag/js/gpt.js"}),b},S=({metrikaCounter:e,parallel:t,prebidScriptUrl:s})=>{const i={gpt:!1,prebid:!1},n=s?(0,m.x)({attributes:{ym:e},crossOrigin:"anonymous",id:"prebid_tgo",src:s}):null;return t?Promise.all([A().then((()=>i.gpt=!0)).catch((e=>i.gptError=e)),null==n?void 0:n.then((()=>i.prebid=!0)).catch((e=>i.prebidError=e))]).then((()=>i)).catch((()=>i)):A().then((()=>{i.gpt=!0})).catch((e=>i.gptError=e)).then((()=>{if(!i.gptError)return null==n?void 0:n.then((()=>i.prebid=!0)).catch((e=>i.prebidError=e))})).then((()=>i)).catch((()=>i))},k=e=>w(void 0,null,(function*(){return new Promise(((t,s)=>{window.googletag=window.googletag||{cmd:[]};const{googletag:i}=window;i.cmd||(i.cmd=[]),i.cmd.push((()=>w(void 0,null,(function*(){try{t(yield e(window.googletag))}catch(e){s(e)}}))))}))}));let E;const I=()=>w(void 0,null,(function*(){return E||(!0===(null==googletag?void 0:googletag.pubadsReady)&&(0,v.H)({block:g.W.MONETIZATION,level:"warn",message:"googletagSetBaseConfig was called after googletag.enableServices()"}),E=k((e=>{const t=e.pubads();(e=>{var t;if(!window.appData)return;const s=(0,n.om)(window.appData.abt.flags);if(void 0!==s&&!s.length)return;if(void 0===s){const e="stand"===window.appData.env.CROWD_TYPE;if(p.XK&&!e&&!(null==(t=window.appData.clientFeatures)?void 0:t.isDistrib))return}const i=r(null!=s?s:"{rootHostname}");e.set("page_url",i)})(t),t.enableSingleRequest(),t.disableInitialLoad(),l.HQ&&googletag.pubads().addEventListener("impressionViewable",(()=>{y('pubads event "impressionViewable" called')})).addEventListener("slotOnload",(()=>{y('pubads event "slotOnload" called')})).addEventListener("slotRenderEnded",(()=>{y('pubads event "slotRenderEnded" called')})).addEventListener("slotRequested",(()=>{y('pubads event "slotRequested" called')})).addEventListener("slotResponseReceived",(()=>{y('pubads event "slotResponseReceived" called')})).addEventListener("rewardedSlotReady",(()=>{y('pubads event "rewardedSlotReady" called')})).addEventListener("rewardedSlotGranted",(()=>{y('pubads event "rewardedSlotGranted" called')})).addEventListener("rewardedSlotClosed",(()=>{y('pubads event "rewardedSlotClosed" called')})),function(){return w(this,null,(function*(){const e=yield P(),t=googletag.pubads();y("setGoogleKeysForTargeting",e),Object.entries(e).forEach((([e,s])=>{t.setTargeting(e,s)}))}))}().then((()=>{E=Promise.resolve(),y("googletagSetBaseConfig"),!0===e.pubadsReady&&(0,v.H)({block:g.W.MONETIZATION,level:"error",message:"setGoogleKeysForTargeting finished after googletag.enableServices()"})}))}))),E}));let R;function P(){return R||(R=new o.Z(window.appData.apiData).getGoogleKeyValues({appID:window.clientMetadata.appId,lang:window.clientMetadata.lang,platform:window.clientMetadata.platform}).catch((e=>((0,v.H)({block:g.W.GOOGLE_ADS,message:"Trouble with getting google key values"},e),{}))).then((e=>(y("getGoogleKeysForTargeting",e),e)))),R}},38508:(e,t,s)=>{"use strict";s.d(t,{M:()=>a});var i=s(41811),n=s(29483);function a(e,t){const{blockId:s,pageId:i}=t;let a="__getTextFromYandexAdvError_EMPTY_ERROR_TEXT__";if(e.text){const t=new RegExp((0,n.h)(s),"g");if(a=e.text.replace(t,"{see additional}"),"number"==typeof i){const e=new RegExp(`{see additional}_${i}`,"g");a=a.replace(e,"{see additional}_{see additional}")}}return a}i.bS},25562:(e,t,s)=>{"use strict";s.d(t,{_7:()=>n});const i=[[300,250],[300,300],[300,500],[300,600],[320,480],[336,280],[480,320]],n=e=>a(i,e?120:0,140),a=(e,t=0,s=0)=>{if("undefined"==typeof window)return e;return((e,t,s)=>{const i=e.filter((e=>e[0]<t&&e[1]<s));return 0===i.length?[e[0]]:i})(e,window.innerWidth-t,window.innerHeight-s)}},59886:(e,t,s)=>{"use strict";s.d(t,{F7:()=>o,GG:()=>g,Hf:()=>u,Vc:()=>h,XI:()=>v,XO:()=>l,ZV:()=>p,cy:()=>d,kw:()=>m,wz:()=>a,xH:()=>c});var i=s(25562),n=s(42873);const a={adServerCurrency:"EUR",conversionRateFile:`${"undefined"!=typeof window&&(null==(r=window.appData)?void 0:r.cdnUrl)?window.appData.cdnUrl:"https://yastatic.net/s3"}/games-static/static-data/prebid/currency-file@1/latest.json`,defaultRates:{EUR:{EUR:1,USD:1.1},USD:{EUR:.9,USD:1}}};var r;const o={buckets:[{increment:.01,max:3,precision:2},{increment:.1,max:10},{increment:.2,max:50}]},d={gdpr:{actionTimeout:1e4,cmpApi:"iab",defaultGdprScope:!0,rules:[{enforcePurpose:!0,enforceVendor:!0,purpose:"basicAds",vendorExceptions:["between","cpmstar","pubmatic","rtbhouse","smartadserver","yandex"]}],timeout:5e3},usp:{timeout:100}};var l=(e=>(e.EMPTY_SLOT="Google slot event is empty",e.INSTREAM_EMPTY="Instream response is empty",e.NO_SLOT="googletag couldn't create gptSlot",e))(l||{});const c=(0,i._7)(!0),h=(e,t,s)=>{const i=e?"playhop":"yandex",a=n.U[i][s].interstitial[t];return{mediaTypes:{banner:{sizes:c}},bids:a}},u={},p=5e3,v=8e3,m=1e3,g={aws:"https://statics.games-storage-aws.yandex.net/statics/prebid/prebid8.10.0.js",yastatic:"https://yastatic.net/s3/games-static/static-data/prebid/prebid8.50.0.js"}},25798:(e,t,s)=>{"use strict";s.d(t,{cQ:()=>E,BA:()=>I,OH:()=>L});var i=s(46210),n=s(36529),a=s(65015),r=s(40656),o=Object.defineProperty,d=Object.defineProperties,l=Object.getOwnPropertyDescriptors,c=Object.getOwnPropertySymbols,h=Object.prototype.hasOwnProperty,u=Object.prototype.propertyIsEnumerable,p=(e,t,s)=>t in e?o(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;r.WT;v=((e,t)=>{for(var s in t||(t={}))h.call(t,s)&&p(e,s,t[s]);if(c)for(var s of c(t))u.call(t,s)&&p(e,s,t[s]);return e})({},{default:[[300,250],[300,300]],wide:[[728,90],[750,200],[970,90],[970,250],[980,90],[980,120]]}),d(v,l({wide:[[728,90],[970,90],[970,250]]}));var v;const m={filterSettings:{iframe:{bidders:"*",filter:"include"}},iframeEnabled:!0,syncEnabled:!0};var g=s(59886),w=s(91605),y=s(68199),f=s(93298),b=s(15771),A=s(90380),S=(e,t,s)=>new Promise(((i,n)=>{var a=e=>{try{o(s.next(e))}catch(e){n(e)}},r=e=>{try{o(s.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,r);o((s=s.apply(e,t)).next())}));const k=(0,f.M$)("PrebidUtils",f.XG.Adv,{background:"#0c6c09",text:"#ccc"});function E({cdnUrl:e,flags:t,fullUrl:s,options:{isSlowCountry:n}}){const a=(0,i.xA)(s);if(a)return(0,i.Xv)(a);if((0,b.jX)(t))return g.GG.aws;let r=g.GG.yastatic;const o=(0,b.di)(t,A.Z.advPrebidScript);if(o){if(/^https:\/\//.test(o))return o;r=r.replace(/(?:\d+\.){1,2}\d+(\.js)$/,`${o}$1`)}return(0,y.R)(n)&&e&&(r=r.replace("https://yastatic.net/s3",e)),r}const I=e=>S(void 0,null,(function*(){return new Promise((t=>{window.pbjs=window.pbjs||{que:[]};const{pbjs:s}=window;s.que.push((()=>S(void 0,null,(function*(){t(yield e(s))}))))}))}));function R(){const e=new URL(window.location.href);return e.hostname=e.hostname.replace(/^.+\.([a-z0-9]+(\.com)?\.[a-z]+)$/,"$1"),e.search="",e.hash="",e.href}const P=5e3;function T(){let e=!1;return Promise.race([I((t=>S(this,null,(function*(){k("Set prebid config"),e=!0,t.setConfig({consentManagement:g.cy,currency:g.wz,debug:f.HQ,deviceAccess:!0,enableTIDs:!0,enableSendAllBids:!0,fetchBids:!0,pageUrl:R(),priceGranularity:g.F7,targetingControls:{allowTargetingKeys:["BIDDER","AD_ID","PRICE_BUCKET","SIZE","DEAL","SOURCE","FORMAT","UUID","CACHE_ID","CACHE_HOST","ADOMAIN","ACAT","CRID","DSP"],allowSendAllBidsTargetingKeys:["BIDDER","AD_ID","PRICE_BUCKET","SIZE","DEAL","SOURCE","FORMAT","UUID","CACHE_ID","CACHE_HOST","ADOMAIN","ACAT","CRID","DSP"]},transmitTid:!0,userSync:m});const s=(0,w.NR)();s&&t.installedModules.includes("yandexAnalyticsAdapter")&&t.enableAnalytics({provider:"yandex",options:{counters:[s]}}),f.HQ&&function(e){e.onEvent("auctionInit",(()=>{k("Auction init")})),e.onEvent("auctionEnd",(t=>{const s=t.bidsReceived.length?"success":"empty",i="success"===s?e.getHighestCpmBids().map((e=>({ad:e.ad,adunit:e.adUnitCode,adId:e.adId,bidder:e.bidder,cpm:e.cpm,size:e.size,time:e.timeToRespond}))):void 0;k(`Auction end with status = ${s}; result = ${JSON.stringify(i,null,"\t")}`)})),e.onEvent("bidderError",(function(e){var t;const{bidderRequest:s}=e,i=null==(t=s.bids[0])?void 0:t.adUnitCode;k(`Bidder error code = ${s.bidderCode}; adUnitCode = ${i}`)})),e.onEvent("noBid",(function(e){const{adUnitCode:t}=e;k(`No bid for adUnitCode = ${t}`)})),e.onEvent("adRenderFailed",(e=>{k("adRenderFailed, bidder =",e.bid.bidder)})),e.onEvent("adRenderSucceeded",(e=>{k("adRenderSucceeded, bidder =",e.bid.bidder)}))}(t)})))),(0,n.D)(P).then((()=>{e||(k("Config was not set."),(0,a.fF)(new Error("[prebid_tgo] Config was not set (canceled by timeout)")))}))])}let C;function L(){return C||(C=new Promise((e=>{T().finally((()=>{C=Promise.resolve(),e()}))}))),C}},78569:(e,t,s)=>{"use strict";s.d(t,{H:()=>n});var i=s(37705);function n({adUnitCodes:e,advTag:t,bids:s}){for(let n of e){const e=null==s?void 0:s[n];if(e){const s=e.bids[0];(0,i.Kz)("prebid_auction","",{additional:{tag:t,bidder:s.bidder,currency:s.currency,originalCurrency:s.originalCurrency,size:s.size}})}else(0,i.Kz)("prebid_auction","",{additional:{tag:t,bidder:"none"}})}}},32054:(e,t,s)=>{"use strict";s.d(t,{CU:()=>a,ZY:()=>n,pr:()=>r});var i=s(26213);function n({flags:e,isConfirmedGuard:t,location:s}){return!((n=s.search)&&"1"===new URLSearchParams(n.replace(/^\?/,"")).get(i.U)||e.skip_guard)&&(!!function(e){return e?-1!==e.hash.indexOf("info=true")||-1!==e.search.indexOf("info=true"):"undefined"!=typeof window&&-1!==window.location.href.indexOf("info=true")}(s)||!t);var n}function a({gameData:e,userRegionData:t}){return!(null==t?void 0:t.isForeign)&&(!!(e&&e.extraFeatures.purchases&&e.extraFeatures.hasProducts)&&!(null==e?void 0:e.askedPurchasesInfoPermission))}function r({gameData:e,userRegionData:t}){return!a({gameData:e,userRegionData:t})&&Boolean(null==e?void 0:e.guard)}},3436:(e,t,s)=>{"use strict";let i;s.d(t,{R:()=>i});try{new EventTarget,i=EventTarget}catch(e){class t{constructor(){this.eventListeners={}}addEventListener(e,t){this.eventListeners[e]=this.eventListeners[e]||[],this.eventListeners[e].push(t)}removeEventListener(e,t){this.eventListeners[e]&&(this.eventListeners[e]=this.eventListeners[e].filter((e=>e!==t)))}dispatchEvent(e){const t=e.type;for(const s of this.eventListeners[t]||[]){const t="handleEvent"in s?s.handleEvent:s;try{t.apply(s,[e])}catch(e){}}return!e.defaultPrevented}}i=t}},73285:(e,t,s)=>{"use strict";function i(e){if(!e)return"";const t={"&amp;":"&","&#39;":"'","&quot;":'"'};return e.replace(/&amp;|&#39;|&quot;/g,(e=>t[e]))}s.d(t,{T:()=>i})},41318:(e,t,s)=>{"use strict";function i(e,t,s){if(!t)return s("guard.player.permissions.description");const i=s("payments.currency.genitive").toLowerCase();return s(e?"guard.player.permissions.purchasesInfo.description.auth.withCurrencyName":"guard.player.permissions.purchasesInfo.description.notAuth.withCurrencyName",{params:{currencyName:i}})}s.d(t,{f:()=>i})},73171:(e,t,s)=>{"use strict";s.d(t,{D:()=>n});var i=s(87363);function n(e){const t=(0,i.useRef)();return(0,i.useEffect)((()=>{t.current=e}),[e]),t.current}},81442:(e,t,s)=>{"use strict";s.d(t,{r:()=>n});var i=s(58432);const n=()=>"object"==typeof window&&"2735850"===(0,i.KT)()},97733:(e,t,s)=>{"use strict";s.d(t,{U:()=>A});var i=s(65015),n=s(5e4),a=s(34711),r=s(7991),o=s(97553),d=s(93298),l=s(99725),c=Object.defineProperty,h=Object.defineProperties,u=Object.getOwnPropertyDescriptors,p=Object.getOwnPropertySymbols,v=Object.prototype.hasOwnProperty,m=Object.prototype.propertyIsEnumerable,g=(e,t,s)=>t in e?c(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,w=(e,t)=>{for(var s in t||(t={}))v.call(t,s)&&g(e,s,t[s]);if(p)for(var s of p(t))m.call(t,s)&&g(e,s,t[s]);return e};const y=(0,d.M$)("log-adv",d.XG.Adv),f=Date.now(),b={[n.$.ANCHOR]:0,[n.$.CATALOG]:0,[n.$.INTERSTITIAL]:0,[n.$.REWARDED]:0,[n.$.STICKY]:0};class A{constructor(e){this.startTime=-1,this.requestStartTime=-1,this.showStartTime=-1,this.previousEventNames=[],this.additional=Object.assign(this.getGeneralEventParams(),e)}tag(e){return this.additional.tag=e,this}bindRequest(e){this.additional.ad_req_id=e.additional.ad_req_id}copy(e={}){const t=Object.assign(Object.create(Object.getPrototypeOf(this)),this);return t.previousEventNames=[...this.previousEventNames],t.additional=w(w({},this.additional),e),t}getGeneralEventParams(){const e={},t=(0,a.X)();t&&(e.clid=String(t));const s=(0,r.W5)();return s&&(e.gclid=String(s)),e}logError(e,t={}){const s=new Error(e);s.additional=t,(0,i.fF)(s,{prefix:"Adv ClickDaemon error"})}checkOrder(e,t){this.previousEventNames.includes(e)||this.logError(`No precending ${e} event call before ${t}`)}sendLog(e,t={}){var s,i,n,a;n=w(w({},this.additional),t),a={documentHidden:"hidden"===document.visibilityState},t=h(n,u(a)),-1!==this.startTime&&(t.timeshift=Date.now()-this.startTime||-1),(null==(s=t.provider)?void 0:s.includes("_block"))&&(t.provider=t.provider.replace("_block","")),t.provider&&!t.advtype&&(t.advtype=t.provider),this.previousEventNames.push(e),d.HQ&&y("clickdaemon",`adv2_${e}`,t),null==(i=window.clickdaemonLog)||i.call(window,`adv_${e}`,t)}hadEvent(e){return this.previousEventNames.includes(e)}tryOpen({provider:e,reason:t}){this.additional.ad_seq_id=(0,l.w)(),this.additional.reason=t,e&&(this.additional.provider=e);const s={pageShow:++b[this.additional.tag],pageStartTime:Date.now()-f};this.sendLog(o.zL.TRY_OPEN,s),this.startTime=Date.now()}noAdv(){this.checkOrder(o.zL.TRY_OPEN,o.zL.NO_ADV),this.sendLog(o.zL.NO_ADV)}skip(e){this.checkOrder(o.zL.TRY_OPEN,o.zL.SKIP),this.sendLog(o.zL.SKIP,{reason:e})}rateLimited(e){this.checkOrder(o.zL.TRY_OPEN,o.zL.RATE_LIMITED),this.sendLog(o.zL.RATE_LIMITED,{reason:e})}demand({advBlockId:e,depth:t,provider:s,reason:i}){this.checkOrder(o.zL.TRY_OPEN,o.zL.DEMAND),this.additional.adv_block_id=e,this.additional.depth=null!=t?t:0,s&&(this.additional.provider=s),i&&(this.additional.reason=i),this.sendLog(o.zL.DEMAND)}waterfall({advBlockId:e,depth:t,provider:s,reason:i,tag:n}){this.checkOrder(o.zL.DEMAND,o.zL.WATERFALL),n&&(this.additional.tag=n),this.additional.provider=s,this.additional.adv_block_id=e,this.additional.depth=t,this.additional.reason=i,this.sendLog(o.zL.WATERFALL)}request(e){e||this.checkOrder(o.zL.DEMAND,o.zL.REQUEST),this.requestStartTime=Date.now(),e&&(this.additional.adv_block_id=e.advBlockId,e.reason&&(this.additional.reason=e.reason),e.provider&&(this.additional.provider=e.provider)),(null==e?void 0:e.adReqId)?this.additional.ad_req_id=e.adReqId:this.additional.ad_req_id=(0,l.w)();const t={};void 0!==this.highestCpmBidder&&(t.highestCpmBidder=this.highestCpmBidder),this.sendLog(o.zL.REQUEST,t)}response(){this.checkOrder(o.zL.REQUEST,o.zL.RESPONSE);const e={reason:"success",time_to_close:-1===this.requestStartTime?-1:Date.now()-this.requestStartTime};void 0!==this.highestCpmBidder&&(e.highestCpmBidder=this.highestCpmBidder),this.sendLog(o.zL.RESPONSE,e)}responseEmpty(){this.checkOrder(o.zL.REQUEST,o.zL.RESPONSE_EMPTY);const e={time_to_close:-1===this.requestStartTime?-1:Date.now()-this.requestStartTime};void 0!==this.highestCpmBidder&&(e.highestCpmBidder=this.highestCpmBidder),this.sendLog(o.zL.RESPONSE_EMPTY,e)}show(){this.checkOrder(o.zL.DEMAND,o.zL.SHOW),this.showStartTime=Date.now(),this.sendLog(o.zL.SHOW)}rewarded(){this.checkOrder(o.zL.SHOW,o.zL.REWARDED),this.sendLog(o.zL.REWARDED)}close(){this.checkOrder(o.zL.SHOW,o.zL.CLOSE),this.sendLog(o.zL.CLOSE,{time_to_close:-1===this.showStartTime?-1:Date.now()-this.showStartTime})}noContent(){this.checkOrder(o.zL.RESPONSE_EMPTY,o.zL.NO_CONTENT),this.sendLog(o.zL.NO_CONTENT)}fail(e){this.sendLog(o.zL.FAIL,{reason:String(e)})}error(e){this.sendLog(o.zL.ERROR,{reason:String(e)})}}},65068:(e,t,s)=>{"use strict";s.d(t,{i:()=>b});var i=s(23404),n=s(65015),a=s(34711),r=s(7991),o=s(97553),d=s(60295),l=s(93298),c=s(99725),h=Object.defineProperty,u=Object.defineProperties,p=Object.getOwnPropertyDescriptors,v=Object.getOwnPropertySymbols,m=Object.prototype.hasOwnProperty,g=Object.prototype.propertyIsEnumerable,w=(e,t,s)=>t in e?h(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,y=(e,t)=>{for(var s in t||(t={}))m.call(t,s)&&w(e,s,t[s]);if(v)for(var s of v(t))g.call(t,s)&&w(e,s,t[s]);return e};const f=(0,l.M$)("log-adv",l.XG.Adv);class b{constructor(e){this.additional=e,this.requestHistory=[],this.openHistory=[],this.showStartTime={},this.requestStartTime={},this.seqToReqMap={}}request(e){var t;const s=Object.assign(this.getGeneralEventParams(),{ad_req_id:(0,c.w)(),adv_block_id:e.advBlockId,advtype:e.advtype,adv_block_type:e.adv_block_type||e.advtype,depth:String(null!=(t=e.depth)?t:Object.keys(this.requestHistory).length),reason:e.reason||o.p_.ONSPOT});if(this.requestStartTime[s.ad_req_id]=Date.now(),e.prevReqId)s.prev_ad_req_id=e.prevReqId;else if("0"!==s.depth)try{s.prev_ad_req_id=this.getPrevAdReqId(Number(s.depth))}catch(e){this.logError("prev_ad_req_id is not defined",(i=y({event:o.zL.REQUEST},s),n={history:this.requestHistory.map((e=>e.ad_req_id))},u(i,p(n))))}var i,n;return this.requestHistory.push(s),this.sendLog(o.zL.REQUEST,s),s.ad_req_id}restoreRequest(e){this.requestHistory.push(e)}response({adReqId:e,depth:t,clickUrl:s,reason:i,advBlockType:n}){let a=-1;if(e)a=this.requestHistory.findIndex((t=>t.ad_req_id===e));else if(void 0!==t)for(let e=this.requestHistory.length-1;e>=0;e--)if(this.requestHistory[e].depth===String(t)){a=e;break}if(-1===a)return void this.logError("Request history not found",y({adReqId:e,depth:t,clickUrl:s,reason:i,advBlockType:n},this.getGeneralEventParams()));const r=this.requestHistory[a],l=Date.now()-this.requestStartTime[r.ad_req_id],c=Object.assign(this.getGeneralEventParams(),{ad_req_id:r.ad_req_id,adv_block_id:r.adv_block_id,adv_block_type:n||r.advtype,advtype:r.advtype,depth:String(r.depth),time_to_close:String(l)});r.prev_ad_req_id&&(c.prev_ad_req_id=r.prev_ad_req_id),s&&(this.requestHistory[a].click_url=s,c.click_url=s),i&&(c.reason=i),(0,d.s4)("load_adv_time",l,!0,{"-additional":encodeURIComponent(JSON.stringify({ad_req_id:r.ad_req_id,adv_block_id:r.adv_block_id,adv_block_type:n||r.advtype,advtype:r.advtype,depth:String(r.depth),tag:r.tag||"",reason:r.reason||""}))}),this.sendLog(o.zL.RESPONSE,c)}rerender(e,t){return this.tryOpen(e,t,o.zL.RERENDER)}tryOpen(e,t,s=o.zL.TRY_OPEN){const i=Object.assign(this.getGeneralEventParams(),{ad_seq_id:(0,c.w)(),adv_block_id:e,advtype:t,startTime:Date.now()});return this.openHistory.push(i),this.sendLog(s,i),i.ad_seq_id}noAdv(e){this.sendNestedTryOpenLog(o.zL.NO_ADV,e)}rateLimited(e,t){this.sendNestedTryOpenLog(o.zL.RATE_LIMITED,t,{reason:e})}skip(e,t){this.sendNestedTryOpenLog(o.zL.SKIP,t,{reason:e})}demand(e,t=0,s,i){const n={};t&&(n.depth=String(t)),e&&(n.reason=e),(null==i?void 0:i.advBlockId)&&(n.adv_block_id=null==i?void 0:i.advBlockId),(null==i?void 0:i.advtype)&&(n.advtype=null==i?void 0:i.advtype),this.sendNestedTryOpenLog(o.zL.DEMAND,s,n)}error(e,t,s){const i=this.getGeneralNestedRequestParams(o.zL.ERROR,e,t);i.reason=s,this.sendLog(o.zL.ERROR,i)}fail(e,t,s){const i=this.getGeneralNestedRequestParams(o.zL.FAIL,e,t);i.reason=s,this.sendLog(o.zL.FAIL,i)}errorNoRequest({adSeqId:e,advBlockId:t,provider:s,error:i,depth:n}){const a=Object.assign(this.getGeneralEventParams(),{ad_req_id:"",ad_seq_id:e,adv_block_id:t,advtype:s,depth:n||0,reason:`Request was not initiated_${i}`});this.sendLog(o.zL.ERROR,a)}noContent(e,t,s={}){const i=this.getGeneralNestedRequestParams(o.zL.NO_CONTENT,e,t);this.sendLog(o.zL.NO_CONTENT,y(y({},i),s))}show(e,t,s,i){const n=this.getGeneralNestedRequestParams(o.zL.SHOW,e,t,s);i&&(n.reason=i),this.showStartTime[t]=Date.now(),this.sendLog(o.zL.SHOW,n)}rewarded(e,t){const s=this.getGeneralNestedRequestParams(o.zL.REWARDED,e,t);this.sendLog(o.zL.REWARDED,s)}close(e,t){const s=this.getGeneralNestedRequestParams(o.zL.CLOSE,e,t);s.time_to_close=String(Date.now()-this.showStartTime[t]),this.sendLog(o.zL.CLOSE,s)}getRequestByAdReqId(e){return this.requestHistory.find((t=>t.ad_req_id===e))}sendLog(e,t){var s;t.documentHidden="hidden"===document.visibilityState,l.HQ&&f("clickdaemon",`adv_${e}`,t),null==(s=window.clickdaemonLog)||s.call(window,`adv_${e}`,t)}getGeneralNestedRequestParams(e,t,s,i){t?this.seqToReqMap[s]&&(this.seqToReqMap[s]=t):t=this.seqToReqMap[s];const n=this.requestHistory.find((e=>e.ad_req_id===t)),a=this.openHistory.find((e=>e.ad_seq_id===s));n||this.logError("ad_req_id is not found",y({event:e,adReqId:t,adSeqId:s,clickUrl:i,advtype:null==a?void 0:a.advtype},this.getGeneralEventParams())),a||this.logError("ad_seq_id is not found",y({event:e,adReqId:t,adSeqId:s,clickUrl:i,advtype:null==n?void 0:n.advtype},this.getGeneralEventParams()));const r=Object.assign(this.getGeneralEventParams(),{ad_req_id:t,ad_seq_id:s,adv_block_id:(null==n?void 0:n.adv_block_id)||"",adv_block_type:null==n?void 0:n.advtype,advtype:null==n?void 0:n.advtype,click_url:i||(null==n?void 0:n.click_url)||"",depth:(null==n?void 0:n.depth)||"0"});return(null==n?void 0:n.adsessionid)&&(r.adsessionid=null==n?void 0:n.adsessionid),(null==n?void 0:n.prev_ad_req_id)&&(r.prev_ad_req_id=n.prev_ad_req_id),Object.assign(this.getGeneralEventParams(),r)}sendNestedTryOpenLog(e,t,s={}){if(!this.openHistory.length)return void this.logError("No adv_try_open was called",y(y({event:e,adSeqId:t},s),this.getGeneralEventParams()));let i;t&&(i=this.openHistory.find((e=>e.ad_seq_id===t))),i||(i=this.openHistory[this.openHistory.length-1]);const n=Object.assign({},i,s);delete n.startTime,this.sendLog(e,n)}getGeneralEventParams(){const e=Object.assign({},this.additional),t=(0,a.X)();t&&(e.clid=String(t));const s=(0,r.W5)();return s&&(e.gclid=String(s)),e}getPrevAdReqId(e){const t=Object.keys(this.requestHistory).length;let s="";if(e){if(t>=e)for(let t=this.requestHistory.length-1;t>=0;t--)if(this.requestHistory[t].depth===String(e-1)){s=this.requestHistory[t].ad_req_id;break}}else t>0&&(s=this.requestHistory[t-1].ad_req_id);if(!s)throw new Error;return s}logError(e,t={}){const s=new Error(e);s.additional=t,(0,n.fF)(s,{prefix:i.yt})}}},97553:(e,t,s)=>{"use strict";s.d(t,{Jm:()=>r,Ud:()=>n,o9:()=>a,p_:()=>i,zL:()=>o});var i=(e=>(e.ONSPOT="onspot",e.PRELOAD="preload",e.PRELOAD_WATERFALL="preload_waterfall",e.REFRESH="refresh",e.START_FULLSCREEN="start_fullscreen",e.WATERFALL="waterfall",e))(i||{}),n=(e=>(e.EMPTY="empty",e.ERROR="error",e.NOT_IMPL="not_impl",e.SUCCESS="success",e))(n||{}),a=(e=>(e.SKIP="skip",e))(a||{}),r=(e=>(e.ALL_ADS_DISABLED_BY_PARTNERS_KIT="all_ads_disabled_by_partners_kit",e.ANOTHER_AD_OPENED="another_ad_opened",e.INTERSTITIAL_ADS_TURN_OFF="interstitial_ads_turn_off",e.REWARDED_ADS_TURN_OFF="rewarded_ads_turn_off",e.TV="tv",e.UNKNOWN="unknown",e.UTM="utm",e))(r||{}),o=(e=>(e.CLOSE="close",e.DEMAND="demand",e.ERROR="error",e.FAIL="fail",e.NO_ADV="no_adv",e.NO_CONTENT="no_content",e.RATE_LIMITED="rate_limited",e.REQUEST="request",e.RERENDER="rerender",e.RESPONSE="response",e.RESPONSE_EMPTY="response_empty",e.REWARDED="rewarded",e.SHOW="show",e.SKIP="skip",e.TRY_OPEN="try_open",e.WATERFALL="waterfall",e))(o||{})},4070:(e,t,s)=>{"use strict";s.d(t,{Z:()=>w});var i=s(93298),n=Object.defineProperty,a=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,d=(e,t,s)=>t in e?n(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,l=(e,t)=>{for(var s in t||(t={}))r.call(t,s)&&d(e,s,t[s]);if(a)for(var s of a(t))o.call(t,s)&&d(e,s,t[s]);return e};s(73930);const c=["height","width"],h=["top","left","right","bottom"],u=[...c,...h],p="game",v=[".game",".play-guard-dialog",".merge-conflicts",".guard"],m=(0,i.M$)("ResizeBlockManager",i.XG.Dev,{background:"#c7aa00"}),g="ResizeBlockManager";const w=new class{constructor(){if(this.rootElements=[],this.blocks={},this.resizeBlocks={},this.resizes={},this.resizeListeners={},this.getObserverCallback=(e,t,s)=>(i,n)=>{const a=e.querySelector(t);a&&(n.disconnect(),s(a))},"undefined"==typeof window)return;let e;try{window.parent[g],e=window.parent}catch(t){e=window}if(e[g]){const t=e[g];t.rootElements.includes(window.document.body)||(t.rootElements.push(window.document.body),t.updateBlocks(),t.applyResizeBlocks("new rootElement"))}else e[g]=this,this.rootElements=[window.document.body];return e[g]}addResizeBlockListener(e,t,s=!0){var i;m("addListener",e),this.resizeListeners[e]||(this.resizeListeners[e]=[]);const n=this.resizeListeners[e];if(-1===n.indexOf(t)){if(n.push(t),s){const t=e===p?".game":e;this.resizeBlocks[t]&&this.callbackBlock(e,null!=(i=this.resizeBlocks[t])?i:{})}}else m("try to add existing listener, ",e)}removeResizeBlockListener(e,t){if(m("removeListener",e),!this.resizeListeners[e])return;const s=this.resizeListeners[e],i=s.indexOf(t);-1!==i&&s.splice(i,1)}addResizeBlock(e,t){m("addResize",e,t),this.resizes[e]=t,this.calcResizeBlocks(),this.updateBlocks(),this.applyResizeBlocks("addResizeBlock")}removeResizeBlock(e){m("removeResize",e),this.resizes[e]&&(delete this.resizes[e],this.calcResizeBlocks(),this.updateBlocks(),this.applyResizeBlocks("removeResizeBlock"))}findHTMLElement(e){let t=null;for(const s of this.rootElements)if(t=s.querySelector(e),t)break;if(t)return void(this.blocks[e]=t);m("create MutationObserver for ",e);const s=this.rootElements.map((t=>{const s=new MutationObserver(this.getObserverCallback(t,e,(t=>{this.blocks[e]=t,this.applyResizeBlocks("block found "+e)})));return s.observe(t,{childList:!0}),s}));this.blocks[e]=s}updateBlocks(){for(const e in this.blocks){if(void 0!==this.resizeBlocks[e])continue;const t=this.blocks[e];t instanceof Array?(t.forEach((e=>{e.disconnect()})),delete this.blocks[e]):(this.clearResizeBlock(e,this.blocks[e]),delete this.blocks[e])}for(const e in this.resizeBlocks)void 0===this.blocks[e]&&this.findHTMLElement(e)}calcResizeBlocks(){const e={};for(const t in this.resizes){const s=this.resizes[t];for(const t in s)if(s[t])if(t===p)for(const i of v)this.calcResizeParam(e,s[t],i);else this.calcResizeParam(e,s[t],t)}this.resizeBlocks=e}calcResizeParam(e,t,s){var i,n;let a=e[s];a||(a={},e[s]=a);for(const e of u)a[e]=(null!=(i=a[e])?i:0)+(null!=(n=t[e])?n:0)}applyResizeBlocks(e="unknown"){m(`applyResize (${e})`,this.resizeBlocks,this.blocks);for(const e in this.resizeBlocks){const t=this.blocks[e];if(!t||Array.isArray(t))continue;const s=this.resizeBlocks[e];for(const e of h)(null==s?void 0:s[e])?t.style[e]=s[e]+"px":t.style.removeProperty(e);for(const e of c)(null==s?void 0:s[e])?t.style[e]=`calc(100% + ${s[e]}px)`:t.style.removeProperty(e);this.callbackBlock(e,null!=s?s:{})}}clearResizeBlock(e,t){for(const e of u)t.style.removeProperty(e);this.callbackBlock(e,{})}callbackBlock(e,t){var s;if(".game"===e&&this.callbackBlock(p,t),null==(s=this.resizeListeners[e])?void 0:s.length)for(const s of this.resizeListeners[e])s(e,l({top:0,left:0,right:0,bottom:0,width:0,height:0},t))}removeDefaultClass(e){const t=window.document.body;Array.from(t.classList).forEach((s=>{e.forEach((e=>{s.startsWith(e)&&t.classList.remove(s)}))}))}}},909:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var i=s(43548),n=s(91521),a=s(48810),r=s(41811);function o(){(0,a.Ur)(n.Z,"true"),i.Z.post({type:"payments",action:"platform-purchase-start",data:{paymentsConfig:{},purchaseConfig:{id:r.U0.NO_ADS_ONE_DAY,developerPayload:""}}})}},77430:(e,t,s)=>{"use strict";s.d(t,{Z:()=>n});class i extends Error{constructor(e,t){super(e),this.name=this.constructor.name,this.code=t,Object.setPrototypeOf(this,i.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,i)}}const n=i},42762:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});const i={"sz-18":"checkbox-critical-module__sz-18--JPKaQ","align-top":"checkbox-critical-module__align-top--TAhHZ","align-center":"checkbox-critical-module__align-center--kFxX3","align-bottom":"checkbox-critical-module__align-bottom--XM9sc",checkbox:"checkbox-critical-module__checkbox--kaku1",checked:"checkbox-critical-module__checked--gXEO4",disabled:"checkbox-critical-module__disabled--ixUBR",part:"checkbox-critical-module__part--bzRf2",control:"checkbox-critical-module__control--H1774",tick:"checkbox-critical-module__tick--KVCpI",wrapper:"checkbox-critical-module__wrapper--pnfLG",label:"checkbox-critical-module__label--fe3TK"}},16280:(e,t,s)=>{"use strict";s.r(t)},9737:(e,t,s)=>{"use strict";s.r(t)},52390:(e,t,s)=>{"use strict";s.r(t)},33784:(e,t,s)=>{"use strict";s.r(t)},73930:(e,t,s)=>{"use strict";s.r(t)},37379:e=>{!function(){"use strict";e.exports={polyfill:function(){var e=window,t=document;if(!("scrollBehavior"in t.documentElement.style)||!0===e.__forceSmoothScrollPolyfill__){var s,i=e.HTMLElement||e.Element,n=468,a={scroll:e.scroll||e.scrollTo,scrollBy:e.scrollBy,elementScroll:i.prototype.scroll||d,scrollIntoView:i.prototype.scrollIntoView},r=e.performance&&e.performance.now?e.performance.now.bind(e.performance):Date.now,o=(s=e.navigator.userAgent,new RegExp(["MSIE ","Trident/","Edge/"].join("|")).test(s)?1:0);e.scroll=e.scrollTo=function(){void 0!==arguments[0]&&(!0!==l(arguments[0])?v.call(e,t.body,void 0!==arguments[0].left?~~arguments[0].left:e.scrollX||e.pageXOffset,void 0!==arguments[0].top?~~arguments[0].top:e.scrollY||e.pageYOffset):a.scroll.call(e,void 0!==arguments[0].left?arguments[0].left:"object"!=typeof arguments[0]?arguments[0]:e.scrollX||e.pageXOffset,void 0!==arguments[0].top?arguments[0].top:void 0!==arguments[1]?arguments[1]:e.scrollY||e.pageYOffset))},e.scrollBy=function(){void 0!==arguments[0]&&(l(arguments[0])?a.scrollBy.call(e,void 0!==arguments[0].left?arguments[0].left:"object"!=typeof arguments[0]?arguments[0]:0,void 0!==arguments[0].top?arguments[0].top:void 0!==arguments[1]?arguments[1]:0):v.call(e,t.body,~~arguments[0].left+(e.scrollX||e.pageXOffset),~~arguments[0].top+(e.scrollY||e.pageYOffset)))},i.prototype.scroll=i.prototype.scrollTo=function(){if(void 0!==arguments[0])if(!0!==l(arguments[0])){var e=arguments[0].left,t=arguments[0].top;v.call(this,this,void 0===e?this.scrollLeft:~~e,void 0===t?this.scrollTop:~~t)}else{if("number"==typeof arguments[0]&&void 0===arguments[1])throw new SyntaxError("Value could not be converted");a.elementScroll.call(this,void 0!==arguments[0].left?~~arguments[0].left:"object"!=typeof arguments[0]?~~arguments[0]:this.scrollLeft,void 0!==arguments[0].top?~~arguments[0].top:void 0!==arguments[1]?~~arguments[1]:this.scrollTop)}},i.prototype.scrollBy=function(){void 0!==arguments[0]&&(!0!==l(arguments[0])?this.scroll({left:~~arguments[0].left+this.scrollLeft,top:~~arguments[0].top+this.scrollTop,behavior:arguments[0].behavior}):a.elementScroll.call(this,void 0!==arguments[0].left?~~arguments[0].left+this.scrollLeft:~~arguments[0]+this.scrollLeft,void 0!==arguments[0].top?~~arguments[0].top+this.scrollTop:~~arguments[1]+this.scrollTop))},i.prototype.scrollIntoView=function(){if(!0!==l(arguments[0])){var s=function(e){for(;e!==t.body&&!1===u(e);)e=e.parentNode||e.host;return e}(this),i=s.getBoundingClientRect(),n=this.getBoundingClientRect();s!==t.body?(v.call(this,s,s.scrollLeft+n.left-i.left,s.scrollTop+n.top-i.top),"fixed"!==e.getComputedStyle(s).position&&e.scrollBy({left:i.left,top:i.top,behavior:"smooth"})):e.scrollBy({left:n.left,top:n.top,behavior:"smooth"})}else a.scrollIntoView.call(this,void 0===arguments[0]||arguments[0])}}function d(e,t){this.scrollLeft=e,this.scrollTop=t}function l(e){if(null===e||"object"!=typeof e||void 0===e.behavior||"auto"===e.behavior||"instant"===e.behavior)return!0;if("object"==typeof e&&"smooth"===e.behavior)return!1;throw new TypeError("behavior member of ScrollOptions "+e.behavior+" is not a valid value for enumeration ScrollBehavior.")}function c(e,t){return"Y"===t?e.clientHeight+o<e.scrollHeight:"X"===t?e.clientWidth+o<e.scrollWidth:void 0}function h(t,s){var i=e.getComputedStyle(t,null)["overflow"+s];return"auto"===i||"scroll"===i}function u(e){var t=c(e,"Y")&&h(e,"Y"),s=c(e,"X")&&h(e,"X");return t||s}function p(t){var s,i,a,o,d=(r()-t.startTime)/n;o=d=d>1?1:d,s=.5*(1-Math.cos(Math.PI*o)),i=t.startX+(t.x-t.startX)*s,a=t.startY+(t.y-t.startY)*s,t.method.call(t.scrollable,i,a),i===t.x&&a===t.y||e.requestAnimationFrame(p.bind(e,t))}function v(s,i,n){var o,l,c,h,u=r();s===t.body?(o=e,l=e.scrollX||e.pageXOffset,c=e.scrollY||e.pageYOffset,h=a.scroll):(o=s,l=s.scrollLeft,c=s.scrollTop,h=d),p({scrollable:o,method:h,startTime:u,startX:l,startY:c,x:i,y:n})}}}}()}}]);
//# sourceMappingURL=https://s3.mdst.yandex.net/games/source-maps/_/build/client/game/desktop/yandex/GameBody.component.async.149b2b528cb5aa476994.js.map